/*! For license information please see main.js.LICENSE.txt */
(()=>{var e={74:()=>{},417:(e,t,o)=>{"use strict";o.d(t,{g:()=>n});var r=o(202);class n extends r.k{static fromGraph(e){const t=new n(e.client);return t.setComponent(e.componentName),t}constructor(e,t="beta"){super(e,t)}forComponent(e){const t=new n(this.client);return this.setComponent(e),t}}},202:(e,t,o)=>{"use strict";o.d(t,{k:()=>p,G:()=>h});var r=o(877);class n{}var i=o(738),s=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class a{constructor(e,t,o,r){"/"!==o.charAt(0)&&(o="/"+o),this.resource=o,this.method=r,this.index=e,this.id=t}}class c{constructor(e){this.graph=e,this.allRequests=[],this.requestsQueue=[],this.scopes=[],this.nextIndex=0,this.retryAfter=0}get hasRequests(){return this.requestsQueue.length>0}get(e,t,o,r){const n=this.nextIndex++,i=new a(n,e,t,"GET");i.headers=r,this.allRequests.push(i),this.requestsQueue.push(n),o&&(this.scopes=this.scopes.concat(o))}executeNext(){return s(this,void 0,void 0,(function*(){const e=new Map;var t;if(this.retryAfter&&(yield(t=1e3*this.retryAfter,new Promise((e=>{setTimeout(e,t)}))),this.retryAfter=0),!this.hasRequests)return e;const o=this.requestsQueue.splice(0,20),s=new r.w5;for(const e of o.map((e=>this.allRequests[e])))s.addRequest({id:e.index.toString(),request:new Request(c.baseUrl+e.resource,{method:e.method,headers:e.headers})});const a=this.scopes.length?(0,i.z)(...this.scopes):[],l=this.graph.api("$batch").middlewareOptions(a),d=yield s.getContent(),u=yield l.post(d);for(const t of u.responses){const o=new n,r=this.allRequests[t.id];o.id=r.id,o.index=r.index,o.headers=t.headers,200===t.status?(t.headers["Content-Type"].includes("image/jpeg")?o.content="data:image/jpeg;base64,"+t.body:t.headers["Content-Type"].includes("image/pjpeg")?o.content="data:image/pjpeg;base64,"+t.body:o.content=t.body,e.set(r.id,o)):429===t.status&&(this.requestsQueue.unshift(t.id),this.retryAfter=Math.max(this.retryAfter,parseInt(t.headers["Retry-After"],10)||1))}return e}))}executeAll(){return s(this,void 0,void 0,(function*(){const e=new Map;for(;this.hasRequests;){const t=yield this.executeNext();for(const[o,r]of t)e.set(o,r)}return e}))}}c.baseUrl="https://graph.microsoft.com";var l=o(215),d=o(533),u=o(418);class p{constructor(e,t="v1.0"){this._client=e,this._version=t}get client(){return this._client}get componentName(){return this._componentName}get version(){return this._version}forComponent(e){const t=new p(this._client,this._version);return t.setComponent(e),t}api(e){let t=this._client.api(e).version(this._version);return this._componentName&&(t.middlewareOptions=e=>{const o=t;return o._middlewareOptions=o._middlewareOptions.concat(e),t},t=t.middlewareOptions([new l.x(this._componentName)])),t}createBatch(){return new c(this)}setComponent(e){this._componentName=e instanceof Element?e.tagName:e}}function h(e,t,o){const n=[new r.uM(e),new r.vU(new r.WI),new r.Pw,new d.i(u.l,e.name),new r.LW],s=r.KU.initWithMiddleware({middleware:(0,i.a)(...n)}),a=new p(s,t);return o?a.forComponent(o):a}},532:()=>{},157:(e,t,o)=>{"use strict";o.d(t,{b:()=>l});var r,n=o(789),i=o(437),s=o(468),a=o(873),c=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};!function(e){e.mobile="",e.tablet="tablet",e.desktop="desktop"}(r||(r={}));class l extends n.oi{constructor(){super(),this.direction="ltr",this._isLoadingState=!1,this._isFirstUpdated=!1,this.handleLocalizationChanged=this.handleLocalizationChanged.bind(this),this.handleDirectionChanged=this.handleDirectionChanged.bind(this),this.handleProviderUpdates=this.handleProviderUpdates.bind(this),this.handleActiveAccountUpdates=this.handleActiveAccountUpdates.bind(this),this.handleDirectionChanged(),this.handleLocalizationChanged()}get mediaQuery(){return this.offsetWidth<768?r.mobile:this.offsetWidth<1200?r.tablet:r.desktop}get isLoadingState(){return this._isLoadingState}get isFirstUpdated(){return this._isFirstUpdated}get strings(){return{}}connectedCallback(){super.connectedCallback(),a.r.onStringsUpdated(this.handleLocalizationChanged),a.r.onDirectionUpdated(this.handleDirectionChanged)}disconnectedCallback(){super.disconnectedCallback(),a.r.removeOnStringsUpdated(this.handleLocalizationChanged),a.r.removeOnDirectionUpdated(this.handleDirectionChanged),s.C.removeProviderUpdatedListener(this.handleProviderUpdates),s.C.removeActiveAccountChangedListener(this.handleActiveAccountUpdates)}firstUpdated(e){super.firstUpdated(e),this._isFirstUpdated=!0,s.C.onProviderUpdated(this.handleProviderUpdates),s.C.onActiveAccountChanged(this.handleActiveAccountUpdates),this.requestStateUpdate()}loadState(){return Promise.resolve()}clearState(){}fireCustomEvent(e,t,o=!1,r=!1){const n=new CustomEvent(e,{bubbles:o,cancelable:r,detail:t});return this.dispatchEvent(n)}updated(e){super.updated(e);const t=new CustomEvent("updated",{bubbles:!0,cancelable:!0});this.dispatchEvent(t)}requestStateUpdate(e=!1){return c(this,void 0,void 0,(function*(){if(!this._isFirstUpdated)return;this.isLoadingState&&!e&&(yield this._currentLoadStatePromise);const t=s.C.globalProvider;if(!t)return Promise.resolve();if(t.state!==i.Aw.SignedOut){if(t.state===i.Aw.Loading)return Promise.resolve();{const t=new Promise(((o,r)=>c(this,void 0,void 0,(function*(){try{this.setLoadingState(!0),this.fireCustomEvent("loadingInitiated"),yield this.loadState(),this.setLoadingState(!1),this.fireCustomEvent("loadingCompleted"),o()}catch(e){this.clearState(),this.setLoadingState(!1),this.fireCustomEvent("loadingFailed"),r(e)}return this._currentLoadStatePromise=this.isLoadingState&&this._currentLoadStatePromise&&e?this._currentLoadStatePromise.then((()=>t)):t}))))}}else this.clearState()}))}setLoadingState(e){this._isLoadingState!==e&&(this._isLoadingState=e,this.requestUpdate("isLoadingState"))}handleProviderUpdates(){this.requestStateUpdate()}handleActiveAccountUpdates(){return c(this,void 0,void 0,(function*(){this.clearState(),this.requestStateUpdate()}))}handleLocalizationChanged(){a.r.updateStringsForTag(this.tagName,this.strings),this.requestUpdate()}handleDirectionChanged(){this.direction=a.r.getDocumentDirection()}}!function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);i>3&&s&&Object.defineProperty(t,o,s)}([(0,n.sz)(),function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}("design:type",Object)],l.prototype,"direction",void 0)},734:(e,t,o)=>{"use strict";o.d(t,{v:()=>i});var r=o(789),n=o(157);class i extends n.b{get provider(){return this._provider}set provider(e){this._provider&&this.provider.removeStateChangedHandler((()=>this.stateChangedHandler)),this._provider=e,this._provider&&this.provider.onStateChanged((()=>this.stateChangedHandler))}get isAvailable(){return!0}firstUpdated(e){super.firstUpdated(e);let t=!1;if(this.dependsOn){let e=this.dependsOn;for(;e;){if(e.isAvailable){t=!0;break}e=e.dependsOn}}!t&&this.isAvailable&&this.initializeProvider()}initializeProvider(){}stateChangedHandler(){this.fireCustomEvent("onStateChanged",this.provider.state)}}!function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);i>3&&s&&Object.defineProperty(t,o,s)}([(0,r.Cb)({attribute:"depends-on",converter:e=>document.querySelector(e),type:String}),function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}("design:type",i)],i.prototype,"dependsOn",void 0)},887:(e,t,o)=>{"use strict";o.d(t,{h:()=>a});var r=o(789),n=o(818),i=o(157),s=o(641);class a extends i.b{constructor(){super(),this.templates={},this._renderedSlots=!1,this._renderedTemplates={},this._slotNamesAddedDuringRender=[],this.templateContext=this.templateContext||{}}update(e){this.templates=this.getTemplates(),this._slotNamesAddedDuringRender=[],super.update(e)}updated(e){super.updated(e),this.removeUnusedSlottedElements()}renderTemplate(e,t,o){if(!this.hasTemplate(e))return null;o=o||e,this._slotNamesAddedDuringRender.push(o),this._renderedSlots=!0;const i=r.dy`
      <slot name=${o}></slot>
    `;if(this._renderedTemplates.hasOwnProperty(o)){const{context:e,slot:r}=this._renderedTemplates[o];if((0,n.f)(e,t))return i;this.removeChild(r)}const a=document.createElement("div");return a.slot=o,a.dataset.generated="template",s.p.renderTemplate(a,this.templates[e],t,Object.assign({},this.templateContext)),this.appendChild(a),this._renderedTemplates[o]={context:t,slot:a},this.fireCustomEvent("templateRendered",{templateType:e,context:t,element:a}),i}hasTemplate(e){return this.templates&&this.templates[e]}getTemplates(){const e={};for(let t=0;t<this.children.length;t++){const o=this.children[t];if("TEMPLATE"===o.nodeName){const r=o;r.dataset.type?e[r.dataset.type]=r:e.default=r,r.templateOrder=t}}return e}removeUnusedSlottedElements(){if(this._renderedSlots){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.dataset&&t.dataset.generated&&!this._slotNamesAddedDuringRender.includes(t.slot)&&(this.removeChild(t),delete this._renderedTemplates[t.slot],e--)}this._renderedSlots=!1}}}},788:(e,t,o)=>{"use strict";o.d(t,{Graph:()=>n.k,createFromProvider:()=>n.G,BetaGraph:()=>i.g,MgtBaseComponent:()=>s.b,MgtBaseProvider:()=>a.v,MgtTemplatedComponent:()=>c.h,IProvider:()=>l.T8,LoginType:()=>l.Bz,ProviderState:()=>l.Aw,Providers:()=>d.C,CacheService:()=>u.Q,arraysAreEqual:()=>p.s,equals:()=>p.f,chainMiddleware:()=>h.a,prepScopes:()=>h.z,TeamsHelper:()=>f.P,GraphPageIterator:()=>m.H});var r=o(532);o.o(r,"BetaGraph")&&o.d(t,{BetaGraph:function(){return r.BetaGraph}}),o.o(r,"CacheService")&&o.d(t,{CacheService:function(){return r.CacheService}}),o.o(r,"Graph")&&o.d(t,{Graph:function(){return r.Graph}}),o.o(r,"GraphPageIterator")&&o.d(t,{GraphPageIterator:function(){return r.GraphPageIterator}}),o.o(r,"IProvider")&&o.d(t,{IProvider:function(){return r.IProvider}}),o.o(r,"LoginType")&&o.d(t,{LoginType:function(){return r.LoginType}}),o.o(r,"MgtBaseComponent")&&o.d(t,{MgtBaseComponent:function(){return r.MgtBaseComponent}}),o.o(r,"MgtBaseProvider")&&o.d(t,{MgtBaseProvider:function(){return r.MgtBaseProvider}}),o.o(r,"MgtTemplatedComponent")&&o.d(t,{MgtTemplatedComponent:function(){return r.MgtTemplatedComponent}}),o.o(r,"Msal2Provider")&&o.d(t,{Msal2Provider:function(){return r.Msal2Provider}}),o.o(r,"ProviderState")&&o.d(t,{ProviderState:function(){return r.ProviderState}}),o.o(r,"Providers")&&o.d(t,{Providers:function(){return r.Providers}}),o.o(r,"TeamsHelper")&&o.d(t,{TeamsHelper:function(){return r.TeamsHelper}}),o.o(r,"arraysAreEqual")&&o.d(t,{arraysAreEqual:function(){return r.arraysAreEqual}}),o.o(r,"chainMiddleware")&&o.d(t,{chainMiddleware:function(){return r.chainMiddleware}}),o.o(r,"createFromProvider")&&o.d(t,{createFromProvider:function(){return r.createFromProvider}}),o.o(r,"equals")&&o.d(t,{equals:function(){return r.equals}}),o.o(r,"prepScopes")&&o.d(t,{prepScopes:function(){return r.prepScopes}});var n=o(202),i=o(417),s=o(157),a=o(734),c=o(887),l=o(437),d=o(468),u=(o(164),o(828)),p=o(818),h=o(738),f=o(335),g=o(383);o.o(g,"GraphPageIterator")&&o.d(t,{GraphPageIterator:function(){return g.GraphPageIterator}}),o.o(g,"Msal2Provider")&&o.d(t,{Msal2Provider:function(){return g.Msal2Provider}}),o(641);var m=o(505);o(873),o(88),o(522)},88:(e,t,o)=>{"use strict";o.d(t,{D:()=>u});var r=o(437),n=o(877),i=o(202),s=o(738);const a="https://proxy.apisandbox.msdn.microsoft.com/svc?url=";class c extends i.k{constructor(e){const t=[new n.uM(e),new n.vU(new n.WI),new n.Pw,new l,new n.LW];super(n.KU.initWithMiddleware({baseUrl:a+"https://graph.microsoft.com/",middleware:(0,s.a)(...t)}))}forComponent(e){return this}}class l{execute(e){return t=this,o=void 0,n=function*(){try{const t=e.request,o=a.length;e.request=t.substring(0,o)+escape(t.substring(o))}catch(e){}return yield this._nextMiddleware.execute(e)},new((r=void 0)||(r=Promise))((function(e,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(t){var o;t.done?e(t.value):(o=t.value,o instanceof r?o:new r((function(e){e(o)}))).then(s,a)}c((n=n.apply(t,o||[])).next())}));var t,o,r,n}setNext(e){this._nextMiddleware=e}}var d=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class u extends r.T8{constructor(e=!1){super(),this.graph=new c(this),e?this.setState(r.Aw.SignedIn):this.setState(r.Aw.SignedOut)}login(){return d(this,void 0,void 0,(function*(){this.setState(r.Aw.Loading),yield new Promise((e=>setTimeout(e,3e3))),this.setState(r.Aw.SignedIn)}))}logout(){return d(this,void 0,void 0,(function*(){this.setState(r.Aw.Loading),yield new Promise((e=>setTimeout(e,3e3))),this.setState(r.Aw.SignedOut)}))}getAccessToken(){return Promise.resolve("{token:https://graph.microsoft.com/}")}get name(){return"MgtMockProvider"}}},522:(e,t,o)=>{"use strict";var r=o(789),n=o(734),i=o(468),s=o(88),a=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s};let c=class extends n.v{initializeProvider(){i.C.globalProvider=new s.D(!this.signedOut)}};a([(0,r.Cb)({attribute:"signed-out",type:Boolean}),function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}("design:type",Object)],c.prototype,"signedOut",void 0),c=a([(0,r.Mo)("mgt-mock-provider")],c)},437:(e,t,o)=>{"use strict";o.d(t,{T8:()=>s,Bz:()=>r,Aw:()=>n});var r,n,i=o(260);class s{constructor(){this._loginChangedDispatcher=new i.p,this._activeAccountChangedDispatcher=new i.p,this._state=n.Loading}get state(){return this._state}get name(){return"MgtIProvider"}setState(e){e!==this._state&&(this._state=e,this._loginChangedDispatcher.fire({}))}onStateChanged(e){this._loginChangedDispatcher.add(e)}removeStateChangedHandler(e){this._loginChangedDispatcher.remove(e)}setActiveAccount(e){this.fireActiveAccountChanged()}onActiveAccountChanged(e){this._activeAccountChangedDispatcher.add(e)}removeActiveAccountChangedHandler(e){this._activeAccountChangedDispatcher.remove(e)}fireActiveAccountChanged(){this._activeAccountChangedDispatcher.fire({})}getAccessTokenForScopes(...e){return this.getAccessToken({scopes:e})}}!function(e){e[e.Popup=0]="Popup",e[e.Redirect=1]="Redirect"}(r||(r={})),function(e){e[e.Loading=0]="Loading",e[e.SignedOut=1]="SignedOut",e[e.SignedIn=2]="SignedIn"}(n||(n={}))},468:(e,t,o)=>{"use strict";o.d(t,{C:()=>s});var r,n=o(260),i=o(437);class s{static get globalProvider(){return this._globalProvider}static set globalProvider(e){e!==this._globalProvider&&(this._globalProvider&&(this._globalProvider.removeStateChangedHandler(this.handleProviderStateChanged),this._globalProvider.removeActiveAccountChangedHandler(this.handleActiveAccountChanged)),e&&(e.onStateChanged(this.handleProviderStateChanged),e.onActiveAccountChanged(this.handleActiveAccountChanged)),this._globalProvider=e,this._eventDispatcher.fire(r.ProviderChanged))}static onProviderUpdated(e){this._eventDispatcher.add(e)}static removeProviderUpdatedListener(e){this._eventDispatcher.remove(e)}static onActiveAccountChanged(e){this._activeAccountChangedDispatcher.add(e)}static removeActiveAccountChangedListener(e){this._activeAccountChangedDispatcher.remove(e)}static me(){return e=this,t=void 0,r=function*(){if(!this._me){const e=this.client;if(e)try{const t=yield e.api("me").get();t&&t.id&&(this._me=t)}catch(e){}}return this._me},new((o=void 0)||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}));var e,t,o,r}static get client(){return s.globalProvider&&s.globalProvider.state===i.Aw.SignedIn?s.globalProvider.graph.client:null}static handleProviderStateChanged(){s.globalProvider&&s.globalProvider.state===i.Aw.SignedIn||(s._me=null),s._eventDispatcher.fire(r.ProviderStateChanged)}static handleActiveAccountChanged(){s._activeAccountChangedDispatcher.fire(null)}}s._eventDispatcher=new n.p,s._activeAccountChangedDispatcher=new n.p,function(e){e[e.ProviderChanged=0]="ProviderChanged",e[e.ProviderStateChanged=1]="ProviderStateChanged"}(r||(r={}))},164:(e,t,o)=>{"use strict";o(202),o(437)},828:(e,t,o)=>{"use strict";let r,n;o.d(t,{Q:()=>C});const i=new WeakMap,s=new WeakMap,a=new WeakMap,c=new WeakMap,l=new WeakMap;let d={get(e,t,o){if(e instanceof IDBTransaction){if("done"===t)return s.get(e);if("objectStoreNames"===t)return e.objectStoreNames||a.get(e);if("store"===t)return o.objectStoreNames[1]?void 0:o.objectStore(o.objectStoreNames[0])}return p(e[t])},set:(e,t,o)=>(e[t]=o,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function u(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(n||(n=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(h(this),e),p(i.get(this))}:function(...e){return p(t.apply(h(this),e))}:function(e,...o){const r=t.call(h(this),e,...o);return a.set(r,e.sort?e.sort():[e]),p(r)}:(e instanceof IDBTransaction&&function(e){if(s.has(e))return;const t=new Promise(((t,o)=>{const r=()=>{e.removeEventListener("complete",n),e.removeEventListener("error",i),e.removeEventListener("abort",i)},n=()=>{t(),r()},i=()=>{o(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",n),e.addEventListener("error",i),e.addEventListener("abort",i)}));s.set(e,t)}(e),o=e,(r||(r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>o instanceof e))?new Proxy(e,d):e);var t,o}function p(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,o)=>{const r=()=>{e.removeEventListener("success",n),e.removeEventListener("error",i)},n=()=>{t(p(e.result)),r()},i=()=>{o(e.error),r()};e.addEventListener("success",n),e.addEventListener("error",i)}));return t.then((t=>{t instanceof IDBCursor&&i.set(t,e)})).catch((()=>{})),l.set(t,e),t}(e);if(c.has(e))return c.get(e);const t=u(e);return t!==e&&(c.set(e,t),l.set(t,e)),t}const h=e=>l.get(e),f=["get","getKey","getAll","getAllKeys","count"],g=["put","add","delete","clear"],m=new Map;function v(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(m.get(t))return m.get(t);const o=t.replace(/FromIndex$/,""),r=t!==o,n=g.includes(o);if(!(o in(r?IDBIndex:IDBObjectStore).prototype)||!n&&!f.includes(o))return;const i=async function(e,...t){const i=this.transaction(e,n?"readwrite":"readonly");let s=i.store;return r&&(s=s.index(t.shift())),(await Promise.all([s[o](...t),n&&i.done]))[0]};return m.set(t,i),i}var b;b=d,d={...b,get:(e,t,o)=>v(e,t)||b.get(e,t,o),has:(e,t)=>!!v(e,t)||b.has(e,t)};var y=o(468),k=o(437),w=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class C{static getCache(e,t){const o=`${e.name}/${t}`;return this.isInitialized||this.init(),this.cacheStore.has(t)||this.cacheStore.set(o,new T(e,t)),this.cacheStore.get(o)}static clearCaches(){this.cacheStore.forEach((e=>indexedDB.deleteDatabase(e.getDBName())))}static get config(){return this.cacheConfig}static init(){let e;y.C.globalProvider&&(e=y.C.globalProvider.state),y.C.onProviderUpdated((()=>{e===k.Aw.SignedIn&&y.C.globalProvider.state===k.Aw.SignedOut&&this.clearCaches(),e=y.C.globalProvider.state})),this.isInitialized=!0}}C.cacheStore=new Map,C.isInitialized=!1,C.cacheConfig={defaultInvalidationPeriod:36e5,groups:{invalidationPeriod:null,isEnabled:!0},isEnabled:!0,people:{invalidationPeriod:null,isEnabled:!0},photos:{invalidationPeriod:null,isEnabled:!0},presence:{invalidationPeriod:3e5,isEnabled:!0},users:{invalidationPeriod:null,isEnabled:!0},response:{invalidationPeriod:null,isEnabled:!0},files:{invalidationPeriod:null,isEnabled:!0},fileLists:{invalidationPeriod:null,isEnabled:!0}};class T{constructor(e,t){if(!(t in e.stores))throw Error('"store" must be defined in the "schema"');this.schema=e,this.store=t}getValue(e){return w(this,void 0,void 0,(function*(){if(!window.indexedDB)return null;try{return(yield this.getDb()).get(this.store,e)}catch(e){return null}}))}putValue(e,t){return w(this,void 0,void 0,(function*(){if(window.indexedDB)try{yield(yield this.getDb()).put(this.store,Object.assign(Object.assign({},t),{timeCached:Date.now()}),e)}catch(e){return}}))}clearStore(){return w(this,void 0,void 0,(function*(){if(window.indexedDB)try{(yield this.getDb()).clear(this.store)}catch(e){return}}))}getDBName(){return`mgt-${this.schema.name}`}getDb(){return function(e,t,{blocked:o,upgrade:r,blocking:n,terminated:i}={}){const s=indexedDB.open(e,t),a=p(s);return r&&s.addEventListener("upgradeneeded",(e=>{r(p(s.result),e.oldVersion,e.newVersion,p(s.transaction))})),o&&s.addEventListener("blocked",(()=>o())),a.then((e=>{i&&e.addEventListener("close",(()=>i())),n&&e.addEventListener("versionchange",(()=>n()))})).catch((()=>{})),a}(this.getDBName(),this.schema.version,{upgrade:(e,t,o,r)=>{for(const t in this.schema.stores)this.schema.stores.hasOwnProperty(t)&&(e.objectStoreNames.contains(t)||e.createObjectStore(t))}})}}},215:(e,t,o)=>{"use strict";o.d(t,{x:()=>r});class r{constructor(e){this.componentName="string"==typeof e?e:e.tagName.toLowerCase()}}},260:(e,t,o)=>{"use strict";o.d(t,{p:()=>r});class r{constructor(){this.eventHandlers=[]}fire(e){for(const t of this.eventHandlers)t(e)}add(e){this.eventHandlers.push(e)}remove(e){for(let t=0;t<this.eventHandlers.length;t++)this.eventHandlers[t]===e&&(this.eventHandlers.splice(t,1),t--)}}},738:(e,t,o)=>{"use strict";o.d(t,{z:()=>n,a:()=>i});var r=o(877);function n(...e){const t={scopes:e};return[new r.xn(void 0,t)]}function i(...e){const t=e[0];let o=t;for(let t=1;t<e.length;++t){const r=e[t];o.setNext&&o.setNext(r),o=r}return t}},505:(e,t,o)=>{"use strict";o.d(t,{H:()=>n});var r=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class n{get value(){return this._value}get hasNext(){return!!this._nextLink}static create(e,t,o){return r(this,void 0,void 0,(function*(){const r=yield t.get();if(r&&r.value){const t=new n;return t._graph=e,t._value=r.value,t._nextLink=r["@odata.nextLink"],t._version=o||e.version,t}return null}))}static createFromValue(e,t,o){let r=new n;return r._graph=e,r._value=t,r._nextLink=o||null,r._version=e.version,r||null}next(){return r(this,void 0,void 0,(function*(){if(this._nextLink){const e=this._nextLink.split(this._version)[1],t=yield this._graph.api(e).version(this._version).get();if(t&&t.value&&t.value.length)return this._value=this._value.concat(t.value),this._nextLink=t["@odata.nextLink"],t.value}return null}))}}},873:(e,t,o)=>{"use strict";o.d(t,{r:()=>n});var r=o(260);class n{static get strings(){return this._strings}static set strings(e){this._strings=e,this._stringsEventDispatcher.fire(null)}static getDocumentDirection(){return document.body.getAttribute("dir")||document.documentElement.getAttribute("dir")}static onStringsUpdated(e){this._stringsEventDispatcher.add(e)}static removeOnStringsUpdated(e){this._stringsEventDispatcher.remove(e)}static onDirectionUpdated(e){this._directionEventDispatcher.add(e),this.initDirection()}static removeOnDirectionUpdated(e){this._directionEventDispatcher.remove(e)}static initDirection(){if(this._isDirectionInit)return;this._isDirectionInit=!0,this.mutationObserver=new MutationObserver((e=>{e.forEach((e=>{"dir"==e.attributeName&&this._directionEventDispatcher.fire(null)}))}));const e={attributes:!0,attributeFilter:["dir"]};this.mutationObserver.observe(document.body,e),this.mutationObserver.observe(document.documentElement,e)}static updateStringsForTag(e,t){if((e=e.toLowerCase()).startsWith("mgt-")&&(e=e.substring(4)),this._strings&&t){for(let e of Object.entries(t))this._strings[e[0]]&&(t[e[0]]=this._strings[e[0]]);if(this._strings._components&&this._strings._components[e]){let o=this._strings._components[e];for(let e of Object.keys(o))t[e]&&(t[e]=o[e])}}return t}}n._stringsEventDispatcher=new r.p,n._directionEventDispatcher=new r.p,n._isDirectionInit=!1},533:(e,t,o)=>{"use strict";o.d(t,{i:()=>i});var r=o(994),n=o(215);class i{constructor(e,t){this._packageVersion=e,this._providerName=t}execute(e){return t=this,o=void 0,s=function*(){try{const t=[],o=e.middlewareControl.getMiddlewareOptions(n.x);if(o){const e=`${o.componentName}/${this._packageVersion}`;t.push(e)}if(this._providerName){const e=`${this._providerName}/${this._packageVersion}`;t.push(e)}const i=`mgt/${this._packageVersion}`;t.push(i),t.push((0,r.i5)(e.request,e.options,"SdkVersion"));const s=t.join(", ");(0,r.rn)(e.request,e.options,"SdkVersion",s)}catch(e){}return yield this._nextMiddleware.execute(e)},new((i=void 0)||(i=Promise))((function(e,r){function n(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(t){var o;t.done?e(t.value):(o=t.value,o instanceof i?o:new i((function(e){e(o)}))).then(n,a)}c((s=s.apply(t,o||[])).next())}));var t,o,i,s}setNext(e){this._nextMiddleware=e}}},335:(e,t,o)=>{"use strict";o.d(t,{P:()=>r});class r{static get microsoftTeamsLib(){return this._microsoftTeamsLib||window.microsoftTeams}static set microsoftTeamsLib(e){this._microsoftTeamsLib=e}static get isAvailable(){return!(!this.microsoftTeamsLib||(window.parent!==window.self||!window.nativeInterface)&&"embedded-page-container"!==window.name&&"extension-tab-frame"!==window.name)}static executeDeepLink(e,t){const o=this.microsoftTeamsLib;o.initialize(),o.executeDeepLink(e,t)}}},383:()=>{},641:(e,t,o)=>{"use strict";o.d(t,{p:()=>r});class r{static renderTemplate(e,t,o,r){let n;if(t.$parentTemplateContext&&(o=Object.assign(Object.assign({},o),{$parent:t.$parentTemplateContext})),t.content&&t.content.childNodes.length){const i=t.content.cloneNode(!0);n=this.renderNode(i,e,o,r)}else if(t.childNodes.length){const i=document.createElement("div");for(let e=0;e<t.childNodes.length;e++)i.appendChild(this.simpleCloneNode(t.childNodes[e]));n=this.renderNode(i,e,o,r)}n&&e.appendChild(n)}static setBindingSyntax(e,t){this._startExpression=e,this._endExpression=t;const o=this.escapeRegex(this._startExpression),r=this.escapeRegex(this._endExpression);this._expression=new RegExp(`${o}\\s*([$\\w\\.()\\[\\]]+)\\s*${r}`,"g")}static get globalContext(){return this._globalContext}static get expression(){return this._expression||this.setBindingSyntax("{{","}}"),this._expression}static escapeRegex(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}static simpleCloneNode(e){if(!e)return null;const t=e.cloneNode(!1);for(let o=0;o<e.childNodes.length;o++){const r=this.simpleCloneNode(e.childNodes[o]);r&&t.appendChild(r)}return t}static expandExpressionsAsString(e,t,o){return e.replace(this.expression,((e,r)=>{const n=this.evalInContext(r||this.trimExpression(e),Object.assign(Object.assign({},t),o));return n?"object"==typeof n?JSON.stringify(n):n.toString():""}))}static renderNode(e,t,o,r){if("#text"===e.nodeName)return e.textContent=this.expandExpressionsAsString(e.textContent,o,r),e;if("TEMPLATE"===e.nodeName)return e.$parentTemplateContext=o,e;let n=e;if(n.attributes)for(let e=0;e<n.attributes.length;e++){const i=n.attributes[e];if("data-props"===i.name){const e=this.trimExpression(i.value);for(const i of e.split(",")){const e=i.trim().split(":");if(2===e.length){const i=e[0].trim(),s=this.evalInContext(e[1].trim(),Object.assign(Object.assign({},o),r));i.startsWith("@")?"function"==typeof s&&n.addEventListener(i.substring(1),(e=>s(e,o,t))):n[i]=s}}}else n.setAttribute(i.name,this.expandExpressionsAsString(i.value,o,r))}const i=[],s=[];let a=!1;for(let n=0;n<e.childNodes.length;n++){const c=e.childNodes[n],l=c;let d=!1;if(l.dataset){let e=!1;if(l.dataset.if){const t=l.dataset.if;this.evalBoolInContext(this.trimExpression(t),Object.assign(Object.assign({},o),r))?(l.removeAttribute("data-if"),a=!0,d=!0):(s.push(l),e=!0)}else void 0!==l.dataset.else&&(a?(s.push(l),e=!0):l.removeAttribute("data-else"));l.dataset.for&&!e?i.push(l):e||this.renderNode(c,t,o,r)}else this.renderNode(c,t,o,r);d||"#text"===c.nodeName||(a=!1)}for(const e of s)n.removeChild(e);for(let e=0;e<i.length;e++){const s=i[e],a=s.dataset.for,c=this.trimExpression(a).split(/\s+(in|of)\s+/i);if(3===c.length){const e=c[0],i=c[2],a=this.evalInContext(i,Object.assign(Object.assign({},o),r));if(Array.isArray(a)){s.removeAttribute("data-for");for(let i=0;i<a.length;i++){const c=Object.assign({$index:i},o);c[e]=a[i];const l=s.cloneNode(!0);this.renderNode(l,t,c,r),n.insertBefore(l,s)}}n.removeChild(s)}}return e}static evalBoolInContext(e,t){return t=Object.assign(Object.assign({},t),this.globalContext),new Function("with(this) { return !!("+e+")}").call(t)}static evalInContext(e,t){t=Object.assign(Object.assign({},t),this.globalContext);const o=new Function("with(this) { return "+e+";}");let r;try{r=o.call(t)}catch(e){}return r}static trimExpression(e){return(e=e.trim()).startsWith(this._startExpression)&&e.endsWith(this._endExpression)&&(e=(e=e.substr(this._startExpression.length,e.length-this._startExpression.length-this._endExpression.length)).trim()),e}}r._globalContext={}},818:(e,t,o)=>{"use strict";function r(e,t){return n(e,t,new Set)}function n(e,t,o){const r=Object.prototype.toString.call(e),i=Object.prototype.toString.call(t);if(r===i&&"[object Object]"===r&&!o.has(e)){o.add(e);for(const r in e)if(!n(e[r],t[r],o))return!1;for(const o in t)if(!e.hasOwnProperty(o))return!1;return!0}if(r===i&&"[object Array]"===r&&!o.has(e)){if(o.add(e),e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!n(e[r],t[r],o))return!1;return!0}return e===t}function i(e,t){if(e===t)return!0;if(!e||!t)return!1;if(e.length!==t.length)return!1;if(0===e.length)return!0;const o=new Set(e);for(const e of t)if(!o.has(e))return!1;return!0}o.d(t,{f:()=>r,s:()=>i})},418:(e,t,o)=>{"use strict";o.d(t,{l:()=>r});const r="2.2.0"},877:(e,t,o)=>{"use strict";o.d(t,{uM:()=>u,xn:()=>l,w5:()=>i,KU:()=>U,LW:()=>p,UN:()=>E,vU:()=>f,WI:()=>h,Pw:()=>k});var r,n=o(655);!function(e){e.GET="GET",e.PATCH="PATCH",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(r||(r={}));class i{constructor(e){if(this.requests=new Map,void 0!==e){const t=i.requestLimit;if(e.length>t){const e=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}for(const t of e)this.addRequest(t)}}static validateDependencies(e){if(0===e.size){const e=new Error("Empty requests map, Please provide at least one request.");throw e.name="Empty Requests Error",e}return(e=>{const t=e.entries();let o=t.next();for(;!o.done;){const e=o.value[1];if(void 0!==e.dependsOn&&e.dependsOn.length>0)return!1;o=t.next()}return!0})(e)||(e=>{const t=e.entries();let o=t.next();const r=o.value[1];if(void 0!==r.dependsOn&&r.dependsOn.length>0)return!1;let n=o;for(o=t.next();!o.done;){const e=o.value[1];if(void 0===e.dependsOn||1!==e.dependsOn.length||e.dependsOn[0]!==n.value[1].id)return!1;n=o,o=t.next()}return!0})(e)||(e=>{const t=e.entries();let o=t.next();const r=o.value[1];let n;if(void 0===r.dependsOn||0===r.dependsOn.length)n=r.id;else{if(1!==r.dependsOn.length)return!1;{const t=r.dependsOn[0];if(t===r.id||!e.has(t))return!1;n=t}}for(o=t.next();!o.done;){const e=o.value[1];if((void 0===e.dependsOn||0===e.dependsOn.length)&&n!==e.id)return!1;if(void 0!==e.dependsOn&&0!==e.dependsOn.length){if(1===e.dependsOn.length&&(e.id===n||e.dependsOn[0]!==n))return!1;if(e.dependsOn.length>1)return!1}o=t.next()}return!0})(e)}static getRequestData(e){return n.mG(this,void 0,void 0,(function*(){const t={url:""},o=new RegExp("^https?://");t.url=o.test(e.url)?"/"+e.url.split(/.*?\/\/.*?\//)[1]:e.url,t.method=e.method;const n={};return e.headers.forEach(((e,t)=>{n[t]=e})),Object.keys(n).length&&(t.headers=n),e.method!==r.PATCH&&e.method!==r.POST&&e.method!==r.PUT||(t.body=yield i.getRequestBody(e)),t}))}static getRequestBody(e){return n.mG(this,void 0,void 0,(function*(){let t,o=!1;try{const r=e.clone();t=yield r.json(),o=!0}catch(e){}if(!o)try{if("undefined"!=typeof Blob){const o=yield e.blob(),r=new FileReader;t=yield new Promise((e=>{r.addEventListener("load",(()=>{const t=r.result,o=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(t);e(o[4])}),!1),r.readAsDataURL(o)}))}else"undefined"!=typeof Buffer&&(t=(yield e.buffer()).toString("base64"));o=!0}catch(e){}return t}))}addRequest(e){const t=i.requestLimit;if(""===e.id){const e=new Error("Id for a request is empty, Please provide an unique id");throw e.name="Empty Id For Request",e}if(this.requests.size===t){const e=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}if(this.requests.has(e.id)){const t=new Error(`Adding request with duplicate id ${e.id}, Make the id of the requests unique`);throw t.name="Duplicate RequestId Error",t}return this.requests.set(e.id,e),e.id}removeRequest(e){const t=this.requests.delete(e),o=this.requests.entries();let r=o.next();for(;!r.done;){const t=r.value[1].dependsOn;if(void 0!==t){const o=t.indexOf(e);-1!==o&&t.splice(o,1),0===t.length&&delete r.value[1].dependsOn}r=o.next()}return t}getContent(){return n.mG(this,void 0,void 0,(function*(){const e=[],t={requests:e},o=this.requests.entries();let r=o.next();if(r.done){const e=new Error("No requests added yet, Please add at least one request.");throw e.name="Empty Payload",e}if(!i.validateDependencies(this.requests)){const e=new Error("Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.");throw e.name="Invalid Dependency",e}for(;!r.done;){const t=r.value[1],n=yield i.getRequestData(t.request);if(void 0!==n.body&&(void 0===n.headers||void 0===n.headers["content-type"])){const e=new Error(`Content-type header is not mentioned for request #${t.id}, For request having body, Content-type header should be mentioned`);throw e.name="Invalid Content-type header",e}n.id=t.id,void 0!==t.dependsOn&&t.dependsOn.length>0&&(n.dependsOn=t.dependsOn),e.push(n),r=o.next()}return t.requests=e,t}))}addDependency(e,t){if(!this.requests.has(e)){const t=new Error(`Dependent ${e} does not exists, Please check the id`);throw t.name="Invalid Dependent",t}if(void 0!==t&&!this.requests.has(t)){const e=new Error(`Dependency ${t} does not exists, Please check the id`);throw e.name="Invalid Dependency",e}if(void 0!==t){const o=this.requests.get(e);if(void 0===o.dependsOn&&(o.dependsOn=[]),-1!==o.dependsOn.indexOf(t)){const o=new Error(`Dependency ${t} is already added for the request ${e}`);throw o.name="Duplicate Dependency",o}o.dependsOn.push(t)}else{const o=this.requests.entries();let r,n=o.next();for(;!n.done&&n.value[1].id!==e;)r=n,n=o.next();if(void 0===r){const e=new Error(`Can't add dependency ${t}, There is only a dependent request in the batch`);throw e.name="Invalid Dependency Addition",e}{const t=r.value[0];if(void 0===n.value[1].dependsOn&&(n.value[1].dependsOn=[]),-1!==n.value[1].dependsOn.indexOf(t)){const o=new Error(`Dependency ${t} is already added for the request ${e}`);throw o.name="Duplicate Dependency",o}n.value[1].dependsOn.push(t)}}}removeDependency(e,t){const o=this.requests.get(e);if(void 0===o||void 0===o.dependsOn||0===o.dependsOn.length)return!1;if(void 0!==t){const e=o.dependsOn.indexOf(t);return-1!==e&&(o.dependsOn.splice(e,1),!0)}return delete o.dependsOn,!0}}i.requestLimit=20;class s{constructor(e=[]){this.middlewareOptions=new Map;for(const t of e){const e=t.constructor;this.middlewareOptions.set(e,t)}}getMiddlewareOptions(e){return this.middlewareOptions.get(e)}setMiddlewareOptions(e,t){this.middlewareOptions.set(e,t)}}var a,c=o(994);class l{constructor(e,t){this.authenticationProvider=e,this.authenticationProviderOptions=t}}!function(e){e[e.NONE=0]="NONE",e[e.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",e[e.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",e[e.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"}(a||(a={}));class d{constructor(){this.featureUsage=a.NONE}static updateFeatureUsageFlag(e,t){let o;e.middlewareControl instanceof s?o=e.middlewareControl.getMiddlewareOptions(d):e.middlewareControl=new s,void 0===o&&(o=new d,e.middlewareControl.setMiddlewareOptions(d,o)),o.setFeatureUsage(t)}setFeatureUsage(e){this.featureUsage=this.featureUsage|e}getFeatureUsage(){return this.featureUsage.toString(16)}}class u{constructor(e){this.authenticationProvider=e}execute(e){return n.mG(this,void 0,void 0,(function*(){try{let t,o,r;e.middlewareControl instanceof s&&(t=e.middlewareControl.getMiddlewareOptions(l)),void 0!==t&&(o=t.authenticationProvider,r=t.authenticationProviderOptions),void 0===o&&(o=this.authenticationProvider);const n=`Bearer ${yield o.getAccessToken(r)}`;return(0,c.rB)(e.request,e.options,u.AUTHORIZATION_HEADER,n),d.updateFeatureUsageFlag(e,a.AUTHENTICATION_HANDLER_ENABLED),yield this.nextMiddleware.execute(e)}catch(e){throw e}}))}setNext(e){this.nextMiddleware=e}}u.AUTHORIZATION_HEADER="Authorization";class p{execute(e){return n.mG(this,void 0,void 0,(function*(){try{return void(e.response=yield fetch(e.request,e.options))}catch(e){throw e}}))}}class h{constructor(e=h.DEFAULT_DELAY,t=h.DEFAULT_MAX_RETRIES,o=h.DEFAULT_SHOULD_RETRY){if(e>h.MAX_DELAY&&t>h.MAX_MAX_RETRIES){const e=new Error(`Delay and MaxRetries should not be more than ${h.MAX_DELAY} and ${h.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e>h.MAX_DELAY){const e=new Error(`Delay should not be more than ${h.MAX_DELAY}`);throw e.name="MaxLimitExceeded",e}if(t>h.MAX_MAX_RETRIES){const e=new Error(`MaxRetries should not be more than ${h.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e<0&&t<0){const e=new Error("Delay and MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}if(e<0){const e=new Error("Delay should not be negative");throw e.name="MinExpectationNotMet",e}if(t<0){const e=new Error("MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}this.delay=Math.min(e,h.MAX_DELAY),this.maxRetries=Math.min(t,h.MAX_MAX_RETRIES),this.shouldRetry=o}getMaxDelay(){return h.MAX_DELAY}}h.DEFAULT_DELAY=3,h.DEFAULT_MAX_RETRIES=3,h.MAX_DELAY=180,h.MAX_MAX_RETRIES=10,h.DEFAULT_SHOULD_RETRY=()=>!0;class f{constructor(e=new h){this.options=e}isRetry(e){return-1!==f.RETRY_STATUS_CODES.indexOf(e.status)}isBuffered(e,t){const o="string"==typeof e?t.method:e.method;return o!==r.PUT&&o!==r.PATCH&&o!==r.POST||"application/octet-stream"!==(0,c.i5)(e,t,"Content-Type")}getDelay(e,t,o){const r=()=>Number(Math.random().toFixed(3)),n=void 0!==e.headers?e.headers.get(f.RETRY_AFTER_HEADER):null;let i;return i=null!==n?Number.isNaN(Number(n))?Math.round((new Date(n).getTime()-Date.now())/1e3):Number(n):t>=2?this.getExponentialBackOffTime(t)+o+r():o+r(),Math.min(i,this.options.getMaxDelay()+r())}getExponentialBackOffTime(e){return Math.round(.5*(Math.pow(2,e)-1))}sleep(e){return n.mG(this,void 0,void 0,(function*(){const t=1e3*e;return new Promise((e=>setTimeout(e,t)))}))}getOptions(e){let t;return e.middlewareControl instanceof s&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),void 0===t&&(t=Object.assign(new h,this.options)),t}executeWithRetry(e,t,o){return n.mG(this,void 0,void 0,(function*(){try{if(yield this.nextMiddleware.execute(e),t<o.maxRetries&&this.isRetry(e.response)&&this.isBuffered(e.request,e.options)&&o.shouldRetry(o.delay,t,e.request,e.options,e.response)){++t,(0,c.rn)(e.request,e.options,f.RETRY_ATTEMPT_HEADER,t.toString());const r=this.getDelay(e.response,t,o.delay);return yield this.sleep(r),yield this.executeWithRetry(e,t,o)}return}catch(e){throw e}}))}execute(e){return n.mG(this,void 0,void 0,(function*(){try{const t=0,o=this.getOptions(e);return d.updateFeatureUsageFlag(e,a.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(e,t,o)}catch(e){throw e}}))}setNext(e){this.nextMiddleware=e}}f.RETRY_STATUS_CODES=[429,503,504],f.RETRY_ATTEMPT_HEADER="Retry-Attempt",f.RETRY_AFTER_HEADER="Retry-After";class g{constructor(e=g.DEFAULT_MAX_REDIRECTS,t=g.DEFAULT_SHOULD_RETRY){if(e>g.MAX_MAX_REDIRECTS){const e=new Error(`MaxRedirects should not be more than ${g.MAX_MAX_REDIRECTS}`);throw e.name="MaxLimitExceeded",e}if(e<0){const e=new Error("MaxRedirects should not be negative");throw e.name="MinExpectationNotMet",e}this.maxRedirects=e,this.shouldRedirect=t}}g.DEFAULT_MAX_REDIRECTS=5,g.MAX_MAX_REDIRECTS=20,g.DEFAULT_SHOULD_RETRY=()=>!0;class m{constructor(e=new g){this.options=e}isRedirect(e){return-1!==m.REDIRECT_STATUS_CODES.indexOf(e.status)}hasLocationHeader(e){return e.headers.has(m.LOCATION_HEADER)}getLocationHeader(e){return e.headers.get(m.LOCATION_HEADER)}isRelativeURL(e){return-1===e.indexOf("://")}shouldDropAuthorizationHeader(e,t){const o=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,r=o.exec(e);let n,i;null!==r&&(n=r[0]);const s=o.exec(t);return null!==s&&(i=s[0]),void 0!==n&&void 0!==i&&n!==i}updateRequestUrl(e,t){return n.mG(this,void 0,void 0,(function*(){t.request="string"==typeof t.request?e:yield(0,c.Yn)(e,t.request)}))}getOptions(e){let t;return e.middlewareControl instanceof s&&(t=e.middlewareControl.getMiddlewareOptions(g)),void 0===t&&(t=Object.assign(new g,this.options)),t}executeWithRedirect(e,t,o){return n.mG(this,void 0,void 0,(function*(){try{yield this.nextMiddleware.execute(e);const n=e.response;if(!(t<o.maxRedirects&&this.isRedirect(n)&&this.hasLocationHeader(n)&&o.shouldRedirect(n)))return;if(++t,n.status===m.STATUS_CODE_SEE_OTHER)e.options.method=r.GET,delete e.options.body;else{const t=this.getLocationHeader(n);!this.isRelativeURL(t)&&this.shouldDropAuthorizationHeader(n.url,t)&&delete e.options.headers[m.AUTHORIZATION_HEADER],yield this.updateRequestUrl(t,e)}yield this.executeWithRedirect(e,t,o)}catch(e){throw e}}))}execute(e){return n.mG(this,void 0,void 0,(function*(){try{const t=0,o=this.getOptions(e);return e.options.redirect=m.MANUAL_REDIRECT,d.updateFeatureUsageFlag(e,a.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(e,t,o)}catch(e){throw e}}))}setNext(e){this.nextMiddleware=e}}m.REDIRECT_STATUS_CODES=[301,302,303,307,308],m.STATUS_CODE_SEE_OTHER=303,m.LOCATION_HEADER="Location",m.AUTHORIZATION_HEADER="Authorization",m.MANUAL_REDIRECT="manual";const v=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn"]),b=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],y=e=>{const t=e&&e.constructor&&e.constructor.name;if("Buffer"===t||"Blob"===t||"File"===t||"FormData"===t||"string"==typeof e)return e;if("ArrayBuffer"===t)e=Buffer.from(e);else if("Int8Array"===t||"Int16Array"===t||"Int32Array"===t||"Uint8Array"===t||"Uint16Array"===t||"Uint32Array"===t||"Uint8ClampedArray"===t||"Float32Array"===t||"Float64Array"===t||"DataView"===t)e=Buffer.from(e.buffer);else try{e=JSON.stringify(e)}catch(e){throw new Error("Unable to stringify the content")}return e};class k{execute(e){return n.mG(this,void 0,void 0,(function*(){try{if((e=>{if(-1!==(e=e.toLowerCase()).indexOf("https://")){const t=(e=e.replace("https://","")).indexOf(":"),o=e.indexOf("/");let r="";if(-1!==o)return-1!==t&&t<o?(r=e.substring(0,t),v.has(r)):(r=e.substring(0,o),v.has(r))}return!1})("string"==typeof e.request?e.request:e.request.url)){let t=(0,c.i5)(e.request,e.options,k.CLIENT_REQUEST_ID_HEADER);t||(t=(0,c.DO)(),(0,c.rn)(e.request,e.options,k.CLIENT_REQUEST_ID_HEADER,t));let o,r=`${k.PRODUCT_NAME}/2.2.1`;if(e.middlewareControl instanceof s&&(o=e.middlewareControl.getMiddlewareOptions(d)),o){const e=o.getFeatureUsage();r+=` (${k.FEATURE_USAGE_STRING}=${e})`}(0,c.rB)(e.request,e.options,k.SDK_VERSION_HEADER,r)}else delete e.options.headers[k.CLIENT_REQUEST_ID_HEADER],delete e.options.headers[k.SDK_VERSION_HEADER];return yield this.nextMiddleware.execute(e)}catch(e){throw e}}))}setNext(e){this.nextMiddleware=e}}var w,C;k.CLIENT_REQUEST_ID_HEADER="client-request-id",k.SDK_VERSION_HEADER="SdkVersion",k.PRODUCT_NAME="graph-js",k.FEATURE_USAGE_STRING="featureUsage",(C=w||(w={}))[C.MANUAL=0]="MANUAL",C[C.RANDOM=1]="RANDOM";class T{constructor(e=-1,t=-1){this.minValue=e,this.maxValue=t}}class S extends class{constructor(e,t,o,r={}){this.DEFAULT_FILE_SIZE=5242880,this.client=e,this.file=t,void 0===r.rangeSize&&(r.rangeSize=this.DEFAULT_FILE_SIZE),this.options=r,this.uploadSession=o,this.nextRange=new T(0,this.options.rangeSize-1)}static createUploadSession(e,t,o,r={}){return n.mG(this,void 0,void 0,(function*(){try{const n=yield e.api(t).headers(r).post(o);return{url:n.uploadUrl,expiry:new Date(n.expirationDateTime)}}catch(e){throw e}}))}parseRange(e){const t=e[0];if(void 0===t||""===t)return new T;const o=t.split("-"),r=parseInt(o[0],10);let n=parseInt(o[1],10);return Number.isNaN(n)&&(n=this.file.size-1),new T(r,n)}updateTaskStatus(e){this.uploadSession.expiry=new Date(e.expirationDateTime),this.nextRange=this.parseRange(e.nextExpectedRanges)}getNextRange(){if(-1===this.nextRange.minValue)return this.nextRange;const e=this.nextRange.minValue;let t=e+this.options.rangeSize-1;return t>=this.file.size&&(t=this.file.size-1),new T(e,t)}sliceFile(e){return this.file.content.slice(e.minValue,e.maxValue+1)}upload(){return n.mG(this,void 0,void 0,(function*(){try{for(;;){const e=this.getNextRange();if(-1===e.maxValue){const e=new Error("Task with which you are trying to upload is already completed, Please check for your uploaded file");throw e.name="Invalid Session",e}const t=this.sliceFile(e),o=yield this.uploadSlice(t,e,this.file.size);if(void 0!==o.id)return o;this.updateTaskStatus(o)}}catch(e){throw e}}))}uploadSlice(e,t,o){return n.mG(this,void 0,void 0,(function*(){try{return yield this.client.api(this.uploadSession.url).headers({"Content-Length":""+(t.maxValue-t.minValue+1),"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${o}`}).put(e)}catch(e){throw e}}))}cancel(){return n.mG(this,void 0,void 0,(function*(){try{return yield this.client.api(this.uploadSession.url).delete()}catch(e){throw e}}))}getStatus(){return n.mG(this,void 0,void 0,(function*(){try{const e=yield this.client.api(this.uploadSession.url).get();return this.updateTaskStatus(e),e}catch(e){throw e}}))}resume(){return n.mG(this,void 0,void 0,(function*(){try{return yield this.getStatus(),yield this.upload()}catch(e){throw e}}))}}{constructor(e,t,o,r){super(e,t,o,r)}static constructCreateSessionUrl(e,t=S.DEFAULT_UPLOAD_PATH){return e=e.trim(),""===(t=t.trim())&&(t="/"),"/"!==t[0]&&(t=`/${t}`),"/"!==t[t.length-1]&&(t=`${t}/`),`/me/drive/root:${t.split("/").map((e=>encodeURIComponent(e))).join("/")}${encodeURIComponent(e)}:/createUploadSession`}static create(e,t,o){return n.mG(this,void 0,void 0,(function*(){const r=o.fileName;let n,i;if("undefined"!=typeof Blob&&t instanceof Blob)n=new File([t],r),i=n.size;else if("undefined"!=typeof File&&t instanceof File)n=t,i=n.size;else if("undefined"!=typeof Buffer&&t instanceof Buffer){const e=t;i=e.byteLength-e.byteOffset,n=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}try{const t=S.constructCreateSessionUrl(o.fileName,o.path),s=yield S.createUploadSession(e,t,o.fileName),a=((e=5242880)=>{const t=62914560;return e>t&&(e=t),(o=e)>327680&&(o=320*Math.floor(o/327680)*1024),o;var o})(o.rangeSize);return new S(e,{name:r,content:n,size:i},s,{rangeSize:a})}catch(e){throw e}}))}static createUploadSession(e,t,o){const r=Object.create(null,{createUploadSession:{get:()=>super.createUploadSession}});return n.mG(this,void 0,void 0,(function*(){const n={item:{"@microsoft.graph.conflictBehavior":"rename",name:o}};try{return r.createUploadSession.call(this,e,t,n)}catch(e){throw e}}))}commit(e){return n.mG(this,void 0,void 0,(function*(){try{const t={name:this.file.name,"@microsoft.graph.conflictBehavior":"rename","@microsoft.graph.sourceUrl":this.uploadSession.url};return yield this.client.api(e).put(t)}catch(e){throw e}}))}}S.DEFAULT_UPLOAD_PATH="/";class _{constructor(e){this.provider=e}getAccessToken(){return n.mG(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.provider(((o,r)=>{r?e(r):t(o)}))}))}))}}class I extends Error{constructor(e=-1,t,o){super(t||o&&o.message),Object.setPrototypeOf(this,I.prototype),this.statusCode=e,this.code=null,this.requestId=null,this.date=new Date,this.body=null,this.stack=o?o.stack:this.stack}}class x{static constructError(e,t){const o=new I(t,"",e);return void 0!==e.name&&(o.code=e.name),o.body=e.toString(),o.date=new Date,o}static constructErrorFromResponse(e,t){e=e.error;const o=new I(t,e.message);o.code=e.code,void 0!==e.innerError&&(o.requestId=e.innerError["request-id"],o.date=new Date(e.innerError.date));try{o.body=JSON.stringify(e)}catch(e){}return o}static getError(e=null,t=-1,o){return n.mG(this,void 0,void 0,(function*(){let r;if(r=e&&e.error?x.constructErrorFromResponse(e,t):"undefined"!=typeof Error&&e instanceof Error?x.constructError(e,t):new I(t),"function"!=typeof o)return r;o(r,null)}))}}var E,A,P,R;!function(e){e.ARRAYBUFFER="arraybuffer",e.BLOB="blob",e.DOCUMENT="document",e.JSON="json",e.RAW="raw",e.STREAM="stream",e.TEXT="text"}(E||(E={})),function(e){e.TEXT_HTML="text/html",e.TEXT_XML="text/xml",e.APPLICATION_XML="application/xml",e.APPLICATION_XHTML="application/xhtml+xml"}(A||(A={})),function(e){e.TEXT_PLAIN="text/plain",e.APPLICATION_JSON="application/json"}(P||(P={})),function(e){e.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",e.IMAGE="^image\\/.+"}(R||(R={}));class O{static parseDocumentResponse(e,t){try{return"undefined"!=typeof DOMParser?new Promise(((o,r)=>{e.text().then((e=>{try{const r=(new DOMParser).parseFromString(e,t);o(r)}catch(e){r(e)}}))})):Promise.resolve(e.body)}catch(e){throw e}}static convertResponse(e,t){return n.mG(this,void 0,void 0,(function*(){if(204===e.status)return Promise.resolve();let o;try{switch(t){case E.ARRAYBUFFER:o=yield e.arrayBuffer();break;case E.BLOB:o=yield e.blob();break;case E.DOCUMENT:o=yield O.parseDocumentResponse(e,A.TEXT_XML);break;case E.JSON:o=yield e.json();break;case E.STREAM:o=yield Promise.resolve(e.body);break;case E.TEXT:o=yield e.text();break;default:const t=e.headers.get("Content-type");if(null!==t){const r=t.split(";")[0];o=new RegExp(R.DOCUMENT).test(r)?yield O.parseDocumentResponse(e,r):new RegExp(R.IMAGE).test(r)?e.blob():r===P.TEXT_PLAIN?yield e.text():r===P.APPLICATION_JSON?yield e.json():Promise.resolve(e.body)}else o=Promise.resolve(e.body)}}catch(e){throw e}return o}))}static getResponse(e,t,o){return n.mG(this,void 0,void 0,(function*(){try{if(t===E.RAW)return Promise.resolve(e);{const r=yield O.convertResponse(e,t);if(!e.ok)throw r;if("function"!=typeof o)return r;o(null,r)}}catch(e){throw e}}))}}class N{constructor(e,t,o){this.parsePath=e=>{if(-1!==e.indexOf("https://")){const t=(e=e.replace("https://","")).indexOf("/");-1!==t&&(this.urlComponents.host="https://"+e.substring(0,t),e=e.substring(t+1,e.length));const o=e.indexOf("/");-1!==o&&(this.urlComponents.version=e.substring(0,o),e=e.substring(o+1,e.length))}"/"===e.charAt(0)&&(e=e.substr(1));const t=e.indexOf("?");if(-1===t)this.urlComponents.path=e;else{this.urlComponents.path=e.substr(0,t);const o=e.substring(t+1,e.length).split("&");for(const e of o)this.parseQueryParameter(e)}},this.httpClient=e,this.config=t,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(o)}addCsvQueryParameter(e,t,o){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";let r=[];o.length>1&&"string"==typeof t?r=Array.prototype.slice.call(o):"string"==typeof t?r.push(t):r=r.concat(t),this.urlComponents.oDataQueryParams[e]+=r.join(",")}buildFullUrl(){const e=(e=>{const t=e=>e.replace(/^\/+/,"");return Array.prototype.slice.call(e).reduce(((e,o)=>{return[(r=e,r.replace(/\/+$/,"")),t(o)].join("/");var r}))})([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}createQueryString(){const e=this.urlComponents,t=[];if(0!==Object.keys(e.oDataQueryParams).length)for(const o in e.oDataQueryParams)e.oDataQueryParams.hasOwnProperty(o)&&t.push(o+"="+e.oDataQueryParams[o]);if(0!==Object.keys(e.otherURLQueryParams).length)for(const o in e.otherURLQueryParams)e.otherURLQueryParams.hasOwnProperty(o)&&t.push(o+"="+e.otherURLQueryParams[o]);if(0!==e.otherURLQueryOptions.length)for(const o of e.otherURLQueryOptions)t.push(o);return t.length>0?"?"+t.join("&"):""}parseQueryParameter(e){if("string"==typeof e)if("?"===e.charAt(0)&&(e=e.substring(1)),-1!==e.indexOf("&")){const t=e.split("&");for(const e of t)this.parseQueryParamenterString(e)}else this.parseQueryParamenterString(e);else if(e.constructor===Object)for(const t in e)e.hasOwnProperty(t)&&this.setURLComponentsQueryParamater(t,e[t]);return this}parseQueryParamenterString(e){if(this.isValidQueryKeyValuePair(e)){const t=e.indexOf("="),o=e.substring(0,t),r=e.substring(t+1);this.setURLComponentsQueryParamater(o,r)}else this.urlComponents.otherURLQueryOptions.push(e)}setURLComponentsQueryParamater(e,t){if(-1!==b.indexOf(e)){const o=this.urlComponents.oDataQueryParams[e],r=o&&("$expand"===e||"$select"===e||"$orderby"===e);this.urlComponents.oDataQueryParams[e]=r?o+","+t:t}else this.urlComponents.otherURLQueryParams[e]=t}isValidQueryKeyValuePair(e){const t=e.indexOf("=");return-1!==t&&!(-1!==e.indexOf("(")&&e.indexOf("(")<t)}updateRequestOptions(e){const t=Object.assign({},e.headers);if(void 0!==this.config.fetchOptions){const t=Object.assign({},this.config.fetchOptions);Object.assign(e,t),void 0!==typeof this.config.fetchOptions.headers&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),void 0!==e.headers&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}send(e,t,o){return n.mG(this,void 0,void 0,(function*(){let r;const n=new s(this._middlewareOptions);this.updateRequestOptions(t);try{return r=(yield this.httpClient.sendRequest({request:e,options:t,middlewareControl:n})).response,yield O.getResponse(r,this._responseType,o)}catch(e){let t;throw void 0!==r&&(t=r.status),yield x.getError(e,t,o)}}))}setHeaderContentType(){if(!this._headers)return void this.header("Content-Type","application/json");const e=Object.keys(this._headers);for(const t of e)if("content-type"===t.toLowerCase())return;this.header("Content-Type","application/json")}header(e,t){return this._headers[e]=t,this}headers(e){for(const t in e)e.hasOwnProperty(t)&&(this._headers[t]=e[t]);return this}option(e,t){return this._options[e]=t,this}options(e){for(const t in e)e.hasOwnProperty(t)&&(this._options[t]=e[t]);return this}middlewareOptions(e){return this._middlewareOptions=e,this}version(e){return this.urlComponents.version=e,this}responseType(e){return this._responseType=e,this}select(e){return this.addCsvQueryParameter("$select",e,arguments),this}expand(e){return this.addCsvQueryParameter("$expand",e,arguments),this}orderby(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}filter(e){return this.urlComponents.oDataQueryParams.$filter=e,this}search(e){return this.urlComponents.oDataQueryParams.$search=e,this}top(e){return this.urlComponents.oDataQueryParams.$top=e,this}skip(e){return this.urlComponents.oDataQueryParams.$skip=e,this}skipToken(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}count(e=!1){return this.urlComponents.oDataQueryParams.$count=e.toString(),this}query(e){return this.parseQueryParameter(e)}get(e){return n.mG(this,void 0,void 0,(function*(){const t=this.buildFullUrl(),o={method:r.GET};try{return yield this.send(t,o,e)}catch(e){throw e}}))}post(e,t){return n.mG(this,void 0,void 0,(function*(){const o=this.buildFullUrl(),n={method:r.POST,body:y(e)};"FormData"===(e&&e.constructor&&e.constructor.name)?n.headers={}:(this.setHeaderContentType(),n.headers=this._headers);try{return yield this.send(o,n,t)}catch(e){throw e}}))}create(e,t){return n.mG(this,void 0,void 0,(function*(){try{return yield this.post(e,t)}catch(e){throw e}}))}put(e,t){return n.mG(this,void 0,void 0,(function*(){const o=this.buildFullUrl();this.setHeaderContentType();const n={method:r.PUT,body:y(e)};try{return yield this.send(o,n,t)}catch(e){throw e}}))}patch(e,t){return n.mG(this,void 0,void 0,(function*(){const o=this.buildFullUrl();this.setHeaderContentType();const n={method:r.PATCH,body:y(e)};try{return yield this.send(o,n,t)}catch(e){throw e}}))}update(e,t){return n.mG(this,void 0,void 0,(function*(){try{return yield this.patch(e,t)}catch(e){throw e}}))}delete(e){return n.mG(this,void 0,void 0,(function*(){const t=this.buildFullUrl(),o={method:r.DELETE};try{return yield this.send(t,o,e)}catch(e){throw e}}))}del(e){return n.mG(this,void 0,void 0,(function*(){try{return yield this.delete(e)}catch(e){throw e}}))}getStream(e){return n.mG(this,void 0,void 0,(function*(){const t=this.buildFullUrl(),o={method:r.GET};this.responseType(E.STREAM);try{return yield this.send(t,o,e)}catch(e){throw e}}))}putStream(e,t){return n.mG(this,void 0,void 0,(function*(){const o=this.buildFullUrl(),n={method:r.PUT,headers:{"Content-Type":"application/octet-stream"},body:e};try{return yield this.send(o,n,t)}catch(e){throw e}}))}}class D{constructor(...e){if(!e||!e.length){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Please provide a default middleware chain or custom middleware chain",e}this.setMiddleware(...e)}setMiddleware(...e){e.length>1?this.parseMiddleWareArray(e):this.middleware=e[0]}parseMiddleWareArray(e){e.forEach(((t,o)=>{o<e.length-1&&t.setNext(e[o+1])})),this.middleware=e[0]}sendRequest(e){return n.mG(this,void 0,void 0,(function*(){try{if("string"==typeof e.request&&void 0===e.options){const e=new Error;throw e.name="InvalidRequestOptions",e.message="Unable to execute the middleware, Please provide valid options for a request",e}return yield this.middleware.execute(e),e}catch(e){throw e}}))}}class L{static createWithAuthenticationProvider(e){const t=new u(e),o=new f(new h),r=new k,n=new p;if(t.setNext(o),"object"==typeof process){const e=new m(new g);o.setNext(e),e.setNext(r)}else o.setNext(r);return r.setNext(n),L.createWithMiddleware(t)}static createWithMiddleware(...e){return new D(...e)}}class U{constructor(e){this.config={baseUrl:"https://graph.microsoft.com/",debugLogging:!1,defaultVersion:"v1.0"};try{(()=>{if("undefined"==typeof Promise&&"undefined"==typeof fetch){const e=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof Promise){const e=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof fetch){const e=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}})()}catch(e){throw e}for(const t in e)e.hasOwnProperty(t)&&(this.config[t]=e[t]);let t;if(void 0!==e.authProvider&&void 0!==e.middleware){const e=new Error;throw e.name="AmbiguityInInitialization",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",e}if(void 0!==e.authProvider)t=L.createWithAuthenticationProvider(e.authProvider);else{if(void 0===e.middleware){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",e}t=new D(...[].concat(e.middleware))}this.httpClient=t}static init(e){const t={};for(const o in e)e.hasOwnProperty(o)&&(t[o]="authProvider"===o?new _(e[o]):e[o]);return U.initWithMiddleware(t)}static initWithMiddleware(e){try{return new U(e)}catch(e){throw e}}api(e){return new N(this.httpClient,this.config,e)}}},994:(e,t,o)=>{"use strict";o.d(t,{DO:()=>n,i5:()=>i,rn:()=>s,rB:()=>a,Yn:()=>c});var r=o(655);const n=()=>{let e="";for(let t=0;t<32;t++)8!==t&&12!==t&&16!==t&&20!==t||(e+="-"),e+=Math.floor(16*Math.random()).toString(16);return e},i=(e,t,o)=>{let r=null;if("undefined"!=typeof Request&&e instanceof Request)r=e.headers.get(o);else if(void 0!==t&&void 0!==t.headers)if("undefined"!=typeof Headers&&t.headers instanceof Headers)r=t.headers.get(o);else if(t.headers instanceof Array){const e=t.headers;for(let t=0,n=e.length;t<n;t++)if(e[t][0]===o){r=e[t][1];break}}else void 0!==t.headers[o]&&(r=t.headers[o]);return r},s=(e,t,o,r)=>{if("undefined"!=typeof Request&&e instanceof Request)e.headers.set(o,r);else if(void 0!==t)if(void 0===t.headers)t.headers=new Headers({[o]:r});else if("undefined"!=typeof Headers&&t.headers instanceof Headers)t.headers.set(o,r);else if(t.headers instanceof Array){let e=0;const n=t.headers.length;for(;e<n;e++){const n=t.headers[e];if(n[0]===o){n[1]=r;break}}e===n&&t.headers.push([o,r])}else Object.assign(t.headers,{[o]:r})},a=(e,t,o,r)=>{"undefined"!=typeof Request&&e instanceof Request?e.headers.append(o,r):void 0!==t&&(void 0===t.headers?t.headers=new Headers({[o]:r}):"undefined"!=typeof Headers&&t.headers instanceof Headers?t.headers.append(o,r):t.headers instanceof Array?t.headers.push([o,r]):void 0===t.headers?t.headers={[o]:r}:void 0===t.headers[o]?t.headers[o]=r:t.headers[o]+=`, ${r}`)},c=(e,t)=>r.mG(void 0,void 0,void 0,(function*(){const o=t.headers.get("Content-Type")?yield t.blob():yield Promise.resolve(void 0),{method:r,headers:n,referrer:i,referrerPolicy:s,mode:a,credentials:c,cache:l,redirect:d,integrity:u,keepalive:p,signal:h}=t;return new Request(e,{method:r,headers:n,body:o,referrer:i,referrerPolicy:s,mode:a,credentials:c,cache:l,redirect:d,integrity:u,keepalive:p,signal:h})}))},789:(e,t,o)=>{"use strict";o.d(t,{oi:()=>R,iv:()=>A,Mo:()=>w,dy:()=>u.dy,sz:()=>S,Cb:()=>T});var r=o(921),n=o(560);function i(e,t){const{element:{content:o},parts:r}=e,n=document.createTreeWalker(o,133,null,!1);let i=a(r),s=r[i],c=-1,l=0;const d=[];let u=null;for(;n.nextNode();){c++;const e=n.currentNode;for(e.previousSibling===u&&(u=null),t.has(e)&&(d.push(e),null===u&&(u=e)),null!==u&&l++;void 0!==s&&s.index===c;)s.index=null!==u?-1:s.index-l,i=a(r,i),s=r[i]}d.forEach((e=>e.parentNode.removeChild(e)))}const s=e=>{let t=11===e.nodeType?0:1;const o=document.createTreeWalker(e,133,null,!1);for(;o.nextNode();)t++;return t},a=(e,t=-1)=>{for(let o=t+1;o<e.length;o++){const t=e[o];if((0,n.pC)(t))return o}return-1};var c=o(787),l=o(432),d=o(122),u=o(153);const p=(e,t)=>`${e}--${t}`;let h=!0;void 0===window.ShadyCSS?h=!1:void 0===window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1."),h=!1);const f=e=>t=>{const o=p(t.type,e);let r=l.r.get(o);void 0===r&&(r={stringsArray:new WeakMap,keyString:new Map},l.r.set(o,r));let i=r.stringsArray.get(t.strings);if(void 0!==i)return i;const s=t.strings.join(n.Jw);if(i=r.keyString.get(s),void 0===i){const o=t.getTemplateElement();h&&window.ShadyCSS.prepareTemplateDom(o,e),i=new n.YS(t,o),r.keyString.set(s,i)}return r.stringsArray.set(t.strings,i),i},g=["html","svg"],m=new Set;window.JSCompiler_renameProperty=(e,t)=>e;const v={toAttribute(e,t){switch(t){case Boolean:return e?"":null;case Object:case Array:return null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){switch(t){case Boolean:return null!==e;case Number:return null===e?null:Number(e);case Object:case Array:return JSON.parse(e)}return e}},b=(e,t)=>t!==e&&(t==t||e==e),y={attribute:!0,type:String,converter:v,reflect:!1,hasChanged:b};class k extends HTMLElement{constructor(){super(),this.initialize()}static get observedAttributes(){this.finalize();const e=[];return this._classProperties.forEach(((t,o)=>{const r=this._attributeNameForProperty(o,t);void 0!==r&&(this._attributeToPropertyMap.set(r,o),e.push(r))})),e}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const e=Object.getPrototypeOf(this)._classProperties;void 0!==e&&e.forEach(((e,t)=>this._classProperties.set(t,e)))}}static createProperty(e,t=y){if(this._ensureClassProperties(),this._classProperties.set(e,t),t.noAccessor||this.prototype.hasOwnProperty(e))return;const o="symbol"==typeof e?Symbol():`__${e}`,r=this.getPropertyDescriptor(e,o,t);void 0!==r&&Object.defineProperty(this.prototype,e,r)}static getPropertyDescriptor(e,t,o){return{get(){return this[t]},set(r){const n=this[e];this[t]=r,this.requestUpdateInternal(e,n,o)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this._classProperties&&this._classProperties.get(e)||y}static finalize(){const e=Object.getPrototypeOf(this);if(e.hasOwnProperty("finalized")||e.finalize(),this.finalized=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const e=this.properties,t=[...Object.getOwnPropertyNames(e),..."function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e):[]];for(const o of t)this.createProperty(o,e[o])}}static _attributeNameForProperty(e,t){const o=t.attribute;return!1===o?void 0:"string"==typeof o?o:"string"==typeof e?e.toLowerCase():void 0}static _valueHasChanged(e,t,o=b){return o(e,t)}static _propertyValueFromAttribute(e,t){const o=t.type,r=t.converter||v,n="function"==typeof r?r:r.fromAttribute;return n?n(e,o):e}static _propertyValueToAttribute(e,t){if(void 0===t.reflect)return;const o=t.type,r=t.converter;return(r&&r.toAttribute||v.toAttribute)(e,o)}initialize(){this._updateState=0,this._updatePromise=new Promise((e=>this._enableUpdatingResolver=e)),this._changedProperties=new Map,this._saveInstanceProperties(),this.requestUpdateInternal()}_saveInstanceProperties(){this.constructor._classProperties.forEach(((e,t)=>{if(this.hasOwnProperty(t)){const e=this[t];delete this[t],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(t,e)}}))}_applyInstanceProperties(){this._instanceProperties.forEach(((e,t)=>this[t]=e)),this._instanceProperties=void 0}connectedCallback(){this.enableUpdating()}enableUpdating(){void 0!==this._enableUpdatingResolver&&(this._enableUpdatingResolver(),this._enableUpdatingResolver=void 0)}disconnectedCallback(){}attributeChangedCallback(e,t,o){t!==o&&this._attributeToProperty(e,o)}_propertyToAttribute(e,t,o=y){const r=this.constructor,n=r._attributeNameForProperty(e,o);if(void 0!==n){const e=r._propertyValueToAttribute(t,o);if(void 0===e)return;this._updateState=8|this._updateState,null==e?this.removeAttribute(n):this.setAttribute(n,e),this._updateState=-9&this._updateState}}_attributeToProperty(e,t){if(8&this._updateState)return;const o=this.constructor,r=o._attributeToPropertyMap.get(e);if(void 0!==r){const e=o.getPropertyOptions(r);this._updateState=16|this._updateState,this[r]=o._propertyValueFromAttribute(t,e),this._updateState=-17&this._updateState}}requestUpdateInternal(e,t,o){let r=!0;if(void 0!==e){const n=this.constructor;o=o||n.getPropertyOptions(e),n._valueHasChanged(this[e],t,o.hasChanged)?(this._changedProperties.has(e)||this._changedProperties.set(e,t),!0!==o.reflect||16&this._updateState||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(e,o))):r=!1}!this._hasRequestedUpdate&&r&&(this._updatePromise=this._enqueueUpdate())}requestUpdate(e,t){return this.requestUpdateInternal(e,t),this.updateComplete}async _enqueueUpdate(){this._updateState=4|this._updateState;try{await this._updatePromise}catch(e){}const e=this.performUpdate();return null!=e&&await e,!this._hasRequestedUpdate}get _hasRequestedUpdate(){return 4&this._updateState}get hasUpdated(){return 1&this._updateState}performUpdate(){if(!this._hasRequestedUpdate)return;this._instanceProperties&&this._applyInstanceProperties();let e=!1;const t=this._changedProperties;try{e=this.shouldUpdate(t),e?this.update(t):this._markUpdated()}catch(t){throw e=!1,this._markUpdated(),t}e&&(1&this._updateState||(this._updateState=1|this._updateState,this.firstUpdated(t)),this.updated(t))}_markUpdated(){this._changedProperties=new Map,this._updateState=-5&this._updateState}get updateComplete(){return this._getUpdateComplete()}_getUpdateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._updatePromise}shouldUpdate(e){return!0}update(e){void 0!==this._reflectingProperties&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach(((e,t)=>this._propertyToAttribute(t,this[t],e))),this._reflectingProperties=void 0),this._markUpdated()}updated(e){}firstUpdated(e){}}k.finalized=!0;const w=e=>t=>"function"==typeof t?((e,t)=>(window.customElements.define(e,t),t))(e,t):((e,t)=>{const{kind:o,elements:r}=t;return{kind:o,elements:r,finisher(t){window.customElements.define(e,t)}}})(e,t),C=(e,t)=>"method"===t.kind&&t.descriptor&&!("value"in t.descriptor)?Object.assign(Object.assign({},t),{finisher(o){o.createProperty(t.key,e)}}):{kind:"field",key:Symbol(),placement:"own",descriptor:{},initializer(){"function"==typeof t.initializer&&(this[t.key]=t.initializer.call(this))},finisher(o){o.createProperty(t.key,e)}};function T(e){return(t,o)=>void 0!==o?((e,t,o)=>{t.constructor.createProperty(o,e)})(e,t,o):C(e,t)}function S(e){return T({attribute:!1,hasChanged:null==e?void 0:e.hasChanged})}const _=Element.prototype;_.msMatchesSelector||_.webkitMatchesSelector;const I=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,x=Symbol();class E{constructor(e,t){if(t!==x)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e}get styleSheet(){return void 0===this._styleSheet&&(I?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}const A=(e,...t)=>{const o=t.reduce(((t,o,r)=>t+(e=>{if(e instanceof E)return e.cssText;if("number"==typeof e)return e;throw new Error(`Value passed to 'css' function must be a 'css' function result: ${e}. Use 'unsafeCSS' to pass non-literal values, but\n            take care to ensure page security.`)})(o)+e[r+1]),e[0]);return new E(o,x)};(window.litElementVersions||(window.litElementVersions=[])).push("2.5.1");const P={};class R extends k{static getStyles(){return this.styles}static _getUniqueStyles(){if(this.hasOwnProperty(JSCompiler_renameProperty("_styles",this)))return;const e=this.getStyles();if(Array.isArray(e)){const t=(e,o)=>e.reduceRight(((e,o)=>Array.isArray(o)?t(o,e):(e.add(o),e)),o),o=t(e,new Set),r=[];o.forEach((e=>r.unshift(e))),this._styles=r}else this._styles=void 0===e?[]:[e];this._styles=this._styles.map((e=>{if(e instanceof CSSStyleSheet&&!I){const t=Array.prototype.slice.call(e.cssRules).reduce(((e,t)=>e+t.cssText),"");return new E(String(t),x)}return e}))}initialize(){super.initialize(),this.constructor._getUniqueStyles(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow(this.constructor.shadowRootOptions)}adoptStyles(){const e=this.constructor._styles;0!==e.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?I?this.renderRoot.adoptedStyleSheets=e.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet)):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(e.map((e=>e.cssText)),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}update(e){const t=this.render();super.update(e),t!==P&&this.constructor.render(t,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach((e=>{const t=document.createElement("style");t.textContent=e.cssText,this.renderRoot.appendChild(t)})))}render(){return P}}R.finalized=!0,R.render=(e,t,o)=>{if(!o||"object"!=typeof o||!o.scopeName)throw new Error("The `scopeName` option is required.");const n=o.scopeName,u=c.L.has(t),v=h&&11===t.nodeType&&!!t.host,b=v&&!m.has(n),y=b?document.createDocumentFragment():t;if((0,c.s)(e,y,Object.assign({templateFactory:f(n)},o)),b){const e=c.L.get(y);c.L.delete(y);((e,t,o)=>{m.add(e);const r=o?o.element:document.createElement("template"),n=t.querySelectorAll("style"),{length:c}=n;if(0===c)return void window.ShadyCSS.prepareTemplateStyles(r,e);const d=document.createElement("style");for(let e=0;e<c;e++){const t=n[e];t.parentNode.removeChild(t),d.textContent+=t.textContent}(e=>{g.forEach((t=>{const o=l.r.get(p(t,e));void 0!==o&&o.keyString.forEach((e=>{const{element:{content:t}}=e,o=new Set;Array.from(t.querySelectorAll("style")).forEach((e=>{o.add(e)})),i(e,o)}))}))})(e);const u=r.content;o?function(e,t,o=null){const{element:{content:r},parts:n}=e;if(null==o)return void r.appendChild(t);const i=document.createTreeWalker(r,133,null,!1);let c=a(n),l=0,d=-1;for(;i.nextNode();)for(d++,i.currentNode===o&&(l=s(t),o.parentNode.insertBefore(t,o));-1!==c&&n[c].index===d;){if(l>0){for(;-1!==c;)n[c].index+=l,c=a(n,c);return}c=a(n,c)}}(o,d,u.firstChild):u.insertBefore(d,u.firstChild),window.ShadyCSS.prepareTemplateStyles(r,e);const h=u.querySelector("style");if(window.ShadyCSS.nativeShadow&&null!==h)t.insertBefore(h.cloneNode(!0),t.firstChild);else if(o){u.insertBefore(d,u.firstChild);const e=new Set;e.add(d),i(o,e)}})(n,y,e.value instanceof d.R?e.value.template:void 0),(0,r.r4)(t,t.firstChild),t.appendChild(y),c.L.set(t,e)}!u&&v&&window.ShadyCSS.styleElement(t.host)},R.shadowRootOptions={mode:"open"}},695:(e,t,o)=>{"use strict";o.d(t,{X:()=>n,w:()=>i});const r=new WeakMap,n=e=>(...t)=>{const o=e(...t);return r.set(o,!0),o},i=e=>"function"==typeof e&&r.has(e)},921:(e,t,o)=>{"use strict";o.d(t,{eC:()=>r,V:()=>n,r4:()=>i});const r="undefined"!=typeof window&&null!=window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,n=(e,t,o=null,r=null)=>{for(;t!==o;){const o=t.nextSibling;e.insertBefore(t,r),t=o}},i=(e,t,o=null)=>{for(;t!==o;){const o=t.nextSibling;e.removeChild(t),t=o}}},301:(e,t,o)=>{"use strict";o.d(t,{J:()=>r,L:()=>n});const r={},n={}},356:(e,t,o)=>{"use strict";o.d(t,{QG:()=>u,_l:()=>p,nt:()=>h,JG:()=>f,m:()=>g,sL:()=>m,K1:()=>b});var r=o(695),n=o(921),i=o(301),s=o(122),a=o(823),c=o(560);const l=e=>null===e||!("object"==typeof e||"function"==typeof e),d=e=>Array.isArray(e)||!(!e||!e[Symbol.iterator]);class u{constructor(e,t,o){this.dirty=!0,this.element=e,this.name=t,this.strings=o,this.parts=[];for(let e=0;e<o.length-1;e++)this.parts[e]=this._createPart()}_createPart(){return new p(this)}_getValue(){const e=this.strings,t=e.length-1,o=this.parts;if(1===t&&""===e[0]&&""===e[1]){const e=o[0].value;if("symbol"==typeof e)return String(e);if("string"==typeof e||!d(e))return e}let r="";for(let n=0;n<t;n++){r+=e[n];const t=o[n];if(void 0!==t){const e=t.value;if(l(e)||!d(e))r+="string"==typeof e?e:String(e);else for(const t of e)r+="string"==typeof t?t:String(t)}}return r+=e[t],r}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class p{constructor(e){this.value=void 0,this.committer=e}setValue(e){e===i.J||l(e)&&e===this.value||(this.value=e,(0,r.w)(e)||(this.committer.dirty=!0))}commit(){for(;(0,r.w)(this.value);){const e=this.value;this.value=i.J,e(this)}this.value!==i.J&&this.committer.commit()}}class h{constructor(e){this.value=void 0,this.__pendingValue=void 0,this.options=e}appendInto(e){this.startNode=e.appendChild((0,c.IW)()),this.endNode=e.appendChild((0,c.IW)())}insertAfterNode(e){this.startNode=e,this.endNode=e.nextSibling}appendIntoPart(e){e.__insert(this.startNode=(0,c.IW)()),e.__insert(this.endNode=(0,c.IW)())}insertAfterPart(e){e.__insert(this.startNode=(0,c.IW)()),this.endNode=e.endNode,e.endNode=this.startNode}setValue(e){this.__pendingValue=e}commit(){if(null===this.startNode.parentNode)return;for(;(0,r.w)(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=i.J,e(this)}const e=this.__pendingValue;e!==i.J&&(l(e)?e!==this.value&&this.__commitText(e):e instanceof a.j?this.__commitTemplateResult(e):e instanceof Node?this.__commitNode(e):d(e)?this.__commitIterable(e):e===i.L?(this.value=i.L,this.clear()):this.__commitText(e))}__insert(e){this.endNode.parentNode.insertBefore(e,this.endNode)}__commitNode(e){this.value!==e&&(this.clear(),this.__insert(e),this.value=e)}__commitText(e){const t=this.startNode.nextSibling,o="string"==typeof(e=null==e?"":e)?e:String(e);t===this.endNode.previousSibling&&3===t.nodeType?t.data=o:this.__commitNode(document.createTextNode(o)),this.value=e}__commitTemplateResult(e){const t=this.options.templateFactory(e);if(this.value instanceof s.R&&this.value.template===t)this.value.update(e.values);else{const o=new s.R(t,e.processor,this.options),r=o._clone();o.update(e.values),this.__commitNode(r),this.value=o}}__commitIterable(e){Array.isArray(this.value)||(this.value=[],this.clear());const t=this.value;let o,r=0;for(const n of e)o=t[r],void 0===o&&(o=new h(this.options),t.push(o),0===r?o.appendIntoPart(this):o.insertAfterPart(t[r-1])),o.setValue(n),o.commit(),r++;r<t.length&&(t.length=r,this.clear(o&&o.endNode))}clear(e=this.startNode){(0,n.r4)(this.startNode.parentNode,e.nextSibling,this.endNode)}}class f{constructor(e,t,o){if(this.value=void 0,this.__pendingValue=void 0,2!==o.length||""!==o[0]||""!==o[1])throw new Error("Boolean attributes can only contain a single expression");this.element=e,this.name=t,this.strings=o}setValue(e){this.__pendingValue=e}commit(){for(;(0,r.w)(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=i.J,e(this)}if(this.__pendingValue===i.J)return;const e=!!this.__pendingValue;this.value!==e&&(e?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=e),this.__pendingValue=i.J}}class g extends u{constructor(e,t,o){super(e,t,o),this.single=2===o.length&&""===o[0]&&""===o[1]}_createPart(){return new m(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class m extends p{}let v=!1;(()=>{try{const e={get capture(){return v=!0,!1}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){}})();class b{constructor(e,t,o){this.value=void 0,this.__pendingValue=void 0,this.element=e,this.eventName=t,this.eventContext=o,this.__boundHandleEvent=e=>this.handleEvent(e)}setValue(e){this.__pendingValue=e}commit(){for(;(0,r.w)(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=i.J,e(this)}if(this.__pendingValue===i.J)return;const e=this.__pendingValue,t=this.value,o=null==e||null!=t&&(e.capture!==t.capture||e.once!==t.once||e.passive!==t.passive),n=null!=e&&(null==t||o);o&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),n&&(this.__options=y(e),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=e,this.__pendingValue=i.J}handleEvent(e){"function"==typeof this.value?this.value.call(this.eventContext||this.element,e):this.value.handleEvent(e)}}const y=e=>e&&(v?{capture:e.capture,passive:e.passive,once:e.once}:e.capture)},787:(e,t,o)=>{"use strict";o.d(t,{L:()=>s,s:()=>a});var r=o(921),n=o(356),i=o(432);const s=new WeakMap,a=(e,t,o)=>{let a=s.get(t);void 0===a&&((0,r.r4)(t,t.firstChild),s.set(t,a=new n.nt(Object.assign({templateFactory:i.t},o))),a.appendInto(t)),a.setValue(e),a.commit()}},432:(e,t,o)=>{"use strict";o.d(t,{t:()=>n,r:()=>i});var r=o(560);function n(e){let t=i.get(e.type);void 0===t&&(t={stringsArray:new WeakMap,keyString:new Map},i.set(e.type,t));let o=t.stringsArray.get(e.strings);if(void 0!==o)return o;const n=e.strings.join(r.Jw);return o=t.keyString.get(n),void 0===o&&(o=new r.YS(e,e.getTemplateElement()),t.keyString.set(n,o)),t.stringsArray.set(e.strings,o),o}const i=new Map},122:(e,t,o)=>{"use strict";o.d(t,{R:()=>i});var r=o(921),n=o(560);class i{constructor(e,t,o){this.__parts=[],this.template=e,this.processor=t,this.options=o}update(e){let t=0;for(const o of this.__parts)void 0!==o&&o.setValue(e[t]),t++;for(const e of this.__parts)void 0!==e&&e.commit()}_clone(){const e=r.eC?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),t=[],o=this.template.parts,i=document.createTreeWalker(e,133,null,!1);let s,a=0,c=0,l=i.nextNode();for(;a<o.length;)if(s=o[a],(0,n.pC)(s)){for(;c<s.index;)c++,"TEMPLATE"===l.nodeName&&(t.push(l),i.currentNode=l.content),null===(l=i.nextNode())&&(i.currentNode=t.pop(),l=i.nextNode());if("node"===s.type){const e=this.processor.handleTextExpression(this.options);e.insertAfterNode(l.previousSibling),this.__parts.push(e)}else this.__parts.push(...this.processor.handleAttributeExpressions(l,s.name,s.strings,this.options));a++}else this.__parts.push(void 0),a++;return r.eC&&(document.adoptNode(e),customElements.upgrade(e)),e}}},823:(e,t,o)=>{"use strict";o.d(t,{j:()=>s}),o(921);var r=o(560);const n=window.trustedTypes&&trustedTypes.createPolicy("lit-html",{createHTML:e=>e}),i=` ${r.Jw} `;class s{constructor(e,t,o,r){this.strings=e,this.values=t,this.type=o,this.processor=r}getHTML(){const e=this.strings.length-1;let t="",o=!1;for(let n=0;n<e;n++){const e=this.strings[n],s=e.lastIndexOf("\x3c!--");o=(s>-1||o)&&-1===e.indexOf("--\x3e",s+1);const a=r.W5.exec(e);t+=null===a?e+(o?i:r.N):e.substr(0,a.index)+a[1]+a[2]+r.$E+a[3]+r.Jw}return t+=this.strings[e],t}getTemplateElement(){const e=document.createElement("template");let t=this.getHTML();return void 0!==n&&(t=n.createHTML(t)),e.innerHTML=t,e}}},560:(e,t,o)=>{"use strict";o.d(t,{Jw:()=>r,N:()=>n,$E:()=>s,YS:()=>a,pC:()=>l,IW:()=>d,W5:()=>u});const r=`{{lit-${String(Math.random()).slice(2)}}}`,n=`\x3c!--${r}--\x3e`,i=new RegExp(`${r}|${n}`),s="$lit$";class a{constructor(e,t){this.parts=[],this.element=t;const o=[],n=[],a=document.createTreeWalker(t.content,133,null,!1);let l=0,p=-1,h=0;const{strings:f,values:{length:g}}=e;for(;h<g;){const e=a.nextNode();if(null!==e){if(p++,1===e.nodeType){if(e.hasAttributes()){const t=e.attributes,{length:o}=t;let r=0;for(let e=0;e<o;e++)c(t[e].name,s)&&r++;for(;r-- >0;){const t=f[h],o=u.exec(t)[2],r=o.toLowerCase()+s,n=e.getAttribute(r);e.removeAttribute(r);const a=n.split(i);this.parts.push({type:"attribute",index:p,name:o,strings:a}),h+=a.length-1}}"TEMPLATE"===e.tagName&&(n.push(e),a.currentNode=e.content)}else if(3===e.nodeType){const t=e.data;if(t.indexOf(r)>=0){const r=e.parentNode,n=t.split(i),a=n.length-1;for(let t=0;t<a;t++){let o,i=n[t];if(""===i)o=d();else{const e=u.exec(i);null!==e&&c(e[2],s)&&(i=i.slice(0,e.index)+e[1]+e[2].slice(0,-s.length)+e[3]),o=document.createTextNode(i)}r.insertBefore(o,e),this.parts.push({type:"node",index:++p})}""===n[a]?(r.insertBefore(d(),e),o.push(e)):e.data=n[a],h+=a}}else if(8===e.nodeType)if(e.data===r){const t=e.parentNode;null!==e.previousSibling&&p!==l||(p++,t.insertBefore(d(),e)),l=p,this.parts.push({type:"node",index:p}),null===e.nextSibling?e.data="":(o.push(e),p--),h++}else{let t=-1;for(;-1!==(t=e.data.indexOf(r,t+1));)this.parts.push({type:"node",index:-1}),h++}}else a.currentNode=n.pop()}for(const e of o)e.parentNode.removeChild(e)}}const c=(e,t)=>{const o=e.length-t.length;return o>=0&&e.slice(o)===t},l=e=>-1!==e.index,d=()=>document.createComment(""),u=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/},153:(e,t,o)=>{"use strict";o.d(t,{_l:()=>r._l,nt:()=>r.nt,sL:()=>r.sL,IW:()=>c.IW,XM:()=>s.X,dy:()=>l,r4:()=>a.r4,V:()=>a.V});var r=o(356);const n=new class{handleAttributeExpressions(e,t,o,n){const i=t[0];return"."===i?new r.m(e,t.slice(1),o).parts:"@"===i?[new r.K1(e,t.slice(1),n.eventContext)]:"?"===i?[new r.JG(e,t.slice(1),o)]:new r.QG(e,t,o).parts}handleTextExpression(e){return new r.nt(e)}};var i=o(823),s=o(695),a=o(921),c=(o(301),o(787),o(432),o(122),o(560));"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.4.1");const l=(e,...t)=>new i.j(e,t,"html",n)},655:(e,t,o)=>{"use strict";o.d(t,{ZT:()=>n,pi:()=>i,mG:()=>s,Jh:()=>a});var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)};function n(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}var i=function(){return(i=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function s(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function a(e,t){var o,r,n,i,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){s.label=i[1];break}if(6===i[0]&&s.label<n[1]){s.label=n[1],n=i;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(i);break}n[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}}},t={};function o(r){var n=t[r];if(void 0!==n)return n.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,o),i.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=o(788),t=o(789);const r=[t.iv`
.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--selected-person-background-color:#f3f2f1}.mgt-dark{--selected-person-background-color:#4f4f4f}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--dropdown-item-selected-background:#deecf9;--arrow-fill:#000000}.mgt-dark{--dropdown-item-selected-background:#333d47;--arrow-fill:#605e5c}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--button-color:#323130;--popup-color:#323130}.mgt-dark{--button-color:#f3f2f1;--popup-color:#f3f2f1}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--event-background-color:#ffffff}.mgt-dark{--event-background-color:#161514}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--person-card-details-item-color:#201f1e}.mgt-dark{--person-card-details-item-color:#faf9f8}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--task-border:2px solid #e1dfdd;--task-complete-border:2px dotted #e1dfdd;--task-new-add-button-disabled-background:#edebe9;--task-icon-color:#000000}.mgt-dark{--task-border:2px solid #797775;--task-complete-border:2px dotted #797775;--task-new-add-button-disabled-background:#4f4f4f;--task-icon-color:#ffffff}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--file-background-color:#ffffff}.mgt-dark{--file-background-color:#424242}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--file-item-background-color--hover:rgba(0, 0, 0, 0.1);--file-item-background-color--active:rgba(0, 0, 0, 0.05);--file-list-background-color:#ffffff}.mgt-dark{--file-item-background-color--hover:#0078d4;--file-item-background-color--active:#238ada;--file-list-background-color:#424242}
`],n=document.createElement("style");n.type="text/css",n.appendChild(document.createTextNode("\n@font-face {\n    font-family: 'FabricMDL2Icons';\n    src: url('https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff2') format('woff2'),\n    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff) format(\"woff\"),\n    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.ttf) format(\"truetype\");;\n}\n")),document.head.appendChild(n);const i=document.createElement("style");function s(e){const t=new Date,o=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=o)return e.toLocaleString("default",{hour:"numeric",minute:"numeric"});const r=new Date(o);if(r.setDate(t.getDate()-t.getDay()),e>=r)return e.toLocaleString("default",{hour:"numeric",minute:"numeric",weekday:"short"});const n=new Date(r);return n.setDate(r.getDate()-7),e>=n?e.toLocaleString("default",{day:"numeric",month:"numeric",weekday:"short"}):e.toLocaleString("default",{day:"numeric",month:"numeric",year:"numeric"})}function a(e){const t=e.getMonth(),o=e.getDate();return`${c(t)} ${o}`}function c(e){switch(e){case 0:return"January";case 1:return"February";case 2:return"March";case 3:return"April";case 4:return"May";case 5:return"June";case 6:return"July";case 7:return"August";case 8:return"September";case 9:return"October";case 10:return"November";case 11:return"December";default:return"Month"}}function l(e,t){let o;return function(){const r=()=>e.apply(this,arguments);clearTimeout(o),o=setTimeout(r,t)}}function d(e){return e.startsWith("[")?e.match(/([a-zA-Z0-9+._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9_-]+)/gi).toString():e}function u(e){return/^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+(\.[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(\.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)*$/.test(e)}i.innerHTML=r.toString(),document.head.appendChild(i);var p=o(153);class h{constructor(e){this.classes=new Set,this.changed=!1,this.element=e;const t=(e.getAttribute("class")||"").split(/\s+/);for(const e of t)this.classes.add(e)}add(e){this.classes.add(e),this.changed=!0}remove(e){this.classes.delete(e),this.changed=!0}commit(){if(this.changed){let e="";this.classes.forEach((t=>e+=t+" ")),this.element.setAttribute("class",e)}}}const f=new WeakMap,g=(0,p.XM)((e=>t=>{if(!(t instanceof p._l)||t instanceof p.sL||"class"!==t.committer.name||t.committer.parts.length>1)throw new Error("The `classMap` directive must be used in the `class` attribute and must be the only part in the attribute.");const{committer:o}=t,{element:r}=o;let n=f.get(t);void 0===n&&(r.setAttribute("class",o.strings.join(" ")),f.set(t,n=new Set));const i=r.classList||new h(r);n.forEach((t=>{t in e||(i.remove(t),n.delete(t))}));for(const t in e){const o=e[t];o!=n.has(t)&&(o?(i.add(t),n.add(t)):(i.remove(t),n.delete(t)))}"function"==typeof i.commit&&i.commit()})),m={name:"presence",stores:{presence:"presence"},version:1},v={name:"users",stores:{users:"users",usersQuery:"usersQuery"},version:1},b={name:"photos",stores:{contacts:"contacts",users:"users"},version:1},y={name:"people",stores:{contacts:"contacts",groupPeople:"groupPeople",peopleQuery:"peopleQuery"},version:1},k={name:"groups",stores:{groups:"groups",groupsQuery:"groupsQuery"},version:2},w={name:"responses",stores:{responses:"responses"},version:1},C={name:"files",stores:{driveFiles:"driveFiles",groupFiles:"groupFiles",siteFiles:"siteFiles",userFiles:"userFiles",insightFiles:"insightFiles",fileQueries:"fileQueries"},version:1},T={name:"file-lists",stores:{fileLists:"fileLists",insightfileLists:"insightfileLists"},version:1};var S,_,I=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};!function(e){e[e.any=0]="any",e.person="person",e.group="group"}(S||(S={})),function(e){e.any="any",e.user="user",e.contact="contact"}(_||(_={}));const x=()=>e.CacheService.config.people.invalidationPeriod||e.CacheService.config.defaultInvalidationPeriod,E=()=>e.CacheService.config.people.isEnabled&&e.CacheService.config.isEnabled;function A(t,o,r=10,n=_.any){return I(this,void 0,void 0,(function*(){let i,s=`${o}:${r}:${n}`;if(E()){i=e.CacheService.getCache(y,y.stores.peopleQuery);const t=E()?yield i.getValue(s):null;if(t&&x()>Date.now()-t.timeCached)return t.results.map((e=>JSON.parse(e)))}let a,c="personType/class eq 'Person'";n!==_.any&&(n===_.user?c+="and personType/subclass eq 'OrganizationUser'":c+="and (personType/subclass eq 'ImplicitContact' or personType/subclass eq 'PersonalContact')");try{if(a=yield t.api("/me/people").search('"'+o+'"').top(r).filter(c).middlewareOptions((0,e.prepScopes)("people.read")).get(),E()&&a){const e={maxResults:r,results:null};e.results=a.value.map((e=>JSON.stringify(e))),i.putValue(o,e)}}catch(e){}return a?a.value:null}))}function P(t,o=_.any){return I(this,void 0,void 0,(function*(){let r,n=`*:${o}`;if(E()){r=e.CacheService.getCache(y,y.stores.peopleQuery);const t=yield r.getValue(n);if(t&&x()>Date.now()-t.timeCached)return t.results.map((e=>JSON.parse(e)))}let i,s="personType/class eq 'Person'";o!==_.any&&(o===_.user?s+="and personType/subclass eq 'OrganizationUser'":s+="and (personType/subclass eq 'ImplicitContact' or personType/subclass eq 'PersonalContact')");try{i=yield t.api("/me/people").middlewareOptions((0,e.prepScopes)("people.read")).filter(s).get(),E()&&i&&r.putValue(n,{maxResults:10,results:i.value.map((e=>JSON.stringify(e)))})}catch(e){}return i?i.value:null}))}function R(e){const t=e,o=e,r=e;return o.mail?d(o.mail):t.scoredEmailAddresses&&t.scoredEmailAddresses.length?d(t.scoredEmailAddresses[0].address):r.emailAddresses&&r.emailAddresses.length?d(r.emailAddresses[0].address):null}function O(t,o){return I(this,void 0,void 0,(function*(){let r;if(E()){r=e.CacheService.getCache(y,y.stores.contacts);const t=yield r.getValue(o);if(t&&x()>Date.now()-t.timeCached)return JSON.parse(t.person)}const n=yield t.api("/me/contacts").filter(`emailAddresses/any(a:a/address eq '${o}')`).middlewareOptions((0,e.prepScopes)("contacts.read")).get();return E()&&n&&r.putValue(o,{person:JSON.stringify(n.value)}),n?n.value:null}))}var N=o(877),D=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const L=()=>e.CacheService.config.users.invalidationPeriod||e.CacheService.config.defaultInvalidationPeriod,U=()=>e.CacheService.config.users.isEnabled&&e.CacheService.config.isEnabled;function M(t,o){return D(this,void 0,void 0,(function*(){let r;if(U()){r=e.CacheService.getCache(v,v.stores.users);const t=yield r.getValue("me");if(t&&L()>Date.now()-t.timeCached){const e=JSON.parse(t.user),r=o?o.filter((t=>!Object.keys(e).includes(t))):null;if(!r||r.length<=1)return e}}let n="me";o&&(n=n+"?$select="+o.toString());const i=t.api(n).middlewareOptions((0,e.prepScopes)("user.read")).get();return U()&&r.putValue("me",{user:JSON.stringify(yield i)}),i}))}function F(t,o,r){return D(this,void 0,void 0,(function*(){let n;if(U()){n=e.CacheService.getCache(v,v.stores.users);const t=yield n.getValue(o);if(t&&L()>Date.now()-t.timeCached){const e=t.user?JSON.parse(t.user):null,o=r&&e?r.filter((t=>!Object.keys(e).includes(t))):null;if(!o||o.length<=1)return e}}let i=`/users/${o}`;r&&(i=i+"?$select="+r.toString());const s=yield t.api(i).middlewareOptions((0,e.prepScopes)("user.readbasic.all")).get();return U()&&n.putValue(o,{user:JSON.stringify(s)}),s}))}function H(t,o){return D(this,void 0,void 0,(function*(){if(!o||0===o.length)return[];const r=t.createBatch(),n={},i=[];let s;U()&&(s=e.CacheService.getCache(v,v.stores.users));for(const e of o){n[e]=null;let t=null;U()&&(t=yield s.getValue(e)),t&&L()>Date.now()-t.timeCached?n[e]=t.user?JSON.parse(t.user):null:""!==e&&(r.get(e,`/users/${e}`,["user.readbasic.all"]),i.push(e))}try{const e=yield r.executeAll();for(const t of o){const o=e.get(t);o&&o.content&&(n[t]=o.content,U()&&s.putValue(t,{user:JSON.stringify(o.content)}))}return Promise.all(Object.values(n))}catch(e){try{return o.filter((e=>i.includes(e))).forEach((e=>n[e]=F(t,e))),U()&&o.filter((e=>i.includes(e))).forEach((e=>D(this,void 0,void 0,(function*(){return s.putValue(e,{user:JSON.stringify(yield n[e])})})))),Promise.all(Object.values(n))}catch(e){return[]}}}))}function q(t,o,r=10){return D(this,void 0,void 0,(function*(){const n={maxResults:r,results:null};let i,s;if(U()){i=e.CacheService.getCache(v,v.stores.usersQuery);const t=yield i.getValue(o);if(t&&L()>Date.now()-t.timeCached)return t.results.map((e=>JSON.parse(e)))}try{s=yield t.api("users").header("ConsistencyLevel","eventual").count(!0).search(`"displayName:${o}" OR "mail:${o}"`).top(r).middlewareOptions((0,e.prepScopes)("User.ReadBasic.All")).get()}catch(e){}return U()&&s&&(n.results=s.value.map((e=>JSON.stringify(e))),i.putValue(o,n)),s?s.value:null}))}function $(t,o,r,n=10,i=S.person,s=!1){return D(this,void 0,void 0,(function*(){const a={maxResults:n,results:null};let c;const l=`${r||"*"}:${o||"*"}:${i}:${s}`;if(U()){c=e.CacheService.getCache(v,v.stores.usersQuery);const t=yield c.getValue(l);if(t&&L()>Date.now()-t.timeCached)return t.results.map((e=>JSON.parse(e)))}let d="";o&&(d=`startswith(displayName,'${o}') or startswith(givenName,'${o}') or startswith(surname,'${o}') or startswith(mail,'${o}') or startswith(userPrincipalName,'${o}')`);let u=`/groups/${r}/${s?"transitiveMembers":"members"}`;i===S.person?u+="/microsoft.graph.user":i===S.group&&(u+="/microsoft.graph.group",o&&(d=`startswith(displayName,'${o}') or startswith(mail,'${o}')`));const p=yield t.api(u).count(!0).top(n).filter(d).header("ConsistencyLevel","eventual").middlewareOptions((0,e.prepScopes)("user.read.all","people.read")).get();return U()&&p&&(a.results=p.value.map((e=>JSON.stringify(e))),c.putValue(l,a)),p?p.value:null}))}var B=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const j=()=>e.CacheService.config.photos.invalidationPeriod||e.CacheService.config.defaultInvalidationPeriod,z=()=>e.CacheService.config.photos.isEnabled&&e.CacheService.config.isEnabled;function V(t,o,r){return B(this,void 0,void 0,(function*(){try{const i=yield t.api(`${o}/photo/$value`).responseType(N.UN.RAW).middlewareOptions((0,e.prepScopes)(...r)).get();if(404===i.status)return{eTag:null,photo:null};if(!i.ok)return null;return{eTag:i.headers.get("eTag"),photo:yield(n=yield i.blob(),new Promise(((e,t)=>{const o=new FileReader;o.onerror=t,o.onload=t=>{e(o.result)},o.readAsDataURL(n)})))}}catch(e){return null}var n}))}function G(t,o){return B(this,void 0,void 0,(function*(){let r,n;return z()&&(r=e.CacheService.getCache(b,b.stores.contacts),n=yield r.getValue(o),n&&j()>Date.now()-n.timeCached)?n.photo:(n=yield V(t,`me/contacts/${o}`,["contacts.read"]),z()&&n&&r.putValue(o,n),n?n.photo:null)}))}function K(t,o){return B(this,void 0,void 0,(function*(){let r,n;if(z()){if(r=e.CacheService.getCache(b,b.stores.users),n=yield r.getValue(o),n&&j()>Date.now()-n.timeCached)return n.photo;if(n)try{const e=yield t.api(`users/${o}/photo`).get();e&&(e["@odata.mediaEtag"]!==n.eTag||null===e["@odata.mediaEtag"]&&null===e.eTag)&&(n=null)}catch(e){return null}}return n=n||(yield V(t,`users/${o}`,["user.readbasic.all"])),z()&&n&&r.putValue(o,n),n?n.photo:null}))}function W(e,t,o=!0){return B(this,void 0,void 0,(function*(){if("personType"in t&&"OrganizationUser"!==t.personType.subclass){if("PersonalContact"===t.personType.subclass&&o){const o=R(t),r=yield O(e,o);if(r&&r.length&&r[0].id)return yield G(e,r[0].id)}return null}if(t.userPrincipalName||t.id){const o=t.userPrincipalName||t.id;return yield K(e,o)}if(t.id){const o=yield K(e,t.id);if(o)return o}const r=R(t);if(r){const t=yield q(e,r,1);if(t&&t.length)return yield K(e,t[0].id);if(o){const t=yield O(e,r);if(t&&t.length)return yield G(e,t[0].id)}}return null}))}function Q(t,o,r){return B(this,void 0,void 0,(function*(){e.CacheService.getCache(b,o).putValue(t,r)}))}var J=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const Y=()=>e.CacheService.config.presence.invalidationPeriod||e.CacheService.config.defaultInvalidationPeriod,Z=()=>e.CacheService.config.presence.isEnabled&&e.CacheService.config.isEnabled;function X(t,o){return J(this,void 0,void 0,(function*(){let r;if(Z()){r=e.CacheService.getCache(m,m.stores.presence);const t=yield r.getValue(o||"me");if(t&&Y()>Date.now()-t.timeCached)return JSON.parse(t.presence)}const n=o?["presence.read.all"]:["presence.read"],i=o?`/users/${o}/presence`:"/me/presence",s=yield t.api(i).middlewareOptions((0,e.prepScopes)(...n)).get();return Z()&&r.putValue(o||"me",{presence:JSON.stringify(s)}),s}))}var ee,te;function oe(t,o,r){return n=this,i=void 0,a=function*(){let n,i,s=null,a=null;const c=o?`users/${o}`:"me";let l=c+(r?`?$select=${r.toString()}`:"");const d=o?["user.readbasic.all"]:["user.read"];if(U()){const t=e.CacheService.getCache(v,v.stores.users);i=yield t.getValue(o||"me"),i&&L()>Date.now()-i.timeCached?(a=i.user?JSON.parse(i.user):null,r&&r.filter((e=>!Object.keys(a).includes(e))).length>=1&&(a=null,i=null)):i=null}if(z())if(n=yield function(t,o){return B(this,void 0,void 0,(function*(){const r=e.CacheService.getCache(b,o);return yield r.getValue(t)}))}(o||"me",b.stores.users),n&&j()>Date.now()-n.timeCached)s=n.photo;else if(n)try{const e=yield t.api(`${c}/photo`).get();e&&e["@odata.mediaEtag"]&&e["@odata.mediaEtag"]===n.eTag?(Q(o||"me",b.stores.users,n),s=n.photo):n=null}catch(e){}if(n||i)if(n){if(!i){const r=yield t.api(l).middlewareOptions((0,e.prepScopes)(...d)).get();r&&(U()&&e.CacheService.getCache(v,v.stores.users).putValue(o||"me",{user:JSON.stringify(r)}),a=r)}}else{const e=yield V(t,c,d);e&&(z()&&Q(o||"me",b.stores.users,{eTag:e.eTag,photo:e.photo}),s=e.photo)}else{let n;const i=t.createBatch();o?(i.get("user",`/users/${o}${r?"?$select="+r.toString():""}`,["user.readbasic.all"]),i.get("photo",`users/${o}/photo/$value`,["user.readbasic.all"])):(i.get("user","me",["user.read"]),i.get("photo","me/photo/$value",["user.read"]));const c=yield i.executeAll(),l=c.get("photo");l&&(n=l.headers.ETag,s=l.content);const d=c.get("user");d&&(a=d.content),U()&&e.CacheService.getCache(v,v.stores.users).putValue(o||"me",{user:JSON.stringify(a)}),z()&&Q(o||"me",b.stores.users,{eTag:n,photo:s})}return a&&(a.personImage=s),a},new((s=void 0)||(s=Promise))((function(e,t){function o(e){try{c(a.next(e))}catch(e){t(e)}}function r(e){try{c(a.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof s?n:new s((function(e){e(n)}))).then(o,r)}c((a=a.apply(n,i||[])).next())}));var n,i,s,a}function re(e,o){switch(e){case te.ArrowRight:return t.dy`
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M8 7L4.46481 10.5359L4.46481 7L4.46481 3.46413L8 7Z" />
        </svg>
      `;case te.ArrowDown:return t.dy`
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 9L2.46447 5.46447H6H9.53553L6 9Z" />
        </svg>
      `;case te.TeamSeparator:return t.dy`
        <svg width="6" height="10" viewBox="0 0 6 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M5.70711 5L1.49999 9.20711L0.792886 8.50001L4.29289 5L0.792887 1.49999L1.49999 0.792885L5.70711 5Z"
            fill=${o}
          />
        </svg>
      `;case te.Search:return t.dy`
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
          <g clip-path="url(#clip0)">
            <circle cx="5.36377" cy="5.36396" r="4" transform="rotate(45 5.36377 5.36396)" stroke="#B3B0AD" />
            <path
              d="M8.19189 7.48529L12.7881 12.0815C12.9834 12.2767 12.9834 12.5933 12.7881 12.7886V12.7886C12.5928 12.9839 12.2762 12.9839 12.081 12.7886L7.48479 8.1924L8.19189 7.48529Z"
              fill="#B3B0AD"
            />
          </g>
          <defs>
            <clipPath id="clip0">
              <rect width="14" height="14" fill="white" />
            </clipPath>
          </defs>
        </svg>
      `;case te.SkypeArrow:return t.dy`
        <svg viewBox="0 0 12 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M3.95184 0.480534C4.23385 0.10452 4.70926 -0.0724722 5.1685 0.0275755C5.62775 0.127623 5.98645 0.486329 6.0865 0.945575C6.18655 1.40482 6.00956 1.88023 5.63354 2.16224L4.07196 3.72623H10.7988C11.4622 3.72623 12 4.26403 12 4.92744C12 5.59086 11.4622 6.12866 10.7988 6.12866H4.07196L5.63114 7.68784C6.0955 8.15225 6.0955 8.90515 5.63114 9.36955C5.51655 9.48381 5.38119 9.57514 5.23234 9.63862C5.09341 9.69857 4.94399 9.73042 4.79269 9.73232C4.63498 9.73233 4.4789 9.70046 4.33382 9.63862C4.18765 9.57669 4.05593 9.48507 3.94703 9.36955L0.343377 5.7659C-0.114459 5.29881 -0.114459 4.55128 0.343377 4.08419L3.95184 0.480534Z"
            fill="#B4009E"
          />
        </svg>
      `;case te.SmallEmail:return t.dy`
        <svg width="14" height="10" viewBox="0 0 14 10" xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M11.8473 1H2.04886L6.47364 4.18916C6.64273 4.31103 6.86969 4.31522 7.04316 4.19968L11.8473 1ZM1 1.47671V9H13V1.43376L7.59749 5.03198C7.07706 5.3786 6.39621 5.36601 5.88894 5.0004L1 1.47671ZM0 1C0 0.447715 0.447715 0 1 0H13C13.5523 0 14 0.447715 14 1V9C14 9.55228 13.5523 10 13 10H1C0.447716 10 0 9.55229 0 9V1Z"
          />
        </svg>
      `;case te.SmallChat:return t.dy`
        <svg width="13" height="13" viewBox="0 0 13 13" xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M9.5781 8.26403L9.57811 8.26403C9.68611 8.29867 9.8455 8.36364 10.0125 8.50479C10.1405 8.61294 10.2409 8.73883 10.3235 8.86465L11.9634 10.9944C11.9701 10.9924 11.9753 10.9904 11.9785 10.9889C11.9841 10.9864 11.9918 10.9823 12 10.9768V1.32284C12 1.18078 11.8731 1 11.6207 1H1.37926C1.12692 1 1 1.18078 1 1.32284V7.37377C1 7.45357 1.01415 7.49036 1.02102 7.50507C1.02778 7.51955 1.04342 7.54689 1.09159 7.58705L1.10485 7.5981L1.11771 7.6096C1.13526 7.62529 1.21707 7.69076 1.33937 7.76027C1.46122 7.82952 1.58119 7.87864 1.67944 7.89966L1.69102 7.90214L1.691 7.9022C3.32106 8.27116 6.2626 8.27688 8.67896 8.18036L8.69908 8.17955L8.71921 8.17956L8.7627 8.17954C9.01362 8.17932 9.31313 8.17907 9.5781 8.26403ZM11.2376 11.6908L9.50506 9.44081C9.39493 9.26422 9.32445 9.23285 9.27276 9.21627C9.17534 9.18504 9.0401 9.17966 8.71888 9.17956C6.31879 9.27543 3.24831 9.27999 1.47024 8.87753C1.01314 8.77974 0.600449 8.48852 0.451238 8.35513C0.15593 8.10893 0 7.78958 0 7.37377V1.32284C0 0.593147 0.610664 0 1.37926 0H11.6207C12.3893 0 13 0.593147 13 1.32284V11.0441C13 11.4686 12.6828 11.7689 12.3881 11.9012C12.1048 12.0284 11.673 12.0728 11.3387 11.7993C11.3003 11.7679 11.2678 11.7301 11.2376 11.6908ZM3 3.5C3 3.22386 3.22386 3 3.5 3H9.5C9.77614 3 10 3.22386 10 3.5C10 3.77614 9.77614 4 9.5 4H3.5C3.22386 4 3 3.77614 3 3.5ZM3.5 5C3.22386 5 3 5.22386 3 5.5C3 5.77614 3.22386 6 3.5 6H6.5C6.77614 6 7 5.77614 7 5.5C7 5.22386 6.77614 5 6.5 5H3.5Z"
          />
        </svg>
      `;case te.ExpandDown:return t.dy`
        <svg width="15" height="8" viewBox="0 0 15 8" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M14 1L7.5 7L1 1" stroke="#3078CD" />
        </svg>
      `;case te.Overview:return t.dy`
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            d="M12 4V9H2V4H12ZM11 8V5H3V8H11ZM13 4H18V9H13V4ZM17 8V5H14V8H17ZM8 15V10H18V15H8ZM9 11V14H17V11H9ZM2 15V10H7V15H2ZM3 11V14H6V11H3Z"
          />
        </svg>
      `;case te.Send:return t.dy`
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            d="M4.27144 8.99999L1.72572 2.45387C1.54854 1.99826 1.9928 1.56256 2.43227 1.71743L2.50153 1.74688L16.0015 8.49688C16.3902 8.69122 16.4145 9.22336 16.0744 9.45992L16.0015 9.50311L2.50153 16.2531C2.0643 16.4717 1.58932 16.0697 1.70282 15.6178L1.72572 15.5461L4.27144 8.99999L1.72572 2.45387L4.27144 8.99999ZM3.3028 3.4053L5.25954 8.43705L10.2302 8.43749C10.515 8.43749 10.7503 8.64911 10.7876 8.92367L10.7927 8.99999C10.7927 9.28476 10.5811 9.52011 10.3065 9.55736L10.2302 9.56249L5.25954 9.56205L3.3028 14.5947L14.4922 8.99999L3.3028 3.4053Z"
          />
        </svg>
      `;case te.Contact:return t.dy`
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            d="M11.3315 11.7855L11.3452 11.7913L11.3591 11.7967C11.4057 11.8149 11.4421 11.8389 11.4762 11.8729L12.8836 13.2797C12.9177 13.3137 12.9416 13.35 12.9597 13.3965L12.9651 13.4104L12.971 13.4241C12.9902 13.4693 13 13.5151 13 13.5699C13 13.6248 12.9901 13.6759 12.9676 13.7303L12.9675 13.7302L12.9628 13.7419C12.9458 13.7844 12.9218 13.822 12.8836 13.8602L12.7941 13.9497C12.57 14.1736 12.3673 14.37 12.1855 14.5396C12.0445 14.6712 11.9037 14.7767 11.7639 14.8601C11.6429 14.9284 11.499 14.9865 11.3265 15.0296C11.1716 15.0683 10.9523 15.0957 10.6541 15.0957C10.226 15.0957 9.77339 15.0291 9.29316 14.8873C8.79837 14.7411 8.29897 14.537 7.79466 14.2716C7.29099 14.0043 6.7904 13.6843 6.2931 13.3097C5.79797 12.9334 5.32815 12.5234 4.88351 12.0793C4.44215 11.6299 4.03516 11.1575 3.66219 10.6619C3.2916 10.1652 2.97561 9.66531 2.71228 9.16232C2.44987 8.65684 2.24939 8.16115 2.1072 7.67496C1.96889 7.20203 1.9043 6.75953 1.9043 6.34426C1.9043 6.04676 1.92945 5.8283 1.96505 5.67477C2.00758 5.51024 2.06491 5.36965 2.13346 5.24839C2.21771 5.10725 2.32161 4.96874 2.44802 4.83312C2.61763 4.65148 2.814 4.44899 3.03788 4.22522L3.14024 4.12291C3.18256 4.08061 3.22694 4.05101 3.2785 4.0291C3.32105 4.01103 3.36887 4 3.43131 4C3.48634 4 3.53235 4.00983 3.57773 4.0291L3.57771 4.02914L3.58585 4.03251C3.6411 4.05541 3.68414 4.08469 3.72239 4.12291L5.12984 5.52968C5.16387 5.56369 5.18781 5.60004 5.20594 5.64649L5.21136 5.66038L5.2172 5.6741C5.23642 5.71931 5.24622 5.76513 5.24622 5.81992C5.24622 5.88591 5.23631 5.9178 5.23225 5.92835C5.20132 5.99698 5.16601 6.05438 5.12738 6.10352C5.07447 6.17083 5.01613 6.23146 4.95179 6.28625L4.94467 6.2923L4.93768 6.29849C4.81323 6.40852 4.69584 6.51839 4.58605 6.62811C4.45174 6.76237 4.32909 6.90895 4.22378 7.06908C4.0535 7.32254 3.96032 7.61696 3.96032 7.93007C3.96032 8.35888 4.12439 8.75141 4.42612 9.05299L7.95115 12.5763C8.25285 12.8779 8.64535 13.0417 9.07392 13.0417C9.38687 13.0417 9.68121 12.9486 9.9347 12.7785C10.0949 12.6733 10.2415 12.5507 10.3758 12.4164C10.4856 12.3067 10.5955 12.1894 10.7056 12.065L10.7118 12.058L10.7179 12.0509C10.7727 11.9866 10.8333 11.9283 10.9007 11.8754C10.9499 11.8367 11.0074 11.8014 11.0761 11.7704C11.0868 11.7663 11.1189 11.7564 11.1851 11.7564C11.2401 11.7564 11.2861 11.7662 11.3315 11.7855ZM11.5689 15.9998C11.8248 15.9358 12.0573 15.8442 12.2663 15.7248C12.4753 15.6012 12.6757 15.4499 12.8676 15.2708C13.0596 15.0918 13.2707 14.8872 13.501 14.657L13.5906 14.5674C13.7228 14.4353 13.823 14.284 13.8912 14.1134C13.9637 13.9387 14 13.7575 14 13.5699C14 13.3824 13.9637 13.2033 13.8912 13.0328C13.823 12.858 13.7228 12.7045 13.5906 12.5724L12.1831 11.1656C12.0509 11.0335 11.8974 10.9333 11.7225 10.8651C11.5519 10.7926 11.3728 10.7564 11.1851 10.7564C10.9974 10.7564 10.829 10.7884 10.6797 10.8523C10.5347 10.9163 10.4025 10.9951 10.283 11.0889C10.1636 11.1827 10.0549 11.2871 9.95677 11.4022C9.85868 11.5131 9.76272 11.6154 9.66889 11.7092C9.57506 11.8029 9.47909 11.8818 9.381 11.9457C9.28717 12.0097 9.18481 12.0417 9.07392 12.0417C8.91185 12.0417 8.77323 11.9841 8.65808 11.869L5.13305 8.34571C5.0179 8.23061 4.96032 8.09206 4.96032 7.93007C4.96032 7.81924 4.99231 7.71693 5.05628 7.62314C5.12026 7.52509 5.19916 7.42918 5.29299 7.33539C5.38682 7.24161 5.48918 7.14569 5.60007 7.04765C5.71522 6.9496 5.81972 6.84089 5.91355 6.72153C6.00738 6.60217 6.08628 6.47002 6.15026 6.32508C6.21423 6.17588 6.24622 6.00749 6.24622 5.81992C6.24622 5.63236 6.20997 5.45331 6.13746 5.2828C6.06922 5.10802 5.96899 4.95455 5.83678 4.8224L4.42932 3.41564C4.29711 3.28348 4.14357 3.18117 3.9687 3.1087C3.7981 3.03623 3.61897 3 3.43131 3C3.23939 3 3.05813 3.03623 2.88752 3.1087C2.71692 3.18117 2.56552 3.28348 2.4333 3.41564L2.33094 3.51795C2.10063 3.74814 1.89591 3.95916 1.71678 4.15099C1.54192 4.33856 1.39264 4.53678 1.26895 4.74567C1.14953 4.95455 1.05784 5.18475 0.993862 5.43626C0.934152 5.68777 0.904297 5.99044 0.904297 6.34426C0.904297 6.86434 0.985332 7.40147 1.1474 7.95565C1.30947 8.50983 1.53552 9.06614 1.82554 9.62458C2.11556 10.1788 2.46102 10.7244 2.86193 11.2615C3.26285 11.7944 3.70001 12.3017 4.17342 12.7834C4.65111 13.2609 5.15651 13.7021 5.68963 14.107C6.22703 14.512 6.77295 14.8616 7.3274 15.1557C7.88611 15.4499 8.44696 15.6801 9.00994 15.8463C9.57292 16.0126 10.121 16.0957 10.6541 16.0957C11.0081 16.0957 11.313 16.0637 11.5689 15.9998ZM14.9616 14H17.0002C17.5525 14 18.0002 13.5523 18.0002 13V5C18.0002 4.44772 17.5525 4 17.0002 4H6.43555L6.54385 4.11514C6.77073 4.34192 6.94536 4.60775 7.06365 4.90525C7.07677 4.93665 7.08919 4.96824 7.10089 5H16.8821L10.2238 8.32913C10.083 8.39951 9.91736 8.39951 9.7766 8.32913L7.22381 7.05273L6.7766 7.94716L9.32938 9.22355C9.75167 9.4347 10.2487 9.4347 10.671 9.22356L17.0002 6.05895V13H14.9314C14.9772 13.1858 15.0001 13.3764 15.0001 13.5699C15.0001 13.7154 14.9872 13.8589 14.9616 14Z"
          />
        </svg>
      `;case te.Copy:return t.dy`
        <svg width="13" height="14" viewBox="0 0 13 14" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M12.625 5.50293V14H3.875V11.375H0.375V0H6.24707L8.87207 2.625H9.74707L12.625 5.50293ZM10 5.25H11.1279L10 4.12207V5.25ZM3.875 2.625H7.62793L5.87793 0.875H1.25V10.5H3.875V2.625ZM11.75 6.125H9.125V3.5H4.75V13.125H11.75V6.125Z"
          />
        </svg>
      `;case te.CellPhone:return t.dy`
        <svg width="10" height="15" viewBox="0 0 10 15" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect x="0.5" y="0.5" width="9" height="14" rx="0.9" stroke="${o}" />
          <rect x="3" y="12" width="4" height="1" rx="0.5" fill="${o}" />
        </svg>
      `;case te.Chat:return t.dy`
        <svg width="17" height="15" viewBox="0 0 17 15" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M2.67824 0C2.3824 0 2.14258 0.239826 2.14258 0.535665C2.14258 0.831505 2.3824 1.07133 2.67824 1.07133H13.9985C14.5508 1.07133 14.9985 1.51905 14.9985 2.07133V12.3203C14.9985 12.6161 15.2384 12.856 15.5342 12.856C15.8301 12.856 16.0699 12.6161 16.0699 12.3203V2C16.0699 0.895431 15.1744 0 14.0699 0H2.67824Z"
            fill="${o}"
          />
          <path
            d="M9.34097 11.4769L9.3309 11.4769L9.32085 11.4773C6.74142 11.5804 3.51639 11.5801 1.6855 11.1657L1.6855 11.1657L1.67972 11.1644C1.30373 11.084 0.937799 10.8292 0.816663 10.7209L0.81023 10.7152L0.803602 10.7096C0.601843 10.5414 0.5 10.3403 0.5 10.0423V3.55978C0.5 3.07185 0.912353 2.64258 1.47765 2.64258H12.4497C13.0149 2.64258 13.4273 3.07185 13.4273 3.55978V13.9745C13.4273 14.1578 13.2827 14.3397 13.067 14.4366C12.8614 14.5288 12.6204 14.5275 12.457 14.3904L10.5932 11.9699C10.5218 11.8587 10.4457 11.7646 10.3579 11.6904C10.2528 11.6015 10.1556 11.5622 10.0869 11.5401L9.93419 12.0163L10.0869 11.5401C9.89097 11.4773 9.65413 11.477 9.34097 11.4769Z"
            stroke="${o}"
          />
        </svg>
      `;case te.Department:return t.dy`
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M9.625 3.5H14V11.375H0V3.5H4.375V1.75H9.625V3.5ZM5.25 2.625V3.5H8.75V2.625H5.25ZM13.125 4.375H0.875V6.125H3.5V5.25H4.375V6.125H9.625V5.25H10.5V6.125H13.125V4.375ZM0.875 10.5H13.125V7H10.5V7.875H9.625V7H4.375V7.875H3.5V7H0.875V10.5Z"
            fill="${o}"
          />
        </svg>
      `;case te.Email:return t.dy`
        <svg width="14" height="10" viewBox="0 0 14 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M0.5 0.772727C0.5 0.622104 0.622104 0.5 0.772727 0.5H13.2273C13.3779 0.5 13.5 0.622104 13.5 0.772727V9.22727C13.5 9.3779 13.3779 9.5 13.2273 9.5H0.772727C0.622104 9.5 0.5 9.3779 0.5 9.22727V0.772727Z"
            stroke="${o}"
          />
          <path d="M13.5 0.5L7.18923 4.70314C6.92113 4.8817 6.57039 4.87522 6.30907 4.68687L0.5 0.5" stroke="#929292" />
        </svg>
      `;case te.OfficeLocation:return t.dy`
        <svg width="14" height="17" viewBox="0 0 14 17" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M6.78489 16.3832L6.78263 16.3859C6.75278 16.4216 6.71543 16.4503 6.67324 16.4701L6.88498 16.923L6.67324 16.4701C6.63105 16.4898 6.58504 16.5 6.53846 16.5C6.49188 16.5 6.44588 16.4898 6.40368 16.4701C6.36149 16.4503 6.32415 16.4216 6.2943 16.3859L6.29202 16.3832C5.47882 15.4241 4.01597 13.6289 2.75914 11.7172C2.13055 10.7611 1.56021 9.78597 1.14862 8.87887C0.732553 7.96189 0.5 7.15987 0.5 6.53687C0.5 3.20251 3.20343 0.5 6.53846 0.5C9.87349 0.5 12.5769 3.20251 12.5769 6.53687C12.5769 7.16011 12.3444 7.96225 11.9283 8.87925C11.5167 9.78639 10.9464 10.7615 10.3178 11.7175C9.06097 13.6291 7.59812 15.424 6.78489 16.3832Z"
            stroke="${o}"
          />
          <path
            d="M4.40039 6.53921C4.40039 5.37092 5.34748 4.42383 6.51577 4.42383C7.68407 4.42383 8.63116 5.37092 8.63116 6.53921C8.63116 7.70751 7.68407 8.6546 6.51577 8.6546C5.34748 8.6546 4.40039 7.70751 4.40039 6.53921Z"
            stroke="${o}"
          />
        </svg>
      `;case te.Person:return t.dy`
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M8.91699 4C8.91699 5.65685 7.57385 7 5.91699 7C4.26014 7 2.91699 5.65685 2.91699 4C2.91699 2.34315 4.26014 1 5.91699 1C7.57385 1 8.91699 2.34315 8.91699 4ZM8.04431 7.38803C9.16935 6.68014 9.91699 5.42738 9.91699 4C9.91699 1.79086 8.12613 0 5.91699 0C3.70785 0 1.91699 1.79086 1.91699 4C1.91699 5.42739 2.66465 6.68016 3.78972 7.38805C1.82681 8.13254 0.356122 9.8773 0 12H1.01706C1.48033 9.71776 3.49808 8 5.91704 8C8.336 8 10.3538 9.71776 10.817 12H11.8341C11.478 9.87728 10.0072 8.1325 8.04431 7.38803Z"
            fill="${o}"
          />
        </svg>
      `;case te.Messages:return t.dy`
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M4 3.5C4 3.22386 4.22386 3 4.5 3H16C17.1046 3 18 3.89543 18 5V12.5C18 12.7761 17.7761 13 17.5 13C17.2239 13 17 12.7761 17 12.5V5C17 4.44772 16.5523 4 16 4H4.5C4.22386 4 4 3.77614 4 3.5ZM4.04886 6H13.8473L9.04316 9.19968C8.86969 9.31522 8.64273 9.31103 8.47364 9.18916L4.04886 6ZM3 14V6.47671L7.88894 10.0004C8.39621 10.366 9.07706 10.3786 9.59749 10.032L15 6.43376V14H3ZM3 5C2.44772 5 2 5.44772 2 6V14C2 14.5523 2.44772 15 3 15H15C15.5523 15 16 14.5523 16 14V6C16 5.44772 15.5523 5 15 5H3Z"
          />
        </svg>
      `;case te.Organization:return t.dy`
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M13 4H8V7H13V4ZM8 3C7.44772 3 7 3.44772 7 4V7C7 7.55228 7.44772 8 8 8H10V9H7.5C6.67157 9 6 9.67157 6 10.5V11H4C3.44772 11 3 11.4477 3 12V15C3 15.5523 3.44772 16 4 16H9C9.55228 16 10 15.5523 10 15V12C10 11.4477 9.55228 11 9 11H7V10.5C7 10.2239 7.22386 10 7.5 10H13.5C13.7761 10 14 10.2239 14 10.5V11H12C11.4477 11 11 11.4477 11 12V15C11 15.5523 11.4477 16 12 16H17C17.5523 16 18 15.5523 18 15V12C18 11.4477 17.5523 11 17 11H15V10.5C15 9.67157 14.3284 9 13.5 9H11V8H13C13.5523 8 14 7.55228 14 7V4C14 3.44772 13.5523 3 13 3H8ZM9 12H4L4 15H9V12ZM12 12H17V15H12V12Z"
          />
        </svg>
      `;case te.ExpandRight:return t.dy`
        <svg width="8" height="13" viewBox="0 0 8 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M1 12L6.5 6.5L1 1" stroke="#B8B8B8" stroke-width="2" />
        </svg>
      `;case te.Profile:return t.dy`
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M13 8C13 9.65685 11.6569 11 10 11C8.34315 11 7 9.65685 7 8C7 6.34315 8.34315 5 10 5C11.6569 5 13 6.34315 13 8ZM12.1273 11.388C13.2524 10.6801 14 9.42738 14 8C14 5.79086 12.2091 4 10 4C7.79086 4 6 5.79086 6 8C6 9.42739 6.74766 10.6802 7.87272 11.3881C5.90981 12.1325 4.43913 13.8773 4.08301 16H5.10007C5.56334 13.7178 7.58109 12 10 12C12.419 12 14.4368 13.7178 14.9 16H15.9171C15.561 13.8773 14.0903 12.1325 12.1273 11.388Z"
          />
        </svg>
      `;case te.Profile:return t.dy`
        <svg width="12" height="14" viewBox="0 0 12 14" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            opacity="0.5"
            d="M5.125 10.0625C5.125 10.2448 5.15918 10.4157 5.22754 10.5752C5.2959 10.7347 5.38932 10.8737 5.50781 10.9922C5.6263 11.1107 5.7653 11.2041 5.9248 11.2725C6.08431 11.3408 6.25521 11.375 6.4375 11.375H9.0625C9.35872 11.375 9.63672 11.4297 9.89648 11.5391C10.1608 11.6484 10.3978 11.8079 10.6074 12.0176C10.8171 12.2272 10.9766 12.4642 11.0859 12.7285C11.1953 12.9883 11.25 13.2663 11.25 13.5625C11.25 13.681 11.2067 13.7835 11.1201 13.8701C11.0335 13.9567 10.931 14 10.8125 14C10.694 14 10.5915 13.9567 10.5049 13.8701C10.4183 13.7835 10.375 13.681 10.375 13.5625C10.375 13.3802 10.3408 13.2093 10.2725 13.0498C10.2041 12.8903 10.1107 12.7513 9.99219 12.6328C9.8737 12.5143 9.7347 12.4209 9.5752 12.3525C9.41569 12.2842 9.24479 12.25 9.0625 12.25H6.4375C6.14128 12.25 5.861 12.1953 5.59668 12.0859C5.33691 11.9766 5.10221 11.8171 4.89258 11.6074C4.68294 11.3978 4.52344 11.1631 4.41406 10.9033C4.30469 10.639 4.25 10.3587 4.25 10.0625V9.46777C3.7168 9.21712 3.23372 8.89811 2.80078 8.51074C2.36784 8.12337 1.9987 7.69043 1.69336 7.21191C1.39258 6.72884 1.16016 6.21159 0.996094 5.66016C0.832031 5.10417 0.75 4.52995 0.75 3.9375C0.75 3.39518 0.852539 2.88477 1.05762 2.40625C1.26725 1.92773 1.5498 1.51074 1.90527 1.15527C2.26074 0.799805 2.67773 0.519531 3.15625 0.314453C3.63477 0.104818 4.14518 0 4.6875 0C5.22982 0 5.74023 0.104818 6.21875 0.314453C6.69727 0.519531 7.11426 0.799805 7.46973 1.15527C7.8252 1.51074 8.10547 1.92773 8.31055 2.40625C8.52018 2.88477 8.625 3.39518 8.625 3.9375C8.625 4.52995 8.54297 5.10417 8.37891 5.66016C8.21484 6.21615 7.98014 6.7334 7.6748 7.21191C7.37402 7.69043 7.00716 8.12337 6.57422 8.51074C6.14583 8.89811 5.66276 9.21712 5.125 9.46777V10.0625ZM1.625 3.9375C1.625 4.45247 1.69564 4.9515 1.83691 5.43457C1.98275 5.91309 2.18783 6.3597 2.45215 6.77441C2.72103 7.18913 3.04232 7.56283 3.41602 7.89551C3.79427 8.22363 4.2181 8.49479 4.6875 8.70898C5.1569 8.49479 5.57845 8.22363 5.95215 7.89551C6.3304 7.56283 6.65169 7.18913 6.91602 6.77441C7.1849 6.3597 7.38997 5.91309 7.53125 5.43457C7.67708 4.9515 7.75 4.45247 7.75 3.9375C7.75 3.51367 7.66797 3.11719 7.50391 2.74805C7.3444 2.37435 7.12565 2.05078 6.84766 1.77734C6.57422 1.49935 6.25065 1.2806 5.87695 1.12109C5.50781 0.957031 5.11133 0.875 4.6875 0.875C4.26367 0.875 3.86491 0.957031 3.49121 1.12109C3.12207 1.2806 2.7985 1.49935 2.52051 1.77734C2.24707 2.05078 2.02832 2.37435 1.86426 2.74805C1.70475 3.11719 1.625 3.51367 1.625 3.9375ZM6.4375 4.375C6.31901 4.375 6.21647 4.33171 6.12988 4.24512C6.04329 4.15853 6 4.05599 6 3.9375C6 3.75521 5.96582 3.58431 5.89746 3.4248C5.8291 3.2653 5.73568 3.1263 5.61719 3.00781C5.4987 2.88932 5.3597 2.7959 5.2002 2.72754C5.04069 2.65918 4.86979 2.625 4.6875 2.625C4.56901 2.625 4.46647 2.58171 4.37988 2.49512C4.29329 2.40853 4.25 2.30599 4.25 2.1875C4.25 2.06901 4.29329 1.96647 4.37988 1.87988C4.46647 1.79329 4.56901 1.75 4.6875 1.75C4.98828 1.75 5.27083 1.80697 5.53516 1.9209C5.80404 2.03483 6.03646 2.19206 6.23242 2.39258C6.43294 2.58854 6.59017 2.82096 6.7041 3.08984C6.81803 3.35417 6.875 3.63672 6.875 3.9375C6.875 4.05599 6.83171 4.15853 6.74512 4.24512C6.65853 4.33171 6.55599 4.375 6.4375 4.375Z"
            fill="black"
          />
        </svg>
      `;case te.File:return t.dy`
        <svg width="20" height="26" viewBox="0 0 20 26" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            opacity="0.64"
            d="M19.613 6.993L13.018 0.421C12.7473 0.15221 12.3815 0.000947397 12 0H1.4C0.628 0 0 0.615 0 1.372V24.642C0 25.391 0.622 26 1.386 26H18.6C19.372 26 20 25.385 20 24.628V7.923C20 7.577 19.86 7.237 19.613 6.993Z"
            fill="#605E5C"
          />
          <path
            d="M19 24.628C19 24.83 18.816 25 18.6 25H1.386C1.173 25 1 24.84 1 24.642V1.372C1 1.17 1.184 1 1.4 1H12V6.6C12 7.372 12.628 8 13.4 8H19V24.628Z"
            fill="white"
          />
          <path d="M18.204 6.99994L13 1.81494V6.59994C13 6.81994 13.18 6.99994 13.4 6.99994H18.204Z" fill="white" />
        </svg>
      `;case te.Files:return t.dy`
        <svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M17 8C17.1354 8 17.263 8.02604 17.3828 8.07812C17.5078 8.13021 17.6146 8.20312 17.7031 8.29688C17.7969 8.38542 17.8698 8.48958 17.9219 8.60938C17.974 8.72917 18 8.85677 18 8.99219C18 9.14844 17.9635 9.29948 17.8906 9.44531L14.6172 16H2V5C2 4.85938 2.02604 4.72917 2.07812 4.60938C2.13021 4.48958 2.20052 4.38542 2.28906 4.29688C2.38281 4.20312 2.48958 4.13021 2.60938 4.07812C2.72917 4.02604 2.85938 4 3 4H5.75C5.98438 4 6.1849 4.02604 6.35156 4.07812C6.52344 4.125 6.67448 4.1849 6.80469 4.25781C6.9401 4.33073 7.0599 4.41146 7.16406 4.5C7.26823 4.58854 7.3724 4.66927 7.47656 4.74219C7.58594 4.8151 7.70052 4.8776 7.82031 4.92969C7.94531 4.97656 8.08854 5 8.25 5H14C14.1406 5 14.2708 5.02604 14.3906 5.07812C14.5104 5.13021 14.6146 5.20312 14.7031 5.29688C14.7969 5.38542 14.8698 5.48958 14.9219 5.60938C14.974 5.72917 15 5.85938 15 6V8H17ZM3 13.3828L5.41406 8.55469C5.5026 8.38281 5.625 8.2474 5.78125 8.14844C5.94271 8.04948 6.11979 8 6.3125 8H14V6H8.25C8.01562 6 7.8125 5.97656 7.64062 5.92969C7.47396 5.8776 7.32292 5.8151 7.1875 5.74219C7.05729 5.66927 6.9401 5.58854 6.83594 5.5C6.73177 5.41146 6.625 5.33073 6.51562 5.25781C6.41146 5.1849 6.29688 5.125 6.17188 5.07812C6.05208 5.02604 5.91146 5 5.75 5H3V13.3828ZM17 9H6.3125L3.3125 15H14L17 9Z"
          />
        </svg>
      `;case te.Back:return t.dy`
        <svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M16 8.5H1.95312L8.10156 14.6484L7.39844 15.3516L0.046875 8L7.39844 0.648438L8.10156 1.35156L1.95312 7.5H16V8.5Z"
          />
        </svg>
      `}}function ne(){return void 0!==window.getWindowSegments}!function(e){e[e.image=2]="image",e[e.oneline=3]="oneline",e[e.twolines=4]="twolines",e[e.threelines=5]="threelines"}(ee||(ee={})),function(e){e[e.ArrowRight=0]="ArrowRight",e[e.ArrowDown=1]="ArrowDown",e[e.TeamSeparator=2]="TeamSeparator",e[e.Search=3]="Search",e[e.SkypeArrow=4]="SkypeArrow",e[e.SmallEmail=5]="SmallEmail",e[e.SmallChat=6]="SmallChat",e[e.ExpandDown=7]="ExpandDown",e[e.Overview=8]="Overview",e[e.Send=9]="Send",e[e.Contact=10]="Contact",e[e.Copy=11]="Copy",e[e.CellPhone=12]="CellPhone",e[e.Chat=13]="Chat",e[e.Department=14]="Department",e[e.Email=15]="Email",e[e.OfficeLocation=16]="OfficeLocation",e[e.Person=17]="Person",e[e.Messages=18]="Messages",e[e.Organization=19]="Organization",e[e.ExpandRight=20]="ExpandRight",e[e.Profile=21]="Profile",e[e.Birthday=22]="Birthday",e[e.File=23]="File",e[e.Files=24]="Files",e[e.Back=25]="Back"}(te||(te={}));const ie=[t.iv`
.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.root .scout-top{position:fixed;top:0;left:0}.root .scout-bottom{position:fixed;bottom:0;right:0}.root .flyout{display:none;position:fixed;z-index:9999999;opacity:0;box-shadow:var(--box-shadow,0 3.2px 7.2px 0 rgba(0,0,0,.132))}.root.visible .flyout{display:inline-block;animation-name:fadeIn;animation-duration:.3s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;transition:top .3s ease,bottom .3s ease,left .3s ease}@keyframes fadeIn{from{opacity:0;margin-top:-10px;margin-bottom:-10px}to{opacity:1;margin-top:0;margin-bottom:0}}
`];var se=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},ae=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let ce=class extends e.MgtBaseComponent{constructor(){super(),this._edgePadding=24,this._renderedOnce=!1,this.avoidHidingAnchor=!0,this.handleWindowEvent=this.handleWindowEvent.bind(this),this.handleResize=this.handleResize.bind(this),this.handleKeyUp=this.handleKeyUp.bind(this),this.addEventListener("expanded",(()=>{window.requestAnimationFrame((()=>{this.updateFlyout()}))}))}static get styles(){return ie}get isOpen(){return this._isOpen}set isOpen(e){const t=this._isOpen;t!==e&&(this._isOpen=e,window.requestAnimationFrame((()=>{this.setupWindowEvents(this.isOpen);const e=this._flyout;!this.isOpen&&e&&(e.style.width=null,e.style.setProperty("--mgt-flyout-set-width",null),e.style.setProperty("--mgt-flyout-set-height",null),e.style.maxHeight=null,e.style.top=null,e.style.left=null,e.style.bottom=null)})),this.requestUpdate("isOpen",t),this.dispatchEvent(new Event(e?"opened":"closed")))}get _flyout(){return this.renderRoot.querySelector(".flyout")}get _anchor(){return this.renderRoot.querySelector(".anchor")}get _topScout(){return this.renderRoot.querySelector(".scout-top")}get _bottomScout(){return this.renderRoot.querySelector(".scout-bottom")}open(){this.isOpen=!0}close(){this.isOpen=!1}disconnectedCallback(){this.setupWindowEvents(!1),super.disconnectedCallback()}updated(e){super.updated(e),window.requestAnimationFrame((()=>{this.updateFlyout()}))}render(){const e={dir:this.direction,root:!0,visible:this.isOpen},o=this.renderAnchor();let r=null;return(this.isOpen||this._renderedOnce)&&(this._renderedOnce=!0,r=t.dy`
        <div class="flyout" @wheel=${this.handleFlyoutWheel}>
          ${this.renderFlyout()}
        </div>
      `),t.dy`
      <div class=${g(e)}>
        <div class="anchor">
          ${o}
        </div>
        <div class="scout-top"></div>
        <div class="scout-bottom"></div>
        ${r}
      </div>
    `}renderAnchor(){return t.dy`
      <slot></slot>
    `}renderFlyout(){return t.dy`
      <slot name="flyout"></slot>
    `}updateFlyout(){if(!this.isOpen)return;const e=this._anchor,t=this._flyout;if(t&&e){const o=window.innerWidth&&document.documentElement.clientWidth?Math.min(window.innerWidth,document.documentElement.clientWidth):window.innerWidth||document.documentElement.clientWidth,r=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight;let n,i,s,a=0,c=0;const l=t.getBoundingClientRect(),d=e.getBoundingClientRect(),u=this._topScout.getBoundingClientRect(),p=this._bottomScout.getBoundingClientRect(),h={height:r,left:0,top:0,width:o};if(ne()){const e=(ne()?window:null).getWindowSegments();let t;const o=d.left+d.width/2,r=d.top+d.height/2;for(const n of e)if(o>=n.left&&r>=n.top){t=n;break}t&&(h.left=t.left,h.top=t.top,h.width=t.width,h.height=t.height)}l.width+2*this._edgePadding>h.width?l.width>h.width?(s=h.width,a=0):a=(h.width-l.width)/2:a=d.left+l.width+this._edgePadding>h.width?d.left-(d.left+l.width+this._edgePadding-h.width):d.left<this._edgePadding?this._edgePadding:d.left;const f=h.height-(d.top+d.height),g=d.top;this.avoidHidingAnchor?f<=l.height?g<l.height?g>f?(n=h.height-d.top,i=g):(c=d.bottom,i=f):(n=h.height-d.top,i=g):(c=d.bottom,i=f):l.height+2*this._edgePadding>h.height?l.height>=h.height?(i=h.height,c=0):c=(h.height-l.height)/2:c=d.top+d.height+l.height+this._edgePadding>h.height?h.height-l.height-this._edgePadding:Math.max(d.top+d.height,this._edgePadding),0===u.top&&0===u.left||(a-=u.left,void 0!==n?n+=p.top-r:c-=u.top),"rtl"===this.direction?a>100&&this.offsetLeft>100&&(t.style.left=h.width-a+l.left-l.width-30+"px"):t.style.left=`${a+h.left}px`,void 0!==n?(t.style.top="unset",t.style.bottom=`${n}px`):(t.style.bottom="unset",t.style.top=`${c+h.top}px`),s&&(t.style.width=`${s}px`,t.style.setProperty("--mgt-flyout-set-width",`${s}px`),window.requestAnimationFrame((()=>this.updateFlyout()))),i?(t.style.maxHeight=`${i}px`,t.style.setProperty("--mgt-flyout-set-height",`${i}px`)):(t.style.maxHeight=null,t.style.setProperty("--mgt-flyout-set-height","unset"))}}setupWindowEvents(e){e&&this.isLightDismiss?(window.addEventListener("wheel",this.handleWindowEvent),window.addEventListener("pointerdown",this.handleWindowEvent),window.addEventListener("resize",this.handleResize),window.addEventListener("keyup",this.handleKeyUp)):(window.removeEventListener("wheel",this.handleWindowEvent),window.removeEventListener("pointerdown",this.handleWindowEvent),window.removeEventListener("resize",this.handleResize),window.removeEventListener("keyup",this.handleKeyUp))}handleWindowEvent(e){const t=this._flyout;if(t)if(e.composedPath){const o=e.composedPath();if(o.includes(t)||"pointerdown"===e.type&&o.includes(this))return}else{let o=e.target;for(;o;)if(o=o.parentElement,o===t||"pointerdown"===e.type&&o===this)return}this.close()}handleResize(e){this.close()}handleKeyUp(e){"Escape"===e.key&&this.close()}handleFlyoutWheel(e){e.preventDefault()}};var le;se([(0,t.Cb)({attribute:"light-dismiss",type:Boolean}),ae("design:type",Boolean)],ce.prototype,"isLightDismiss",void 0),se([(0,t.Cb)({attribute:null,type:Boolean}),ae("design:type",Boolean)],ce.prototype,"avoidHidingAnchor",void 0),se([(0,t.Cb)({attribute:"isOpen",type:Boolean}),ae("design:type",Boolean),ae("design:paramtypes",[Boolean])],ce.prototype,"isOpen",null),ce=se([(0,t.Mo)("mgt-flyout"),ae("design:paramtypes",[])],ce),function(e){e[e.none=0]="none",e[e.hover=1]="hover",e[e.click=2]="click"}(le||(le={}));const de=[t.iv`
@charset "UTF-8";:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host([hidden]){display:none}:host{display:inline-block;font-family:var(--font-family,var(--default-font-family));vertical-align:top}:host .root{display:block}:host svg,mgt-person svg{width:var(--avatar-size-s,var(--avatar-size,24px));height:var(--avatar-size-s,var(--avatar-size,24px))}:host .person-root,mgt-person .person-root{position:relative;display:flex;align-items:center;color:var(--color,var(--color-sub1,#323130))}:host .person-root .user-avatar,mgt-person .person-root .user-avatar{position:relative;width:var(--avatar-size,var(--avatar-size-s,48px));height:var(--avatar-size,var(--avatar-size-s,48px));display:flex;justify-content:center;align-items:center;flex-shrink:0;cursor:var(--avatar-cursor,default)}:host .person-root .user-avatar .user-presence,mgt-person .person-root .user-avatar .user-presence{margin:0;position:absolute;left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .72 - 4px);top:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .72 - 4px);width:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .28);height:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .28);border:2px solid var(--presence-background-color,var(--background-color,#fff));border-radius:50%}:host .person-root .user-avatar .user-presence .presence-oof-offline-wrapper,mgt-person .person-root .user-avatar .user-presence .presence-oof-offline-wrapper{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#b4009e}:host .person-root .user-avatar .user-presence .presence-oof-offline-wrapper .presence-oof-offline svg,mgt-person .person-root .user-avatar .user-presence .presence-oof-offline-wrapper .presence-oof-offline svg{color:#b4009e;width:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .14);margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-basic,mgt-person .person-root .user-avatar .user-presence .presence-basic{width:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .28 - 4px);height:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .28 - 4px);border-style:solid;border-width:2px;border-radius:50%;margin:0;font-size:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .14);vertical-align:top;display:flex;align-items:center}:host .person-root .user-avatar .user-presence .presence-basic.presence-offline,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-offline{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#8a8886}:host .person-root .user-avatar .user-presence .presence-basic.presence-available,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-available{background-color:#6bb700;border-color:#6bb700}:host .person-root .user-avatar .user-presence .presence-basic.presence-oof-available,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-oof-available{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#6bb700}:host .person-root .user-avatar .user-presence .presence-basic.presence-away,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-away{background-color:#fa4;border-color:#fa4}:host .person-root .user-avatar .user-presence .presence-basic.presence-dnd,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-dnd{background-color:#c50f1f;border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-basic.presence-oof-dnd,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-oof-dnd{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-basic.presence-busy,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-busy{background-color:#c50f1f;border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-basic.presence-oof-busy,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-oof-busy{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-offline::before,mgt-person .person-root .user-avatar .user-presence .presence-offline::before{content:"";color:#8a8886;font-weight:700;margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-available::before,mgt-person .person-root .user-avatar .user-presence .presence-available::before{content:"";color:var(--presence-icon-color,var(--background-color,#fff));margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-oof-available::before,mgt-person .person-root .user-avatar .user-presence .presence-oof-available::before{content:"";color:#6bb700;margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-away::before,mgt-person .person-root .user-avatar .user-presence .presence-away::before{content:"";color:var(--presence-icon-color,var(--background-color,#fff));margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-dnd::before,mgt-person .person-root .user-avatar .user-presence .presence-dnd::before{content:"";color:var(--presence-icon-color,var(--background-color,#fff));margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-oof-dnd::before,mgt-person .person-root .user-avatar .user-presence .presence-oof-dnd::before{content:"";color:#c50f1f;margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar.initials,mgt-person .person-root .user-avatar.initials{color:var(--initials-color,#fff);border-radius:var(--avatar-border-radius,50%);font-weight:400}:host .person-root .user-avatar.initials .contact-icon,:host .person-root .user-avatar.initials .initials-text,mgt-person .person-root .user-avatar.initials .contact-icon,mgt-person .person-root .user-avatar.initials .initials-text{cursor:var(--avatar-cursor,default);margin-top:-1px;font-size:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .4)}:host .person-root .user-avatar.initials .contact-icon,mgt-person .person-root .user-avatar.initials .contact-icon{display:inline}:host .person-root .user-avatar.small,mgt-person .person-root .user-avatar.small{width:var(--avatar-size-s,var(--avatar-size,24px));height:var(--avatar-size-s,var(--avatar-size,24px))}:host .person-root .user-avatar.small .contact-icon,:host .person-root .user-avatar.small .initials-text,mgt-person .person-root .user-avatar.small .contact-icon,mgt-person .person-root .user-avatar.small .initials-text{font-size:calc(var(--avatar-size-s,var(--avatar-size,24px)) * .4)}:host .person-root .user-avatar.small .user-presence,mgt-person .person-root .user-avatar.small .user-presence{left:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);top:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);width:8px;height:8px}:host .person-root .user-avatar.small .user-presence .presence-basic,mgt-person .person-root .user-avatar.small .user-presence .presence-basic{width:4px;height:4px;border-radius:4px;padding:0}:host .person-root .user-avatar.small .user-presence .presence-basic .presence-oof-offline svg,mgt-person .person-root .user-avatar.small .user-presence .presence-basic .presence-oof-offline svg{height:0;width:0}:host .person-root .user-avatar.small .user-presence .presence-available::before,:host .person-root .user-avatar.small .user-presence .presence-away::before,:host .person-root .user-avatar.small .user-presence .presence-dnd::before,:host .person-root .user-avatar.small .user-presence .presence-offline::before,:host .person-root .user-avatar.small .user-presence .presence-oof-available::before,:host .person-root .user-avatar.small .user-presence .presence-oof-away::before,:host .person-root .user-avatar.small .user-presence .presence-oof-dnd::before,:host .person-root .user-avatar.small .user-presence .presence-oof-offline::before,mgt-person .person-root .user-avatar.small .user-presence .presence-available::before,mgt-person .person-root .user-avatar.small .user-presence .presence-away::before,mgt-person .person-root .user-avatar.small .user-presence .presence-dnd::before,mgt-person .person-root .user-avatar.small .user-presence .presence-offline::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-available::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-away::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-dnd::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-offline::before{content:''}:host .person-root .user-avatar .img-wrapper,mgt-person .person-root .user-avatar .img-wrapper{height:100%;width:100%;display:flex;overflow:hidden;border:var(--avatar-border,0);border-radius:var(--avatar-border-radius,50%);position:relative}:host .person-root .user-avatar .img-wrapper img,mgt-person .person-root .user-avatar .img-wrapper img{position:absolute;display:block;top:-100%;right:-100%;bottom:-100%;left:-100%;margin:auto;height:100%;width:auto}:host .person-root .user-avatar.pinkRed10,mgt-person .person-root .user-avatar.pinkRed10{background-color:var(--initials-background-color,#750b1c)}:host .person-root .user-avatar.red20,mgt-person .person-root .user-avatar.red20{background-color:var(--initials-background-color,#a4262c)}:host .person-root .user-avatar.red10,mgt-person .person-root .user-avatar.red10{background-color:var(--initials-background-color,#d13438)}:host .person-root .user-avatar.orange20,mgt-person .person-root .user-avatar.orange20{background-color:var(--initials-background-color,#ca5010)}:host .person-root .user-avatar.orangeYellow20,mgt-person .person-root .user-avatar.orangeYellow20{background-color:var(--initials-background-color,#986f0b)}:host .person-root .user-avatar.green10,mgt-person .person-root .user-avatar.green10{background-color:var(--initials-background-color,#498205)}:host .person-root .user-avatar.green20,mgt-person .person-root .user-avatar.green20{background-color:var(--initials-background-color,#0b6a0b)}:host .person-root .user-avatar.cyan20,mgt-person .person-root .user-avatar.cyan20{background-color:var(--initials-background-color,#038387)}:host .person-root .user-avatar.cyan30,mgt-person .person-root .user-avatar.cyan30{background-color:var(--initials-background-color,#005b70)}:host .person-root .user-avatar.cyanBlue10,mgt-person .person-root .user-avatar.cyanBlue10{background-color:var(--initials-background-color,#0078d4)}:host .person-root .user-avatar.cyanBlue20,mgt-person .person-root .user-avatar.cyanBlue20{background-color:var(--initials-background-color,#004e8c)}:host .person-root .user-avatar.blue10,mgt-person .person-root .user-avatar.blue10{background-color:var(--initials-background-color,#4f6bed)}:host .person-root .user-avatar.blueMagenta30,mgt-person .person-root .user-avatar.blueMagenta30{background-color:var(--initials-background-color,#5c2e91)}:host .person-root .user-avatar.blueMagenta20,mgt-person .person-root .user-avatar.blueMagenta20{background-color:var(--initials-background-color,#8764b8)}:host .person-root .user-avatar.magenta20,mgt-person .person-root .user-avatar.magenta20{background-color:var(--initials-background-color,#881798)}:host .person-root .user-avatar.magenta10,mgt-person .person-root .user-avatar.magenta10{background-color:var(--initials-background-color,#c239b3)}:host .person-root .user-avatar.magentaPink10,mgt-person .person-root .user-avatar.magentaPink10{background-color:var(--initials-background-color,#e3008c)}:host .person-root .user-avatar.orange30,mgt-person .person-root .user-avatar.orange30{background-color:var(--initials-background-color,#8e562e)}:host .person-root .user-avatar.gray30,mgt-person .person-root .user-avatar.gray30{background-color:var(--initials-background-color,#7a7574)}:host .person-root .user-avatar.gray20,mgt-person .person-root .user-avatar.gray20{background-color:var(--initials-background-color,#69797e)}:host .person-root .details,mgt-person .person-root .details{flex-shrink:1;display:flex;flex-direction:column;overflow:hidden;line-height:1.4;margin:var(--details-spacing,0 0 0 12px)}:host .person-root .details.small,mgt-person .person-root .details.small{margin:var(--details-spacing,0 0 0 6px)}:host .person-root .details>div,mgt-person .person-root .details>div{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}:host .person-root .details .line1,mgt-person .person-root .details .line1{font-size:var(--font-size,14px);font-weight:var(--font-weight,600);text-transform:var(text-transform,none)}:host .person-root .details .line2,mgt-person .person-root .details .line2{color:var(--line2-color,var(--color-sub1,#323130));font-size:var(--line2-font-size,var(--email-font-size,12px));font-weight:var(--line2-font-weight,400);text-transform:var(--line2-text-transform,var(text-transform,none))}:host .person-root .details .line3,mgt-person .person-root .details .line3{color:var(--line3-color,var(--color-sub2,#797775));font-size:var(--line3-font-size,var(--email-font-size,12px));font-weight:var(--line3-font-weight,400);text-transform:var(--line3-text-transform,var(text-transform,none))}:host .avatar-icon,mgt-person .avatar-icon{display:flex;align-items:center;justify-content:center;line-height:1;margin:0;font-size:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .5);width:var(--avatar-size,var(--avatar-size-s,48px));height:var(--avatar-size,var(--avatar-size-s,48px));overflow:hidden;border-radius:var(--avatar-border-radius,50%)}:host .avatar-icon.small,mgt-person .avatar-icon.small{font-size:var(--avatar-size-s,var(--avatar-size,24px));width:var(--avatar-size-s,var(--avatar-size,24px));height:var(--avatar-size-s,var(--avatar-size,24px))}[dir=rtl] .root{direction:rtl}[dir=rtl] svg{direction:rtl}[dir=rtl] .person-root .user-avatar{position:relative}[dir=rtl] .person-root .details{margin:var(--details-spacing,0 12px 0 0)}[dir=rtl] .person-root .details.small{margin:var(--details-spacing,0 6px 0 0)}[dir=rtl] .person-root .user-presence .presence-oof-offline svg{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-offline::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-available::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-oof-available::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-away::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-dnd::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-oof-dnd::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root.small .contact-icon,[dir=rtl] .person-root.small .initials-text{font-size:calc(var(--avatar-size-s,var(--avatar-size,24px)) * .4)}[dir=rtl] .person-root.small .user-presence{left:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);top:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);width:8px;height:8px}[dir=rtl] .person-root.small .user-presence .presence-basic{width:4px;height:4px;border-radius:4px;padding:0}[dir=rtl] .person-root.small .user-presence .presence-basic .presence-oof-offline svg{height:0;width:0}
`];var ue,pe,he,fe=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},ge=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};!function(e){e[e.avatar=2]="avatar",e[e.oneline=3]="oneline",e[e.twolines=4]="twolines",e[e.threelines=5]="threelines"}(pe||(pe={})),function(e){e.photo="photo",e.initials="initials"}(he||(he={}));const me=["businessPhones","displayName","givenName","jobTitle","mail","mobilePhone","officeLocation","preferredLanguage","surname","userPrincipalName","id"];let ve=ue=class extends e.MgtTemplatedComponent{constructor(){super(),this.personCardInteraction=le.none,this.line1Property="displayName",this.line2Property="email",this.line3Property="jobTitle",this.view=ee.image,this.avatarSize="auto",this._isInvalidImageSrc=!1,this._avatarType="photo"}static get styles(){return de}get personQuery(){return this._personQuery}set personQuery(e){e!==this._personQuery&&(this._personQuery=e,this.personDetails=null,this.requestStateUpdate())}get fallbackDetails(){return this._fallbackDetails}set fallbackDetails(e){e!==this._fallbackDetails&&(this._fallbackDetails=e,this.personDetails||(e&&e.displayName?this._personAvatarBg=this.getColorFromName(e.displayName):this._personAvatarBg="gray20",this.requestStateUpdate()))}get userId(){return this._userId}set userId(e){e!==this._userId&&(this._userId=e,this.personDetails=null,this.requestStateUpdate())}get personDetails(){return this._personDetails}set personDetails(e){this._personDetails!==e&&(this._personDetails=e,e&&e.displayName?this._personAvatarBg=this.getColorFromName(e.displayName):this._personAvatarBg="gray20",this._fetchedImage=null,this._fetchedPresence=null,this.requestStateUpdate(),this.requestUpdate("personDetails"))}get personImage(){return this._personImage||this._fetchedImage}set personImage(e){if(e===this._personImage)return;this._isInvalidImageSrc=!e;const t=this._personImage;this._personImage=e,this.requestUpdate("personImage",t)}get avatarType(){return this._avatarType}set avatarType(e){e!==this._avatarType&&(this._avatarType=e,this.requestStateUpdate())}get personPresence(){return this._personPresence||this._fetchedPresence}set personPresence(e){if(e===this._personPresence)return;const t=this._personPresence;this._personPresence=e,this.requestUpdate("personPresence",t)}static get requiredScopes(){const e=["user.readbasic.all","user.read","people.read","presence.read.all","presence.read"];return ue.config.useContactApis&&e.push("contacts.read"),e}get flyout(){return this.renderRoot.querySelector(".flyout")}render(){if(this.isLoadingState&&!this.personDetails&&!this.fallbackDetails)return this.renderLoading();const e=this.personDetails||this.fallbackDetails,o=this.getImage(),r=this.personPresence||this._fetchedPresence;if(!e&&!o)return this.renderNoData();let n=this.renderTemplate("default",{person:e,personImage:o,personPresence:r});if(!n){const i=this.renderDetails(e),s=this.renderAvatar(e,o,r);n=t.dy`
        <div class="person-root">
          ${s} ${i}
        </div>
      `}return this.personCardInteraction!==le.none&&(n=this.renderFlyout(n,e,o,r)),t.dy`
      <div
        class="root"
        dir=${this.direction}
        @click=${this.handleMouseClick}
        @mouseenter=${this.handleMouseEnter}
        @mouseleave=${this.handleMouseLeave}
      >
        ${n}
      </div>
    `}renderLoading(){return this.renderTemplate("loading",null)||t.dy``}clearState(){this._personImage="",this._personDetails=null,this._fetchedImage=null,this._fetchedPresence=null}renderNoData(){const e=this.renderTemplate("no-data",null);if(e)return e;const o={"avatar-icon":!0,"ms-Icon":!0,"ms-Icon--Contact":!0,small:!this.isLargeAvatar()};return t.dy`
      <i class=${g(o)}></i>
    `}renderImage(e,o){const r=e&&this.personCardInteraction===le.none&&(e.displayName||R(e))||"";if(o&&!this._isInvalidImageSrc&&"photo"===this._avatarType)return t.dy`
        <div class="img-wrapper">
          <img alt=${r} src=${o} @error=${()=>this._isInvalidImageSrc=!0} />
        </div>
      `;if(e){const o=this.getInitials(e);return t.dy`
        <span class="initials-text" aria-label="${o}">
          ${o&&o.length?t.dy`
                ${o}
              `:t.dy`
                <i class="ms-Icon ms-Icon--Contact contact-icon"></i>
              `}
        </span>
      `}}renderPresence(e){if(!this.showPresence||!e)return t.dy``;let o=null;switch(e.availability){case"DoNotDisturb":switch(e.activity){case"OutOfOffice":o="presence-oof-dnd";break;default:o="presence-dnd"}break;case"BeRightBack":o="presence-away";break;case"Available":switch(e.activity){case"Available":o="presence-available";break;case"OutOfOffice":o="presence-oof-available"}break;case"Busy":switch(e.activity){case"OutOfOffice":o="presence-oof-busy";break;default:o="presence-busy"}break;case"Away":switch(e.activity){case"Away":o="presence-away";break;case"OutOfOffice":o="presence-oof-offline"}break;case"Offline":switch(e.activity){case"Offline":o="presence-offline";break;case"OutOfOffice":o="presence-oof-offline";break;case"OffWork":o="presence-offline"}break;default:o="presence-offline"}const r={"ms-Icon":!0,"presence-basic":!0};r[o]=!0;let n=null;return n="presence-oof-offline"===o?t.dy`
        <div class="ms-Icon presence-basic presence-oof-offline-wrapper">
          <i class="presence-oof-offline">
            ${re(te.SkypeArrow,"#666666")}
          </i>
        </div>
      `:t.dy`
        <i class=${g(r)} aria-hidden="true"></i>
      `,t.dy`
      <div class="user-presence" title=${e.activity} aria-label=${e.activity}>
        ${n}
      </div>
    `}renderAvatar(e,o,r){const n=e&&this.personCardInteraction===le.none&&(e.displayName||R(e))||"",i={initials:!o||this._isInvalidImageSrc||"initials"===this._avatarType,small:!this.isLargeAvatar(),"user-avatar":!0};o&&!this._isInvalidImageSrc&&"initials"!==this._avatarType||!e||(i[this._personAvatarBg]=!0);const s=this.renderImage(e,o),a=this.renderPresence(r);return t.dy`
      <div class=${g(i)} title=${n} aria-label=${n}>
        ${s} ${a}
      </div>
    `}handleLine1Clicked(){this.fireCustomEvent("line1clicked",this.personDetails)}handleLine2Clicked(){this.fireCustomEvent("line2clicked",this.personDetails)}handleLine3Clicked(){this.fireCustomEvent("line3clicked",this.personDetails)}renderDetails(e){if(!e||this.view===ee.image||this.view===pe.avatar)return t.dy``;const o=[];if(this.view>ee.image)if(this.hasTemplate("line1")){const r=this.renderTemplate("line1",{person:e});o.push(t.dy`
          <div class="line1" @click=${()=>this.handleLine1Clicked()}>${r}</div>
        `)}else{const r=this.getTextFromProperty(e,this.line1Property);r&&o.push(t.dy`
            <div class="line1" @click=${()=>this.handleLine1Clicked()} aria-label="${r}">${r}</div>
          `)}if(this.view>ee.oneline)if(this.hasTemplate("line2")){const r=this.renderTemplate("line2",{person:e});o.push(t.dy`
          <div class="line2" @click=${()=>this.handleLine2Clicked()}>${r}</div>
        `)}else{const r=this.getTextFromProperty(e,this.line2Property);r&&o.push(t.dy`
            <div class="line2" @click=${()=>this.handleLine2Clicked()} aria-label="${r}">${r}</div>
          `)}if(this.view>ee.twolines)if(this.hasTemplate("line3")){const r=this.renderTemplate("line3",{person:e});o.push(t.dy`
          <div class="line3" @click=${()=>this.handleLine3Clicked()}>${r}</div>
        `)}else{const r=this.getTextFromProperty(e,this.line3Property);r&&o.push(t.dy`
            <div class="line3" @click=${()=>this.handleLine3Clicked()} aria-label="${r}">${r}</div>
          `)}const r=g({details:!0,small:!this.isLargeAvatar()});return t.dy`
      <div class="${r}">
        ${o}
      </div>
    `}renderFlyout(e,o,r,n){const i=this._personCardShouldRender?t.dy`
          <div slot="flyout">
            ${this.renderFlyoutContent(o,r,n)}
          </div>
        `:t.dy``;return t.dy`
      <mgt-flyout light-dismiss class="flyout" .avoidHidingAnchor=${!1}>
        ${e} ${i}
      </mgt-flyout>
    `}renderFlyoutContent(e,o,r){return this.renderTemplate("person-card",{person:e,personImage:o})||t.dy`
        <mgt-person-card
          .personDetails=${e}
          .personImage=${o}
          .personPresence=${r}
          .showPresence=${this.showPresence}
        ></mgt-person-card>
      `}loadState(){return t=this,o=void 0,n=function*(){const t=e.Providers.globalProvider;if(!t||t.state===e.ProviderState.Loading)return;if(t.state===e.ProviderState.SignedOut)return void(this.personDetails=null);const o=t.graph.forComponent(this);let r=[...me,this.line1Property,this.line2Property,this.line3Property];if(r=r.filter((e=>"email"!==e)),this.personDetails){if(!this.personDetails.personImage&&this.fetchImage&&"photo"===this._avatarType&&!this.personImage&&!this._fetchedImage){const e=yield W(o,this.personDetails,ue.config.useContactApis);e&&(this.personDetails.personImage=e,this._fetchedImage=e)}}else if(this.userId||"me"===this.personQuery){let e;e="photo"===this._avatarType?yield oe(o,this.userId,r):"me"===this.personQuery?yield M(o,r):yield F(o,this.userId,r),this.personDetails=e,this._fetchedImage=this.getImage()}else if(this.personQuery){let e=yield A(o,this.personQuery,1);if(e&&0!==e.length||(e=(yield q(o,this.personQuery,1))||[]),e&&e.length&&(this.personDetails=e[0],"photo"===this._avatarType)){const t=yield W(o,e[0],ue.config.useContactApis);t&&(this.personDetails.personImage=t,this._fetchedImage=t)}}const n={activity:"Offline",availability:"Offline",id:null};if(this.showPresence&&!this.personPresence&&!this._fetchedPresence)try{if(this.personDetails&&this.personDetails.id){const e="me"!==this.personQuery?this.personDetails.id:null;this._fetchedPresence=yield X(o,e)}else this._fetchedPresence=n}catch(e){this._fetchedPresence=n}},new((r=void 0)||(r=Promise))((function(e,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(t){var o;t.done?e(t.value):(o=t.value,o instanceof r?o:new r((function(e){e(o)}))).then(s,a)}c((n=n.apply(t,o||[])).next())}));var t,o,r,n}getInitials(e){if(e||(e=this.personDetails),e.initials)return e.initials;let t="";if(e.givenName&&(t+=e.givenName[0].toUpperCase()),e.surname&&(t+=e.surname[0].toUpperCase()),!t&&e.displayName){const o=e.displayName.split(/\s+/);for(let e=0;e<2&&e<o.length;e++)o[e][0]&&this.isLetter(o[e][0])&&(t+=o[e][0].toUpperCase())}return t}getColorFromName(e){const t=e.split("").map((e=>e.charCodeAt(0))).join(""),o=["pinkRed10","red20","red10","orange20","orangeYellow20","green10","green20","cyan20","cyan30","cyanBlue10","cyanBlue20","blue10","blueMagenta30","blueMagenta20","magenta20","magenta10","magentaPink10","orange30","gray30","gray20"];return o[parseInt(t,10)%o.length]}getImage(){if(this.personImage)return this.personImage;if(this._fetchedImage)return this._fetchedImage;const e=this.personDetails;return e&&e.personImage?e.personImage:null}isLetter(e){try{return e.match(new RegExp("\\p{L}","u"))}catch(t){return e.toLowerCase()!==e.toUpperCase()}}getTextFromProperty(e,t){if(!t||0===t.length)return null;const o=t.trim().split(",");let r,n=0;for(;!r&&n<o.length;){const t=o[n].trim();switch(t){case"mail":case"email":r=R(e);break;default:r=e[t]}n++}return r}isLargeAvatar(){return"large"===this.avatarSize||"auto"===this.avatarSize&&this.view>ee.oneline}handleMouseClick(e){this.personCardInteraction===le.click&&this.showPersonCard()}handleMouseEnter(e){clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this.personCardInteraction===le.hover&&(this._mouseEnterTimeout=setTimeout(this.showPersonCard.bind(this),500))}handleMouseLeave(e){clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this._mouseLeaveTimeout=setTimeout(this.hidePersonCard.bind(this),500)}hidePersonCard(){const e=this.flyout;e&&e.close();const t=this.querySelector("mgt-person-card")||this.renderRoot.querySelector("mgt-person-card");t&&(t.isExpanded=!1,t.clearHistory())}showPersonCard(){this._personCardShouldRender||(this._personCardShouldRender=!0);const e=this.flyout;e&&e.open()}};ve.config={useContactApis:!0},fe([(0,t.Cb)({attribute:"person-query"}),ge("design:type",String),ge("design:paramtypes",[String])],ve.prototype,"personQuery",null),fe([(0,t.Cb)({attribute:"fallback-details",type:Object}),ge("design:type",Object),ge("design:paramtypes",[Object])],ve.prototype,"fallbackDetails",null),fe([(0,t.Cb)({attribute:"user-id"}),ge("design:type",String),ge("design:paramtypes",[String])],ve.prototype,"userId",null),fe([(0,t.Cb)({attribute:"show-presence",type:Boolean}),ge("design:type",Boolean)],ve.prototype,"showPresence",void 0),fe([(0,t.Cb)({attribute:"avatar-size",type:String}),ge("design:type",String)],ve.prototype,"avatarSize",void 0),fe([(0,t.Cb)({attribute:"person-details",type:Object}),ge("design:type",Object),ge("design:paramtypes",[Object])],ve.prototype,"personDetails",null),fe([(0,t.Cb)({attribute:"person-image",type:String}),ge("design:type",String),ge("design:paramtypes",[String])],ve.prototype,"personImage",null),fe([(0,t.Cb)({attribute:"fetch-image",type:Boolean}),ge("design:type",Boolean)],ve.prototype,"fetchImage",void 0),fe([(0,t.Cb)({attribute:"avatar-type",converter:e=>"initials"===(e=e.toLowerCase())?he.initials:he.photo}),ge("design:type",String),ge("design:paramtypes",[String])],ve.prototype,"avatarType",null),fe([(0,t.Cb)({attribute:"person-presence",type:Object}),ge("design:type",Object),ge("design:paramtypes",[Object])],ve.prototype,"personPresence",null),fe([(0,t.Cb)({attribute:"person-card",converter:(e,t)=>(e=e.toLowerCase(),void 0===le[e]?le.none:le[e])}),ge("design:type",Number)],ve.prototype,"personCardInteraction",void 0),fe([(0,t.Cb)({attribute:"line1-property"}),ge("design:type",String)],ve.prototype,"line1Property",void 0),fe([(0,t.Cb)({attribute:"line2-property"}),ge("design:type",String)],ve.prototype,"line2Property",void 0),fe([(0,t.Cb)({attribute:"line3-property"}),ge("design:type",String)],ve.prototype,"line3Property",void 0),fe([(0,t.Cb)({converter:e=>e&&0!==e.length?(e=e.toLowerCase(),void 0===ee[e]?ee.image:ee[e]):ee.image}),ge("design:type",Number)],ve.prototype,"view",void 0),fe([(0,t.sz)(),ge("design:type",String)],ve.prototype,"_fetchedImage",void 0),fe([(0,t.sz)(),ge("design:type",Object)],ve.prototype,"_fetchedPresence",void 0),fe([(0,t.sz)(),ge("design:type",Boolean)],ve.prototype,"_isInvalidImageSrc",void 0),fe([(0,t.sz)(),ge("design:type",Boolean)],ve.prototype,"_personCardShouldRender",void 0),ve=ue=fe([(0,t.Mo)("mgt-person"),ge("design:paramtypes",[])],ve);const be=[t.iv`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--event-background-color:#ffffff}.mgt-dark{--event-background-color:#161514}:host .header,mgt-agenda .header{margin:var(--agenda-header-margin,40px 10px 14px 10px);font-family:var(--default-font-family);font-size:var(--agenda-header-font-size,24px);color:var(--agenda-header-color,var(--color-sub1,#323130))}:host .agenda>.group:first-child>.header,mgt-agenda .agenda>.group:first-child>.header{margin-top:0}:host .agenda-list,mgt-agenda .agenda-list{list-style-type:none;padding:0;margin:0;font-family:var(--default-font-family);font-style:normal;font-weight:400}:host .event,mgt-agenda .event{background:var(--event-background-color,#fff);border:var(--event-border,solid 2px transparent);box-shadow:var(--event-box-shadow,0 2px 8px var(--box-shadow-color,rgba(0,0,0,.092)));margin:var(--event-margin,0 10px 14px 10px);padding:var(--event-padding,0);display:flex}:host .narrow .event,mgt-agenda .narrow .event{flex-direction:column}:host .event-time-container,mgt-agenda .event-time-container{display:flex;flex-direction:column;margin:18px 38px 18px 18px;width:125px}:host .narrow .event-time-container,mgt-agenda .narrow .event-time-container{margin:14px 18px 8px 18px}:host .event-time,mgt-agenda .event-time{font-size:var(--event-time-font-size,12px);color:var(--event-time-color,var(--color,#000));font-weight:600}:host .event-duration,mgt-agenda .event-duration{color:rgba(16,16,16,.3)}:host .event-details-container,mgt-agenda .event-details-container{margin:14px 18px 14px 0}:host .narrow .event-details-container,mgt-agenda .narrow .event-details-container{margin:0 18px 14px 18px}:host .event-subject,mgt-agenda .event-subject{margin:0 18px 0 0;font-size:var(--event-subject-font-size,19px);color:var(--event-subject-color,var(--color-sub1,#323130))}:host .event-location-container,mgt-agenda .event-location-container{display:flex;margin:8px 18px 0 0}:host .event-location-icon svg,mgt-agenda .event-location-icon svg{height:12px}:host .event-location-icon svg path,mgt-agenda .event-location-icon svg path{stroke:var(--event-location-color,var(--color,#000))}:host .event-location,mgt-agenda .event-location{font-size:var(--event-location-font-size,12px);color:var(--event-location-color,var(--color,#000));margin:0 0 0 4px;line-height:17px}:host .event-attendees,mgt-agenda .event-attendees{--list-margin:8px 0 0 0;--avatar-size-s:20px}:host .event-other-container,mgt-agenda .event-other-container{margin:2px 16px 4px 16px;margin-left:auto}:host .loading-element,mgt-agenda .loading-element{background:var(--event-background-color,#fff);border-radius:1px}:host .event-time-loading,mgt-agenda .event-time-loading{width:100px;height:10px}:host .event-subject-loading,mgt-agenda .event-subject-loading{width:263px;height:16px}:host .event-location-icon-loading,mgt-agenda .event-location-icon-loading{width:14px;height:14px}:host .event-location-loading,mgt-agenda .event-location-loading{width:90px;height:10px;margin:2px 0 0 4px}:host .event-attendee-loading,mgt-agenda .event-attendee-loading{width:20px;height:20px;border-radius:10px;margin:0 2px 0 0}[dir=rtl] .event-location{margin:0 4px 0 0}[dir=rtl] .event-time-container{direction:ltr;margin:18px 18px 18px 38px}[dir=rtl] .event-details-container{margin:14px 0 14px 18px}[dir=rtl] .event-details-container .event-subject{margin:0 0 0 18px}[dir=rtl] .event-details-container .event-location-container{margin:8px 0 0 18px}
`],ye=(e,t)=>{const o=e.startNode.parentNode,r=void 0===t?e.endNode:t.startNode,n=o.insertBefore((0,p.IW)(),r);o.insertBefore((0,p.IW)(),r);const i=new p.nt(e.options);return i.insertAfterNode(n),i},ke=(e,t)=>(e.setValue(t),e.commit(),e),we=(e,t,o)=>{const r=e.startNode.parentNode,n=o?o.startNode:e.endNode,i=t.endNode.nextSibling;i!==n&&(0,p.V)(r,t.startNode,i,n)},Ce=e=>{(0,p.r4)(e.startNode.parentNode,e.startNode,e.endNode.nextSibling)},Te=(e,t,o)=>{const r=new Map;for(let n=t;n<=o;n++)r.set(e[n],n);return r},Se=new WeakMap,_e=new WeakMap,Ie=(0,p.XM)(((e,t,o)=>{let r;return void 0===o?o=t:void 0!==t&&(r=t),t=>{if(!(t instanceof p.nt))throw new Error("repeat can only be used in text bindings");const n=Se.get(t)||[],i=_e.get(t)||[],s=[],a=[],c=[];let l,d,u=0;for(const t of e)c[u]=r?r(t,u):u,a[u]=o(t,u),u++;let h=0,f=n.length-1,g=0,m=a.length-1;for(;h<=f&&g<=m;)if(null===n[h])h++;else if(null===n[f])f--;else if(i[h]===c[g])s[g]=ke(n[h],a[g]),h++,g++;else if(i[f]===c[m])s[m]=ke(n[f],a[m]),f--,m--;else if(i[h]===c[m])s[m]=ke(n[h],a[m]),we(t,n[h],s[m+1]),h++,m--;else if(i[f]===c[g])s[g]=ke(n[f],a[g]),we(t,n[f],n[h]),f--,g++;else if(void 0===l&&(l=Te(c,g,m),d=Te(i,h,f)),l.has(i[h]))if(l.has(i[f])){const e=d.get(c[g]),o=void 0!==e?n[e]:null;if(null===o){const e=ye(t,n[h]);ke(e,a[g]),s[g]=e}else s[g]=ke(o,a[g]),we(t,o,n[h]),n[e]=null;g++}else Ce(n[f]),f--;else Ce(n[h]),h++;for(;g<=m;){const e=ye(t,s[m+1]);ke(e,a[g]),s[g++]=e}for(;h<=f;){const e=n[h++];null!==e&&Ce(e)}Se.set(t,s),_e.set(t,c)}})),xe=[t.iv`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host .people-list,mgt-people .people-list{list-style-type:none;margin:var(--list-margin,8px 4px 8px 8px);padding:0;font-family:var(--default-font-family);color:var(--color,#000);font-style:normal;font-weight:400;display:flex;align-items:center}:host .people-person,mgt-people .people-person{margin:var(--avatar-margin,0 4px 0 0);display:flex}:host .overflow span,mgt-people .overflow span{vertical-align:middle}
`];var Ee=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},Ae=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Pe=class extends e.MgtTemplatedComponent{constructor(){super(),this.personCardInteraction=le.hover,this.scopes=[],this._version="v1.0",this.showMax=3}static get styles(){return xe}get groupId(){return this._groupId}set groupId(e){this._groupId!==e&&(this._groupId=e,this.requestStateUpdate(!0))}get userIds(){return this._userIds}set userIds(t){(0,e.arraysAreEqual)(this._userIds,t)||(this._userIds=t,this.requestStateUpdate(!0))}get peopleQueries(){return this._peopleQueries}set peopleQueries(t){(0,e.arraysAreEqual)(this._peopleQueries,t)||(this._peopleQueries=t,this.requestStateUpdate(!0))}get resource(){return this._resource}set resource(e){this._resource!==e&&(this._resource=e,this.requestStateUpdate(!0))}get version(){return this._version}set version(e){this._version!==e&&(this._version=e,this.requestStateUpdate(!0))}static get requiredScopes(){return[...new Set(["user.read.all","people.read","user.readbasic.all","presence.read.all","contacts.read",...ve.requiredScopes])]}clearState(){this.people=null}requestStateUpdate(e){return e&&(this.people=null),super.requestStateUpdate(e)}render(){return this.isLoadingState?this.renderLoading():this.people&&0!==this.people.length?this.renderTemplate("default",{people:this.people,max:this.showMax})||this.renderPeople():this.renderNoData()}renderLoading(){return this.renderTemplate("loading",null)||t.dy``}renderPeople(){const e=this.people.slice(0,this.showMax);return t.dy`
      <ul class="people-list">
        ${Ie(e,(e=>e.id?e.id:e.displayName),(e=>t.dy`
            <li class="people-person">
              ${this.renderPerson(e)}
            </li>
          `))}
        ${this.people.length>this.showMax?this.renderOverflow():null}
      </ul>
    `}renderOverflow(){const e=this.people.length-this.showMax;return this.renderTemplate("overflow",{extra:e,max:this.showMax,people:this.people})||t.dy`
        <li class="overflow"><span>+${e}<span></li>
      `}renderPerson(e){let o={activity:"Offline",availability:"Offline",id:null};return this.showPresence&&this._peoplePresence&&(o=this._peoplePresence[e.id]),this.renderTemplate("person",{person:e},e.id)||t.dy`
        <mgt-person
          .personDetails=${e}
          .fetchImage=${!0}
          .avatarSize=${"small"}
          .personCardInteraction=${this.personCardInteraction}
          .showPresence=${this.showPresence}
          .personPresence=${o}
        ></mgt-person>
      `}renderNoData(){return this.renderTemplate("no-data",null)||t.dy``}loadState(){return t=this,o=void 0,n=function*(){if(!this.people){const t=e.Providers.globalProvider;if(t&&t.state===e.ProviderState.SignedIn){const o=t.graph.forComponent(this);this.groupId?this.people=yield $(o,null,this.groupId,this.showMax,S.person):this.userIds?this.people=yield H(o,this.userIds):this.peopleQueries?this.people=yield function(t,o){return D(this,void 0,void 0,(function*(){if(!o||0===o.length)return[];const r=t.createBatch(),n=[];let i,s;U()&&(s=e.CacheService.getCache(v,v.stores.usersQuery));for(const e of o)U()&&(i=yield s.getValue(e)),U()&&i&&L()>Date.now()-i.timeCached?n.push(JSON.parse(i.results[0])):""!==e&&r.get(e,`/me/people?$search="${e}"`,["people.read"]);try{const e=yield r.executeAll();for(const t of o){const o=e.get(t);o&&o.content&&o.content.value&&o.content.value.length>0&&(n.push(o.content.value[0]),U()&&s.putValue(t,{maxResults:1,results:[JSON.stringify(o.content.value[0])]}))}return n}catch(e){try{return Promise.all(o.filter((e=>e&&""!==e)).map((e=>D(this,void 0,void 0,(function*(){const o=yield A(t,e,1);if(o&&o.length)return U()&&s.putValue(e,{maxResults:1,results:[JSON.stringify(o[0])]}),o[0]})))))}catch(e){return[]}}}))}(o,this.peopleQueries):this.resource?this.people=yield function(t,o,r,n){return I(this,void 0,void 0,(function*(){let i;const s=`${o}${r}`;if(E()){i=e.CacheService.getCache(y,y.stores.peopleQuery);const t=yield i.getValue(s);if(t&&x()>Date.now()-t.timeCached)return t.results.map((e=>JSON.parse(e)))}let a=t.api(r).version(o);n&&n.length&&(a=a.middlewareOptions((0,e.prepScopes)(...n)));let c=yield a.get();if(c&&Array.isArray(c.value)&&c["@odata.nextLink"]){let e=1,r=c;for(;r&&r["@odata.nextLink"];){e++;const n=r["@odata.nextLink"].split(o)[1];r=yield t.client.api(n).version(o).get(),r&&r.value&&r.value.length&&(r.value=c.value.concat(r.value),c=r)}}if(E()&&c){const e={results:null};Array.isArray(c.value)?e.results=c.value.map((e=>JSON.stringify(e))):e.results=[JSON.stringify(c)],i.putValue(s,e)}return c?Array.isArray(c.value)?c.value:[c]:null}))}(o,this.version,this.resource,this.scopes):this.people=yield P(o),this.showPresence?this._peoplePresence=yield function(t,o){return J(this,void 0,void 0,(function*(){if(!o||0===o.length)return{};const r={},n=[],i=["presence.read.all"];let s;Z()&&(s=e.CacheService.getCache(m,m.stores.presence));for(const e of o)if(""!==e&&e.id){const t=e.id;let o;r[t]=null,Z()&&(o=yield s.getValue(t)),Z()&&o&&Y()>Date.now()-(yield o).timeCached?r[t]=JSON.parse(o.presence):n.push(t)}try{if(n.length>0){const o=yield t.api("/communications/getPresencesByUserId").middlewareOptions((0,e.prepScopes)(...i)).post({ids:n});for(const e of o.value)r[e.id]=e,Z()&&s.putValue(e.id,{presence:JSON.stringify(e)})}return r}catch(e){try{const e=yield Promise.all(o.filter((e=>e&&e.id&&!r[e.id]&&"personType"in e&&"OrganizationUser"===e.personType.subclass)).map((e=>X(t,e.id))));for(const t of e)r[t.id]=t;return r}catch(e){return null}}}))}(o,this.people):this._peoplePresence=null}}},new((r=void 0)||(r=Promise))((function(e,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(t){var o;t.done?e(t.value):(o=t.value,o instanceof r?o:new r((function(e){e(o)}))).then(s,a)}c((n=n.apply(t,o||[])).next())}));var t,o,r,n}};Ee([(0,t.Cb)({attribute:"group-id",type:String}),Ae("design:type",String),Ae("design:paramtypes",[Object])],Pe.prototype,"groupId",null),Ee([(0,t.Cb)({attribute:"user-ids",converter:(e,t)=>e.split(",").map((e=>e.trim()))}),Ae("design:type",Array),Ae("design:paramtypes",[Array])],Pe.prototype,"userIds",null),Ee([(0,t.Cb)({attribute:"people",type:Object}),Ae("design:type",Array)],Pe.prototype,"people",void 0),Ee([(0,t.Cb)({attribute:"people-queries",converter:(e,t)=>e.split(",").map((e=>e.trim()))}),Ae("design:type",Array),Ae("design:paramtypes",[Array])],Pe.prototype,"peopleQueries",null),Ee([(0,t.Cb)({attribute:"show-max",type:Number}),Ae("design:type",Number)],Pe.prototype,"showMax",void 0),Ee([(0,t.Cb)({attribute:"show-presence",type:Boolean}),Ae("design:type",Boolean)],Pe.prototype,"showPresence",void 0),Ee([(0,t.Cb)({attribute:"person-card",converter:(e,t)=>(e=e.toLowerCase(),void 0===le[e]?le.hover:le[e])}),Ae("design:type",Number)],Pe.prototype,"personCardInteraction",void 0),Ee([(0,t.Cb)({attribute:"resource",type:String}),Ae("design:type",String),Ae("design:paramtypes",[Object])],Pe.prototype,"resource",null),Ee([(0,t.Cb)({attribute:"version",type:String}),Ae("design:type",String),Ae("design:paramtypes",[Object])],Pe.prototype,"version",null),Ee([(0,t.Cb)({attribute:"scopes",converter:e=>e?e.toLowerCase().split(","):null,reflect:!0}),Ae("design:type",Array)],Pe.prototype,"scopes",void 0),Pe=Ee([(0,t.Mo)("mgt-people"),Ae("design:paramtypes",[])],Pe);var Re=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},Oe=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ne=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};let De=class extends e.MgtTemplatedComponent{constructor(){super(),this._days=3,this.onResize=this.onResize.bind(this)}static get styles(){return be}get date(){return this._date}set date(e){this._date!==e&&(this._date=e,this.reloadState())}get groupId(){return this._groupId}set groupId(e){this._groupId!==e&&(this._groupId=e,this.reloadState())}get days(){return this._days}set days(e){this._days!==e&&(this._days=e,this.reloadState())}get eventQuery(){return this._eventQuery}set eventQuery(e){this._eventQuery!==e&&(this._eventQuery=e,this.reloadState())}get preferredTimezone(){return this._preferredTimezone}set preferredTimezone(e){this._preferredTimezone!==e&&(this._preferredTimezone=e,this.reloadState())}static get requiredScopes(){return[...new Set(["calendars.read",...Pe.requiredScopes])]}connectedCallback(){this._isNarrow=this.offsetWidth<600,super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}render(){if(!this.events&&this.isLoadingState)return this.renderLoading();if(!this.events||0===this.events.length)return this.renderNoData();const e=this.showMax&&this.showMax>0?this.events.slice(0,this.showMax):this.events;return this.renderTemplate("default",{events:e})||(this._isNarrow=this.offsetWidth<600,t.dy`
      <div dir=${this.direction} class="agenda${this._isNarrow?" narrow":""}${this.groupByDay?" grouped":""}">
        ${this.groupByDay?this.renderGroups(e):this.renderEvents(e)}
        ${this.isLoadingState?this.renderLoading():t.dy``}
      </div>
    `)}reload(){return Ne(this,void 0,void 0,(function*(){this.events=yield this.loadEvents()}))}renderLoading(){return this.renderTemplate("loading",null)||t.dy`
        <div class="event">
          <div class="event-time-container">
            <div class="event-time-loading loading-element"></div>
          </div>
          <div class="event-details-container">
            <div class="event-subject-loading loading-element"></div>
            <div class="event-location-container">
              <div class="event-location-icon-loading loading-element"></div>
              <div class="event-location-loading loading-element"></div>
            </div>
            <div class="event-location-container">
              <div class="event-attendee-loading loading-element"></div>
              <div class="event-attendee-loading loading-element"></div>
              <div class="event-attendee-loading loading-element"></div>
            </div>
          </div>
        </div>
      `}clearState(){this.events=null}renderNoData(){return this.renderTemplate("no-data",null)||t.dy``}renderEvent(e){return t.dy`
      <div class="event">
        <div class="event-time-container">
          <div class="event-time" aria-label="${this.getEventTimeString(e)}">${this.getEventTimeString(e)}</div>
        </div>
        <div class="event-details-container">
          ${this.renderTitle(e)} ${this.renderLocation(e)} ${this.renderAttendees(e)}
        </div>
        <div class="event-other-container">${this.renderOther(e)}</div>
      </div>
    `}renderHeader(e){return this.renderTemplate("header",{header:e},"header-"+e)||t.dy`
        <div class="header" aria-label="${e}">${e}</div>
      `}renderTitle(e){return t.dy`
      <div class="event-subject">${e.subject}</div>
    `}renderLocation(e){return e.location.displayName?t.dy`
      <div class="event-location-container">
        <div class="event-location-icon">${re(te.OfficeLocation)}</div>
        <div class="event-location" aria-label="${e.location.displayName}">${e.location.displayName}</div>
      </div>
    `:null}renderAttendees(e){return e.attendees.length?t.dy`
      <mgt-people
        class="event-attendees"
        .peopleQueries=${e.attendees.map((e=>e.emailAddress.address))}
      ></mgt-people>
    `:null}renderOther(e){return this.hasTemplate("event-other")?t.dy`
          ${this.renderTemplate("event-other",{event:e},e.id+"-other")}
        `:null}renderGroups(e){const o={};return e.forEach((e=>{const t=this.getDateHeaderFromDateTimeString(e.start.dateTime);o[t]=o[t]||[],o[t].push(e)})),t.dy`
      ${Object.keys(o).map((e=>t.dy`
            <div class="group">${this.renderHeader(e)} ${this.renderEvents(o[e])}</div>
          `))}
    `}renderEvents(e){return t.dy`
      <ul class="agenda-list">
        ${e.map((e=>t.dy`
              <li @click=${()=>this.eventClicked(e)}>
                ${this.renderTemplate("event",{event:e},e.id)||this.renderEvent(e)}
              </li>
            `))}
      </ul>
    `}loadState(){return Ne(this,void 0,void 0,(function*(){if(this.events)return;const e=yield this.loadEvents();e&&e.length>0&&(this.events=e)}))}reloadState(){return Ne(this,void 0,void 0,(function*(){this.events=null,this.requestStateUpdate(!0)}))}onResize(){this._isNarrow=this.offsetWidth<600}eventClicked(e){this.fireCustomEvent("eventClick",{event:e})}getEventTimeString(e){if(e.isAllDay)return"ALL DAY";let t=e.start.dateTime;"UTC"===e.start.timeZone&&(t+="Z");let o=e.end.dateTime;return"UTC"===e.end.timeZone&&(o+="Z"),`${this.prettyPrintTimeFromDateTime(new Date(t))} - ${this.prettyPrintTimeFromDateTime(new Date(o))}`}loadEvents(){return Ne(this,void 0,void 0,(function*(){const t=e.Providers.globalProvider;let o=[];if(t&&t.state===e.ProviderState.SignedIn){const r=t.graph.forComponent(this);if(this.eventQuery)try{const t=this.eventQuery.split("|");let n,i;t.length>1?(i=t[0].trim(),n=t[1].trim()):i=this.eventQuery;let s=yield r.api(i);n&&(s=s.middlewareOptions((0,e.prepScopes)(n))),this.preferredTimezone&&(s=s.header("Prefer",`outlook.timezone="${this.preferredTimezone}"`));const a=yield s.get();a&&a.value&&(o=a.value)}catch(e){}else{const t=this.date?new Date(this.date):new Date;t.setHours(0,0,0,0);const n=new Date(t.getTime());n.setDate(t.getDate()+this.days);try{const i=yield function(t,o,r,n,i){let s;s=n?`groups/${n}/calendar`:"me",s+=`/calendarview?startdatetime=${o.toISOString()}&enddatetime=${r.toISOString()}`;let a=t.api(s).middlewareOptions((0,e.prepScopes)("calendars.read")).orderby("start/dateTime");return i&&(a=a.header("Prefer",`outlook.timezone="${i}"`)),e.GraphPageIterator.create(t,a)}(r,t,n,this.groupId,this.preferredTimezone);if(i&&i.value)for(o=i.value;i.hasNext;)yield i.next(),o=i.value}catch(e){}}}return o}))}prettyPrintTimeFromDateTime(e){this.preferredTimezone||e.setMinutes(e.getMinutes()-e.getTimezoneOffset());let t=e.getHours();const o=e.getMinutes(),r=t>=12?"PM":"AM";return t%=12,t=t||12,`${t}:${o<10?"0"+o:o} ${r}`}getDateHeaderFromDateTimeString(e){const t=new Date(e);t.setMinutes(t.getMinutes()-t.getTimezoneOffset());const o=t.getDay(),r=t.getMonth(),n=t.getDate(),i=t.getFullYear();return`${function(e){switch(e){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";case 6:return"Saturday";default:return"Day"}}(o)}, ${c(r)} ${n}, ${i}`}getEventDuration(e){let t=new Date(e.start.dateTime);const o=new Date(e.end.dateTime),r=new Date;let n="";r>t&&(t=r);const i=o.getTime()-t.getTime(),s=Math.round(i/6e4);if(s>1440||e.isAllDay)n=Math.ceil(s/1440)+"d";else if(s>60){n=Math.round(s/60)+"h";const e=s%60;e&&(n+=e+"m")}else n=s+"m";return n}};Re([(0,t.Cb)({attribute:"date",type:String}),Oe("design:type",String),Oe("design:paramtypes",[Object])],De.prototype,"date",null),Re([(0,t.Cb)({attribute:"group-id",type:String}),Oe("design:type",String),Oe("design:paramtypes",[Object])],De.prototype,"groupId",null),Re([(0,t.Cb)({attribute:"days",type:Number}),Oe("design:type",Number),Oe("design:paramtypes",[Object])],De.prototype,"days",null),Re([(0,t.Cb)({attribute:"event-query",type:String}),Oe("design:type",String),Oe("design:paramtypes",[Object])],De.prototype,"eventQuery",null),Re([(0,t.Cb)({attribute:"events",type:Array}),Oe("design:type",Array)],De.prototype,"events",void 0),Re([(0,t.Cb)({attribute:"show-max",type:Number}),Oe("design:type",Number)],De.prototype,"showMax",void 0),Re([(0,t.Cb)({attribute:"group-by-day",type:Boolean}),Oe("design:type",Boolean)],De.prototype,"groupByDay",void 0),Re([(0,t.Cb)({attribute:"preferred-timezone",type:String}),Oe("design:type",String),Oe("design:paramtypes",[Object])],De.prototype,"preferredTimezone",null),Re([(0,t.Cb)({attribute:!1}),Oe("design:type",Boolean)],De.prototype,"_isNarrow",void 0),De=Re([(0,t.Mo)("mgt-agenda"),Oe("design:paramtypes",[])],De);const Le=[t.iv`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--file-background-color:#ffffff}.mgt-dark{--file-background-color:#424242}:host{font-family:var(--font-family,var(--default-font-family))}:host .item,mgt-file .item{display:flex;flex-flow:row nowrap;align-items:center;background-color:var(--file-background-color,#fff)}:host .item__file-type-icon,mgt-file .item__file-type-icon{padding:16px;width:var(--file-type-icon-size,28px);min-width:var(--file-type-icon-size,28px);height:var(--file-type-icon-size,28px);display:flex;align-items:center;justify-content:center}:host .item__file-type-icon img,mgt-file .item__file-type-icon img{height:var(--file-type-icon-size,28px);width:var(--file-type-icon-size,28px)}:host .item__details,mgt-file .item__details{padding:10px 0}:host .item__details .line1,mgt-file .item__details .line1{font-size:var(--font-size,14px);font-weight:var(--font-weight,400);text-transform:var(text-transform,none);line-height:20px;color:var(--color-sub1,#323130)}:host .item__details .line2,mgt-file .item__details .line2{color:var(--line2-color,var(--color-sub1,#323130));font-size:var(--line2-font-size,var(--last-modified-font-size,12px));font-weight:var(--line2-font-weight,400);text-transform:var(--line2-text-transform,var(text-transform,none));line-height:16px}:host .item__details .line3,mgt-file .item__details .line3{color:var(--line3-color,var(--color-sub1,#323130));font-size:var(--line3-font-size,var(--size-font-size,12px));font-weight:var(--line3-font-weight,400);text-transform:var(--line3-text-transform,var(text-transform,none));line-height:16px}[dir=rtl] .item__details{direction:ltr}
`];var Ue=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const Me=()=>e.CacheService.config.files.invalidationPeriod||e.CacheService.config.defaultInvalidationPeriod,Fe=()=>e.CacheService.config.files.isEnabled&&e.CacheService.config.isEnabled,He=()=>e.CacheService.config.fileLists.isEnabled&&e.CacheService.config.isEnabled;function qe(t,o){return Ue(this,void 0,void 0,(function*(){let r;r=e.CacheService.getCache(C,C.stores.fileQueries);const n=yield ze(r,o);if(n)return n;let i;try{i=yield t.api(o).middlewareOptions((0,e.prepScopes)("files.read")).get(),Fe()&&r.putValue(o,{file:JSON.stringify(i)})}catch(e){}return i||null}))}function $e(t,o,r){return Ue(this,void 0,void 0,(function*(){if(!o)return[];const n=o.value,i=t.createBatch(),s=[];for(const e of n){const t=e.resourceReference.id;""!==t&&i.get(t,t,r)}try{const e=yield i.executeAll();for(const t of n){const o=e.get(t.resourceReference.id);o&&o.content&&s.push(o.content)}return s}catch(o){try{return Promise.all(n.filter((e=>e.resourceReference.id&&""!==e.resourceReference.id)).map((o=>Ue(this,void 0,void 0,(function*(){const n=yield t.api(o.resourceReference.id).middlewareOptions((0,e.prepScopes)(...r)).get();if(n&&n.length)return n[0].content})))))}catch(e){return[]}}}))}function Be(t,o){return Ue(this,void 0,void 0,(function*(){return e.GraphPageIterator.create(t,o)}))}function je(t,o,r){return Ue(this,void 0,void 0,(function*(){return e.GraphPageIterator.createFromValue(t,o,r)}))}function ze(e,t){return Ue(this,void 0,void 0,(function*(){if(Fe()){const o=yield e.getValue(t);if(o&&Me()>Date.now()-o.timeCached)return JSON.parse(o.file)}return null}))}function Ve(t,o){return Ue(this,void 0,void 0,(function*(){if(t||(t=e.CacheService.getCache(T,T.stores.fileLists)),He()){const r=yield t.getValue(o);if(r&&(e.CacheService.config.fileLists.invalidationPeriod||e.CacheService.config.defaultInvalidationPeriod)>Date.now()-r.timeCached)return r}return null}))}function Ge(t){return Ue(this,void 0,void 0,(function*(){const o=t._nextLink;if(t.hasNext&&(yield t.next()),He()){let r;r=e.CacheService.getCache(T,T.stores.fileLists);const n=/(graph.microsoft.com\/(v1.0|beta))(.*?)(?=\?)/gi.exec(o)[3];r.putValue(n,{files:t.value,nextLink:t._nextLink})}}))}const Ke={PowerPoint:"pptx",Word:"docx",Excel:"xlsx",Pdf:"pdf",OneNote:"onetoc",OneNotePage:"one",InfoPath:"xsn",Visio:"vstx",Publisher:"pub",Project:"mpp",Access:"accdb",Mail:"email",Csv:"csv",Archive:"archive",Xps:"vector",Audio:"audio",Video:"video",Image:"photo",Web:"html",Text:"txt",Xml:"xml",Story:"genericfile",ExternalContent:"genericfile",Folder:"folder",Spsite:"spo",Other:"genericfile"},We="https://spoprod-a.akamaihd.net/files/fabric-cdn-prod_20201008.001/assets/item-types",Qe={modifiedSubtitle:"Modified",sizeSubtitle:"Size"};var Je=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},Ye=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Ze=class extends e.MgtTemplatedComponent{constructor(){super(),this.line1Property="name",this.line2Property="lastModifiedDateTime",this.line3Property="size",this.view=ee.threelines}static get styles(){return Le}get strings(){return Qe}get fileQuery(){return this._fileQuery}set fileQuery(e){e!==this._fileQuery&&(this._fileQuery=e,this.requestStateUpdate())}get siteId(){return this._siteId}set siteId(e){e!==this._siteId&&(this._siteId=e,this.requestStateUpdate())}get driveId(){return this._driveId}set driveId(e){e!==this._driveId&&(this._driveId=e,this.requestStateUpdate())}get groupId(){return this._groupId}set groupId(e){e!==this._groupId&&(this._groupId=e,this.requestStateUpdate())}get listId(){return this._listId}set listId(e){e!==this._listId&&(this._listId=e,this.requestStateUpdate())}get userId(){return this._userId}set userId(e){e!==this._userId&&(this._userId=e,this.requestStateUpdate())}get itemId(){return this._itemId}set itemId(e){e!==this._itemId&&(this._itemId=e,this.requestStateUpdate())}get itemPath(){return this._itemPath}set itemPath(e){e!==this._itemPath&&(this._itemPath=e,this.requestStateUpdate())}get insightType(){return this._insightType}set insightType(e){e!==this._insightType&&(this._insightType=e,this.requestStateUpdate())}get insightId(){return this._insightId}set insightId(e){e!==this._insightId&&(this._insightId=e,this.requestStateUpdate())}get fileDetails(){return this._fileDetails}set fileDetails(e){e!==this._fileDetails&&(this._fileDetails=e,this.requestStateUpdate())}get fileIcon(){return this._fileIcon}set fileIcon(e){e!==this._fileIcon&&(this._fileIcon=e,this.requestStateUpdate())}static get requiredScopes(){return[...new Set(["files.read","files.read.all","sites.read.all"])]}render(){if(!this.driveItem&&this.isLoadingState)return this.renderLoading();if(!this.driveItem)return this.renderNoData();const e=this.driveItem;let o;if(o=this.renderTemplate("default",{file:e}),!o){const r=this.renderDetails(e),n=this.renderFileTypeIcon();o=t.dy`
        <div class="item">
          ${n} ${r}
        </div>
      `}return t.dy`
      <span dir=${this.direction}>
        ${o}
      </span>
    `}renderLoading(){return this.renderTemplate("loading",null)||t.dy``}renderNoData(){return this.renderTemplate("no-data",null)||t.dy``}renderFileTypeIcon(){if(!this.fileIcon&&!this.driveItem.name)return t.dy``;let e;if(this.fileIcon)e=this.fileIcon;else{const t=/(?:\.([^.]+))?$/,r=void 0===this.driveItem.package&&void 0===this.driveItem.folder?t.exec(this.driveItem.name)[1]?t.exec(this.driveItem.name)[1].toLowerCase():"null":void 0!==this.driveItem.package&&"oneNote"===this.driveItem.package.type?"onetoc":"folder";o=r,48,"svg",e=Object.keys(Ke).find((e=>Ke[e]===o))?`${We}/${48..toString()}/${o}.svg`:"jpg"===o||"png"===o?(o="photo",`${We}/${48..toString()}/${o}.svg`):null}var o;return t.dy`
      <div class="item__file-type-icon">
        ${e?t.dy`
              <img src=${e} alt="File icon" />
            `:t.dy`
              ${re(te.File)}
            `}
      </div>
    `}renderDetails(e){if(!e||this.view===ee.image)return t.dy``;const o=[];if(this.view>ee.image){const r=this.getTextFromProperty(e,this.line1Property);r&&o.push(t.dy`
          <div class="line1" aria-label="${r}">${r}</div>
        `)}if(this.view>ee.oneline){const r=this.getTextFromProperty(e,this.line2Property);r&&o.push(t.dy`
          <div class="line2" aria-label="${r}">${r}</div>
        `)}if(this.view>ee.twolines){const r=this.getTextFromProperty(e,this.line3Property);r&&o.push(t.dy`
          <div class="line3" aria-label="${r}">${r}</div>
        `)}return t.dy`
      <div class="item__details">
        ${o}
      </div>
    `}loadState(){return t=this,o=void 0,n=function*(){if(this.fileDetails)return void(this.driveItem=this.fileDetails);const t=e.Providers.globalProvider;if(!t||t.state===e.ProviderState.Loading)return;if(t.state===e.ProviderState.SignedOut)return void(this.driveItem=null);const o=t.graph.forComponent(this);let r;const n=!(this.driveId||this.siteId||this.groupId||this.listId||this.userId);this.driveId&&!this.itemId&&!this.itemPath||this.siteId&&!this.itemId&&!this.itemPath||this.groupId&&!this.itemId&&!this.itemPath||this.listId&&!this.siteId&&!this.itemId||this.insightType&&!this.insightId||this.userId&&!this.itemId&&!this.itemPath&&!this.insightType&&!this.insightId?r=null:this.fileQuery?r=yield qe(o,this.fileQuery):this.itemId&&n?r=yield function(t,o){return Ue(this,void 0,void 0,(function*(){const r=`/me/drive/items/${o}`;let n;n=e.CacheService.getCache(C,C.stores.userFiles);const i=yield ze(n,r);if(i)return i;let s;try{s=yield t.api(r).middlewareOptions((0,e.prepScopes)("files.read")).get(),Fe()&&n.putValue(r,{file:JSON.stringify(s)})}catch(e){}return s||null}))}(o,this.itemId):this.itemPath&&n?r=yield function(t,o){return Ue(this,void 0,void 0,(function*(){const r=`/me/drive/root:/${o}`;let n;n=e.CacheService.getCache(C,C.stores.userFiles);const i=yield ze(n,r);if(i)return i;let s;try{s=yield t.api(r).middlewareOptions((0,e.prepScopes)("files.read")).get(),Fe()&&n.putValue(r,{file:JSON.stringify(s)})}catch(e){}return s||null}))}(o,this.itemPath):this.userId?this.itemId?r=yield function(t,o,r){return Ue(this,void 0,void 0,(function*(){const n=`/users/${o}/drive/items/${r}`;let i;i=e.CacheService.getCache(C,C.stores.userFiles);const s=yield ze(i,n);if(s)return s;let a;try{a=yield t.api(n).middlewareOptions((0,e.prepScopes)("files.read")).get(),Fe()&&i.putValue(n,{file:JSON.stringify(a)})}catch(e){}return a||null}))}(o,this.userId,this.itemId):this.itemPath?r=yield function(t,o,r){return Ue(this,void 0,void 0,(function*(){const n=`/users/${o}/drive/root:/${r}`;let i;i=e.CacheService.getCache(C,C.stores.userFiles);const s=yield ze(i,n);if(s)return s;let a;try{a=yield t.api(n).middlewareOptions((0,e.prepScopes)("files.read")).get(),Fe()&&i.putValue(n,{file:JSON.stringify(a)})}catch(e){}return a||null}))}(o,this.userId,this.itemPath):this.insightType&&this.insightId&&(r=yield function(t,o,r,n){return Ue(this,void 0,void 0,(function*(){const i=`/users/${o}/insights/${r}/${n}/resource`;let s;s=e.CacheService.getCache(C,C.stores.insightFiles);const a=yield ze(s,i);if(a)return a;let c;try{c=yield t.api(i).middlewareOptions((0,e.prepScopes)("sites.read.all")).get(),Fe()&&s.putValue(i,{file:JSON.stringify(c)})}catch(e){}return c||null}))}(o,this.userId,this.insightType,this.insightId)):this.driveId?this.itemId?r=yield function(t,o,r){return Ue(this,void 0,void 0,(function*(){const n=`/drives/${o}/items/${r}`;let i;i=e.CacheService.getCache(C,C.stores.driveFiles);const s=yield ze(i,n);if(s)return s;let a;try{a=yield t.api(n).middlewareOptions((0,e.prepScopes)("files.read")).get(),Fe()&&i.putValue(n,{file:JSON.stringify(a)})}catch(e){}return a||null}))}(o,this.driveId,this.itemId):this.itemPath&&(r=yield function(t,o,r){return Ue(this,void 0,void 0,(function*(){const n=`/drives/${o}/root:/${r}`;let i;i=e.CacheService.getCache(C,C.stores.driveFiles);const s=yield ze(i,n);if(s)return s;let a;try{a=yield t.api(n).middlewareOptions((0,e.prepScopes)("files.read")).get(),Fe()&&i.putValue(n,{file:JSON.stringify(a)})}catch(e){}return a||null}))}(o,this.driveId,this.itemPath)):this.siteId&&!this.listId?this.itemId?r=yield function(t,o,r){return Ue(this,void 0,void 0,(function*(){const n=`/sites/${o}/drive/items/${r}`;let i;i=e.CacheService.getCache(C,C.stores.siteFiles);const s=yield ze(i,n);if(s)return s;let a;try{a=yield t.api(n).middlewareOptions((0,e.prepScopes)("files.read")).get(),Fe()&&i.putValue(n,{file:JSON.stringify(a)})}catch(e){}return a||null}))}(o,this.siteId,this.itemId):this.itemPath&&(r=yield function(t,o,r){return Ue(this,void 0,void 0,(function*(){const n=`/sites/${o}/drive/root:/${r}`;let i;i=e.CacheService.getCache(C,C.stores.siteFiles);const s=yield ze(i,n);if(s)return s;let a;try{a=yield t.api(n).middlewareOptions((0,e.prepScopes)("files.read")).get(),Fe()&&i.putValue(n,{file:JSON.stringify(a)})}catch(e){}return a||null}))}(o,this.siteId,this.itemPath)):this.listId?r=yield function(t,o,r,n){return Ue(this,void 0,void 0,(function*(){const i=`/sites/${o}/lists/${r}/items/${n}/driveItem`;let s;s=e.CacheService.getCache(C,C.stores.siteFiles);const a=yield ze(s,i);if(a)return a;let c;try{c=yield t.api(i).middlewareOptions((0,e.prepScopes)("files.read")).get(),Fe()&&s.putValue(i,{file:JSON.stringify(c)})}catch(e){}return c||null}))}(o,this.siteId,this.listId,this.itemId):this.groupId?this.itemId?r=yield function(t,o,r){return Ue(this,void 0,void 0,(function*(){const n=`/groups/${o}/drive/items/${r}`;let i;i=e.CacheService.getCache(C,C.stores.groupFiles);const s=yield ze(i,n);if(s)return s;let a;try{a=yield t.api(n).middlewareOptions((0,e.prepScopes)("files.read")).get(),Fe()&&i.putValue(n,{file:JSON.stringify(a)})}catch(e){}return a||null}))}(o,this.groupId,this.itemId):this.itemPath&&(r=yield function(t,o,r){return Ue(this,void 0,void 0,(function*(){const n=`/groups/${o}/drive/root:/${r}`;let i;i=e.CacheService.getCache(C,C.stores.groupFiles);const s=yield ze(i,n);if(s)return s;let a;try{a=yield t.api(n).middlewareOptions((0,e.prepScopes)("files.read")).get(),Fe()&&i.putValue(n,{file:JSON.stringify(a)})}catch(e){}return a||null}))}(o,this.groupId,this.itemPath)):this.insightType&&!this.userId&&(r=yield function(t,o,r){return Ue(this,void 0,void 0,(function*(){const n=`/me/insights/${o}/${r}/resource`;let i;i=e.CacheService.getCache(C,C.stores.insightFiles);const s=yield ze(i,n);if(s)return s;let a;try{a=yield t.api(n).middlewareOptions((0,e.prepScopes)("sites.read.all")).get(),Fe()&&i.putValue(n,{file:JSON.stringify(a)})}catch(e){}return a||null}))}(o,this.insightType,this.insightId)),this.driveItem=r},new((r=void 0)||(r=Promise))((function(e,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(t){var o;t.done?e(t.value):(o=t.value,o instanceof r?o:new r((function(e){e(o)}))).then(s,a)}c((n=n.apply(t,o||[])).next())}));var t,o,r,n}getTextFromProperty(e,t){if(!t||0===t.length)return null;const o=t.trim().split(",");let r,n=0;for(;!r&&n<o.length;){const t=o[n].trim();switch(t){case"size":let o;o=e.size?this.formatBytes(e.size):"0",r=`${this.strings.sizeSubtitle}: ${o}`;break;case"lastModifiedDateTime":let n,i;e.lastModifiedDateTime?(n=s(new Date(e.lastModifiedDateTime)),i=`${this.strings.modifiedSubtitle} ${n}`):i="",r=i;break;default:r=e[t]}n++}return r}formatBytes(e,t=2){if(0===e)return"0 Bytes";const o=t<0?0:t,r=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,r)).toFixed(o))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][r]}};Je([(0,t.Cb)({attribute:"file-query"}),Ye("design:type",String),Ye("design:paramtypes",[String])],Ze.prototype,"fileQuery",null),Je([(0,t.Cb)({attribute:"site-id"}),Ye("design:type",String),Ye("design:paramtypes",[String])],Ze.prototype,"siteId",null),Je([(0,t.Cb)({attribute:"drive-id"}),Ye("design:type",String),Ye("design:paramtypes",[String])],Ze.prototype,"driveId",null),Je([(0,t.Cb)({attribute:"group-id"}),Ye("design:type",String),Ye("design:paramtypes",[String])],Ze.prototype,"groupId",null),Je([(0,t.Cb)({attribute:"list-id"}),Ye("design:type",String),Ye("design:paramtypes",[String])],Ze.prototype,"listId",null),Je([(0,t.Cb)({attribute:"user-id"}),Ye("design:type",String),Ye("design:paramtypes",[String])],Ze.prototype,"userId",null),Je([(0,t.Cb)({attribute:"item-id"}),Ye("design:type",String),Ye("design:paramtypes",[String])],Ze.prototype,"itemId",null),Je([(0,t.Cb)({attribute:"item-path"}),Ye("design:type",String),Ye("design:paramtypes",[String])],Ze.prototype,"itemPath",null),Je([(0,t.Cb)({attribute:"insight-type"}),Ye("design:type",String),Ye("design:paramtypes",[String])],Ze.prototype,"insightType",null),Je([(0,t.Cb)({attribute:"insight-id"}),Ye("design:type",String),Ye("design:paramtypes",[String])],Ze.prototype,"insightId",null),Je([(0,t.Cb)({type:Object}),Ye("design:type",Object),Ye("design:paramtypes",[Object])],Ze.prototype,"fileDetails",null),Je([(0,t.Cb)({attribute:"file-icon"}),Ye("design:type",String),Ye("design:paramtypes",[String])],Ze.prototype,"fileIcon",null),Je([(0,t.Cb)({type:Object}),Ye("design:type",Object)],Ze.prototype,"driveItem",void 0),Je([(0,t.Cb)({attribute:"line1-property"}),Ye("design:type",String)],Ze.prototype,"line1Property",void 0),Je([(0,t.Cb)({attribute:"line2-property"}),Ye("design:type",String)],Ze.prototype,"line2Property",void 0),Je([(0,t.Cb)({attribute:"line3-property"}),Ye("design:type",String)],Ze.prototype,"line3Property",void 0),Je([(0,t.Cb)({attribute:"view",converter:e=>e&&0!==e.length?(e=e.toLowerCase(),void 0===ee[e]?ee.threelines:ee[e]):ee.threelines}),Ye("design:type",Number)],Ze.prototype,"view",void 0),Ze=Je([(0,t.Mo)("mgt-file"),Ye("design:paramtypes",[])],Ze);const Xe=[t.iv`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .spinner{border:2px solid #c7e0f4;border-top:2px solid #0078d4;border-radius:50%;width:20px;height:20px;animation:spin 2s linear infinite}@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}
`];let et=class extends e.MgtBaseComponent{static get styles(){return Xe}render(){return t.dy`
      <div class="spinner"></div>
    `}};et=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s}([(0,t.Mo)("mgt-spinner")],et);const tt=[t.iv`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--file-item-background-color--hover:rgba(0, 0, 0, 0.1);--file-item-background-color--active:rgba(0, 0, 0, 0.05);--file-list-background-color:#ffffff}.mgt-dark{--file-item-background-color--hover:#0078d4;--file-item-background-color--active:#238ada;--file-list-background-color:#424242}:host{font-family:var(--default-font-family);font-size:var(--default-font-size)}:host .file-list-wrapper,mgt-file-item .file-list-wrapper{background-color:var(--file-list-background-color,#fff);box-shadow:var(--file-list-box-shadow,0 3.2px 7.2px rgba(0,0,0,.132),0 .6px 1.8px rgba(0,0,0,.108));border-radius:var(--file-list-border-radius,4px);border:var(--file-list-border,none);position:relative;color:var(--color-sub1,#323130);display:flex;flex-direction:column}:host .file-list-wrapper .file-list,mgt-file-item .file-list-wrapper .file-list{display:flex;padding:var(--file-list-padding,4px 0);margin:var(--file-list-margin,0);flex-direction:column;list-style:none}:host .file-list-wrapper .file-list .file-item,mgt-file-item .file-list-wrapper .file-list .file-item{border-top:var(--file-item-border-top,none);border-left:var(--file-item-border-left,none);border-right:var(--file-item-border-right,none);border-bottom:var(--file-item-border-bottom,none);margin:var(--file-item-margin,0 4px);border-radius:var(--file-item-border-radius,2px);cursor:pointer}:host .file-list-wrapper .file-list .file-item mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item mgt-file{--file-background-color:$background-color}:host .file-list-wrapper .file-list .file-item.focused,:host .file-list-wrapper .file-list .file-item:hover,mgt-file-item .file-list-wrapper .file-list .file-item.focused,mgt-file-item .file-list-wrapper .file-list .file-item:hover{background-color:var(--file-item-background-color--hover,rgba(0,0,0,.1))}:host .file-list-wrapper .file-list .file-item.focused mgt-file,:host .file-list-wrapper .file-list .file-item:hover mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item.focused mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item:hover mgt-file{--file-background-color:$file-item-background-color--hover}:host .file-list-wrapper .file-list .file-item.selected,:host .file-list-wrapper .file-list .file-item:active,mgt-file-item .file-list-wrapper .file-list .file-item.selected,mgt-file-item .file-list-wrapper .file-list .file-item:active{background-color:var(--file-item-background-color--active,rgba(0,0,0,.05))}:host .file-list-wrapper .file-list .file-item.selected mgt-file,:host .file-list-wrapper .file-list .file-item:active mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item.selected mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item:active mgt-file{--file-background-color:$file-item-background-color--active}:host .file-list-wrapper .show-more,mgt-file-item .file-list-wrapper .show-more{text-align:center;font-size:var(--show-more-button-font-size,12px);padding:var(--show-more-button-padding,6px);border-bottom-right-radius:var(--show-more-button-border-bottom-right-radius,4px);border-bottom-left-radius:var(--show-more-button-border-bottom-left-radius,4px);cursor:pointer;background-color:var(--show-more-button-background-color,var(--background-color-sub2,#f3f2f1))}:host .file-list-wrapper .show-more:hover,mgt-file-item .file-list-wrapper .show-more:hover{background-color:var(--show-more-button-background-color--hover,var(--file-item-background-color--hover,rgba(0,0,0,.1)))}
`],ot={showMoreSubtitle:"Show more items"};var rt=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},nt=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},it=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};let st=class extends e.MgtTemplatedComponent{constructor(){super(),this._focusedItemIndex=-1,this.pageSize=10,this.itemView=ee.twolines,this._preloadedFiles=[]}static get styles(){return tt}get strings(){return ot}get fileListQuery(){return this._fileListQuery}set fileListQuery(e){e!==this._fileListQuery&&(this._fileListQuery=e,this.requestStateUpdate(!0))}get fileQueries(){return this._fileQueries}set fileQueries(t){(0,e.arraysAreEqual)(this._fileQueries,t)||(this._fileQueries=t,this.requestStateUpdate(!0))}get siteId(){return this._siteId}set siteId(e){e!==this._siteId&&(this._siteId=e,this.requestStateUpdate(!0))}get driveId(){return this._driveId}set driveId(e){e!==this._driveId&&(this._driveId=e,this.requestStateUpdate(!0))}get groupId(){return this._groupId}set groupId(e){e!==this._groupId&&(this._groupId=e,this.requestStateUpdate(!0))}get itemId(){return this._itemId}set itemId(e){e!==this._itemId&&(this._itemId=e,this.requestStateUpdate(!0))}get itemPath(){return this._itemPath}set itemPath(e){e!==this._itemPath&&(this._itemPath=e,this.requestStateUpdate(!0))}get userId(){return this._userId}set userId(e){e!==this._userId&&(this._userId=e,this.requestStateUpdate(!0))}get insightType(){return this._insightType}set insightType(e){e!==this._insightType&&(this._insightType=e,this.requestStateUpdate(!0))}get fileExtensions(){return this._fileExtensions}set fileExtensions(t){(0,e.arraysAreEqual)(this._fileExtensions,t)||(this._fileExtensions=t,this.requestStateUpdate(!0))}get pageSize(){return this._pageSize}set pageSize(e){e!==this._pageSize&&(this._pageSize=e,this.requestStateUpdate(!0))}static get requiredScopes(){return[...new Set([...Ze.requiredScopes])]}requestStateUpdate(e){return this.clearState(),super.requestStateUpdate(e)}clearState(){super.clearState(),this.files=null}render(){return!this.files&&this.isLoadingState?this.renderLoading():this.files&&0!==this.files.length?this.renderTemplate("default",{files:this.files})||this.renderFiles():this.renderNoData()}renderLoading(){return this.renderTemplate("loading",null)||t.dy``}renderNoData(){return this.renderTemplate("no-data",null)||t.dy``}renderFiles(){return t.dy`
      <div id="file-list-wrapper" class="file-list-wrapper" dir=${this.direction}>
        <ul
          id="file-list"
          class="file-list"
          tabindex="0"
          @keydown="${this.onFileListKeyDown}"
          @keyup="${this.onFileListKeyUp}"
          @blur="${this.onFileListOut}"
        >
          ${Ie(this.files,(e=>e.id),(e=>t.dy`
              <li class="file-item">
                ${this.renderFile(e)}
              </li>
            `))}
        </ul>
        ${!this.hideMoreFilesButton&&this.pageIterator&&(this.pageIterator.hasNext||this._preloadedFiles.length)?this.renderMoreFileButton():null}
      </div>
    `}renderFile(e){const o=this.itemView;return this.renderTemplate("file",{file:e},e.id)||t.dy`
        <mgt-file .fileDetails=${e} .view=${o} @click=${t=>this.handleItemSelect(e,t)}></mgt-file>
      `}renderMoreFileButton(){return this.isLoadingState?t.dy`
        <mgt-spinner></mgt-spinner>
      `:t.dy`<a id="show-more" class="show-more" @click=${()=>this.renderNextPage()} tabindex="0" @keydown=${this.onShowMoreKeyDown}><span>${this.strings.showMoreSubtitle}<span></a>`}onShowMoreKeyDown(e){e&&"Enter"===e.code&&(e.preventDefault(),this.renderNextPage())}onFileListKeyUp(e){const t=this.renderRoot.querySelector(".file-list").children[this._focusedItemIndex];"Enter"!==e.code&&"Space"!==e.code||(e.preventDefault(),null==t||t.classList.remove("selected"),null==t||t.classList.add("focused"))}onFileListKeyDown(e){const t=this.renderRoot.querySelector(".file-list");let o;if(t&&t.children.length){if("ArrowUp"!==e.code&&"ArrowDown"!==e.code||("ArrowUp"===e.code&&(-1===this._focusedItemIndex&&(this._focusedItemIndex=t.children.length),this._focusedItemIndex=(this._focusedItemIndex-1+t.children.length)%t.children.length),"ArrowDown"===e.code&&(this._focusedItemIndex=(this._focusedItemIndex+1)%t.children.length),o=t.children[this._focusedItemIndex],this.updateItemBackgroundColor(t,o,"focused")),"Enter"===e.code||"Space"===e.code){o=t.children[this._focusedItemIndex];const r=o.children[0];e.preventDefault(),this.fireCustomEvent("itemClick",r.fileDetails),this.updateItemBackgroundColor(t,o,"selected")}"Tab"===e.code&&(o=t.children[this._focusedItemIndex],null==o||o.classList.remove("focused"))}}onFileListOut(){const e=this.renderRoot.querySelector(".file-list").children[this._focusedItemIndex];null==e||e.classList.remove("focused")}loadState(){return it(this,void 0,void 0,(function*(){const t=e.Providers.globalProvider;if(!t||t.state===e.ProviderState.Loading)return;if(t.state===e.ProviderState.SignedOut)return void(this.files=null);const o=t.graph.forComponent(this);let r,n;const i=!(this.driveId||this.siteId||this.groupId||this.userId);if((this.driveId&&!this.itemId&&!this.itemPath||this.groupId&&!this.itemId&&!this.itemPath||this.siteId&&!this.itemId&&!this.itemPath||this.userId&&!this.insightType&&!this.itemId&&!this.itemPath)&&(this.files=null),!this.files){let t;if(this.fileListQuery?n=yield function(t,o,r){return Ue(this,void 0,void 0,(function*(){let n,i;i=e.CacheService.getCache(T,T.stores.fileLists);const s=yield Ve(i,o);if(s)return n=yield je(t,s.files,s.nextLink),n;const a=["files.read","sites.read.all"];let c;try{c=yield t.api(o).middlewareOptions((0,e.prepScopes)(...a)),r&&c.top(r),n=yield Be(t,c),He()&&i.putValue(o,{files:n.value,nextLink:n._nextLink})}catch(e){}return n||null}))}(o,this.fileListQuery,this.pageSize):this.fileQueries?r=yield function(t,o){return Ue(this,void 0,void 0,(function*(){if(!o||0===o.length)return[];const r=t.createBatch(),n=[],i=["files.read"];let s,a;Fe()&&(s=e.CacheService.getCache(C,C.stores.fileQueries));for(const e of o)Fe()&&(a=yield s.getValue(e)),Fe()&&a&&Me()>Date.now()-a.timeCached?n.push(JSON.parse(a.file)):""!==e&&r.get(e,e,i);try{const e=yield r.executeAll();for(const t of o){const o=e.get(t);o&&o.content&&(n.push(o.content),Fe()&&s.putValue(t,{file:JSON.stringify(o.content)}))}return n}catch(e){try{return Promise.all(o.filter((e=>e&&""!==e)).map((e=>Ue(this,void 0,void 0,(function*(){const o=yield qe(t,e);if(o)return Fe()&&s.putValue(e,{file:JSON.stringify(o)}),o})))))}catch(e){return[]}}}))}(o,this.fileQueries):i?this.itemId?n=yield function(t,o,r){return Ue(this,void 0,void 0,(function*(){const n=`/me/drive/items/${o}/children`;let i,s;s=e.CacheService.getCache(T,T.stores.fileLists);const a=yield Ve(s,n);if(a)return i=yield je(t,a.files,a.nextLink),i;let c;try{c=t.api(n).middlewareOptions((0,e.prepScopes)("files.read")),r&&c.top(r),i=yield Be(t,c),He()&&s.putValue(n,{files:i.value,nextLink:i._nextLink})}catch(e){}return i||null}))}(o,this.itemId,this.pageSize):this.itemPath?n=yield function(t,o,r){return Ue(this,void 0,void 0,(function*(){const n=`/me/drive/root:/${o}:/children`;let i,s;s=e.CacheService.getCache(T,T.stores.fileLists);const a=yield Ve(s,n);if(a)return i=yield je(t,a.files,a.nextLink),i;let c;try{c=t.api(n).middlewareOptions((0,e.prepScopes)("files.read")),r&&c.top(r),i=yield Be(t,c),He()&&s.putValue(n,{files:i.value,nextLink:i._nextLink})}catch(e){}return i||null}))}(o,this.itemPath,this.pageSize):this.insightType?r=yield function(t,o){return Ue(this,void 0,void 0,(function*(){const r=`/me/insights/${o}`;let n;n=e.CacheService.getCache(T,T.stores.insightfileLists);const i=yield Ve(n,r);if(i)return i;const s=["sites.read.all"];let a;try{a=yield t.api(r).filter("resourceReference/type eq 'microsoft.graph.driveItem'").middlewareOptions((0,e.prepScopes)(...s)).get()}catch(e){}const c=yield $e(t,a,s);return He()&&n.putValue(r,{files:c}),c||null}))}(o,this.insightType):n=yield function(t,o){return Ue(this,void 0,void 0,(function*(){const r="/me/drive/root/children";let n,i;i=e.CacheService.getCache(T,T.stores.fileLists);const s=yield Ve(i,r);if(s)return n=yield je(t,s.files,s.nextLink),n;let a;try{a=t.api(r).middlewareOptions((0,e.prepScopes)("files.read")),o&&a.top(o),n=yield Be(t,a),He()&&i.putValue(r,{files:n.value,nextLink:n._nextLink})}catch(e){}return n||null}))}(o,this.pageSize):this.driveId?this.itemId?n=yield function(t,o,r,n){return Ue(this,void 0,void 0,(function*(){const i=`/drives/${o}/items/${r}/children`;let s,a;a=e.CacheService.getCache(T,T.stores.fileLists);const c=yield Ve(a,i);if(c)return s=yield je(t,c.files,c.nextLink),s;let l;try{l=t.api(i).middlewareOptions((0,e.prepScopes)("files.read")),n&&l.top(n),s=yield Be(t,l),He()&&a.putValue(i,{files:s.value,nextLink:s._nextLink})}catch(e){}return s||null}))}(o,this.driveId,this.itemId,this.pageSize):this.itemPath&&(n=yield function(t,o,r,n){return Ue(this,void 0,void 0,(function*(){const i=`/drives/${o}/root:/${r}:/children`;let s,a;a=e.CacheService.getCache(T,T.stores.fileLists);const c=yield Ve(a,i);if(c)return s=yield je(t,c.files,c.nextLink),s;let l;try{l=t.api(i).middlewareOptions((0,e.prepScopes)("files.read")),n&&l.top(n),s=yield Be(t,l),He()&&a.putValue(i,{files:s.value,nextLink:s._nextLink})}catch(e){}return s||null}))}(o,this.driveId,this.itemPath,this.pageSize)):this.groupId?this.itemId?n=yield function(t,o,r,n){return Ue(this,void 0,void 0,(function*(){const i=`/groups/${o}/drive/items/${r}/children`;let s,a;a=e.CacheService.getCache(T,T.stores.fileLists);const c=yield Ve(a,i);if(c)return s=yield je(t,c.files,c.nextLink),s;let l;try{l=t.api(i).middlewareOptions((0,e.prepScopes)("files.read")),n&&l.top(n),s=yield Be(t,l),He()&&a.putValue(i,{files:s.value,nextLink:s._nextLink})}catch(e){}return s||null}))}(o,this.groupId,this.itemId,this.pageSize):this.itemPath&&(n=yield function(t,o,r,n){return Ue(this,void 0,void 0,(function*(){const i=`/groups/${o}/drive/root:/${r}:/children`;let s,a;a=e.CacheService.getCache(T,T.stores.fileLists);const c=yield Ve(a,i);if(c)return s=yield je(t,c.files,c.nextLink),s;let l;try{l=t.api(i).middlewareOptions((0,e.prepScopes)("files.read")),n&&l.top(n),s=yield Be(t,l),He()&&a.putValue(i,{files:s.value,nextLink:s._nextLink})}catch(e){}return s||null}))}(o,this.groupId,this.itemPath,this.pageSize)):this.siteId?this.itemId?n=yield function(t,o,r,n){return Ue(this,void 0,void 0,(function*(){const i=`/sites/${o}/drive/items/${r}/children`;let s,a;a=e.CacheService.getCache(T,T.stores.fileLists);const c=yield Ve(a,i);if(c)return s=yield je(t,c.files,c.nextLink),s;let l;try{l=t.api(i).middlewareOptions((0,e.prepScopes)("files.read")),n&&l.top(n),s=yield Be(t,l),He()&&a.putValue(i,{files:s.value,nextLink:s._nextLink})}catch(e){}return s||null}))}(o,this.siteId,this.itemId,this.pageSize):this.itemPath&&(n=yield function(t,o,r,n){return Ue(this,void 0,void 0,(function*(){const i=`/sites/${o}/drive/root:/${r}:/children`;let s,a;a=e.CacheService.getCache(T,T.stores.fileLists);const c=yield Ve(a,i);if(c)return s=yield je(t,c.files,c.nextLink),s;let l;try{l=t.api(i).middlewareOptions((0,e.prepScopes)("files.read")),n&&l.top(n),s=yield Be(t,l),He()&&a.putValue(i,{files:s.value,nextLink:s._nextLink})}catch(e){}return s||null}))}(o,this.siteId,this.itemPath,this.pageSize)):this.userId&&(this.itemId?n=yield function(t,o,r,n){return Ue(this,void 0,void 0,(function*(){const i=`/users/${o}/drive/items/${r}/children`;let s,a;a=e.CacheService.getCache(T,T.stores.fileLists);const c=yield Ve(a,i);if(c)return s=yield je(t,c.files,c.nextLink),s;let l;try{l=t.api(i).middlewareOptions((0,e.prepScopes)("files.read")),n&&l.top(n),s=yield Be(t,l),He()&&a.putValue(i,{files:s.value,nextLink:s._nextLink})}catch(e){}return s||null}))}(o,this.userId,this.itemId,this.pageSize):this.itemPath?n=yield function(t,o,r,n){return Ue(this,void 0,void 0,(function*(){const i=`/users/${o}/drive/root:/${r}:/children`;let s,a;a=e.CacheService.getCache(T,T.stores.fileLists);const c=yield Ve(a,i);if(c)return s=yield je(t,c.files,c.nextLink),s;let l;try{l=t.api(i).middlewareOptions((0,e.prepScopes)("files.read")),n&&l.top(n),s=yield Be(t,l),He()&&a.putValue(i,{files:s.value,nextLink:s._nextLink})}catch(e){}return s||null}))}(o,this.userId,this.itemPath,this.pageSize):this.insightType&&(r=yield function(t,o,r){return Ue(this,void 0,void 0,(function*(){let n,i;"shared"===r?(n="/me/insights/shared",i=`((lastshared/sharedby/id eq '${o}') and (resourceReference/type eq 'microsoft.graph.driveItem'))`):(n=`/users/${o}/insights/${r}`,i="resourceReference/type eq 'microsoft.graph.driveItem'");const s=`${n}?$filter=${i}`;let a;a=e.CacheService.getCache(T,T.stores.insightfileLists);const c=yield Ve(a,s);if(c)return c;const l=["sites.read.all"];let d;try{d=yield t.api(n).filter(i).middlewareOptions((0,e.prepScopes)(...l)).get()}catch(e){}const u=yield $e(t,d,l);return He()&&a.putValue(n,{files:u}),u||null}))}(o,this.userId,this.insightType))),n&&(this.pageIterator=n,this._preloadedFiles=[...this.pageIterator.value],r=this._preloadedFiles.length>=this.pageSize?this._preloadedFiles.splice(0,this.pageSize):this._preloadedFiles.splice(0,this._preloadedFiles.length)),this.fileExtensions&&null!==this.fileExtensions){if(this.pageIterator&&this.pageIterator.value){for(;this.pageIterator.hasNext;)yield Ge(this.pageIterator);r=this.pageIterator.value,this._preloadedFiles=[]}t=r.filter((e=>{for(const t of this.fileExtensions)if(t==this.getFileExtension(e.name))return e}))}t&&t.length>=0?this.files=t:this.files=r}}))}handleItemSelect(e,t){if(this.fireCustomEvent("itemClick",e),t){const e=this.renderRoot.querySelector(".file-list"),o=Array.from(e.children),r=t.target.closest("li"),n=o.indexOf(r);this._focusedItemIndex=n;for(let t=0;t<e.children.length;t++)e.children[t].classList.remove("focused")}}renderNextPage(){return it(this,void 0,void 0,(function*(){const e=this.renderRoot.querySelector("file-list-wrapper");e&&e.animate&&e.animate([{height:"auto",transformOrigin:"top left"},{height:"auto",transformOrigin:"top left"}],{duration:1e3,easing:"ease-in-out",fill:"both"}),this._preloadedFiles.length>0?this.files=[...this.files,...this._preloadedFiles.splice(0,Math.min(this.pageSize,this._preloadedFiles.length))]:this.pageIterator.hasNext&&(yield Ge(this.pageIterator),this.files=this.pageIterator.value),this.requestUpdate()}))}getFileExtension(e){return/(?:\.([^.]+))?$/.exec(e)[1]||""}updateItemBackgroundColor(e,t,o){for(let t=0;t<e.children.length;t++)e.children[t].classList.remove(o);t&&(t.classList.add(o),t.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}))}reload(t=!1){t&&function(){let t;t=e.CacheService.getCache(T,T.stores.fileLists),t.clearStore()}(),this.requestStateUpdate(!0)}};rt([(0,t.Cb)({attribute:"file-list-query"}),nt("design:type",String),nt("design:paramtypes",[String])],st.prototype,"fileListQuery",null),rt([(0,t.Cb)({attribute:"file-queries",converter:(e,t)=>e?e.split(",").map((e=>e.trim())):null}),nt("design:type",Array),nt("design:paramtypes",[Array])],st.prototype,"fileQueries",null),rt([(0,t.Cb)({type:Object}),nt("design:type",Array)],st.prototype,"files",void 0),rt([(0,t.Cb)({attribute:"site-id"}),nt("design:type",String),nt("design:paramtypes",[String])],st.prototype,"siteId",null),rt([(0,t.Cb)({attribute:"drive-id"}),nt("design:type",String),nt("design:paramtypes",[String])],st.prototype,"driveId",null),rt([(0,t.Cb)({attribute:"group-id"}),nt("design:type",String),nt("design:paramtypes",[String])],st.prototype,"groupId",null),rt([(0,t.Cb)({attribute:"item-id"}),nt("design:type",String),nt("design:paramtypes",[String])],st.prototype,"itemId",null),rt([(0,t.Cb)({attribute:"item-path"}),nt("design:type",String),nt("design:paramtypes",[String])],st.prototype,"itemPath",null),rt([(0,t.Cb)({attribute:"user-id"}),nt("design:type",String),nt("design:paramtypes",[String])],st.prototype,"userId",null),rt([(0,t.Cb)({attribute:"insight-type"}),nt("design:type",String),nt("design:paramtypes",[String])],st.prototype,"insightType",null),rt([(0,t.Cb)({attribute:"item-view",converter:e=>e&&0!==e.length?(e=e.toLowerCase(),void 0===ee[e]?ee.threelines:ee[e]):ee.threelines}),nt("design:type",Number)],st.prototype,"itemView",void 0),rt([(0,t.Cb)({attribute:"file-extensions",converter:(e,t)=>e.split(",").map((e=>e.trim()))}),nt("design:type",Array),nt("design:paramtypes",[Array])],st.prototype,"fileExtensions",null),rt([(0,t.Cb)({attribute:"page-size",type:Number}),nt("design:type",Number),nt("design:paramtypes",[Number])],st.prototype,"pageSize",null),rt([(0,t.Cb)({attribute:"hide-more-files-button",type:Boolean}),nt("design:type",Boolean)],st.prototype,"hideMoreFilesButton",void 0),st=rt([(0,t.Mo)("mgt-file-list"),nt("design:paramtypes",[])],st);var at,ct=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},lt=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},dt=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};!function(e){e.json="json",e.image="image"}(at||(at={}));const ut=()=>e.CacheService.config.response.isEnabled&&e.CacheService.config.isEnabled;let pt=class extends e.MgtTemplatedComponent{constructor(){super(...arguments),this.scopes=[],this.version="v1.0",this.type=at.json,this.maxPages=3,this.pollingRate=0,this.cacheEnabled=!1,this.cacheInvalidationPeriod=0,this.isPolling=!1,this.isRefreshing=!1}attributeChangedCallback(e,t,o){super.attributeChangedCallback(e,t,o),this.requestStateUpdate()}refresh(e=!1){this.isRefreshing=!0,this.requestStateUpdate(e),this.isRefreshing=!1}clearState(){this.response=null}render(){if(this.isLoadingState&&!this.isPolling)return this.renderTemplate("loading",null);if(this.error)return this.renderTemplate("error",this.error);if(this.hasTemplate("value")&&this.response&&this.response.value){let e;if(Array.isArray(this.response.value)){let o=null;this.isLoadingState&&!this.isPolling&&(o=this.renderTemplate("loading",null)),e=t.dy`
          ${this.response.value.map((e=>this.renderTemplate("value",e,e.id)))} ${o}
        `}else e=this.renderTemplate("value",this.response);if(this.hasTemplate("default")){const o=this.renderTemplate("default",this.response);return this.templates.value.templateOrder>this.templates.default.templateOrder?t.dy`
            ${o}${e}
          `:t.dy`
            ${e}${o}
          `}return e}return this.response&&this.renderTemplate("default",this.response)||t.dy``}loadState(){return dt(this,void 0,void 0,(function*(){const t=e.Providers.globalProvider;if(this.error=null,t&&t.state===e.ProviderState.SignedIn){if(this.resource){try{let o;const r=`${this.version}${this.resource}`;let n=null;if(this.shouldRetrieveCache()){o=e.CacheService.getCache(w,w.stores.responses);const t=ut()?yield o.getValue(r):null;t&&(this.cacheInvalidationPeriod||e.CacheService.config.response.invalidationPeriod||e.CacheService.config.defaultInvalidationPeriod)>Date.now()-t.timeCached&&(n=JSON.parse(t.response))}if(!n){let i=this.resource,s=!1;this.response&&this.response["@odata.deltaLink"]?(i=this.response["@odata.deltaLink"],s=!0):s=new URL(i,"https://graph.microsoft.com").pathname.endsWith("delta");const a=t.graph.forComponent(this);let c=a.api(i).version(this.version);if(this.scopes&&this.scopes.length&&(c=c.middlewareOptions((0,e.prepScopes)(...this.scopes))),this.type===at.json){if(n=yield c.get(),s&&this.response&&Array.isArray(this.response.value)&&Array.isArray(n.value)&&(n.value=this.response.value.concat(n.value)),this.isPolling||(0,e.equals)(this.response,n)||(this.response=n),n&&Array.isArray(n.value)&&n["@odata.nextLink"]){let e=1,t=n;for(;(e<this.maxPages||this.maxPages<=0||s&&this.pollingRate)&&t&&t["@odata.nextLink"];){e++;const o=t["@odata.nextLink"].split(this.version)[1];t=yield a.client.api(o).version(this.version).get(),t&&t.value&&t.value.length&&(t.value=n.value.concat(t.value),n=t,this.isPolling||(this.response=n))}}}else{if(-1===this.resource.indexOf("/photo/$value"))throw new Error("Only /photo/$value endpoints support the image type");const e=this.resource.replace("/photo/$value",""),t=yield V(a,e,this.scopes);t&&(n={image:t.photo})}this.shouldUpdateCache()&&n&&(o=e.CacheService.getCache(w,w.stores.responses),o.putValue(r,{response:JSON.stringify(n)}))}(0,e.equals)(this.response,n)||(this.response=n)}catch(e){this.error=e}this.response&&(this.error=null,this.pollingRate&&setTimeout((()=>dt(this,void 0,void 0,(function*(){this.isPolling=!0,yield this.loadState(),this.isPolling=!1}))),this.pollingRate))}else this.response=null;this.fireCustomEvent("dataChange",{response:this.response,error:this.error})}}))}shouldRetrieveCache(){return ut()&&this.cacheEnabled&&!(this.isRefreshing||this.isPolling)}shouldUpdateCache(){return ut()&&this.cacheEnabled}};ct([(0,t.Cb)({attribute:"resource",reflect:!0,type:String}),lt("design:type",String)],pt.prototype,"resource",void 0),ct([(0,t.Cb)({attribute:"scopes",converter:(e,t)=>e?e.toLowerCase().split(","):null,reflect:!0}),lt("design:type",Array)],pt.prototype,"scopes",void 0),ct([(0,t.Cb)({attribute:"version",reflect:!0,type:String}),lt("design:type",String)],pt.prototype,"version",void 0),ct([(0,t.Cb)({attribute:"type",reflect:!0,type:at}),lt("design:type",String)],pt.prototype,"type",void 0),ct([(0,t.Cb)({attribute:"max-pages",reflect:!0,type:Number}),lt("design:type",Number)],pt.prototype,"maxPages",void 0),ct([(0,t.Cb)({attribute:"polling-rate",reflect:!0,type:Number}),lt("design:type",Number)],pt.prototype,"pollingRate",void 0),ct([(0,t.Cb)({attribute:"cache-enabled",reflect:!0,type:Boolean}),lt("design:type",Boolean)],pt.prototype,"cacheEnabled",void 0),ct([(0,t.Cb)({attribute:"cache-invalidation-period",reflect:!0,type:Number}),lt("design:type",Number)],pt.prototype,"cacheInvalidationPeriod",void 0),ct([(0,t.Cb)({attribute:!1}),lt("design:type",Object)],pt.prototype,"response",void 0),ct([(0,t.Cb)({attribute:!1}),lt("design:type",Object)],pt.prototype,"error",void 0),pt=ct([(0,t.Mo)("mgt-get")],pt);const ht=[t.iv`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--button-color:#323130;--popup-color:#323130}.mgt-dark{--button-color:#f3f2f1;--popup-color:#f3f2f1}:host,mgt-login{--font-size:14px;--font-weight:600;--width:'100%';--height:'100%';--margin:0;--padding:12px 20px;--popup-command-font-size:12px;--popup-command-margin:16px 0 0;--popup-padding:24px 48px 16px 24px}:host .root,mgt-login .root{position:relative;display:inline-block}:host .login-button,mgt-login .login-button{display:flex;align-items:center;font-family:var(--default-font-family);font-size:var(--font-size);font-weight:var(--font-weight);width:var(--width);height:var(--height);margin:var(--margin);padding:var(--padding);color:var(--button-color,#323130);background-color:var(--button-background-color,transparent);border:none;cursor:pointer;transition:color .3s,background-color .3s}:host .login-button mgt-person,mgt-login .login-button mgt-person{--color-sub1:set-var(button__color, $theme-default, $login)}:host .login-button:hover,mgt-login .login-button:hover{color:var(--button-color--hover,#0078d4);--color:var(--button-color--hover, #0078d4);background-color:var(--button-background-color--hover,var(--background-color--hover,#edebe9));--color-sub1:var(--button-color--hover, #0078d4)}:host .login-button:focus,mgt-login .login-button:focus{outline:0}:host .login-button:disabled,mgt-login .login-button:disabled{opacity:.4;pointer-events:none}:host .login-button.no-click,mgt-login .login-button.no-click{pointer-events:none}:host .login-icon+span,mgt-login .login-icon+span{margin-left:6px}:host .popup,mgt-login .popup{font-family:var(--default-font-family);background-color:var(--popup-background-color,var(--background-color-sub1,#faf9f8));min-width:240px;z-index:1;color:var(--popup-color,#323130)}:host .popup mgt-person,mgt-login .popup mgt-person{--color-sub1:set-var(popup__color, $theme-default, $login)}:host .popup-content,mgt-login .popup-content{display:flex;flex-direction:column;padding:var(--popup-padding)}:host .popup-commands ul,mgt-login .popup-commands ul{list-style-type:none;margin:var(--popup-command-margin);padding:0}:host .popup-command,mgt-login .popup-command{font-family:var(--default-font-family);font-size:var(--popup-command-font-size);font-weight:var(--font-weight);color:#0078d4;background-color:var(--popup-background-color,var(--background-color-sub1,#faf9f8));border:none;padding:0;cursor:pointer;transition:color .3s}:host .popup-command:hover,mgt-login .popup-command:hover{color:#005a9e}[dir=rtl]{--popup-padding:24px 24px 16px 48px}[dir=rtl] mgt-person .details{--details-spacing:0px 12px 0px 0px}[dir=rtl] mgt-person .details.small{--details-spacing:0px 6px 0px 0px}
`],ft={signInLinkSubtitle:"Sign In",signOutLinkSubtitle:"Sign Out"};var gt=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},mt=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},vt=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};let bt=class extends e.MgtTemplatedComponent{constructor(){super(),this._isFlyoutOpen=!1}static get styles(){return ht}get strings(){return ft}get flyout(){return this.renderRoot.querySelector(".flyout")}static get requiredScopes(){return[...new Set(["user.read",...ve.requiredScopes])]}connectedCallback(){super.connectedCallback(),this.addEventListener("click",(e=>e.stopPropagation()))}login(){return vt(this,void 0,void 0,(function*(){if(this.userDetails||!this.fireCustomEvent("loginInitiated"))return;const t=e.Providers.globalProvider;t&&t.login&&(yield t.login(),t.state===e.ProviderState.SignedIn?this.fireCustomEvent("loginCompleted"):this.fireCustomEvent("loginFailed"))}))}logout(){return vt(this,void 0,void 0,(function*(){if(!this.fireCustomEvent("logoutInitiated"))return;const t=e.Providers.globalProvider;t&&t.logout&&(yield t.logout(),this.userDetails=null,this.hideFlyout(),this.fireCustomEvent("logoutCompleted"))}))}render(){return t.dy`
      <div class="root" dir=${this.direction}>
        <div>
          ${this.renderButton()}
        </div>
        ${this.renderFlyout()}
      </div>
    `}loadState(){return vt(this,void 0,void 0,(function*(){const t=e.Providers.globalProvider;t&&!this.userDetails&&(t.state===e.ProviderState.SignedIn?(this.userDetails=yield oe(t.graph.forComponent(this)),this.userDetails.personImage&&(this._image=this.userDetails.personImage),this.fireCustomEvent("loginCompleted")):this.userDetails=null)}))}renderButton(){const e={"login-button":!0,"no-click":this._isFlyoutOpen};return t.dy`
      <button ?disabled="${this.isLoadingState}" @click=${this.onClick} class=${g(e)} role="button">
        ${this.renderButtonContent()}
      </button>
    `}renderFlyout(){return t.dy`
      <mgt-flyout
        class="flyout"
        light-dismiss
        @opened=${()=>this._isFlyoutOpen=!0}
        @closed=${()=>this._isFlyoutOpen=!1}
      >
        <div slot="flyout">
          ${this.renderFlyoutContent()}
        </div>
      </mgt-flyout>
    `}renderFlyoutContent(){if(this.userDetails)return t.dy`
      <div class="popup">
        <div class="popup-content">
          <div>
            ${this.renderFlyoutPersonDetails(this.userDetails,this._image)}
          </div>
          <div class="popup-commands">
            ${this.renderFlyoutCommands()}
          </div>
        </div>
      </div>
    `}renderFlyoutPersonDetails(e,o){return this.renderTemplate("flyout-person-details",{personDetails:e,personImage:o})||t.dy`
        <mgt-person .personDetails=${e} .personImage=${o} .view=${ee.twolines} />
      `}renderFlyoutCommands(){return this.renderTemplate("flyout-commands",{handleSignOut:()=>this.logout()})||t.dy`
        <ul>
          <li>
            <button class="popup-command" @click=${this.logout} aria-label="Sign Out">
              ${this.strings.signOutLinkSubtitle}
            </button>
          </li>
        </ul>
      `}renderButtonContent(){return this.userDetails?this.renderSignedInButtonContent(this.userDetails,this._image):this.renderSignedOutButtonContent()}renderSignedInButtonContent(e,o){return this.renderTemplate("signed-in-button-content",{personDetails:e,personImage:o})||t.dy`
        <mgt-person .personDetails=${this.userDetails} .personImage=${this._image} .view=${ee.oneline} />
      `}clearState(){this.userDetails=null,this._image=null}renderSignedOutButtonContent(){return this.renderTemplate("signed-out-button-content",null)||t.dy`
        <i class="login-icon ms-Icon ms-Icon--Contact"></i>
        <span aria-label="Sign In">
          ${this.strings.signInLinkSubtitle}
        </span>
      `}showFlyout(){const e=this.flyout;e&&e.open()}hideFlyout(){const e=this.flyout;e&&e.close()}onClick(){this.userDetails?this.showFlyout():this.login()}};gt([(0,t.Cb)({attribute:"user-details",type:Object}),mt("design:type",Object)],bt.prototype,"userDetails",void 0),gt([(0,t.Cb)({attribute:!1}),mt("design:type",Boolean)],bt.prototype,"_isFlyoutOpen",void 0),bt=gt([(0,t.Mo)("mgt-login"),mt("design:paramtypes",[])],bt);var yt,kt=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};!function(e){e[e.any=0]="any",e[e.unified=1]="unified",e[e.security=2]="security",e[e.mailenabledsecurity=4]="mailenabledsecurity",e[e.distribution=8]="distribution"}(yt||(yt={}));const wt=()=>e.CacheService.config.groups.invalidationPeriod||e.CacheService.config.defaultInvalidationPeriod,Ct=()=>e.CacheService.config.groups.isEnabled&&e.CacheService.config.isEnabled;function Tt(t,o,r=10,n=yt.any){return kt(this,void 0,void 0,(function*(){let i;const s=o||"*"+n;if(Ct()){i=e.CacheService.getCache(k,k.stores.groupsQuery);const t=yield i.getValue(s);if(t&&wt()>Date.now()-t.timeCached&&t.top>=r)return t.groups.map((e=>JSON.parse(e))).slice(0,r+1)}let a="";if(""!==o&&(a=`(startswith(displayName,'${o}') or startswith(mailNickname,'${o}') or startswith(mail,'${o}'))`),n!==yt.any){const e=[];yt.unified===(n&yt.unified)&&e.push("groupTypes/any(c:c+eq+'Unified')"),yt.security===(n&yt.security)&&e.push("(mailEnabled eq false and securityEnabled eq true)"),yt.mailenabledsecurity===(n&yt.mailenabledsecurity)&&e.push("(mailEnabled eq true and securityEnabled eq true)"),yt.distribution===(n&yt.distribution)&&e.push("(mailEnabled eq true and securityEnabled eq false)"),a+=(""!==o?" and ":"")+e.join(" or ")}const c=yield t.api("groups").filter(a).top(r).middlewareOptions((0,e.prepScopes)("Group.Read.All")).get();return Ct()&&c&&i.putValue(s,{groups:c.value.map((e=>JSON.stringify(e))),top:r}),c?c.value:null}))}const St=[t.iv`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--selected-person-background-color:#f3f2f1}.mgt-dark{--selected-person-background-color:#4f4f4f}:host{border-radius:2px;font-family:var(--default-font-family);height:38px;display:contents;height:100%;overflow:hidden}:host .root,mgt-people-picker .root{display:block}.people-picker{background-color:var(--input-background-color,#fff);border-top:var(--input-border-top,2px solid #605e5c);border-right:var(--input-border-right,2px solid #605e5c);border-bottom:var(--input-border-bottom,2px solid #605e5c);border-left:var(--input-border-left,2px solid #605e5c);border:var(--input-border,2px solid #605e5c);padding:6px 0 0}.people-picker:hover{border-color:var(--input-border-color--hover,#323130)}.people-picker.focused{border-color:var(--input-border-color--focus,#0078d4)}.people-picker.disabled{pointer-events:none}.people-picker .selected-list{flex:1 0 auto;display:flex;flex-wrap:wrap;vertical-align:middle;margin:0 8px;list-style-type:none;font-style:normal;font-weight:400;overflow:hidden}.people-picker .selected-list__person-wrapper{display:flex;margin:0 5px 6px 0;align-items:center;border-radius:15px;height:24px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;position:relative;background-color:var(--selected-person-background-color,#f3f2f1)}.people-picker .selected-list__person-wrapper__person{overflow:hidden;min-width:100%;--avatar-size-s:24px;margin-left:0;--color:var(--color-sub1, #323130);color:var(--color-sub1,#323130);padding-bottom:1px;padding-right:4px}.people-picker .selected-list__person-wrapper__overflow{margin-left:25px}.people-picker .selected-list__person-wrapper__overflow__gradient{content:'';position:absolute;margin-right:23px;width:10px;height:90%;top:0;right:0;background-image:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:-moz-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:-o-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%)}.people-picker .selected-list__person-wrapper__overflow__close-icon{height:100%;top:0;margin-top:4px;margin-left:10px;position:absolute;line-height:normal;font-family:FabricMDL2Icons;padding-right:7px;cursor:pointer;right:0;background-color:var(--selected-person-background-color,#f3f2f1);color:var(--color-sub1,#323130)}.people-picker .selected-list .flyout .search-box{margin:1px 2px 8px}.people-picker .selected-list .flyout .search-box.search-box-start{line-height:normal;margin-inline-start:0;margin-inline-end:0}.people-picker .selected-list .flyout .search-box__input{box-sizing:border-box;border-width:0;border-style:none;width:100%;display:flex;flex:1 0 auto;font-family:var(--default-font-family);position:relative;line-height:normal;outline:0;font-style:normal;font-weight:400;font-size:14px;line-height:19px;background-color:var(--input-background-color,#fff);color:var(--color-sub1,#323130)}.people-picker .selected-list .flyout .search-box__input::placeholder{color:var(--placeholder-color,#605e5c)}.people-picker .selected-list .flyout .flyout-root{padding:0;border-radius:2px;min-width:260px;overflow-y:auto;text-align:left;list-style-type:none;background-color:var(--dropdown-background-color,var(--list-background-color,#fff));max-height:var(--mgt-flyout-set-height,unset)}.people-picker .selected-list .flyout .flyout-root li{cursor:pointer}.people-picker .selected-list .flyout .flyout-root .people-list .list-person{display:flex;flex-direction:row;align-items:center;padding:12px;font-style:normal;font-weight:600;font-size:14px}.people-picker .selected-list .flyout .flyout-root .people-list .list-person.focused,.people-picker .selected-list .flyout .flyout-root .people-list .list-person:hover{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.people-picker .selected-list .flyout .flyout-root .people-list .list-person .people-person-text-area{margin-left:13px;flex:1 1 0;max-height:40px;overflow:hidden;color:var(--color-sub1,#323130)}.people-picker .selected-list .flyout .flyout-root .people-list .list-person .people-person-text-area .people-person-text{font-size:14px;font-weight:400;margin:0;padding:0}.people-picker .selected-list .flyout .flyout-root .people-list .list-person .people-person-text-area .people-person-text.highlight-search-text{font-weight:700}mgt-person{--avatar-size-s:32px;margin-left:12px;cursor:default}:host .loading-text,:host .search-error-text,mgt-people-picker .loading-text,mgt-people-picker .search-error-text{font-family:var(--default-font-family);font-style:normal;font-weight:600;font-size:14px;line-height:19px;text-align:center;margin-left:50px;margin-right:50px;color:#0078d4}:host .message-parent,mgt-people-picker .message-parent{padding:2px;margin-top:30px;margin-bottom:30px;display:flex;flex-direction:column;align-items:center;justify-content:center;vertical-align:middle}:host .people-person-job-title,mgt-people-picker .people-person-job-title{flex:100%;order:3;font-weight:400;font-size:12px}:host .people-person-job-title.uppercase,mgt-people-picker .people-person-job-title.uppercase{text-transform:uppercase}mgt-flyout{flex:1 0 auto}[dir=rtl] mgt-person{margin:0 12px 0 0}[dir=rtl] .selected-list{margin-right:8px!important}[dir=rtl] .selected-list__person-wrapper{margin-left:6px!important}[dir=rtl] .selected-list__person-wrapper__person{margin-right:0!important;margin-left:4px!important}[dir=rtl] .selected-list__person-wrapper__overflow__gradient{right:auto!important;position:absolute!important;margin-right:0!important;width:10px!important;height:90%;top:0}[dir=rtl] .selected-list__person-wrapper__overflow__close-icon{right:auto!important;margin-left:5px!important;left:0!important}[dir=rtl] .people-person-text-area{margin-right:13px;margin-left:0!important}[dir=rtl] .flyout-root{text-align:right!important}
`],_t={inputPlaceholderText:"Start typing a name",noResultsFound:"We didn't find any matches.",loadingMessage:"Loading..."};var It=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},xt=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Et=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};let At=class extends e.MgtTemplatedComponent{constructor(){super(),this._type=S.person,this._groupType=yt.any,this._userType=_.any,this._arrowSelectionCount=0,this._isFocused=!1,this.clearState(),this._showLoading=!0,this.showMax=6,this.disabled=!1,this.allowAnyEmail=!1}static get styles(){return St}get strings(){return _t}get flyout(){return this.renderRoot.querySelector(".flyout")}get input(){return this.renderRoot.querySelector(".search-box__input")}get groupId(){return this._groupId}set groupId(e){this._groupId!==e&&(this._groupId=e,this.requestStateUpdate(!0))}get type(){return this._type}set type(e){this._type!==e&&(this._type=e,this.requestStateUpdate(!0))}get groupType(){return this._groupType}set groupType(e){this._groupType!==e&&(this._groupType=e,this.requestStateUpdate(!0))}get userType(){return this._userType}set userType(e){this._userType!==e&&(this._userType=e,this.requestStateUpdate(!0))}static get requiredScopes(){return[...new Set(["user.read.all","people.read","group.read.all","user.readbasic.all",...ve.requiredScopes])]}focus(e){this.gainedFocus(),this.input&&(this.input.focus(e),this.input.select())}selectUsersById(t){return Et(this,void 0,void 0,(function*(){const o=e.Providers.globalProvider,r=e.Providers.globalProvider.graph;if(o&&o.state===e.ProviderState.SignedIn)for(const e in t)try{const o=yield F(r,t[e]);this.addPerson(o)}catch(e){}}))}render(){const e=this.renderTemplate("default",{people:this._foundPeople});if(e)return e;const o=this.renderSelectedPeople(this.selectedPeople),r=this.renderInput(),n=this.renderFlyout(r),i={focused:this._isFocused,"people-picker":!0,disabled:this.disabled};return t.dy`
      <div dir=${this.direction} class=${g(i)} @click=${e=>this.focus(e)}>
        <div class="selected-list">
          ${o} ${n}
        </div>
      </div>
    `}clearState(){this._groupId=null,this.selectedPeople=[],this.userInput=""}requestStateUpdate(e){return e&&(this._groupPeople=null,this._foundPeople=null,this.selectedPeople=[]),super.requestStateUpdate(e)}renderInput(){const e=!!this.selectedPeople.length,o=this.disabled?this.placeholder||"":this.placeholder?this.placeholder:this.strings.inputPlaceholderText,r={"search-box":!0,"search-box-start":e};return"single"===(this.selectionMode?this.selectionMode:"multiple")&&this.selectedPeople.length>=1?(this.lostFocus(),null):t.dy`
      <div class="${g(r)}">
        <input
          id="people-picker-input"
          class="search-box__input"
          type="text"
          placeholder=${o}
          label="people-picker-input"
          aria-label="people-picker-input"
          role="input"
          @keydown="${this.onUserKeyDown}"
          @keyup="${this.onUserKeyUp}"
          @blur=${this.lostFocus}
          @click=${this.handleFlyout}
          ?disabled=${this.disabled}
        />
      </div>
    `}renderSelectedPeople(e){return e=e||this.selectedPeople,this.selectedPeople&&this.selectedPeople.length?t.dy`
      ${e.slice(0,e.length).map((e=>t.dy`
            <div class="selected-list__person-wrapper">
              ${this.renderTemplate("selected-person",{person:e},`selected-${e.id?e.id:e.displayName}`)||this.renderSelectedPerson(e)}

              <div class="selected-list__person-wrapper__overflow">
                <div class="selected-list__person-wrapper__overflow__gradient"></div>
                <div
                  class="selected-list__person-wrapper__overflow__close-icon"
                  @click="${t=>this.removePerson(e,t)}"
                >
                  \uE711
                </div>
              </div>
            </div>
          `))}
    `:null}renderFlyout(e){return t.dy`
      <mgt-flyout light-dismiss class="flyout">
        ${e}
        <div slot="flyout" class="flyout-root" @wheel=${e=>this.handleSectionScroll(e)}>
          ${this.renderFlyoutContent()}
        </div>
      </mgt-flyout>
    `}renderFlyoutContent(){if(this.isLoadingState||this._showLoading)return this.renderLoading();let e=this._foundPeople;if(!e||0===e.length||0===this.showMax)return this.renderNoData();for(const t of e)t.isFocused=!1;return e=e.slice(0,this.showMax),e[0].isFocused=!0,this.renderSearchResults(e)}renderLoading(){return this.renderTemplate("loading",null)||t.dy`
        <div class="message-parent">
          <mgt-spinner></mgt-spinner>
          <div label="loading-text" aria-label="loading" class="loading-text">
            ${this.strings.loadingMessage}
          </div>
        </div>
      `}renderNoData(){if(this._isFocused)return this.renderTemplate("error",null)||this.renderTemplate("no-data",null)||t.dy`
        <div class="message-parent">
          <div label="search-error-text" aria-label="We didn't find any matches." class="search-error-text">
            ${this.strings.noResultsFound}
          </div>
        </div>
      `}renderSearchResults(e){return e=e||this._foundPeople,t.dy`
      <div class="people-list">
        ${Ie(e,(e=>e.id),(e=>{const o={focused:e.isFocused,"list-person":!0};return t.dy`
              <li class="${g(o)}" @click="${t=>this.onPersonClick(e)}">
                ${this.renderPersonResult(e)}
              </li>
            `}))}
      </div>
    `}renderPersonResult(e){const o=e,r=o.jobTitle||o.mail,n={"people-person-job-title":!0,uppercase:!!o.jobTitle};return this.renderTemplate("person",{person:e},e.id)||t.dy`
        <mgt-person .personDetails=${e} .fetchImage=${!0}></mgt-person>
        <div class="people-person-text-area" id="${e.displayName}">
          ${this.renderHighlightText(e)}
          <span class="${g(n)}">${r}</span>
        </div>
      `}renderSelectedPerson(e){return t.dy`
      <mgt-person
        class="selected-list__person-wrapper__person"
        .personDetails=${e}
        .fetchImage=${!0}
        .view=${ee.oneline}
        .personCardInteraction=${le.click}
      ></mgt-person>
    `}loadState(){return Et(this,void 0,void 0,(function*(){let t=this.people;const o=this.userInput.toLowerCase(),r=e.Providers.globalProvider;if(!t&&r&&r.state===e.ProviderState.SignedIn){const n=r.graph.forComponent(this);if(!o.length&&this._isFocused)if(this.defaultPeople)t=this.defaultPeople;else{if(this.groupId){if(null===this._groupPeople)try{this._groupPeople=yield $(n,null,this.groupId,this.showMax,this.type,this.transitiveSearch)}catch(e){this._groupPeople=[]}t=this._groupPeople||[]}else this.type===S.person||this.type===S.any?t=yield P(n,this.userType):this.type===S.group&&(t=(yield Tt(n,"",this.showMax,this.groupType))||[]);this.defaultPeople=t}if(this._showLoading=!1,!this.defaultSelectedUserIds&&!this.defaultSelectedGroupIds||this.selectedPeople.length||this.defaultSelectedUsers||(this.defaultSelectedUsers=yield H(n,this.defaultSelectedUserIds),this.defaultSelectedGroups=yield function(t,o){return kt(this,void 0,void 0,(function*(){if(!o||0===o.length)return[];const r=t.createBatch(),n={},i=[];let s;Ct()&&(s=e.CacheService.getCache(k,k.stores.groups));for(const e of o){n[e]=null;let t=null;Ct()&&(t=yield s.getValue(e)),t&&wt()>Date.now()-t.timeCached?n[e]=t.group?JSON.parse(t.group):null:""!==e&&(r.get(e,`/groups/${e}`,["Group.Read.All"]),i.push(e))}try{const e=yield r.executeAll();for(const t of o){const o=e.get(t);o&&o.content&&(n[t]=o.content,Ct()&&s.putValue(t,{group:JSON.stringify(o.content)}))}return Promise.all(Object.values(n))}catch(r){try{return o.filter((e=>i.includes(e))).forEach((o=>n[o]=function(t,o,r){return kt(this,void 0,void 0,(function*(){let r;if(Ct()){r=e.CacheService.getCache(k,k.stores.groups);const t=yield r.getValue(o);if(t&&wt()>Date.now()-t.timeCached){const e=t.group?JSON.parse(t.group):null,o=null;if(!o||o.length<=1)return e}}let n=`/groups/${o}`;const i=yield t.api(n).middlewareOptions((0,e.prepScopes)("Group.Read.All")).get();return Ct()&&r.putValue(o,{group:JSON.stringify(i)}),i}))}(t,o))),Ct()&&o.filter((e=>i.includes(e))).forEach((e=>kt(this,void 0,void 0,(function*(){return s.putValue(e,{group:JSON.stringify(yield n[e])})})))),Promise.all(Object.values(n))}catch(e){return[]}}}))}(n,this.defaultSelectedGroupIds),this.selectedPeople=[...this.defaultSelectedUsers,...this.defaultSelectedGroups],this.requestUpdate(),this.fireCustomEvent("selectionChanged",this.selectedPeople)),o)if(t=[],this.groupId)t=(yield $(n,o,this.groupId,this.showMax,this.type,this.transitiveSearch))||[];else{if(this.type===S.person||this.type===S.any){try{t=(yield A(n,o,this.showMax,this.userType))||[]}catch(e){}if(t.length<this.showMax&&this.userType!==_.contact)try{const e=(yield q(n,o,this.showMax))||[],r=new Set(t.map((e=>e.id)));for(const o of e)r.has(o.id)||t.push(o)}catch(e){}}if((this.type===S.group||this.type===S.any)&&t.length<this.showMax){let e=[];try{e=(yield Tt(n,o,this.showMax,this.groupType))||[],t=t.concat(e)}catch(e){}}}}this._foundPeople=this.filterPeople(t)}))}hideFlyout(){const e=this.flyout;e&&e.close()}showFlyout(){const e=this.flyout;e&&e.open()}removePerson(e,t){t.stopPropagation();const o=this.selectedPeople.filter((t=>!e.id&&t.displayName?t.displayName!==e.displayName:t.id!==e.id));this.selectedPeople=o,this.loadState(),this.fireCustomEvent("selectionChanged",this.selectedPeople)}addPerson(e){e&&(this.clearInput(),0===this.selectedPeople.filter((t=>!e.id&&t.displayName?t.displayName===e.displayName:t.id===e.id)).length&&(this.selectedPeople=[...this.selectedPeople,e],this.fireCustomEvent("selectionChanged",this.selectedPeople),this.loadState(),this._foundPeople=[]))}clearInput(){this.input.value="",this.userInput=""}handleFlyout(){const e=this.filterPeople(this.defaultPeople);let t=!0;e&&0===e.length&&(t=!1),t&&window.requestAnimationFrame((()=>{this.showFlyout()}))}gainedFocus(){this._isFocused=!0,this.input&&this.input.focus(),this._showLoading=!0,this.loadState()}lostFocus(){this._isFocused=!1,this.requestUpdate()}renderHighlightText(e){let o="",r="",n="";const i=e.displayName,s=i.toLowerCase().indexOf(this.userInput.toLowerCase());if(-1!==s){const e=this.userInput.length;0===s?(o="",n=i.slice(0,e),r=i.slice(e,i.length)):s===i.length?(o=i.slice(0,s),n=i.slice(s,i.length),r=""):(o=i.slice(0,s),n=i.slice(s,s+e),r=i.slice(s+e,i.length))}else o=e.displayName;return t.dy`
      <div>
        <span class="people-person-text">${o}</span
        ><span class="people-person-text highlight-search-text">${n}</span
        ><span class="people-person-text">${r}</span>
      </div>
    `}onUserKeyUp(e){if(40===e.keyCode||39===e.keyCode||38===e.keyCode||37===e.keyCode)return;"Tab"!==e.code||this.flyout.isOpen||this.allowAnyEmail&&this.gainedFocus(),e.shiftKey&&this.gainedFocus();const t=e.target;if("Escape"===e.code)this.clearInput(),this._foundPeople=[];else if("Backspace"===e.code&&0===this.userInput.length&&this.selectedPeople.length>0)this.selectedPeople=this.selectedPeople.splice(0,this.selectedPeople.length-1),this.loadState(),this.hideFlyout(),this.fireCustomEvent("selectionChanged",this.selectedPeople);else{if("Comma"===e.code||"Semicolon"===e.code)return void(this.allowAnyEmail&&(e.preventDefault(),e.stopPropagation()));this.userInput=t.value,u(this.userInput)||this.handleUserSearch()}}handleAnyEmail(){if(this._showLoading=!1,this._arrowSelectionCount=0,u(this.userInput)){const e={mail:this.userInput,displayName:this.userInput};this.addPerson(e)}this.hideFlyout(),this.input&&(this.input.focus(),this._isFocused=!0)}onPersonClick(e){this.addPerson(e),this.hideFlyout(),this.input&&(this.input.focus(),this._isFocused=!0,this.hideFlyout(),this.selectionMode)}handleUserSearch(){this._debouncedSearch||(this._debouncedSearch=l((()=>Et(this,void 0,void 0,(function*(){const e=setTimeout((()=>{this._showLoading=!0}),50);yield this.loadState(),clearTimeout(e),this._showLoading=!1,this.showFlyout(),this._arrowSelectionCount=0}))),400)),this._debouncedSearch()}onUserKeyDown(e){if(!this.flyout.isOpen)return;40!==e.keyCode&&38!==e.keyCode||(this.handleArrowSelection(e),this.input.value.length>0&&e.preventDefault());const t=e.target;if("Tab"===e.code||"Enter"===e.code){if(!e.shiftKey&&this._foundPeople){e.preventDefault(),e.stopPropagation(),this._foundPeople.length&&this.fireCustomEvent("blur");const t=this._foundPeople[this._arrowSelectionCount];t?this.addPerson(t):this.allowAnyEmail&&this.handleAnyEmail()}this.hideFlyout(),e.target.value=""}else"Comma"!==e.code&&"Semicolon"!==e.code||this.allowAnyEmail&&(e.preventDefault(),e.stopPropagation(),this.userInput=t.value,this.handleAnyEmail())}handleArrowSelection(e){const t=this.renderRoot.querySelector(".people-list");if(t&&t.children.length){38===e.keyCode&&(this._arrowSelectionCount=(this._arrowSelectionCount-1+t.children.length)%t.children.length),40===e.keyCode&&(this._arrowSelectionCount=(this._arrowSelectionCount+1)%t.children.length);for(let e=0;e<t.children.length;e++)t.children[e].classList.remove("focused");const o=t.children[this._arrowSelectionCount];o&&(o.classList.add("focused"),o.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}))}}filterPeople(e){if(e){const t=this.selectedPeople.map((e=>e.id?e.id:e.displayName));return e.filter((e=>e.id?-1===t.indexOf(e.id):-1===t.indexOf(e.displayName)))}}handleSectionScroll(e){const t=this.renderRoot.querySelector(".flyout-root");t&&(e.deltaY<0&&0===t.scrollTop||e.deltaY>0&&t.clientHeight+t.scrollTop>=t.scrollHeight-1||e.stopPropagation())}};It([(0,t.Cb)({attribute:"group-id"}),xt("design:type",String),xt("design:paramtypes",[Object])],At.prototype,"groupId",null),It([(0,t.Cb)({attribute:"type",converter:(e,t)=>(e=e.toLowerCase())&&0!==e.length?void 0===S[e]?S.any:S[e]:S.any}),xt("design:type",Object),xt("design:paramtypes",[Object])],At.prototype,"type",null),It([(0,t.Cb)({attribute:"group-type",converter:(e,t)=>{if(!e||0===e.length)return yt.any;const o=e.split(","),r=[];for(let e of o)e=e.trim(),void 0!==yt[e]&&r.push(yt[e]);return 0===r.length?yt.any:r.reduce(((e,t)=>e|t))}}),xt("design:type",Number),xt("design:paramtypes",[Object])],At.prototype,"groupType",null),It([(0,t.Cb)({attribute:"user-type",converter:(e,t)=>(e=e.toLowerCase())&&0!==e.length?void 0===_[e]?_.any:_[e]:_.any}),xt("design:type",String),xt("design:paramtypes",[Object])],At.prototype,"userType",null),It([(0,t.Cb)({attribute:"transitive-search",type:Boolean}),xt("design:type",Boolean)],At.prototype,"transitiveSearch",void 0),It([(0,t.Cb)({attribute:"people",type:Object}),xt("design:type",Array)],At.prototype,"people",void 0),It([(0,t.Cb)({attribute:"show-max",type:Number}),xt("design:type",Number)],At.prototype,"showMax",void 0),It([(0,t.Cb)({attribute:"selected-people",type:Array}),xt("design:type",Array)],At.prototype,"selectedPeople",void 0),It([(0,t.Cb)({attribute:"default-selected-user-ids",converter:e=>e.split(",").map((e=>e.trim())),type:String}),xt("design:type",Array)],At.prototype,"defaultSelectedUserIds",void 0),It([(0,t.Cb)({attribute:"default-selected-group-ids",converter:e=>e.split(",").map((e=>e.trim())),type:String}),xt("design:type",Array)],At.prototype,"defaultSelectedGroupIds",void 0),It([(0,t.Cb)({attribute:"placeholder",type:String}),xt("design:type",String)],At.prototype,"placeholder",void 0),It([(0,t.Cb)({attribute:"disabled",type:Boolean}),xt("design:type",Boolean)],At.prototype,"disabled",void 0),It([(0,t.Cb)({attribute:"allow-any-email",type:Boolean}),xt("design:type",Boolean)],At.prototype,"allowAnyEmail",void 0),It([(0,t.Cb)({attribute:"selection-mode",type:String}),xt("design:type",String)],At.prototype,"selectionMode",void 0),It([(0,t.Cb)({attribute:!1}),xt("design:type",Boolean)],At.prototype,"_showLoading",void 0),It([(0,t.sz)(),xt("design:type",Object)],At.prototype,"_isFocused",void 0),It([(0,t.sz)(),xt("design:type",Array)],At.prototype,"_foundPeople",void 0),At=It([(0,t.Mo)("mgt-people-picker"),xt("design:paramtypes",[])],At);var Pt=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const Rt="businessPhones,companyName,department,displayName,givenName,jobTitle,mail,mobilePhone,officeLocation,preferredLanguage,surname,userPrincipalName,id";const Ot=[t.iv`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--person-card-details-item-color:#201f1e}.mgt-dark{--person-card-details-item-color:#faf9f8}:host{background:var(--person-card-background-color,var(--background-color-sub1,#faf9f8));width:var(--mgt-flyout-set-width,340px);font-family:var(--default-font-family);overflow:hidden;user-select:none;box-shadow:var(--box-shadow,0 3.2px 7.2px 0 rgba(0,0,0,.132));border:1px solid var(--background-color-sub1,#faf9f8)}:host .nav{height:0;position:relative;z-index:100}:host .nav .nav__back{padding:8px;height:32px;width:32px;align-items:center;justify-content:center}:host .nav .nav__back svg{fill:#0078d4}:host .nav .nav__back:hover{cursor:pointer}:host .nav .nav__back:hover svg{fill:#000}:host .person-details-container{display:flex;flex-direction:column;width:calc(var(--mgt-flyout-set-width,340px) - 40px);padding:20px}:host .person-details-container .person-image{--presence-background-color:var(--person-card-background-color, var(--background-color-sub1, #faf9f8));--presence-icon-color:var(--person-card-background-color, var(--background-color-sub1, #faf9f8));--avatar-size:75px;--font-size:var(--person-card-display-name-font-size, 20px);--color:var(--person-card-display-name-color, var(--color-sub1, #323130));--line2-font-size:var(--person-card-title-font-size, 14px);--line2-color:var(--person-card-title-color);--line3-font-size:var(--person-card-subtitle-font-size, 12px);--line3-color:var(--person-card-subtitle-color)}:host .person-details-container .base-icons{display:flex;-webkit-align-items:center;align-items:center;max-width:120px;margin-top:16px}:host .person-details-container .base-icons .icon{display:flex;align-items:center;cursor:pointer;font-size:12px;white-space:nowrap}:host .person-details-container .base-icons .icon:not(:last-child){margin-right:20px}:host .person-details-container .base-icons .icon svg{fill:var(--icon-color,#605e5c)}:host .person-details-container .base-icons .icon span{margin-left:8px;color:#0078d4}:host .person-details-container .base-icons .icon:hover{color:#005a9e}:host .expanded-details-container{display:flex;flex-direction:column;position:relative}:host .expanded-details-container .expanded-details-button{display:flex;justify-content:center;align-items:center;height:28px;background:var(--person-card-background-color,var(--background-color-sub1,#faf9f8));border-top:1px solid var(--line-seperator-color,#edebe9)}:host .expanded-details-container .expanded-details-button .expanded-details-svg{margin-bottom:3px}:host .expanded-details-container .expanded-details-button:hover{background-color:var(--background-color--hover,#edebe9)}:host .expanded-details-container .expanded-details-info{padding:18px;display:flex;flex-direction:column}:host .expanded-details-container .expanded-details-info .contact-text{margin:0 0 24px 0;font-weight:600;font-size:var(--person-card-details-title-font-size,14px);color:var(--person-card-details-title-color,var(--color,#000))}:host .expanded-details-container .expanded-details-info .icons{line-height:normal;font-style:normal;font-weight:400;font-size:var(--person-card-details-item-font-size,15px);color:var(--person-card-details-item-color,#201f1e);text-align:left}:host .expanded-details-container .expanded-details-info .icons .details-icon{margin:0 0 10px 0;display:flex;flex-direction:row;align-items:center}:host .expanded-details-container .expanded-details-info .data{display:block;margin:0 0 0 10px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;width:280px}:host .expanded-details-container .expanded-details-info .normal-subtitle{padding-top:2px}:host .expanded-details-container .expanded-details-info .link-subtitle{color:#0078d4;cursor:pointer}:host .expanded-details-container .expanded-details-info .link-subtitle:hover{opacity:.6}:host .expanded-details-container .section-divider{width:96%;min-height:1px;background:var(--line-seperator-color,#edebe9);align-self:center}:host .section-nav{display:flex;padding:0 14px;border-bottom:1px solid var(--tab-line-color,#edebe9)}:host .section-nav .section-nav__icon{all:initial;box-sizing:border-box;width:48px;padding:12px;display:flex;align-items:center;justify-content:center;border-bottom:2px solid transparent;margin-bottom:-1px;cursor:pointer}:host .section-nav .section-nav__icon svg{width:20px;height:20px;fill:var(--icon-color,#605e5c)}:host .section-nav .section-nav__icon:hover{background:var(--tab-background-color--hover,#edebe9);border-color:var(--tab-line-color--hover,#979593)}:host .section-nav .section-nav__icon.active{border-color:#0078d4}:host .section-nav .section-nav__icon.active svg{fill:#0078d4}:host .loading{margin:40px 20px;display:flex;justify-content:center;height:360px}:host .section-host{max-height:360px;min-height:360px;overflow-y:auto;overflow-x:hidden}:host .quick-message{display:flex;flex-direction:row;border-bottom:1px solid var(--tab-line-color,#edebe9);padding:12px 10px 8px 10px}:host .quick-message .quick-message__input{flex-grow:1;padding-left:8px;border:none;border-radius:2px;color:var(--color-sub1,#323130);background-color:var(--background-color-sub2,#f3f2f1)}:host .quick-message .quick-message__send{all:initial;height:32px;width:32px;display:flex;align-items:center;justify-content:center}:host .quick-message .quick-message__send svg{fill:var(--color-sub2,#797775);height:18px;width:18px}:host .quick-message .quick-message__send:hover svg{fill:var(--color-sub1,#323130)}:host .sections .section{padding:14px 0;display:flex;flex-direction:column;position:relative}:host .sections .section:not(:last-child):after{position:absolute;content:'';width:90%;transform:translateX(-50%);border-bottom:1px solid var(--tab-line-color,#edebe9);left:50%;bottom:0}:host .sections .section .section__header{display:flex;flex-direction:row;padding:0 20px}:host .sections .section .section__title{flex-grow:1;color:var(--title-color-subtitle,#323130);font-size:14px;font-weight:600}:host .sections .section .section__show-more{color:#0078d4;font-size:12px;font-weight:600;align-self:center}:host .sections .section .section__show-more:hover{cursor:pointer;color:#005a9e}:host .sections .section .section__content{margin-top:14px}:host .sections .section .additional-details{padding:0 20px}[dir=rtl] .base-icons span{margin-right:8px}[dir=rtl] .nav__back{width:20px!important;-moz-transform:scaleX(-1);-o-transform:scaleX(-1);-webkit-transform:scaleX(-1);transform:scaleX(-1);filter:FlipH;-ms-filter:FlipH}
`];var Nt=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class Dt extends e.MgtTemplatedComponent{constructor(){super(),this._isCompact=!1,this._personDetails=null}get personDetails(){return this._personDetails}set personDetails(e){this._personDetails!==e&&(this._personDetails=e,this.requestStateUpdate())}get isCompact(){return this._isCompact}asCompactView(){return this._isCompact=!0,this.requestUpdate(),this}asFullView(){return this._isCompact=!1,this.requestUpdate(),this}clearState(){this._isCompact=!1,this._personDetails=null}render(){return this.isCompact?this.renderCompactView():this.renderFullView()}renderLoading(){return t.dy`
      <div class="loading">
        <mgt-spinner></mgt-spinner>
      </div>
    `}renderNoData(){return t.dy`
      <div class="no-data">No data</div>
    `}navigateCard(e){let t=this.parentNode;for(;t;)if(t=t.parentNode,t&&t.host&&"MGT-PERSON-CARD"===t.host.tagName){t=t.host;break}t.navigate(e)}}!function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);i>3&&s&&Object.defineProperty(t,o,s)}([(0,t.Cb)({attribute:"person-details",type:Object}),Nt("design:type",Object),Nt("design:paramtypes",[Object])],Dt.prototype,"personDetails",null);const Lt=[t.iv`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root .part{display:grid;grid-template-columns:auto 1fr auto}:host .root .part .part__icon{display:flex;min-width:20px;width:20px;height:20px;align-items:center;justify-content:center;margin-left:20px;margin-top:10px;line-height:20px}:host .root .part .part__details{margin:10px 14px;overflow:hidden}:host .root .part .part__details .part__title{font-size:12px;color:var(--title-color-sub2,#797775);line-height:20px}:host .root .part .part__details .part__value{grid-column:2;color:var(--color-sub1,#323130);font-size:14px;font-weight:400}:host .root .part .part__details .part__value .part__link{color:#0078d4;font-family:var(--default-font-family);font-size:14px;cursor:pointer;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:100%;display:inline-block}:host .root .part .part__details .part__value .part__link:hover{color:#004578}:host .root .part .part__copy{width:32px;height:100%;background-color:var(--background-color-sub2,#f3f2f1);visibility:hidden;display:flex;align-items:center;justify-content:center}:host .root .part .part__copy svg{fill:var(--color-sub1,#323130);cursor:pointer}:host .root .part:hover{background-color:var(--background-color--hover,#edebe9);cursor:pointer}:host .root .part:hover .part__copy{visibility:visible}:host .root.compact{padding:0}:host .root.compact .part{height:30px;align-items:center}:host .root.compact .part__details{margin:0}:host .root.compact .part__title{display:none}:host .root.compact .part__icon{margin-top:0;margin-right:6px}[dir=rtl] .part__link.phone{text-align:right;direction:ltr}[dir=rtl] .part__icon{margin:10px 20px 0 0!important}[dir=rtl].compact .part__icon{margin-left:6px!important;margin-top:0!important}
`],Ut={contactSectionTitle:"Contact"};let Mt=class extends Dt{constructor(e){super(),this._contactParts={email:{icon:re(te.Email,"#929292"),onClick:()=>this.sendEmail(),showCompact:!0,title:"Email"},chat:{icon:re(te.Chat,"#929292"),onClick:()=>this.sendChat(),showCompact:!1,title:"Teams"},businessPhone:{icon:re(te.CellPhone,"#929292"),onClick:()=>this.sendCall(),showCompact:!0,title:"Business Phone"},cellPhone:{icon:re(te.CellPhone,"#929292"),onClick:()=>this.sendCall(),showCompact:!0,title:"Mobile Phone"},department:{icon:re(te.Department,"#929292"),showCompact:!1,title:"Department"},title:{icon:re(te.Person,"#929292"),showCompact:!1,title:"Title"},officeLocation:{icon:re(te.OfficeLocation,"#929292"),showCompact:!0,title:"Office Location"}},this._person=e,this._contactParts.email.value=R(this._person),this._contactParts.chat.value=this._person.userPrincipalName,this._contactParts.cellPhone.value=this._person.mobilePhone,this._contactParts.department.value=this._person.department,this._contactParts.title.value=this._person.jobTitle,this._contactParts.officeLocation.value=this._person.officeLocation,this._person.businessPhones&&this._person.businessPhones.length&&(this._contactParts.businessPhone.value=this._person.businessPhones[0])}static get styles(){return Lt}get strings(){return Ut}get hasData(){return!!this._contactParts&&!!Object.values(this._contactParts).filter((e=>!!e.value)).length}get displayName(){return this.strings.contactSectionTitle}renderIcon(){return re(te.Contact)}clearState(){super.clearState();for(const e of Object.keys(this._contactParts))this._contactParts[e].value=null}renderCompactView(){let e;if(!this.hasData)return null;const o=Object.values(this._contactParts).filter((e=>!!e.value));let r=Object.values(o).filter((e=>!!e.value&&e.showCompact));return r&&r.length||(r=Object.values(o).slice(0,2)),e=t.dy`
      ${r.map((e=>this.renderContactPart(e)))}
    `,t.dy`
      <div class="root compact" dir=${this.direction}>
        ${e}
      </div>
    `}renderFullView(){let e;if(this.hasData){const o=Object.values(this._contactParts).filter((e=>!!e.value));e=t.dy`
        ${o.map((e=>this.renderContactPart(e)))}
      `}return t.dy`
      <div class="root" dir=${this.direction}>
        <div class="title">${this.displayName}</div>
        ${e}
      </div>
    `}renderContactPart(e){let o=!1;"Mobile Phone"!==e.title&&"Business Phone"!==e.title||(o=!0);const r={part__link:!0,phone:o},n=e.onClick?t.dy`
          <span class=${g(r)} @click=${t=>e.onClick(t)}>${e.value}</span>
        `:t.dy`
          ${e.value}
        `;return t.dy`
      <div class="part" @click=${t=>this.handlePartClick(t,e.value)}>
        <div class="part__icon">${e.icon}</div>
        <div class="part__details">
          <div class="part__title">${e.title}</div>
          <div class="part__value">${n}</div>
        </div>
        <div class="part__copy">
          ${re(te.Copy)}
        </div>
      </div>
    `}handlePartClick(e,t){t&&navigator.clipboard.writeText(t)}sendChat(){const t=this._contactParts.chat.value;if(!t)return;const o=`https://teams.microsoft.com/l/chat/0/0?users=${t}`,r=()=>window.open(o,"_blank");e.TeamsHelper.isAvailable?e.TeamsHelper.executeDeepLink(o,(e=>{e||r()})):r()}sendEmail(){const e=this._contactParts.email.value;e&&window.open("mailto:"+e,"_blank")}sendCall(){const e=this._contactParts.cellPhone.value;e&&window.open("tel:"+e,"_blank")}};Mt=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s}([(0,t.Mo)("mgt-person-card-contact"),function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}("design:paramtypes",[Object])],Mt);const Ft=[t.iv`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root .file{display:flex;align-items:center;padding:11px 20px}:host .root .file:hover{background-color:var(--background-color--hover,#edebe9);cursor:pointer}:host .root .file:last-child{margin-bottom:unset}:host .root .file .file__icon{width:28px;min-width:28px;height:28px;margin-right:12px;display:flex;align-items:center;justify-content:center}:host .root .file .file__icon img{height:28px;width:28px}:host .root .file .file__details{min-width:0;margin-right:40px}:host .root .file .file__details .file__name{font-size:14px;color:var(--color-sub1,#323130)}:host .root .file .file__details .file__last-modified{font-size:12px;color:var(--color-sub2,#797775)}:host .root .file .file__details>div{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}[dir=rtl] .file__icon{margin-right:0!important}[dir=rtl] .file__details{margin-right:12px!important}
`],Ht={filesSectionTitle:"Files",sharedTextSubtitle:"Shared"};let qt=class extends Dt{constructor(e){super(),this._files=e}static get styles(){return Ft}get strings(){return Ht}get displayName(){return this.strings.filesSectionTitle}clearState(){super.clearState(),this._files=null}renderIcon(){return re(te.Files)}renderCompactView(){let e;return e=this.isLoadingState?this.renderLoading():this._files&&this._files.length?t.dy`
        ${this._files.slice(0,3).map((e=>this.renderFile(e)))}
      `:this.renderNoData(),t.dy`
      <div class="root compact" dir=${this.direction}>
        ${e}
      </div>
    `}renderFullView(){let e;return e=this.isLoadingState?this.renderLoading():this._files&&this._files.length?t.dy`
        ${this._files.map((e=>this.renderFile(e)))}
      `:this.renderNoData(),t.dy`
      <div class="root" dir=${this.direction}>
        <div class="title">${this.strings.filesSectionTitle}</div>
        ${e}
      </div>
    `}renderFile(e){const o=e.lastShared?t.dy`
          <div class="file__last-modified">
            ${this.strings.sharedTextSubtitle} ${s(new Date(e.lastShared.sharedDateTime))}
          </div>
        `:null;return t.dy`
      <div class="file" @click=${t=>this.handleFileClick(e)}>
        <div class="file__icon">
          <img src=${function(e,t,o){const r=Ke[e]||"genericfile";return`${We}/${48..toString()}/${r}.svg`}(e.resourceVisualization.type)} />
        </div>
        <div class="file__details">
          <div class="file__name">${e.resourceVisualization.title}</div>
          ${o}
        </div>
      </div>
    `}handleFileClick(e){e.resourceReference&&e.resourceReference.webUrl&&window.open(e.resourceReference.webUrl,"_blank")}};qt=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s}([(0,t.Mo)("mgt-person-card-files"),function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}("design:paramtypes",[Array])],qt);const $t=[t.iv`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root .message{padding:8px 20px;display:flex;align-items:center;justify-content:space-between}:host .root .message:hover{background-color:var(--background-color--hover,#edebe9);cursor:pointer}:host .root .message:last-child{margin-bottom:unset}:host .root .message .message__detail{min-width:0;line-height:normal}:host .root .message .message__detail .message__subject{color:var(--color,#000);font-size:16px}:host .root .message .message__detail .message__from{font-size:12px;color:var(--color-sub1,#323130)}:host .root .message .message__detail .message__message{font-size:12px;color:var(--color-sub2,#797775)}:host .root .message .message__detail>div{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}:host .root .message .message__date{font-size:12px;color:var(--color-sub2,#797775);margin-left:10px;white-space:nowrap}
`],Bt={emailsSectionTitle:"Emails"};let jt=class extends Dt{constructor(e){super(),this._messages=e}static get styles(){return $t}get strings(){return Bt}get displayName(){return this.strings.emailsSectionTitle}clearState(){super.clearState(),this._messages=[]}renderIcon(){return re(te.Messages)}renderCompactView(){let e;if(this.isLoadingState)e=this.renderLoading();else if(this._messages&&this._messages.length){const o=this._messages?this._messages.slice(0,3).map((e=>this.renderMessage(e))):[];e=t.dy`
        ${o}
      `}else e=this.renderNoData();return t.dy`
      <div class="root compact">
        ${e}
      </div>
    `}renderFullView(){let e;return e=this.isLoadingState?this.renderLoading():this._messages&&this._messages.length?t.dy`
        ${this._messages.slice(0,5).map((e=>this.renderMessage(e)))}
      `:this.renderNoData(),t.dy`
      <div class="root">
        <div class="title">${this.strings.emailsSectionTitle}</div>
        ${e}
      </div>
    `}renderMessage(e){return t.dy`
      <div class="message" @click=${()=>this.handleMessageClick(e)}>
        <div class="message__detail">
          <div class="message__subject">${e.subject}</div>
          <div class="message__from">${e.from.emailAddress.name}</div>
          <div class="message__message">${e.bodyPreview}</div>
        </div>
        <div class="message__date">${s(new Date(e.receivedDateTime))}</div>
      </div>
    `}handleMessageClick(e){window.open(e.webLink,"_blank")}};jt=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s}([(0,t.Mo)("mgt-person-card-messages"),function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}("design:paramtypes",[Array])],jt);const zt=[t.iv`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root.compact .coworker .coworker__image{height:40px;width:40px;border-radius:40px;--avatar-size:40px;--avatar-size-s:40px;margin-right:12px}:host .root.compact .coworker .coworker__name{font-size:14px}:host .root.compact .coworker .coworker__title{font-size:12px}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 20px 20px}:host .root .subtitle{color:var(--title-color-sub2,#797775);font-size:14px;margin:0 20px 8px 20px}:host .root .divider{display:flex;background:var(--line-seperator-color,#edebe9);height:1px;margin-top:26px;margin-bottom:18px;margin-left:20px;margin-right:20px}:host .root .org-member{height:74px;box-sizing:border-box;border-radius:2px;padding:12px;display:flex;align-items:center;margin-left:20px;margin-right:20px}:host .root .org-member.org-member--target{background-color:var(--background-color-sub2,#f3f2f1);border:1px solid #0078d4}:host .root .org-member.org-member--direct-report:not(:last-child){border-bottom:none}:host .root .org-member:not(.org-member--target){background-color:var(--background-color-sub1,#faf9f8);border:1px solid var(--line-seperator-color,#edebe9)}:host .root .org-member:not(.org-member--target):hover{cursor:pointer;background-color:var(--background-color--hover,#edebe9)}:host .root .org-member .org-member__person{flex-grow:1}:host .root .org-member .org-member__person mgt-person{--avatar-size:48px;--avatar-size-s:48px;--font-size:16px;--color:#323130;--line2-font-size:14px;--line3-font-size:14px;--line2-text-transform:uppercase;--line2-color:#797775;--line3-color:#797775;--line3-text-transform:uppercase;margin-right:8px;max-width:230px}:host .root .org-member .org-member__details{flex-grow:1}:host .root .org-member .org-member__details .org-member__name{font-size:16px;color:var(--color-sub1,#323130);font-weight:600}:host .root .org-member .org-member__details .org-member__department,:host .root .org-member .org-member__details .org-member__title{font-weight:14px;color:var(--color-sub2,#797775)}:host .root .org-member__separator{border:1px solid var(--line-seperator-color,#edebe9);box-sizing:border-box;width:0;margin:0 50%;height:14px}:host .root .coworker{display:flex;align-items:center;padding:10px 20px}:host .root .coworker:hover{cursor:pointer;background-color:var(--background-color--hover,#edebe9)}:host .root .coworker .coworker__person{height:46px;width:46px;border-radius:46px;margin-right:8px}:host .root .coworker .coworker__person mgt-person{--font-size:16px;--line2-text-transform:uppercase;--line2-font-size:14px;--line2-color:set-var(color__sub2, $theme-default, $common);--avatar-size:46px}:host .root .direct-report__compact{padding:12px 20px}:host .root .direct-report__compact .direct-report{cursor:pointer;width:38px;margin-right:4px;display:inline;--avatar-size:38px}[dir=rtl] .org-member .org-member__more{-moz-transform:scaleX(-1);-o-transform:scaleX(-1);-webkit-transform:scaleX(-1);transform:scaleX(-1);filter:FlipH;-ms-filter:FlipH}
`],Vt={reportsToSectionTitle:"Reports to",directReportsSectionTitle:"Direct reports",organizationSectionTitle:"Organization",youWorkWithSubSectionTitle:"You work with",userWorksWithSubSectionTitle:"works with"};let Gt=class extends Dt{constructor(e,t){super(),this._state=e,this._me=t}static get styles(){return zt}get strings(){return Vt}clearState(){super.clearState(),this._state=null,this._me=null}get displayName(){const{person:e,directReports:t}=this._state;return!e.manager&&t&&t.length?`${this.strings.directReportsSectionTitle} (${t.length})`:this.strings.reportsToSectionTitle}renderIcon(){return re(te.Organization)}renderCompactView(){let e;if(!this._state||!this._state.person)return null;const{person:o,directReports:r}=this._state;return o?(o.manager?e=this.renderCoworker(o.manager):r&&r.length&&(e=this.renderCompactDirectReports()),t.dy`
      <div class="root compact">
        ${e}
      </div>
    `):null}renderFullView(){let e;if(!this._state||!this._state.person)return null;const{person:o,directReports:r,people:n}=this._state;if(!(o||r||n))return null;{const o=this.renderManagers(),r=this.renderCurrentUser(),n=this.renderDirectReports(),i=this.renderCoworkers();e=t.dy`
        ${o} ${r} ${n} ${i}
      `}return t.dy`
      <div class="root" dir=${this.direction}>
        <div class="title">${this.strings.organizationSectionTitle}</div>
        ${e}
      </div>
    `}renderManager(e){return t.dy`
      <div class="org-member" @click=${()=>this.navigateCard(e)}>
        <div class="org-member__person">
          <mgt-person
            .personDetails=${e}
            .line2Property=${"jobTitle"}
            .line3Property=${"department"}
            .fetchImage=${!0}
            .view=${ee.threelines}
          ></mgt-person>
        </div>
        <div class="org-member__more">
          ${re(te.ExpandRight)}
        </div>
      </div>
      <div class="org-member__separator"></div>
    `}renderManagers(){const{person:e}=this._state;if(!e||!e.manager)return null;const t=[];let o=e;for(;o.manager;)t.push(o.manager),o=o.manager;return t.length?t.reverse().map((e=>this.renderManager(e))):null}renderDirectReports(){const{directReports:e}=this._state;return e&&e.length?t.dy`
      <div class="org-member__separator"></div>
      <div>
        ${e.map((e=>t.dy`
            <div class="org-member org-member--direct-report" @click=${()=>this.navigateCard(e)}>
              <div class="org-member__person">
                <mgt-person
                  .personDetails=${e}
                  .line2Property=${"jobTitle"}
                  .line3Property=${"department"}
                  .fetchImage=${!0}
                  .view=${ee.twolines}
                ></mgt-person>
              </div>
              <div class="org-member__more">
                ${re(te.ExpandRight)}
              </div>
            </div>
          `))}
      </div>
    `:null}renderCompactDirectReports(){const{directReports:e}=this._state;return t.dy`
      <div class="direct-report__compact">
        ${e.slice(0,6).map((e=>t.dy`
            <div class="direct-report" @click=${()=>this.navigateCard(e)}>
              <mgt-person .personDetails=${e} .fetchImage=${!0}></mgt-person>
            </div>
          `))}
      </div>
    `}renderCurrentUser(){const{person:e}=this._state;return t.dy`
      <div class="org-member org-member--target">
        <div class="org-member__person">
          <mgt-person
            .personDetails=${e}
            .line2Property=${"jobTitle"}
            .line3Property=${"department"}
            .fetchImage=${!0}
            .view=${ee.threelines}
          ></mgt-person>
        </div>
      </div>
    `}renderCoworker(e){return t.dy`
      <div class="coworker" @click=${()=>this.navigateCard(e)}>
        <div class="coworker__person">
          <mgt-person
            .personDetails=${e}
            .line2Property=${"jobTitle"}
            .fetchImage=${!0}
            .view=${ee.twolines}
          ></mgt-person>
        </div>
      </div>
    `}renderCoworkers(){const{people:e}=this._state;if(!e||!e.length)return null;const o=this._me.id===this._state.person.id?this.strings.youWorkWithSubSectionTitle:`${this._state.person.givenName} ${this.strings.userWorksWithSubSectionTitle}`;return t.dy`
      <div class="divider"></div>
      <div class="subtitle">${o}</div>
      <div>
        ${e.slice(0,6).map((e=>this.renderCoworker(e)))}
      </div>
    `}};Gt=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s}([(0,t.Mo)("mgt-person-card-organization"),function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}("design:paramtypes",[Object,Object])],Gt);const Kt=[t.iv`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root section{margin-bottom:24px;padding:0 20px}:host .root section:last-child{margin:0}:host .root section .section__title{font-size:16px;color:var(--title-color-sub2,#797775)}:host .root section .section__content{display:flex;flex-direction:column;margin-top:10px}:host .root .token-list{display:flex;flex-direction:row;flex-wrap:wrap;margin-top:-10px}:host .root .token-list .token-list__item{text-overflow:ellipsis;white-space:nowrap;display:inline-block;overflow:hidden;font-size:14px;align-items:center;background:var(--background-color-sub2,#f3f2f1);border-radius:2px;max-height:28px;padding:4px 8px;margin-right:10px;margin-top:10px;color:var(--color-sub1,#323130)}:host .root .token-list .token-list__item:last-child{margin-right:initial}:host .root .token-list .token-list__item.overflow{display:none}:host .root .token-list .token-list__item:hover{color:var(--color-sub1,#323130)}:host .root .token-list .token-list__item.token-list__item--show-overflow{cursor:pointer;user-select:unset}:host .root .data-list__item{margin-bottom:20px}:host .root .data-list__item:last-child{margin-bottom:initial}:host .root .data-list__item .data-list__item__header{display:flex;justify-content:space-between;align-items:center}:host .root .data-list__item .data-list__item__content{font-size:12px;line-height:16px;color:var(--color-sub2,#797775);margin-top:4px}:host .root .data-list__item .data-list__item__title{font-size:14px;line-height:16px;color:var(--title-color-subtitle,#323130)}:host .root .data-list__item .data-list__item__date-range{color:var(--color-sub2,#797775);font-size:10px;line-height:12px}:host .root .language__proficiency{opacity:.77}:host .root .work-position .work-position__company{color:#0078d4}:host .root .work-position .work-position__location{font-size:10px;color:var(--color-sub2,#797775);line-height:16px}:host .root .educational-activity .educational-activity__degree{font-size:12px;line-height:14px;color:var(--color-sub3,#979593)}:host .root .birthday{display:flex;align-items:center;margin-top:-6px}:host .root .birthday .birthday__icon{margin-right:8px}:host .root .birthday .birthday__date{font-size:12px;color:var(--color-sub1,#323130)}[dir=rtl] .token-list__item{margin-right:0!important}
`],Wt={SkillsAndExperienceSectionTitle:"Skills & Experience",AboutCompactSectionTitle:"About",SkillsSubSectionTitle:"Skills",LanguagesSubSectionTitle:"Languages",WorkExperienceSubSectionTitle:"Work Experience",EducationSubSectionTitle:"Education",professionalInterestsSubSectionTitle:"Professional Interests",personalInterestsSubSectionTitle:"Personal Interests",birthdaySubSectionTitle:"Birthday",currentYearSubtitle:"Current"};let Qt=class extends Dt{constructor(e){super(),this.profile=e}static get styles(){return Kt}get strings(){return Wt}get displayName(){return this.strings.SkillsAndExperienceSectionTitle}get hasData(){if(!this.profile)return!1;const{languages:e,skills:t,positions:o,educationalActivities:r}=this.profile;return[this._birthdayAnniversary,this._personalInterests&&this._personalInterests.length,this._professionalInterests&&this._professionalInterests.length,e&&e.length,t&&t.length,o&&o.length,r&&r.length].filter((e=>!!e)).length>0}get profile(){return this._profile}set profile(e){e!==this._profile&&(this._profile=e,this._birthdayAnniversary=e&&e.anniversaries?e.anniversaries.find(this.isBirthdayAnniversary):null,this._personalInterests=e&&e.interests?e.interests.filter(this.isPersonalInterest):null,this._professionalInterests=e&&e.interests?e.interests.filter(this.isProfessionalInterest):null)}renderIcon(){return re(te.Profile)}clearState(){super.clearState(),this.profile=null}renderCompactView(){return t.dy`
      <div class="root compact" dir=${this.direction}>
        ${this.renderSubSections().slice(0,2)}
      </div>
    `}renderFullView(){return this.initPostRenderOperations(),t.dy`
      <div class="root" dir=${this.direction}>
        <div class="title">${this.strings.AboutCompactSectionTitle}</div>
        ${this.renderSubSections()}
      </div>
    `}renderSubSections(){return[this.renderSkills(),this.renderBirthday(),this.renderLanguages(),this.renderWorkExperience(),this.renderEducation(),this.renderProfessionalInterests(),this.renderPersonalInterests()].filter((e=>!!e))}renderLanguages(){const{languages:e}=this._profile;if(!e||!e.length)return null;const o=[];for(const r of e){let e=null;r.proficiency&&r.proficiency.length&&(e=t.dy`
          <span class="language__proficiency">
            &nbsp;(${r.proficiency})
          </span>
        `),o.push(t.dy`
        <div class="token-list__item language">
          <span class="language__title">${r.displayName}</span>
          ${e}
        </div>
      `)}return t.dy`
      <section>
        <div class="section__title">${this.strings.LanguagesSubSectionTitle}</div>
        <div class="section__content">
          <div class="token-list">
            ${o}
          </div>
        </div>
      </section>
    `}renderSkills(){const{skills:e}=this._profile;if(!e||!e.length)return null;const o=[];for(const r of e)o.push(t.dy`
        <div class="token-list__item skill">
          ${r.displayName}
        </div>
      `);return t.dy`
      <section>
        <div class="section__title">${this.strings.SkillsSubSectionTitle}</div>
        <div class="section__content">
          <div class="token-list">
            ${o}
          </div>
        </div>
      </section>
    `}renderWorkExperience(){var e,o,r,n,i,s,a,c,l;if(!this._profile||!this._profile.positions)return null;const d=[];for(const u of this._profile.positions)u.detail&&d.push(t.dy`
          <div class="data-list__item work-position">
            <div class="data-list__item__header">
              <div class="data-list__item__title">${null===(e=u.detail)||void 0===e?void 0:e.jobTitle}</div>
              <div class="data-list__item__date-range">
                ${this.getDisplayDateRange(u.detail)}
              </div>
            </div>
            <div class="data-list__item__content">
              <div class="work-position__company">
                ${null===(r=null===(o=null==u?void 0:u.detail)||void 0===o?void 0:o.company)||void 0===r?void 0:r.displayName}
              </div>
              <div class="work-position__location">
                ${null===(s=null===(i=null===(n=null==u?void 0:u.detail)||void 0===n?void 0:n.company)||void 0===i?void 0:i.address)||void 0===s?void 0:s.city}, ${null===(l=null===(c=null===(a=null==u?void 0:u.detail)||void 0===a?void 0:a.company)||void 0===c?void 0:c.address)||void 0===l?void 0:l.state}
              </div>
            </div>
          </div>
        `);return t.dy`
      <section>
        <div class="section__title">${this.strings.WorkExperienceSubSectionTitle}</div>
        <div class="section__content">
          <div class="data-list">
            ${d}
          </div>
        </div>
      </section>
    `}renderEducation(){const{educationalActivities:e}=this._profile;if(!e||!e.length)return null;const o=[];for(const r of e)o.push(t.dy`
        <div class="data-list__item educational-activity">
          <div class="data-list__item__header">
            <div class="data-list__item__title">${r.institution.displayName}</div>
            <div class="data-list__item__date-range">
              ${this.getDisplayDateRange(r)}
            </div>
          </div>
          <div class="data-list__item__content">
            <div class="educational-activity__degree">
              ${r.program.displayName||"Bachelors Degree"}
            </div>
          </div>
        </div>
      `);return t.dy`
      <section>
        <div class="section__title">${this.strings.EducationSubSectionTitle}</div>
        <div class="section__content">
          <div class="data-list">
            ${o}
          </div>
        </div>
      </section>
    `}renderProfessionalInterests(){if(!this._professionalInterests||!this._professionalInterests.length)return null;const e=[];for(const o of this._professionalInterests)e.push(t.dy`
        <div class="token-list__item interest interest--professional">
          ${o.displayName}
        </div>
      `);return t.dy`
      <section>
        <div class="section__title">${this.strings.professionalInterestsSubSectionTitle}</div>
        <div class="section__content">
          <div class="token-list">
            ${e}
          </div>
        </div>
      </section>
    `}renderPersonalInterests(){if(!this._personalInterests||!this._personalInterests.length)return null;const e=[];for(const o of this._personalInterests)e.push(t.dy`
        <div class="token-list__item interest interest--personal">
          ${o.displayName}
        </div>
      `);return t.dy`
      <section>
        <div class="section__title">${this.strings.personalInterestsSubSectionTitle}</div>
        <div class="section__content">
          <div class="token-list">
            ${e}
          </div>
        </div>
      </section>
    `}renderBirthday(){return this._birthdayAnniversary&&this._birthdayAnniversary.date?t.dy`
      <section>
        <div class="section__title">Birthday</div>
        <div class="section__content">
          <div class="birthday">
            <div class="birthday__icon">
              ${re(te.Birthday)}
            </div>
            <div class="birthday__date">
              ${this.getDisplayDate(new Date(this._birthdayAnniversary.date))}
            </div>
          </div>
        </div>
      </section>
    `:null}isPersonalInterest(e){return e.categories&&e.categories.includes("personal")}isProfessionalInterest(e){return e.categories&&e.categories.includes("professional")}isBirthdayAnniversary(e){return"birthday"===e.type}getDisplayDate(e){return e.toLocaleString("default",{day:"numeric",month:"long"})}getDisplayDateRange(e){const t=new Date(e.startMonthYear).getFullYear();return 0===t?null:`${t} — ${e.endMonthYear?new Date(e.endMonthYear).getFullYear():this.strings.currentYearSubtitle}`}initPostRenderOperations(){setTimeout((()=>{try{this.shadowRoot.querySelectorAll("section").forEach((e=>{this.handleTokenOverflow(e)}))}catch(e){}}),0)}handleTokenOverflow(e){const t=e.querySelectorAll(".token-list");if(t&&t.length)for(const e of Array.from(t)){const t=e.querySelectorAll(".token-list__item");if(!t||!t.length)continue;let o=null,r=t[0].getBoundingClientRect();const n=e.getBoundingClientRect(),i=2*r.height+n.top;for(let e=0;e<t.length-1;e++)if(r=t[e].getBoundingClientRect(),r.top>i){o=Array.from(t).slice(e,t.length);break}if(o){o.forEach((e=>e.classList.add("overflow")));const t=document.createElement("div");t.classList.add("token-list__item"),t.classList.add("token-list__item--show-overflow"),t.innerText=`+ ${o.length} more`,t.addEventListener("click",(e=>{t.remove(),o.forEach((e=>e.classList.remove("overflow")))})),e.appendChild(t)}}}};Qt=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s}([(0,t.Mo)("mgt-person-card-profile"),function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}("design:paramtypes",[Object])],Qt);const Jt={sendEmailLinkSubtitle:"Send email",startChatLinkSubtitle:"Start chat",showMoreSectionButton:"Show more"};o(74);var Yt,Zt=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},Xt=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let eo=Yt=class extends e.MgtTemplatedComponent{constructor(){super(),this._chatInput="",this._currentSection=null,this._history=[],this.sections=[]}static get styles(){return Ot}get strings(){return Jt}static get requiredScopes(){return Yt.getScopes()}static getScopes(){const e=[];return this.config.sections.files&&e.push("Sites.Read.All"),this.config.sections.mailMessages&&e.push("Mail.ReadBasic"),this.config.sections.organization&&(e.push("User.Read.All"),"boolean"!=typeof this.config.sections.organization&&this.config.sections.organization.showWorksWith&&e.push("People.Read.All")),this.config.sections.profile&&e.push("User.Read.All"),this.config.useContactApis&&e.push("Contacts.Read"),e.indexOf("User.Read.All")<0&&(e.push("User.ReadBasic.All"),e.push("User.Read")),e.indexOf("People.Read.All")<0&&e.push("People.Read"),[...new Set(e)]}static get config(){return this._config}get personDetails(){return this._personDetails}set personDetails(e){this._personDetails!==e&&(this._personDetails=e,this.personImage=null,this.requestStateUpdate())}get userId(){return this._userId}set userId(e){e!==this._userId&&(this._userId=e,this.personDetails=null,this.state=null,this.requestStateUpdate())}get internalPersonDetails(){return this.state&&this.state.person||this.personDetails}attributeChangedCallback(e,t,o){if(super.attributeChangedCallback(e,t,o),t!==o)switch(e){case"person-query":this.personDetails=null,this.state=null,this.requestStateUpdate()}}navigate(e){this._history.push({personDetails:this.personDetails,personImage:this.getImage(),state:this.state}),this._personDetails=e,this.state=null,this.personImage=null,this._currentSection=null,this.sections=[],this.requestStateUpdate()}goBack(){if(!this._history||!this._history.length)return;const e=this._history.pop();this._currentSection=null,this.state=e.state,this._personDetails=e.state,this.personImage=e.personImage,this.loadSections()}clearHistory(){if(this._currentSection=null,!this._history||!this._history.length)return;const e=this._history[0];this._history=[],this.state=e.state,this._personDetails=e.state,this.personImage=e.personImage,this.loadSections()}render(){if(!this.internalPersonDetails)return this.renderNoData();const e=this.internalPersonDetails,o=this.getImage();if(this.hasTemplate("default"))return this.renderTemplate("default",{person:this.internalPersonDetails,personImage:o});const r=this._history&&this._history.length?t.dy`
            <div class="nav">
              <div class="nav__back" @click=${()=>this.goBack()}>${re(te.Back)}</div>
            </div>
          `:null;let n=this.renderTemplate("person-details",{person:this.internalPersonDetails,personImage:o});if(!n){const o=this.renderPerson(),r=this.renderContactIcons(e);n=t.dy`
        ${o} ${r}
      `}const i=this.isExpanded?this.renderExpandedDetails():this.renderExpandedDetailsButton();return t.dy`
      <div class="root" dir=${this.direction}>
        ${r}
        <div class="person-details-container">${n}</div>
        <div class="expanded-details-container">${i}</div>
      </div>
    `}renderNoData(){return this.renderTemplate("no-data",null)||t.dy``}renderPerson(){return t.dy`
      <mgt-person
        class="person-image"
        .personDetails=${this.internalPersonDetails}
        .personImage=${this.getImage()}
        .personPresence=${this.personPresence}
        .showPresence=${this.showPresence}
        .avatarSize=${"large"}
        .view=${ee.threelines}
        .line2Property=${"jobTitle"}
        .line3Property=${"department"}
      ></mgt-person>
    `}renderPersonSubtitle(e){if((e=e||this.internalPersonDetails).department)return t.dy`
      <div class="department">${e.department}</div>
    `}renderContactIcons(e){if(this.isExpanded)return;const o=e=e||this.internalPersonDetails;let r,n;return R(e)&&(r=t.dy`
        <div class="icon" @click=${()=>this.emailUser()}>
          ${re(te.SmallEmail)}
          <span>${this.strings.sendEmailLinkSubtitle}</span>
        </div>
      `),o.userPrincipalName&&(n=t.dy`
        <div class="icon" @click=${()=>this.chatUser()}>
          ${re(te.SmallChat)}
          <span>${this.strings.startChatLinkSubtitle}</span>
        </div>
      `),t.dy`
      <div class="base-icons">
        ${r} ${n}
      </div>
    `}renderExpandedDetailsButton(){return t.dy`
      <div class="expanded-details-button" @click=${()=>this.showExpandedDetails()}>
        ${re(te.ExpandDown)}
      </div>
    `}renderExpandedDetails(e){if(!this.state&&this.isStateLoading)return t.dy`
        <div class="loading">
          <mgt-spinner></mgt-spinner>
        </div>
      `;e=e||this.internalPersonDetails;const o=this.renderSectionNavigation(),r=this.renderCurrentSection();return t.dy`
      <div class="section-nav">
        ${o}
      </div>
      <div class="section-host" @wheel=${e=>this.handleSectionScroll(e)}>
        ${r}
      </div>
    `}renderSectionNavigation(){if(!this.sections||this.sections.length<2&&!this.hasTemplate("additional-details"))return;const e=this._currentSection?this.sections.indexOf(this._currentSection):-1,o=this.sections.map(((o,r,n)=>{const i=g({active:r===e,"section-nav__icon":!0});return t.dy`
        <button class=${i} @click=${()=>this.updateCurrentSection(o)}>${o.renderIcon()}</button>
      `})),r=g({active:-1===e,"section-nav__icon":!0});return t.dy`
      <button class=${r} @click=${()=>this.updateCurrentSection(null)}>
        ${re(te.Overview)}
      </button>
      ${o}
    `}renderOverviewSection(){const e=this.sections.map((e=>t.dy`
        <div class="section">
          <div class="section__header">
            <div class="section__title">${e.displayName}</div>
            <a class="section__show-more" @click=${()=>this.updateCurrentSection(e)}
              >${this.strings.showMoreSectionButton}</a
            >
          </div>
          <div class="section__content">${e.asCompactView()}</div>
        </div>
      `)),o=this.renderTemplate("additional-details",{person:this.internalPersonDetails,personImage:this.getImage(),state:this.state});return o&&e.splice(1,0,t.dy`
          <div class="section">
            <div class="additional-details">${o}</div>
          </div>
        `),t.dy`
      <div class="sections">
        ${e}
      </div>
    `}renderCurrentSection(){if(this.sections&&this.sections.length||this.hasTemplate("additional-details"))return 1!==this.sections.length||this.hasTemplate("additional-details")?this._currentSection?t.dy`
      ${this._currentSection.asFullView()}
    `:this.renderOverviewSection():t.dy`
        ${this.sections[0].asFullView()}
      `}loadState(){return t=this,o=void 0,n=function*(){if(this.state)return;if(!this.personDetails&&this.inheritDetails){let e=this.parentElement;for(;e&&"MGT-PERSON"!==e.tagName;)e=e.parentElement;e&&e.personDetails&&(this.personDetails=e.personDetails,this.personImage=e.personImage)}const t=e.Providers.globalProvider;if(!t||t.state!==e.ProviderState.SignedIn)return;const o=t.graph.forComponent(this);if(this.isStateLoading=!0,this._me||(this._me=yield e.Providers.me()),this.personDetails){const e=this.personDetails,t=e.userPrincipalName||e.id;if(t&&!R(e)){const e=yield oe(o,t);this.personDetails=e,this.personImage=this.getImage()}}else if(this.userId||"me"===this.personQuery){const e=yield oe(o,this.userId);this.personDetails=e,this.personImage=this.getImage()}else if(this.personQuery){const e=yield A(o,this.personQuery,1);e&&e.length&&(this.personDetails=e[0],W(o,this.personDetails,Yt.config.useContactApis).then((e=>{e&&(this.personDetails.personImage=e,this.personImage=e)})))}const r={activity:"Offline",availability:"Offline",id:null};if(!this.personPresence&&this.showPresence)try{this.personDetails&&this.personDetails.id?X(o,this.personDetails.id).then((e=>{this.personPresence=e})):this.personPresence=r}catch(e){this.personPresence=r}this.state=yield function(e,t,o,r){return Pt(this,void 0,void 0,(function*(){const n=t.id,i=R(t),s="classification"in t||"personType"in t&&("PersonalContact"===t.personType.subclass||"Group"===t.personType.class),a=e.createBatch();let c;s||r.sections.organization&&(function(e,t){const o=`manager($levels=max;$select=${Rt})`;e.get("person",`users/${t}?$expand=${o}&$select=${Rt}&$count=true`,["user.read.all"],{ConsistencyLevel:"eventual"}),e.get("directReports",`users/${t}/directReports?$select=${Rt}`)}(a,n),"boolean"!=typeof r.sections.organization&&r.sections.organization.showWorksWith&&function(e,t){e.get("people",`users/${t}/people?$filter=personType/class eq 'Person'`,["People.Read.All"])}(a,n)),r.sections.mailMessages&&i&&function(e,t){e.get("messages",`me/messages?$search="from:${t}"`,["Mail.ReadBasic"])}(a,i),r.sections.files&&function(e,t){let o;o=t?`me/insights/shared?$filter=lastshared/sharedby/address eq '${t}'`:"me/insights/used",e.get("files",o,["Sites.Read.All"])}(a,o?null:i);const l={};try{c=yield a.executeAll()}catch(e){}if(c)for(const[e,t]of c)l[e]=t.content.value||t.content;if(!s&&r.sections.profile)try{const t=yield function(e,t){return Pt(this,void 0,void 0,(function*(){return yield e.api(`/users/${t}/profile`).version("beta").get()}))}(e,n);t&&(l.profile=t)}catch(e){}return l}))}(o,this.personDetails,this._me===this.personDetails.id,Yt.config),this.loadSections(),this.isStateLoading=!1},new((r=void 0)||(r=Promise))((function(e,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(t){var o;t.done?e(t.value):(o=t.value,o instanceof r?o:new r((function(e){e(o)}))).then(s,a)}c((n=n.apply(t,o||[])).next())}));var t,o,r,n}sendQuickMessage(){const e=this._chatInput.trim();e&&e.length&&this.chatUser(e)}emailUser(){const e=this.internalPersonDetails;if(e){const t=R(e);t&&window.open("mailto:"+t,"_blank")}}callUser(){const e=this.personDetails,t=this.personDetails;if(e&&e.businessPhones&&e.businessPhones.length){const t=e.businessPhones[0];t&&window.open("tel:"+t,"_blank")}else if(t&&t.phones&&t.phones.length){const e=this.getPersonBusinessPhones(t)[0];e&&window.open("tel:"+e,"_blank")}}chatUser(t=null){const o=this.personDetails;if(o&&o.userPrincipalName){let r=`https://teams.microsoft.com/l/chat/0/0?users=${o.userPrincipalName}`;t&&t.length&&(r+=`&message=${t}`);const n=()=>window.open(r,"_blank");e.TeamsHelper.isAvailable?e.TeamsHelper.executeDeepLink(r,(e=>{e||n()})):n()}}showExpandedDetails(){const e=this.renderRoot.querySelector(".root");e&&e.animate&&e.animate([{height:"auto",transformOrigin:"top left"},{height:"auto",transformOrigin:"top left"}],{duration:1e3,easing:"ease-in-out",fill:"both"}),this.isExpanded=!0,this.fireCustomEvent("expanded",null,!0)}loadSections(){if(this.sections=[],!this.internalPersonDetails)return;const e=new Mt(this.internalPersonDetails);if(e.hasData&&this.sections.push(e),!this.state)return;const{person:t,directReports:o,messages:r,files:n,profile:i}=this.state;if(Yt.config.sections.organization&&(t&&t.manager||o&&o.length)&&this.sections.push(new Gt(this.state,this._me)),Yt.config.sections.mailMessages&&r&&r.length&&this.sections.push(new jt(r)),Yt.config.sections.files&&n&&n.length&&this.sections.push(new qt(n)),Yt.config.sections.profile&&i){const e=new Qt(i);e.hasData&&this.sections.push(e)}}getImage(){if(this.personImage)return this.personImage;const e=this.personDetails;return e&&e.personImage?e.personImage:null}getPersonBusinessPhones(e){const t=e.phones,o=[];for(const e of t)"business"===e.type&&o.push(e.number);return o}updateCurrentSection(e){this.renderRoot.querySelector(".section-host").scrollTop=0,this._currentSection=e,this.requestUpdate()}handleSectionScroll(e){const t=this.renderRoot.querySelector(".section-host");t&&(e.deltaY<0&&0===t.scrollTop||e.deltaY>0&&t.clientHeight+t.scrollTop>=t.scrollHeight-1||e.stopPropagation())}};eo._config={sections:{files:!0,mailMessages:!0,organization:{showWorksWith:!0},profile:!0},useContactApis:!0},Zt([(0,t.Cb)({attribute:"person-details",type:Object}),Xt("design:type",Object),Xt("design:paramtypes",[Object])],eo.prototype,"personDetails",null),Zt([(0,t.Cb)({attribute:"person-query"}),Xt("design:type",String)],eo.prototype,"personQuery",void 0),Zt([(0,t.Cb)({attribute:"user-id"}),Xt("design:type",String),Xt("design:paramtypes",[String])],eo.prototype,"userId",null),Zt([(0,t.Cb)({attribute:"person-image",type:String}),Xt("design:type",String)],eo.prototype,"personImage",void 0),Zt([(0,t.Cb)({attribute:"fetch-image",type:Boolean}),Xt("design:type",Boolean)],eo.prototype,"fetchImage",void 0),Zt([(0,t.Cb)({attribute:"is-expanded",type:Boolean}),Xt("design:type",Boolean)],eo.prototype,"isExpanded",void 0),Zt([(0,t.Cb)({attribute:"inherit-details",type:Boolean}),Xt("design:type",Boolean)],eo.prototype,"inheritDetails",void 0),Zt([(0,t.Cb)({attribute:"show-presence",type:Boolean}),Xt("design:type",Boolean)],eo.prototype,"showPresence",void 0),Zt([(0,t.Cb)({attribute:"person-presence",type:Object}),Xt("design:type",Object)],eo.prototype,"personPresence",void 0),Zt([(0,t.sz)(),Xt("design:type",Object)],eo.prototype,"state",void 0),Zt([(0,t.sz)(),Xt("design:type",Boolean)],eo.prototype,"isStateLoading",void 0),eo=Yt=Zt([(0,t.Mo)("mgt-person-card"),Xt("design:paramtypes",[])],eo);const to=[t.iv`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--task-border:2px solid #e1dfdd;--task-complete-border:2px dotted #e1dfdd;--task-new-add-button-disabled-background:#edebe9;--task-icon-color:#000000}.mgt-dark{--task-border:2px solid #797775;--task-complete-border:2px dotted #797775;--task-new-add-button-disabled-background:#4f4f4f;--task-icon-color:#ffffff}:host{font-family:var(--default-font-family);display:flex;flex-direction:column;background-color:var(--background-color-sub1,#faf9f8);padding:var(--tasks-padding,12px);color:var(--color-sub1,#323130)}:host .TaskIcon{font-family:FabricMDL2Icons;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .TaskIcon.Divider{vertical-align:initial;margin:0 12px;font-size:16px}:host .Header{padding:var(--tasks-header-padding,0);margin:var(--tasks-header-margin,0 0 12px 0);padding:var(--tasks-title-padding,0);display:flex;align-items:center;justify-content:space-between}:host .Header .header__loading{max-width:90px;width:100%;height:20px;background:#f2f2f2}:host .Header select{font-family:var(--default-font-family, "Segoe UI");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px);border:none;-moz-appearance:none;-webkit-appearance:none;cursor:pointer}:host .Header select::-ms-expand{display:none}:host .Header .PlanTitle{font-family:var(--default-font-family, "Segoe UI");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px)}:host .Header .AddBar{display:flex}:host .Header .AddBar .AddBarItem{flex:1 1 auto}:host .Header .NewTaskDue{display:flex}:host .Header .NewTaskDue input{flex:1 1 auto;background-color:var(--background-color-sub1,#faf9f8)}:host .Header .TitleCont{flex:1 1 auto;display:flex;align-items:center;height:var(--tasks-new-button-height,34px)}:host .Header .NewTaskButton{flex:0 0 auto;display:flex;justify-content:center;align-items:center;width:var(--tasks-new-button-width,auto);height:var(--tasks-new-button-height,32px);border-radius:2px;padding:0 20px;background:var(--tasks-new-button-background,#0078d4);border:var(--tasks-new-button-border,solid 1px transparent);color:var(--tasks-new-button-color,#fff);user-select:none;-moz-user-select:none;-ms-user-select:none;cursor:pointer}:host .Header .NewTaskButton span{font-size:14px;font-weight:600;letter-spacing:.1px;line-height:14px}:host .Header .NewTaskButton .TaskIcon{margin-right:8px}:host .Header .NewTaskButton.hidden{visibility:hidden}:host .Header .NewTaskButton:hover{background:var(--tasks-new-button-hover-background,#106ebe)}:host .Header .NewTaskButton:active{background:var(--tasks-new-button-active-background,#005a9e)}:host .Task{position:relative;margin:var(--task-margin,0 0 18px 0);padding:var(--task-padding,0 0 0 0);background-color:var(--tasks-background-color,var(--background-color,#fff));border:var(--task-border,2px solid #e1dfdd)}:host .Task .TaskContent{display:flex}:host .Task .TaskContent .Divider{position:absolute;height:2px;left:0;right:0;bottom:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskContent .TaskDetailsContainer{flex:1;display:grid;display:-ms-grid;grid-template-columns:auto 1fr;-ms-grid-columns:auto 1fr;grid-template-rows:auto auto auto auto;-ms-grid-rows:auto auto auto auto;justify-content:space-between;align-items:flex-start;color:var(--task-detail-color,var(--color-sub2,#797775));font-size:12px;font-weight:600;white-space:nowrap;margin-bottom:12px}:host .Task .TaskContent .TaskDetailsContainer .TaskDetail{width:100%;height:100%;margin:4px 24px 6px 0;display:flex;justify-content:flex-start;align-items:center}:host .Task .TaskContent .TaskDetailsContainer .TaskTitle{color:var(--task-title-color,var(--title-color-subtitle,#323130));font-size:14px;font-weight:600;grid-row:1;-ms-grid-row:1;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2;margin:22px 0 4px}:host .Task .TaskContent .TaskDetailsContainer .TaskGroup{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer .TaskBucket{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer .TaskDue{justify-content:flex-end;align-items:flex-start;grid-row:4;-ms-grid-row:4;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2}:host .Task .TaskContent .TaskDetailsContainer.tablet{grid-template-columns:1fr .5fr 1fr .5fr;-ms-grid-columns:1fr .5fr 1fr .5fr;grid-template-rows:auto auto;-ms-grid-rows:auto auto}:host .Task .TaskContent .TaskDetailsContainer.tablet.NoPlan{grid-template-columns:0 1fr 1fr 1fr;-ms-grid-columns:0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDetail{margin:4px 24px 6px 0}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskTitle{grid-row:1;-ms-grid-row:1;grid-column:1/5;-ms-grid-column:1;-ms-grid-column-span:4}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskGroup{grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskBucket{grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskAssignee{grid-row:2;-ms-grid-row:2;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDue{justify-content:flex-start;align-items:center;grid-row:2;-ms-grid-row:2;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop{grid-template-columns:2fr 1fr .5fr 1fr .5fr;-ms-grid-columns:2fr 1fr .5fr 1fr .5fr;grid-template-rows:auto;-ms-grid-rows:auto;margin:0}:host .Task .TaskContent .TaskDetailsContainer.desktop.NoPlan{grid-template-columns:2fr 0 1fr 1fr 1fr;-ms-grid-columns:2fr 0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDetail{margin:0 24px 0 0}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskTitle{padding:0;grid-row:1;-ms-grid-row:1;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskGroup{min-height:61px;grid-row:1;-ms-grid-row:1;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskBucket{grid-row:1;-ms-grid-row:1;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskAssignee{grid-row:1;-ms-grid-row:1;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDue{justify-content:flex-start;align-items:center;grid-row:1;-ms-grid-row:1;grid-column:5;-ms-grid-column:5}:host .Task .TaskContent .TaskDetailsContainer svg{vertical-align:middle;margin-right:4px}:host .Task .TaskContent .TaskDetailsContainer svg path{fill:var(--task-detail-color,var(--color-sub2,#797775))}:host .Task .TaskContent .TaskDetailsContainer select,:host .Task .TaskContent .TaskDetailsContainer span{vertical-align:middle}:host .Task .TaskContent .TaskDetailsContainer .TaskIcon{color:#797775;margin-right:8px}:host .Task .TaskContent .TaskDetailsContainer mgt-people{color:var(--task-detail-color,var(--color-sub2,#797775));font-size:16px}:host .Task .TaskContent .TaskDetailsContainer mgt-person{display:inline-block}:host .Task .TaskContent .TaskDetailsContainer .Picker{background-color:var(--background-color-sub1,#faf9f8);-webkit-background-clip:padding-box;-moz-background-clip:padding-box;background-clip:padding-box;width:var(--mgt-flyout-set-width,350px);color:var(--task-detail-color,var(--color-sub2,#797775))}:host .Task .TaskContent .TaskDetailsContainer .Picker mgt-people-picker{--separator-margin:0px 10px 0px 10px}:host .Task .TaskContent .TaskDetailsContainer input,:host .Task .TaskContent .TaskDetailsContainer select{color:var(--task-detail-color,var(--color-sub2,#797775));font-size:.9em;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskCheckContainer{font-family:FabricMDL2Icons;display:inline-block;border-radius:50%;color:#fff;cursor:pointer;display:flex;align-items:var(--task-icon-alignment,flex-start);margin:21px 10px 20px 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer.Complete .TaskCheck{background-color:var(--task-icon-background-completed,#00ad56);border:var(--task-icon-border-completed,solid 1px #fff);color:var(--task-icon-color-completed,#fff)}:host .Task .TaskCheckContainer.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#979593)}:host .Task .TaskCheckContainer .TaskCheck{font-family:FabricMDL2Icons;font-size:12px;display:inline-block;width:18px;height:18px;border-radius:var(--task-icon-border-radius,50%);border:var(--task-icon-border,solid 1px #797775);color:var(--task-icon-color,#000);display:flex;justify-content:center;align-items:center;background-color:var(--task-icon-background,transparent);user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer .TaskCheck.Loading .TaskCheckContent{animation:rotateIcon 2s infinite linear}:host .Task .TaskOptions{cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;margin:16px 8px 0 0}:host .Task.ReadOnly .TaskCheckContainer{cursor:default}:host .Task.Complete{background:var(--task-complete-background,var(--background-color-sub1,#faf9f8));border:var(--task-complete-border,2px dotted #e1dfdd)}:host .Task.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#979593)}:host .Task.NewTask{margin:var(--task-new-margin,var(--task-margin,0 0 24px 0));display:flex;flex-direction:row}:host .Task.NewTask .SelfAssign{display:none}:host .Task.NewTask .AssignTo{border:0;background:0 0}:host .Task.NewTask .FakeCheckBox{width:15px;height:15px;cursor:pointer;margin:0 5px 0 5px}:host .Task.NewTask .FakeCheckBox::after{font-family:FabricMDL2Icons;content:'\uE739'}:host .Task.NewTask .FakeCheckBox~:checked{font-family:FabricMDL2Icons;content:'\uE73A'}:host .Task.NewTask .TaskContent{flex:1 1 auto;align-content:center;vertical-align:middle;margin:0 0 0 12px}:host .Task.NewTask .TaskContent .TaskDetailsContainer{display:flex;flex-direction:column;align-items:stretch;margin:0}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle{display:flex}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input{flex:1;font-family:var(--default-font-family, "Segoe UI");margin:var(--task-new-input-margin,0 24px 0 16px);padding:var(--task-new-input-padding,6px);font-size:var(--task-new-input-font-size,14px);font-weight:600;border:var(--task-new-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:hover{border-bottom:1px solid #106ebe}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:active{border-bottom:1px solid #005a9e}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:focus{border-bottom:1px solid #0078d4}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails{display:flex;justify-content:stretch;align-items:center;flex-wrap:wrap;margin:14px 0 14px 4px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskGroup{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskBucket{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskDue{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskAssignee{margin:8px 16px;min-width:80px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .TaskPeople label{display:flex;align-content:center;align-items:center}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select{font-family:var(--default-font-family);font-size:12px;font-weight:600;border:var(--task-new-select-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;padding:4px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:hover,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:hover{border-bottom:1px solid #106ebe}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:active,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:active{border-bottom:1px solid #005a9e}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:focus,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:focus{border-bottom:1px solid #0078d4}:host .Task.NewTask .TaskAddButtonContainer{flex:0 0 auto;display:flex}:host .Task.NewTask .TaskAddButtonContainer .TaskAdd,:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{height:100%;max-width:50px;min-width:50px;flex:1 1 auto;justify-content:center;align-items:center;display:flex;cursor:pointer}:host .Task.NewTask .TaskAddButtonContainer .TaskAdd{color:#fff;background:var(--task-new-add-button-background,#0078d4)}:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{font-family:var(--default-font-family, "Segoe UI");font-size:14px;font-weight:600;color:var(--task-new-cancel-button-color,var(--color-sub1,#323130));margin:0 12px 0 32px}:host .Task.NewTask .TaskAddButtonContainer.Disabled .TaskAdd{background:var(--task-new-add-button-disabled-background,#eaeaea);cursor:default}:host .Task.LoadingTask .TaskCheckContainer{cursor:default}:host .Task.LoadingTask .TaskDetails{display:flex}:host .Task.LoadingTask .TaskCheck{background:#f2f2f2;border-color:#f2f2f2;cursor:default}:host .Task.LoadingTask .TaskDetailIcon{width:16px;height:16px;margin:5px;background:#f2f2f2}:host .Task.LoadingTask .TaskTitle{background:#f2f2f2;max-width:400px;height:20px;margin-right:20px!important}:host .Task.LoadingTask .TaskDetail{margin-right:12px;display:flex;flex-direction:row;align-items:center}:host .Task.LoadingTask .TaskDetailName{width:81px;height:10px;background:#f2f2f2}@keyframes rotateIcon{from{transform:rotate(0)}to{transform:rotate(360deg)}}[dir=rtl] mgt-arrow-options{--arrow-options-left:auto}[dir=rtl] mgt-dot-options{--dot-options-translateX:translateX(60px)}[dir=rtl] .TaskDetails{margin-right:14px!important}[dir=rtl] .TaskIcon{margin-left:8px}[dir=rtl] .TaskDetail svg{margin-left:4px}
`];var oo=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};function ro(e,t,o,r){return no(e,t,{assignments:o},r)}function no(t,o,r,n){return oo(this,void 0,void 0,(function*(){return yield t.api(`/planner/tasks/${o}`).header("Cache-Control","no-store").middlewareOptions((0,e.prepScopes)("Group.ReadWrite.All")).header("If-Match",n).patch(JSON.stringify(r))}))}var io=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};function so(t,o,r,n){return io(this,void 0,void 0,(function*(){return yield t.api(`/me/outlook/tasks/${o}`).header("Cache-Control","no-store").header("If-Match",n).middlewareOptions((0,e.prepScopes)("Tasks.ReadWrite")).patch(r)}))}var ao=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class co{constructor(t){this.graph=e.BetaGraph.fromGraph(t)}}class lo extends co{getTaskGroups(){return ao(this,void 0,void 0,(function*(){return(yield function(t){return oo(this,void 0,void 0,(function*(){const o=yield t.api("/me/planner/plans").header("Cache-Control","no-store").middlewareOptions((0,e.prepScopes)("Group.Read.All")).get();return o&&o.value}))}(this.graph)).map((e=>({id:e.id,title:e.title})))}))}getTaskGroupsForGroup(t){return ao(this,void 0,void 0,(function*(){return(yield function(t,o){return oo(this,void 0,void 0,(function*(){const r=`/groups/${o}/planner/plans`,n=yield t.api(r).header("Cache-Control","no-store").middlewareOptions((0,e.prepScopes)("Group.Read.All")).get();return n?n.value:null}))}(this.graph,t)).map((e=>({id:e.id,title:e.title})))}))}getTaskGroup(t){return ao(this,void 0,void 0,(function*(){const o=yield function(t,o){return oo(this,void 0,void 0,(function*(){return yield t.api(`/planner/plans/${o}`).header("Cache-Control","no-store").middlewareOptions((0,e.prepScopes)("Group.Read.All")).get()}))}(this.graph,t);return{id:o.id,title:o.title,_raw:o}}))}getTaskFoldersForTaskGroup(t){return ao(this,void 0,void 0,(function*(){return(yield function(t,o){return oo(this,void 0,void 0,(function*(){const r=yield t.api(`/planner/plans/${o}/buckets`).header("Cache-Control","no-store").middlewareOptions((0,e.prepScopes)("Group.Read.All")).get();return r&&r.value}))}(this.graph,t)).map((e=>({_raw:e,id:e.id,name:e.name,parentId:e.planId})))}))}getTasksForTaskFolder(t){return ao(this,void 0,void 0,(function*(){return(yield function(t,o){return oo(this,void 0,void 0,(function*(){const r=yield t.api(`/planner/buckets/${o}/tasks`).header("Cache-Control","no-store").middlewareOptions((0,e.prepScopes)("Group.Read.All")).get();return r&&r.value}))}(this.graph,t)).map((e=>({_raw:e,assignments:e.assignments,completed:100===e.percentComplete,dueDate:e.dueDateTime&&new Date(e.dueDateTime),eTag:e["@odata.etag"],id:e.id,immediateParentId:e.bucketId,name:e.title,topParentId:e.planId})))}))}setTaskComplete(e,t){return ao(this,void 0,void 0,(function*(){return yield function(e,t,o){return no(e,t,{percentComplete:100},o)}(this.graph,e,t)}))}setTaskIncomplete(e,t){return ao(this,void 0,void 0,(function*(){return yield function(e,t,o){return no(e,t,{percentComplete:0},o)}(this.graph,e,t)}))}addTask(t){return ao(this,void 0,void 0,(function*(){return yield function(t,o){return t.api("/planner/tasks").header("Cache-Control","no-store").middlewareOptions((0,e.prepScopes)("Group.ReadWrite.All")).post(o)}(this.graph,{assignments:t.assignments,bucketId:t.immediateParentId,dueDateTime:t.dueDate&&t.dueDate.toISOString(),planId:t.topParentId,title:t.name})}))}assignPeopleToTask(e,t,o){return ao(this,void 0,void 0,(function*(){return yield ro(this.graph,e,t,o)}))}removeTask(t,o){return ao(this,void 0,void 0,(function*(){return yield function(t,o,r){return t.api(`/planner/tasks/${o}`).header("Cache-Control","no-store").header("If-Match",r).middlewareOptions((0,e.prepScopes)("Group.ReadWrite.All")).delete()}(this.graph,t,o)}))}isAssignedToMe(e,t){return Object.keys(e.assignments).includes(t)}}class uo extends co{getTaskGroups(){return ao(this,void 0,void 0,(function*(){return(yield function(t){return io(this,void 0,void 0,(function*(){const o=yield t.api("/me/outlook/taskGroups").header("Cache-Control","no-store").middlewareOptions((0,e.prepScopes)("Tasks.Read")).get();return o&&o.value}))}(this.graph)).map((e=>({_raw:e,id:e.id,secondaryId:e.groupKey,title:e.name})))}))}getTaskGroup(t){return ao(this,void 0,void 0,(function*(){const o=yield function(t,o){return io(this,void 0,void 0,(function*(){return yield t.api(`/me/outlook/taskGroups/${o}`).header("Cache-Control","no-store").middlewareOptions((0,e.prepScopes)("Tasks.Read")).get()}))}(this.graph,t);return{id:o.id,secondaryId:o.groupKey,title:o.name,_raw:o}}))}getTaskFoldersForTaskGroup(t){return ao(this,void 0,void 0,(function*(){return(yield function(t,o){return io(this,void 0,void 0,(function*(){const r=yield t.api(`/me/outlook/taskGroups/${o}/taskFolders`).header("Cache-Control","no-store").middlewareOptions((0,e.prepScopes)("Tasks.Read")).get();return r&&r.value}))}(this.graph,t)).map((e=>({_raw:e,id:e.id,name:e.name,parentId:t})))}))}getTasksForTaskFolder(t,o){return ao(this,void 0,void 0,(function*(){return(yield function(t,o){return io(this,void 0,void 0,(function*(){const r=yield t.api(`/me/outlook/taskFolders/${o}/tasks`).header("Cache-Control","no-store").middlewareOptions((0,e.prepScopes)("Tasks.Read")).get();return r&&r.value}))}(this.graph,t)).map((e=>({_raw:e,assignments:{},completed:!!e.completedDateTime,dueDate:e.dueDateTime&&new Date(e.dueDateTime.dateTime+"Z"),eTag:e["@odata.etag"],id:e.id,immediateParentId:t,name:e.subject,topParentId:o})))}))}setTaskComplete(e,t){return ao(this,void 0,void 0,(function*(){return yield function(e,t,o){return io(this,void 0,void 0,(function*(){return yield so(e,t,{isReminderOn:!1,status:"completed"},o)}))}(this.graph,e,t)}))}assignPeopleToTask(e,t,o){return ao(this,void 0,void 0,(function*(){return yield ro(this.graph,e,t,o)}))}setTaskIncomplete(e,t){return ao(this,void 0,void 0,(function*(){return yield function(e,t,o){return io(this,void 0,void 0,(function*(){return yield so(e,t,{isReminderOn:!0,status:"notStarted"},o)}))}(this.graph,e,t)}))}addTask(t){return ao(this,void 0,void 0,(function*(){const o={parentFolderId:t.immediateParentId,subject:t.name};return t.dueDate&&(o.dueDateTime={dateTime:t.dueDate.toISOString(),timeZone:"UTC"}),yield function(t,o){return io(this,void 0,void 0,(function*(){const{parentFolderId:r=null}=o;return r?yield t.api(`/me/outlook/taskFolders/${r}/tasks`).header("Cache-Control","no-store").middlewareOptions((0,e.prepScopes)("Tasks.ReadWrite")).post(o):yield t.api("/me/outlook/tasks").header("Cache-Control","no-store").middlewareOptions((0,e.prepScopes)("Tasks.ReadWrite")).post(o)}))}(this.graph,o)}))}removeTask(t,o){return ao(this,void 0,void 0,(function*(){return yield function(t,o,r){return io(this,void 0,void 0,(function*(){return yield t.api(`/me/outlook/tasks/${o}`).header("Cache-Control","no-store").header("If-Match",r).middlewareOptions((0,e.prepScopes)("Tasks.ReadWrite")).delete()}))}(this.graph,t,o)}))}isAssignedToMe(e,t){return!0}getTaskGroupsForGroup(e){return ao(this,void 0,void 0,(function*(){}))}}const po=[t.iv`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host,mgt-arrow-options{position:relative;font-family:var(--default-font-family)}:host .ArrowIcon,mgt-arrow-options .ArrowIcon{font-family:FabricMDL2Icons;margin:0 0 0 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Header,mgt-arrow-options .Header{cursor:pointer}:host .Header:hover,mgt-arrow-options .Header:hover{color:var(--theme-primary-color)}:host .Menu,mgt-arrow-options .Menu{position:absolute;left:var(--arrow-options-left,0);box-shadow:var(--box-shadow-color,rgba(0,0,0,.092)) 0 0 40px 5px;background:var(--background-color,#fff);z-index:1;display:none;color:var(--color,#000);white-space:nowrap}:host .Menu.Open,mgt-arrow-options .Menu.Open{display:block}:host .MenuOption,mgt-arrow-options .MenuOption{padding:20px;cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;display:flex;align-items:center;justify-content:stretch;justify-items:stretch}:host .MenuOption:first,mgt-arrow-options .MenuOption:first{padding:12px 20px 20px 20px}:host .MenuOption:hover,mgt-arrow-options .MenuOption:hover{background-color:var(--background-color--hover,#edebe9)}:host .MenuOption:active,mgt-arrow-options .MenuOption:active{background-color:var(--background-color--active,#e1dfdd)}:host .MenuOptionCheck,mgt-arrow-options .MenuOptionCheck{font-family:FabricMDL2Icons;color:transparent;margin-right:10px}:host .MenuOptionCheck.CurrentValue,mgt-arrow-options .MenuOptionCheck.CurrentValue{color:#0078d4}
`];var ho=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},fo=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let go=class extends e.MgtBaseComponent{constructor(){super(),this.value="",this.options={},this._clickHandler=e=>this.open=!1}static get styles(){return po}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this._clickHandler)}disconnectedCallback(){window.removeEventListener("click",this._clickHandler),super.disconnectedCallback()}onHeaderClick(e){Object.keys(this.options).length>1&&(e.preventDefault(),e.stopPropagation(),this.open=!this.open)}render(){return t.dy`
      <span class="Header" @click=${e=>this.onHeaderClick(e)}>
        <span class="CurrentValue">${this.value}</span>
      </span>
      <div class=${g({Menu:!0,Open:this.open,Closed:!this.open})}>
        ${this.getMenuOptions()}
      </div>
    `}getMenuOptions(){const e=Object.keys(this.options),o=this.options;return e.map((e=>t.dy`
        <div
          class="MenuOption"
          @click="${t=>{this.open=!1,o[e](t)}}"
        >
          <span class=${g({MenuOptionCheck:!0,CurrentValue:this.value===e})}>
            \uE73E
          </span>
          <span class="MenuOptionName">${e}</span>
        </div>
      `))}};ho([(0,t.Cb)({type:Boolean}),fo("design:type",Boolean)],go.prototype,"open",void 0),ho([(0,t.Cb)({type:String}),fo("design:type",String)],go.prototype,"value",void 0),ho([(0,t.Cb)({type:Object}),fo("design:type",Object)],go.prototype,"options",void 0),go=ho([(0,t.Mo)("mgt-arrow-options"),fo("design:paramtypes",[])],go);const mo=[t.iv`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host,mgt-dot-options{font-family:var(--default-font-family)}:host .DotIcon,mgt-dot-options .DotIcon{display:inline-block;font-family:FabricMDL2Icons;min-width:40px;min-height:30px;text-align:center;line-height:30px}:host .Menu,mgt-dot-options .Menu{position:absolute;box-shadow:var(--box-shadow-color,rgba(0,0,0,.092)) 0 0 40px 5px;background:var(--background-color,#fff);z-index:1;display:none;color:var(--color,#000);white-space:nowrap;transform:var(--dot-options-translateX,translateX(-50px))}:host .DotMenu.Open .Menu,mgt-dot-options .DotMenu.Open .Menu{display:block}:host .DotMenu .DotItem,mgt-dot-options .DotMenu .DotItem{direction:ltr;text-align:left;padding:10px 10px 8px 10px}:host .DotMenu .DotItem:hover,mgt-dot-options .DotMenu .DotItem:hover{background:var(--background-color--hover,#edebe9)}:host .DotMenu .DotItem:active,mgt-dot-options .DotMenu .DotItem:active{background:var(--background-color--active,#e1dfdd)}:host .DotMenu .DotItemName,mgt-dot-options .DotMenu .DotItemName{direction:rtl}
`];var vo=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},bo=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let yo=class extends e.MgtBaseComponent{constructor(){super(),this._clickHandler=null,this._clickHandler=e=>this.open=!1}static get styles(){return mo}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this._clickHandler)}disconnectedCallback(){window.removeEventListener("click",this._clickHandler),super.disconnectedCallback()}render(){return t.dy`
      <div class=${g({DotMenu:!0,Open:this.open})} @click=${e=>this.onDotClick(e)}>
        <span class="DotIcon">\uE712</span>
        <div class="Menu">
          ${Object.keys(this.options).map((e=>this.getMenuOption(e,this.options[e])))}
        </div>
      </div>
    `}getMenuOption(e,o){return t.dy`
      <div
        class="DotItem"
        @click="${e=>{e.preventDefault(),e.stopPropagation(),o(e),this.open=!1}}"
      >
        <span class="DotItemName">
          ${e}
        </span>
      </div>
    `}onDotClick(e){e.preventDefault(),e.stopPropagation(),this.open=!this.open}};vo([(0,t.Cb)({type:Boolean}),bo("design:type",Boolean)],yo.prototype,"open",void 0),vo([(0,t.Cb)({type:Object}),bo("design:type",Object)],yo.prototype,"options",void 0),yo=vo([(0,t.Mo)("mgt-dot-options"),bo("design:paramtypes",[])],yo);const ko={removeTaskSubtitle:"Delete Task",cancelNewTaskSubtitle:"cancel",newTaskPlaceholder:"Task...",addTaskButtonSubtitle:"Add"};var wo,Co=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},To=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},So=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};!function(e){e[e.planner=0]="planner",e[e.todo=1]="todo"}(wo||(wo={}));const _o={BASE_SELF_ASSIGNED:"All Tasks",BUCKETS_SELF_ASSIGNED:"All Tasks",BUCKET_NOT_FOUND:"Folder not found",PLANS_SELF_ASSIGNED:"All groups",PLAN_NOT_FOUND:"Group not found"},Io={BASE_SELF_ASSIGNED:"Assigned to Me",BUCKETS_SELF_ASSIGNED:"All Tasks",BUCKET_NOT_FOUND:"Bucket not found",PLANS_SELF_ASSIGNED:"All Plans",PLAN_NOT_FOUND:"Plan not found"},xo={"@odata.type":"microsoft.graph.plannerAssignment",orderHint:"string !"};let Eo=class extends e.MgtTemplatedComponent{constructor(){super(),this.dataSource=wo.planner,this._me=null,this.clearState(),this.previousMediaQuery=this.mediaQuery,this.onResize=this.onResize.bind(this)}get res(){switch(this.dataSource){case wo.todo:return _o;case wo.planner:default:return Io}}static get styles(){return to}get strings(){return ko}get isNewTaskVisible(){return this._isNewTaskVisible}set isNewTaskVisible(e){this._isNewTaskVisible=e,e||(this._newTaskDueDate=null,this._newTaskName="",this._newTaskGroupId="")}static get requiredScopes(){return[...new Set(["group.read.all","group.readwrite.all","tasks.read","tasks.readwrite",...Pe.requiredScopes,...At.requiredScopes])]}connectedCallback(){super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}attributeChangedCallback(e,t,o){super.attributeChangedCallback(e,t,o),"data-source"===e&&(this.dataSource===wo.planner?(this._currentGroup=this.initialId,this._currentFolder=this.initialBucketId):this.dataSource===wo.todo&&(this._currentGroup=null,this._currentFolder=this.initialId),this.clearState(),this.requestStateUpdate())}clearState(){this._newTaskFolderId="",this._newTaskGroupId="",this._newTaskDueDate=null,this._newTaskName="",this._newTaskBeingAdded=!1,this._tasks=[],this._folders=[],this._groups=[],this._hiddenTasks=[],this._loadingTasks=[],this._hasDoneInitialLoad=!1,this._inTaskLoad=!1,this._todoDefaultSet=!1}firstUpdated(e){super.firstUpdated(e),this.initialId&&!this._currentGroup&&(this.dataSource===wo.planner?this._currentGroup=this.initialId:this.dataSource===wo.todo&&(this._currentFolder=this.initialId)),this.dataSource===wo.planner&&this.initialBucketId&&!this._currentFolder&&(this._currentFolder=this.initialBucketId)}render(){let e=this._tasks.filter((e=>this.isTaskInSelectedGroupFilter(e))).filter((e=>this.isTaskInSelectedFolderFilter(e))).filter((e=>!this._hiddenTasks.includes(e.id)));this.taskFilter&&(e=e.filter((e=>this.taskFilter(e._raw))));const o=this._inTaskLoad&&!this._hasDoneInitialLoad?this.renderLoadingTask():null;let r;return this.hideHeader||(r=t.dy`
        <div class="Header" dir=${this.direction}>
          ${this.renderPlanOptions()}
        </div>
      `),t.dy`
      ${r}
      <div class="Tasks" dir=${this.direction}>
        ${this._isNewTaskVisible?this.renderNewTask():null} ${o}
        ${Ie(e,(e=>e.id),(e=>this.renderTask(e)))}
      </div>
    `}loadState(){return So(this,void 0,void 0,(function*(){const t=this.getTaskSource();if(!t)return;const o=e.Providers.globalProvider;if(!o||o.state!==e.ProviderState.SignedIn)return;let r;this._inTaskLoad=!0,this._me||(r=M(o.graph.forComponent(this))),this.groupId&&this.dataSource===wo.planner?yield this._loadTasksForGroup(t):this.targetId?this.dataSource===wo.todo?yield this._loadTargetTodoTasks(t):yield this._loadTargetPlannerTasks(t):yield this._loadAllTasks(t),r&&(this._me=yield r),this._inTaskLoad=!1,this._hasDoneInitialLoad=!0}))}onResize(){this.mediaQuery!==this.previousMediaQuery&&(this.previousMediaQuery=this.mediaQuery,this.requestUpdate())}_loadTargetTodoTasks(e){return So(this,void 0,void 0,(function*(){const t=yield e.getTaskGroups(),o=(yield Promise.all(t.map((t=>e.getTaskFoldersForTaskGroup(t.id))))).reduce(((e,t)=>[...e,...t]),[]),r=(yield Promise.all(o.map((t=>e.getTasksForTaskFolder(t.id,t.parentId))))).reduce(((e,t)=>[...e,...t]),[]);this._tasks=r,this._folders=o,this._groups=t,this._currentGroup=null}))}_loadTargetPlannerTasks(e){return So(this,void 0,void 0,(function*(){const t=yield e.getTaskGroup(this.targetId);let o=yield e.getTaskFoldersForTaskGroup(t.id);this.targetBucketId&&(o=o.filter((e=>e.id===this.targetBucketId)));const r=(yield Promise.all(o.map((t=>e.getTasksForTaskFolder(t.id,t.parentId))))).reduce(((e,t)=>[...e,...t]),[]);this._tasks=r,this._folders=o,this._groups=[t]}))}_loadAllTasks(e){return So(this,void 0,void 0,(function*(){const t=yield e.getTaskGroups(),o=(yield Promise.all(t.map((t=>e.getTaskFoldersForTaskGroup(t.id))))).reduce(((e,t)=>[...e,...t]),[]);if(!this.initialId&&this.dataSource===wo.todo&&!this._todoDefaultSet){this._todoDefaultSet=!0;const e=o.find((e=>e._raw.isDefaultFolder));e&&(this._currentFolder=e.id)}const r=(yield Promise.all(o.map((t=>e.getTasksForTaskFolder(t.id,t.parentId))))).reduce(((e,t)=>[...e,...t]),[]);this._tasks=r,this._folders=o,this._groups=t}))}_loadTasksForGroup(e){return So(this,void 0,void 0,(function*(){const t=yield e.getTaskGroupsForGroup(this.groupId),o=(yield Promise.all(t.map((t=>e.getTaskFoldersForTaskGroup(t.id))))).reduce(((e,t)=>[...e,...t]),[]),r=(yield Promise.all(o.map((t=>e.getTasksForTaskFolder(t.id,t.parentId))))).reduce(((e,t)=>[...e,...t]),[]);this._tasks=r,this._folders=o,this._groups=t}))}addTask(e,t,o,r,n={}){return So(this,void 0,void 0,(function*(){const i=this.getTaskSource();if(!i)return;const s={assignments:n,dueDate:t,immediateParentId:r,name:e,topParentId:o};this._newTaskBeingAdded=!0;const a=yield i.addTask(s);this.fireCustomEvent("taskAdded",a),yield this.requestStateUpdate(),this._newTaskBeingAdded=!1,this.isNewTaskVisible=!1}))}completeTask(e){return So(this,void 0,void 0,(function*(){const t=this.getTaskSource();t&&(this._loadingTasks=[...this._loadingTasks,e.id],yield t.setTaskComplete(e.id,e.eTag),this.fireCustomEvent("taskChanged",e),yield this.requestStateUpdate(),this._loadingTasks=this._loadingTasks.filter((t=>t!==e.id)))}))}uncompleteTask(e){return So(this,void 0,void 0,(function*(){const t=this.getTaskSource();t&&(this._loadingTasks=[...this._loadingTasks,e.id],yield t.setTaskIncomplete(e.id,e.eTag),this.fireCustomEvent("taskChanged",e),yield this.requestStateUpdate(),this._loadingTasks=this._loadingTasks.filter((t=>t!==e.id)))}))}removeTask(e){return So(this,void 0,void 0,(function*(){const t=this.getTaskSource();t&&(this._hiddenTasks=[...this._hiddenTasks,e.id],yield t.removeTask(e.id,e.eTag),this.fireCustomEvent("taskRemoved",e),yield this.requestStateUpdate(),this._hiddenTasks=this._hiddenTasks.filter((t=>t!==e.id)))}))}assignPeople(e,t){return So(this,void 0,void 0,(function*(){const o=this.getTaskSource();if(!o)return;let r=[];e&&e.assignments&&(r=Object.keys(e.assignments).sort());const n=t.map((e=>e.id));if(n.length===r.length&&n.sort().every(((e,t)=>e===r[t])))return;const i={};if(0===t.length)for(let e=0;e<r.length;e++)i[r[e]]=null;if(t){for(let e=0;e<r.length;e++)for(let o=0;o<t.length;o++){if(r[e]!==t[o].id){i[r[e]]=null;break}i[r[e]]=xo}for(let e=0;e<t.length;e++)i[t[e].id]=xo}e&&(this._loadingTasks=[...this._loadingTasks,e.id],yield o.assignPeopleToTask(e.id,i,e.eTag),yield this.requestStateUpdate(),this._loadingTasks=this._loadingTasks.filter((t=>t!==e.id)))}))}onAddTaskClick(e){const t=this.getPeoplePicker(null),o={};if(t)for(const e of t.selectedPeople)t.selectedPeople.length&&(o[e.id]=xo);!this._newTaskBeingAdded&&this._newTaskName&&(this._currentGroup||this._newTaskGroupId)&&this.addTask(this._newTaskName,this._newTaskDueDate,this._currentGroup?this._currentGroup:this._newTaskGroupId,this._currentFolder?this._currentFolder:this._newTaskFolderId,o)}renderPlanOptions(){const o=e.Providers.globalProvider;if(!o||o.state!==e.ProviderState.SignedIn)return null;if(this._inTaskLoad&&!this._hasDoneInitialLoad)return t.dy`
        <span class="LoadingHeader"></span>
      `;const r=this.readOnly||this._isNewTaskVisible?null:t.dy`
            <div
              class="AddBarItem NewTaskButton"
              @click="${()=>{this.isNewTaskVisible=!this.isNewTaskVisible}}"
            >
              <span class="TaskIcon"></span>
              <span>${this.strings.addTaskButtonSubtitle}</span>
            </div>
          `;if(this.dataSource===wo.planner){const e=this._groups.find((e=>e.id===this._currentGroup))||{title:this.res.BASE_SELF_ASSIGNED},o={[this.res.BASE_SELF_ASSIGNED]:e=>{this._currentGroup=null,this._currentFolder=null}};for(const e of this._groups)o[e.title]=t=>{this._currentGroup=e.id,this._currentFolder=null};const n=t.dy`
        <mgt-arrow-options .options="${o}" .value="${e.title}"></mgt-arrow-options>
      `,i=this._currentGroup?t.dy`
            <span class="TaskIcon Divider">/</span>
          `:null,s=this._folders.find((e=>e.id===this._currentFolder))||{name:this.res.BUCKETS_SELF_ASSIGNED},a={[this.res.BUCKETS_SELF_ASSIGNED]:e=>{this._currentFolder=null}};for(const e of this._folders.filter((e=>e.parentId===this._currentGroup)))a[e.name]=t=>{this._currentFolder=e.id};const c=this.targetBucketId?t.dy`
            <span class="PlanTitle">
              ${this._folders[0]&&this._folders[0].name}
            </span>
          `:t.dy`
            <mgt-arrow-options .options="${a}" .value="${s.name}"></mgt-arrow-options>
          `;return t.dy`
        <div class="TitleCont">
          ${n} ${i} ${this._currentGroup?c:null}
        </div>
        ${r}
      `}{const e=this._folders.find((e=>e.id===this.targetId))||{name:this.res.BUCKETS_SELF_ASSIGNED},o=this._folders.find((e=>e.id===this._currentFolder))||{name:this.res.BUCKETS_SELF_ASSIGNED},n={};for(const e of this._folders)n[e.name]=()=>{this._currentFolder=e.id};n[this.res.BUCKETS_SELF_ASSIGNED]=e=>{this._currentFolder=null};const i=this.targetId?t.dy`
            <span class="PlanTitle">
              ${e.name}
            </span>
          `:t.dy`
            <mgt-arrow-options .value="${o.name}" .options="${n}"></mgt-arrow-options>
          `;return t.dy`
        <span class="TitleCont">
          ${i}
        </span>
        ${r}
      `}}renderNewTask(){const e=t.dy`
      <input
        type="text"
        placeholder=${this.strings.newTaskPlaceholder}
        .value="${this._newTaskName}"
        label="new-taskName-input"
        aria-label="new-taskName-input"
        role="input"
        @input="${e=>{this._newTaskName=e.target.value}}"
      />
    `,o=this._groups;o.length>0&&!this._newTaskGroupId&&(this._newTaskGroupId=o[0].id);const r=this.dataSource===wo.todo?null:this._currentGroup?t.dy`
            <span class="NewTaskGroup">
              ${this.renderPlannerIcon()}
              <span>${this.getPlanTitle(this._currentGroup)}</span>
            </span>
          `:t.dy`
            <span class="NewTaskGroup">
              ${this.renderPlannerIcon()}
              <select
                .value="${this._newTaskGroupId}"
                @change="${e=>{this._newTaskGroupId=e.target.value}}"
              >
                ${this._groups.map((e=>t.dy`
                    <option value="${e.id}">${e.title}</option>
                  `))}
              </select>
            </span>
          `,n=this._folders.filter((e=>this._currentGroup&&e.parentId===this._currentGroup||!this._currentGroup&&e.parentId===this._newTaskGroupId));n.length>0&&!this._newTaskFolderId&&(this._newTaskFolderId=n[0].id);const i=this._currentFolder?t.dy`
          <span class="NewTaskBucket">
            ${this.renderBucketIcon()}
            <span>${this.getFolderName(this._currentFolder)}</span>
          </span>
        `:t.dy`
          <span class="NewTaskBucket">
            ${this.renderBucketIcon()}
            <select
              .value="${this._newTaskFolderId}"
              @change="${e=>{this._newTaskFolderId=e.target.value}}"
            >
              ${n.map((e=>t.dy`
                  <option value="${e.id}">${e.name}</option>
                `))}
            </select>
          </span>
        `,s=t.dy`
      <span class="NewTaskDue">
        <input
          type="date"
          label="new-taskDate-input"
          aria-label="new-taskDate-input"
          role="input"
          .value="${this.dateToInputValue(this._newTaskDueDate)}"
          @change="${e=>{const t=e.target.value;this._newTaskDueDate=t?new Date(t+"T17:00"):null}}"
        />
      </span>
    `,a=this.dataSource===wo.todo?null:this.renderAssignedPeople(null),c=this._newTaskBeingAdded?t.dy`
          <div class="TaskAddButtonContainer"></div>
        `:t.dy`
          <div class="TaskAddButtonContainer ${""===this._newTaskName?"Disabled":""}">
            <div class="TaskIcon TaskCancel" @click="${()=>this.isNewTaskVisible=!1}">
              <span>${this.strings.cancelNewTaskSubtitle}</span>
            </div>
            <div class="TaskIcon TaskAdd" @click="${this.onAddTaskClick}">
              <span></span>
            </div>
          </div>
        `;return t.dy`
      <div class="Task NewTask Incomplete">
        <div class="TaskContent">
          <div class="TaskDetailsContainer">
            <div class="TaskTitle">
              ${e}
            </div>
            <div class="TaskDetails">
              ${r} ${i} ${s} ${a}
            </div>
          </div>
        </div>
        ${c}
      </div>
    `}togglePeoplePicker(e){const t=this.getPeoplePicker(e),o=this.getMgtPeople(e),r=this.getFlyout(e);t&&o&&r&&(r.isOpen?r.close():(t.selectedPeople=o.people,r.open(),window.requestAnimationFrame((()=>{t.focus()}))))}updateAssignedPeople(e){const t=this.getPeoplePicker(e),o=this.getMgtPeople(e);t&&t.selectedPeople!==o.people&&(o.people=t.selectedPeople,this.assignPeople(e,t.selectedPeople))}getPeoplePicker(e){const t=e?e.id:"newTask";return this.renderRoot.querySelector(`.picker-${t}`)}getMgtPeople(e){const t=e?e.id:"newTask";return this.renderRoot.querySelector(`.people-${t}`)}getFlyout(e){const t=e?e.id:"newTask";return this.renderRoot.querySelector(`.flyout-${t}`)}renderTask(e){const{name:o="Task",completed:r=!1,dueDate:n}=e,i=this._loadingTasks.includes(e.id),s={Complete:!i&&r,Loading:i,TaskCheck:!0,TaskIcon:!0},c=i?t.dy`
          
        `:r?t.dy`
          
        `:null,l=t.dy`
      <span class=${g(s)}><span class="TaskCheckContent">${c}</span></span>
    `,d=this._currentGroup?null:this.getPlanTitle(e.topParentId),u=this._currentFolder?null:this.getFolderName(e.immediateParentId),p={task:Object.assign(Object.assign({},e._raw),{groupTitle:d,folderTitle:u})},h=this.renderTemplate("task",p,e.id);if(h)return h;let f=this.renderTemplate("task-details",p,`task-details-${e.id}`);if(!f){const r=this.dataSource===wo.todo||this._currentGroup?null:t.dy`
              <div class="TaskDetail TaskGroup">
                ${this.renderPlannerIcon()}
                <span>${this.getPlanTitle(e.topParentId)}</span>
              </div>
            `,i=this._currentFolder?null:t.dy`
            <div class="TaskDetail TaskBucket">
              ${this.renderBucketIcon()}
              <span>${this.getFolderName(e.immediateParentId)}</span>
            </div>
          `,s=n?t.dy`
            <div class="TaskDetail TaskDue">
              <span>Due ${a(n)}</span>
            </div>
          `:null,c=this.dataSource!==wo.todo?this.renderAssignedPeople(e):null;f=t.dy`
        <div class="TaskTitle">
          ${o}
        </div>
        ${r} ${i} ${c} ${s}
      `}const m=this.readOnly||this.hideOptions?null:t.dy`
            <div class="TaskOptions">
              <mgt-dot-options
                .options="${{[this.strings.removeTaskSubtitle]:()=>this.removeTask(e)}}"
              ></mgt-dot-options>
            </div>
          `;return t.dy`
      <div
        class=${g({Complete:r,Incomplete:!r,ReadOnly:this.readOnly,Task:!0})}
      >
        <div
          class="TaskContent"
          @click=${()=>{this.handleTaskClick(e)}}
        >
          <span
            class=${g({Complete:r,Incomplete:!r,TaskCheckContainer:!0})}
            @click="${t=>{this.readOnly||(e.completed?this.uncompleteTask(e):this.completeTask(e),t.stopPropagation(),t.preventDefault())}}"
          >
            ${l}
          </span>
          <div class="TaskDetailsContainer ${this.mediaQuery} ${this._currentGroup?"NoPlan":""}">
            ${f}
          </div>
          ${m}

          <div class="Divider"></div>
        </div>
      </div>
    `}renderAssignedPeople(e){let o=null;const r={NewTaskAssignee:null===e,TaskAssignee:null!==e,TaskDetail:null!==e},n=e?Object.keys(e.assignments).map((e=>e)):[],i=t.dy`
      <template data-type="no-data">
        <i class="login-icon ms-Icon ms-Icon--Contact"></i>
      </template>
    `,s=e?e.id:"newTask";return r[`flyout-${s}`]=!0,o=t.dy`
      <mgt-people
        class="people-${s}"
        .userIds="${n}"
        .personCardInteraction=${le.none}
        @click=${t=>{this.togglePeoplePicker(e),t.stopPropagation()}}
        >${i}
      </mgt-people>
    `,t.dy`
      <mgt-flyout light-dismiss class=${g(r)} @closed=${t=>this.updateAssignedPeople(e)}>
        ${o}
        <div slot="flyout" class=${g({Picker:!0})}>
          <mgt-people-picker
            class="picker-${s}"
            @click=${e=>e.stopPropagation()}
          ></mgt-people-picker>
        </div>
      </mgt-flyout>
    `}handleTaskClick(e){e&&this.fireCustomEvent("taskClick",{task:e._raw})}renderLoadingTask(){return t.dy`
      <div class="Task LoadingTask">
        <div class="TaskContent">
          <div class="TaskCheckContainer">
            <div class="TaskCheck"></div>
          </div>
          <div class="TaskDetailsContainer">
            <div class="TaskTitle"></div>
            <div class="TaskDetails">
              <span class="TaskDetail">
                <div class="TaskDetailIcon"></div>
                <div class="TaskDetailName"></div>
              </span>
              <span class="TaskDetail">
                <div class="TaskDetailIcon"></div>
                <div class="TaskDetailName"></div>
              </span>
            </div>
          </div>
        </div>
      </div>
    `}renderPlannerIcon(){return t.dy`
      <svg width="16" height="18" viewBox="0 0 16 18" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M7.223 1.156C6.98 1.26 6.769 1.404 6.586 1.586C6.403 1.768 6.261 1.98 6.157 2.223C6.052 2.465 6 2.724 6 3H2V17H14V3H10C10 2.724 9.948 2.465 9.844 2.223C9.74 1.98 9.596 1.768 9.414 1.586C9.231 1.404 9.02 1.26 8.777 1.156C8.535 1.053 8.276 1 8 1C7.723 1 7.465 1.053 7.223 1.156ZM5 4H7V3C7 2.86 7.026 2.729 7.078 2.609C7.13 2.49 7.202 2.385 7.293 2.293C7.384 2.202 7.49 2.131 7.609 2.079C7.73 2.026 7.859 2 8 2C8.14 2 8.271 2.026 8.39 2.079C8.511 2.131 8.616 2.202 8.707 2.293C8.798 2.385 8.87 2.49 8.922 2.609C8.974 2.729 9 2.86 9 3V4H11V5H5V4ZM12 6V4H13V16H3V4H4V6H12Z"
          fill="#3C3C3C"
        />
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M7.35156 12.3517L5.49956 14.2037L4.14856 12.8517L4.85156 12.1487L5.49956 12.7967L6.64856 11.6487L7.35156 12.3517Z"
          fill="#3C3C3C"
        />
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M7.35156 8.35168L5.49956 10.2037L4.14856 8.85168L4.85156 8.14868L5.49956 8.79668L6.64856 7.64868L7.35156 8.35168Z"
          fill="#3C3C3C"
        />
        <path fill-rule="evenodd" clip-rule="evenodd" d="M8 14H12.001V13H8V14Z" fill="#3C3C3C" />
        <path fill-rule="evenodd" clip-rule="evenodd" d="M8 10H12.001V9H8V10Z" fill="#3C3C3C" />
      </svg>
    `}renderBucketIcon(){return t.dy`
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M14 2H2V4H3H5H6H10H11H13H14V2ZM10 5H6V6H10V5ZM5 5H3V14H13V5H11V6C11 6.55228 10.5523 7 10 7H6C5.44772 7 5 6.55228 5 6V5ZM1 5H2V14V15H3H13H14V14V5H15V4V2V1H14H2H1V2V4V5Z"
          fill="#3C3C3C"
        />
      </svg>
    `}getTaskSource(){const t=e.Providers.globalProvider;if(!t||t.state!==e.ProviderState.SignedIn)return null;const o=t.graph.forComponent(this);return this.dataSource===wo.planner?new lo(o):this.dataSource===wo.todo?new uo(o):null}getPlanTitle(e){return e?e===this.res.PLANS_SELF_ASSIGNED?this.res.PLANS_SELF_ASSIGNED:(this._groups.find((t=>t.id===e))||{title:this.res.PLAN_NOT_FOUND}).title:this.res.BASE_SELF_ASSIGNED}getFolderName(e){return e?(this._folders.find((t=>t.id===e))||{name:this.res.BUCKET_NOT_FOUND}).name:this.res.BUCKETS_SELF_ASSIGNED}isTaskInSelectedGroupFilter(e){return e.topParentId===this._currentGroup||!this._currentGroup&&this.getTaskSource().isAssignedToMe(e,this._me.id)}isTaskInSelectedFolderFilter(e){return e.immediateParentId===this._currentFolder||!this._currentFolder}dateToInputValue(e){return e?new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().split("T")[0]:null}};Co([(0,t.Cb)({attribute:"read-only",type:Boolean}),To("design:type",Boolean)],Eo.prototype,"readOnly",void 0),Co([(0,t.Cb)({attribute:"data-source",converter:(e,t)=>(e=e.toLowerCase(),wo[e]||wo.planner)}),To("design:type",Number)],Eo.prototype,"dataSource",void 0),Co([(0,t.Cb)({attribute:"target-id",type:String}),To("design:type",String)],Eo.prototype,"targetId",void 0),Co([(0,t.Cb)({attribute:"target-bucket-id",type:String}),To("design:type",String)],Eo.prototype,"targetBucketId",void 0),Co([(0,t.Cb)({attribute:"initial-id",type:String}),To("design:type",String)],Eo.prototype,"initialId",void 0),Co([(0,t.Cb)({attribute:"initial-bucket-id",type:String}),To("design:type",String)],Eo.prototype,"initialBucketId",void 0),Co([(0,t.Cb)({attribute:"hide-header",type:Boolean}),To("design:type",Boolean)],Eo.prototype,"hideHeader",void 0),Co([(0,t.Cb)({attribute:"hide-options",type:Boolean}),To("design:type",Boolean)],Eo.prototype,"hideOptions",void 0),Co([(0,t.Cb)({attribute:"group-id",type:String}),To("design:type",String)],Eo.prototype,"groupId",void 0),Co([(0,t.Cb)(),To("design:type",Boolean)],Eo.prototype,"_isNewTaskVisible",void 0),Co([(0,t.Cb)(),To("design:type",Boolean)],Eo.prototype,"_newTaskBeingAdded",void 0),Co([(0,t.Cb)(),To("design:type",String)],Eo.prototype,"_newTaskName",void 0),Co([(0,t.Cb)(),To("design:type",Date)],Eo.prototype,"_newTaskDueDate",void 0),Co([(0,t.Cb)(),To("design:type",String)],Eo.prototype,"_newTaskGroupId",void 0),Co([(0,t.Cb)(),To("design:type",String)],Eo.prototype,"_newTaskFolderId",void 0),Co([(0,t.Cb)(),To("design:type",Array)],Eo.prototype,"_groups",void 0),Co([(0,t.Cb)(),To("design:type",Array)],Eo.prototype,"_folders",void 0),Co([(0,t.Cb)(),To("design:type",Array)],Eo.prototype,"_tasks",void 0),Co([(0,t.Cb)(),To("design:type",Array)],Eo.prototype,"_hiddenTasks",void 0),Co([(0,t.Cb)(),To("design:type",Array)],Eo.prototype,"_loadingTasks",void 0),Co([(0,t.Cb)(),To("design:type",Boolean)],Eo.prototype,"_inTaskLoad",void 0),Co([(0,t.Cb)(),To("design:type",Boolean)],Eo.prototype,"_hasDoneInitialLoad",void 0),Co([(0,t.Cb)(),To("design:type",Boolean)],Eo.prototype,"_todoDefaultSet",void 0),Co([(0,t.Cb)(),To("design:type",String)],Eo.prototype,"_currentGroup",void 0),Co([(0,t.Cb)(),To("design:type",String)],Eo.prototype,"_currentFolder",void 0),Eo=Co([(0,t.Mo)("mgt-tasks"),To("design:paramtypes",[])],Eo);const Ao=[t.iv`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--dropdown-item-selected-background:#deecf9;--arrow-fill:#000000}.mgt-dark{--dropdown-item-selected-background:#333d47;--arrow-fill:#605e5c}:host{font-family:var(--default-font-family)}.root{position:relative}.root .input-wrapper{font-family:var(--default-font-family);display:flex;flex-wrap:wrap;align-items:center;padding:4px 10px;position:relative;background-color:var(--input-background-color,#fff);font-size:14px;color:var(--color-sub1,#323130);height:29px;line-height:19px;cursor:text;border-top:var(--input-border-top,2px solid #605e5c);border-right:var(--input-border-right,2px solid #605e5c);border-bottom:var(--input-border-bottom,2px solid #605e5c);border-left:var(--input-border-left,2px solid #605e5c);border:var(--input-border,2px solid #605e5c)}.root .input-wrapper:hover{border-color:var(--input-border-color--hover,#323130)}.root .input-wrapper.focused{border-color:var(--input-border-color--focus,#0078d4)}.root .input-wrapper .selected-team{padding-right:10px;border:none;display:flex;position:relative;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;align-items:center;height:24px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.root .input-wrapper .selected-team .arrow{margin-left:8px;margin-right:8px}.root .input-wrapper .selected-team .selected-team-name{font-weight:700}.root .input-wrapper .selected-team .search-wrapper{margin-left:12px;height:18px;display:flex;flex-wrap:nowrap;align-items:center;margin-right:30px}.root .input-wrapper .search-wrapper{overflow:hidden;height:18px;display:flex;flex-wrap:nowrap;align-items:center;margin-right:30px}.root .input-wrapper .hide-icon{display:none}.root .input-wrapper .team-chosen-input{display:inline-block;border:none;line-height:normal;outline:0;font-family:var(--default-font-family);font-style:normal;font-weight:400;font-size:14px;line-height:19px;background-color:transparent;color:var(--color-sub1,#323130);padding-left:5px}.root .input-wrapper .team-chosen-input::placeholder{color:var(--placeholder-color,#605e5c)}.root .input-wrapper .team-chosen-input[contenteditable]:empty::after{content:attr(data-placeholder);color:var(--placeholder-color,#605e5c)}.root .input-wrapper .search-icon{margin-top:1px;align-self:flex-start;font-family:FabricMDL2Icons;color:var(--accent-color,#0078d4);line-height:normal}.root .input-wrapper .input-search{height:19px}.root .input-wrapper .input-search-start{white-space:nowrap;line-height:normal;margin-inline-start:0;margin-inline-end:0}.root .input-wrapper::after{content:'';position:absolute;width:100%;height:90%;top:2px;right:2px;background-image:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-moz-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-o-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%)}.root .close-icon{display:inline-block;position:absolute;right:10px;top:12px;line-height:normal;font-family:FabricMDL2Icons;cursor:pointer;color:var(--placeholder-color,#605e5c);background-color:var(--input-background-color,#fff)}.root .close-icon:hover{color:var(--color-sub1,#323130)}.root .dropdown{padding-top:5px;padding-bottom:11px;position:absolute;box-shadow:0 1.3289px 2.65781px rgba(180,180,180,.182),0 1.3289px 2.65781px rgba(68,68,68,.3);border-radius:2px;background-color:var(--dropdown-background-color,var(--list-background-color,#fff));z-index:1;width:100%;text-align:left;list-style-type:none;font-family:var(--default-font-family);font-style:normal;font-weight:400;color:var(--color-sub1,#323130);display:none;max-height:346px;overflow-y:auto}.root .dropdown.visible{display:block}.root .dropdown .item .arrow svg{fill:var(--arrow-fill,#000)}.root .dropdown .item.list-team{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;-o-user-select:none;display:flex;flex-direction:row;align-items:center;padding:5px 12px 6px 14px;margin-top:6px;font-family:var(--default-font-family);font-style:normal;font-weight:600;font-size:16px;color:var(--color-sub1,#323130);flex-flow:nowrap;position:relative;overflow:hidden;white-space:nowrap;background-color:transparent}.root .dropdown .item.list-team:after{content:'';position:absolute;width:36px;height:100%;top:0;right:0;background-image:-webkit-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:-moz-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:-ms-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:-o-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:linear-gradient(to left,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0))}.root .dropdown .item.list-team:hover{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.root .dropdown .item.list-team .arrow{margin-right:5px;margin-bottom:1px}.root .dropdown .item.selected{background-color:var(--dropdown-item-selected-background,#deecf9)}.root .dropdown .item.focused{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.root .dropdown .channel-display{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;-o-user-select:none;cursor:pointer;padding-left:21px;padding-right:10px}.root .dropdown .channel-display .showing{padding-left:10px;padding-top:4px;padding-bottom:4px}.root .dropdown .channel-display .showing .channel-name-text{font-size:14px;font-weight:400;color:var(--color-sub1,#323130);margin:0;padding:0}.root .dropdown .channel-display .showing .channel-name-text.highlight-search-text{font-weight:700}.root .dropdown .channel-display:hover{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.root .dropdown .loading-text,.root .dropdown .search-error-text{font-family:var(--default-font-family);font-style:normal;font-weight:600;font-size:14px;color:var(--color-sub1,#323130);line-height:19px;text-align:center}.root .dropdown .message-parent{padding:2px;margin-top:30px;margin-bottom:30px;display:flex;flex-direction:column;align-items:center;justify-content:center;vertical-align:middle}.root .dropdown .message-parent .loading-text{margin-top:3px;margin-left:9px;color:#0078d4}[dir=rtl] .input-wrapper::after{content:'';position:absolute;width:99%;height:90%;top:2px;left:0;background-image:linear-gradient(to left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-moz-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-o-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-ms-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-webkit-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%)}[dir=rtl] .search-wrapper{margin-right:0!important}[dir=rtl] .search-icon{margin-left:8px!important}[dir=rtl] .channel-display{padding:0 34px 0 10px!important}[dir=rtl] .close-icon{right:auto;left:10px}[dir=rtl] .dropdown{text-align:right}[dir=rtl] .arrow{-moz-transform:scaleX(-1);-o-transform:scaleX(-1);-webkit-transform:scaleX(-1);transform:scaleX(-1);filter:FlipH;-ms-filter:FlipH;margin-right:0;margin-left:5px}[dir=rtl] .selected-team{padding-left:10px}
`];const Po={inputPlaceholderText:"Select a channel",noResultsFound:"We didn't find any matches.",loadingMessage:"Loading..."};var Ro,Oo=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},No=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Do=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};let Lo=Ro=class extends e.MgtTemplatedComponent{constructor(){super(),this._inputValue="",this._isFocused=!1,this._treeViewState=[],this._focusList=[],this._focusedIndex=-1,this.handleWindowClick=this.handleWindowClick.bind(this),this.addEventListener("keydown",(e=>this.onUserKeyDown(e))),this.addEventListener("focus",(e=>this.loadTeamsIfNotLoaded())),this.addEventListener("mouseover",(e=>this.loadTeamsIfNotLoaded()))}static get styles(){return Ao}get strings(){return Po}static get config(){return this._config}get selectedItem(){return this._selectedItemState?{channel:this._selectedItemState.item,team:this._selectedItemState.parent.item}:null}static get requiredScopes(){return this.config.useTeamsBasedScopes?["team.readbasic.all","channel.readbasic.all"]:["user.read.all","group.read.all"]}set items(e){this._items!==e&&(this._items=e,this._treeViewState=e?this.generateTreeViewState(e):[],this.resetFocusState())}get items(){return this._items}get _input(){return this.renderRoot.querySelector(".team-chosen-input")}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this.handleWindowClick)}disconnectedCallback(){window.removeEventListener("click",this.handleWindowClick),super.disconnectedCallback()}selectChannelById(t){return Do(this,void 0,void 0,(function*(){const o=e.Providers.globalProvider;if(o&&o.state===e.ProviderState.SignedIn){this.items||(yield this.requestStateUpdate());for(const e of this._treeViewState)for(const o of e.channels)if(o.item.id===t)return this.selectChannel(o),!0}return!1}))}render(){const e={focused:this._isFocused,"input-wrapper":!0},o=(this._isFocused&&this._selectedItemState,{dropdown:!0,visible:this._isDropdownVisible}),r={"hide-icon":!!this._selectedItemState,"search-wrapper":!0};return this.renderTemplate("default",{teams:this.items})||t.dy`
        <div class="root" @blur=${this.lostFocus} dir=${this.direction}>
          <div class=${g(e)} @click=${this.gainedFocus}>
            ${this.renderSelected()}
            <div class=${g(r)}>${this.renderSearchIcon()} ${this.renderInput()}</div>
          </div>
          ${this.renderCloseButton()}
          <div class=${g(o)}>${this.renderDropdown()}</div>
        </div>
      `}renderSelected(){return this._selectedItemState?t.dy`
      <li class="selected-team" title=${this._selectedItemState.item.displayName}>
        <div class="selected-team-name">${this._selectedItemState.parent.item.displayName}</div>
        <div class="arrow">${re(te.TeamSeparator,"#B3B0AD")}</div>
        ${this._selectedItemState.item.displayName}
        <div class="search-wrapper">${this.renderSearchIcon()} ${this.renderInput()}</div>
      </li>
    `:t.dy``}clearState(){this._items=[],this._inputValue="",this._treeViewState=[],this._focusList=[]}renderSearchIcon(){return t.dy`
      <div class="search-icon">
        ${re(te.Search,"#252424")}
      </div>
    `}renderInput(){const e={"input-search":!!this._selectedItemState,"input-search-start":!this._selectedItemState};return t.dy`
      <div class="${g(e)}">
        <span
          id="teams-channel-picker-input"
          class="team-chosen-input"
          type="text"
          label="teams-channel-picker-input"
          aria-label="Select a channel"
          data-placeholder="${this._selectedItemState?"":this.strings.inputPlaceholderText} "
          role="input"
          @keyup=${e=>this.handleInputChanged(e)}
          contenteditable
        ></span>
      </div>
    `}renderCloseButton(){return t.dy`
      <div class="close-icon" @click="${()=>this.selectChannel(null)}">
        
      </div>
    `}renderDropdown(){return this.isLoadingState||!this._treeViewState?this.renderLoading():this._treeViewState?!this.isLoadingState&&0===this._treeViewState.length&&this._inputValue.length>0?this.renderError():this.renderDropdownList(this._treeViewState):t.dy``}renderDropdownList(e,o=0){return e&&e.length?e.map(((e,r)=>{const n=!!e.channels&&e.isExpanded;return t.dy`
          ${this.renderItem(e)}
          ${n?this.renderDropdownList(e.channels,o+1):t.dy``}
        `})):null}renderItem(e){let o=null;e.channels&&(o=e.isExpanded?re(te.ArrowDown,"#252424"):re(te.ArrowRight,"#252424"));let r=!1;this.selectedItem&&this.selectedItem.channel===e.item&&(r=!0);const n={focused:this._focusList[this._focusedIndex]===e,item:!0,"list-team":!!e.channels,selected:r},i=this.renderRoot.querySelector(".dropdown");return i.children[this._focusedIndex]&&i.children[this._focusedIndex].scrollIntoView(!1),t.dy`
      <div @click=${()=>this.handleItemClick(e)} class="${g(n)}">
        <div class="arrow">
          ${o}
        </div>
        ${e.channels?e.item.displayName:this.renderHighlightedText(e.item)}
      </div>
    `}renderHighlightedText(e){let o={};const r=e.displayName.toLowerCase().indexOf(this._inputValue.toLowerCase());return-1!==r?0===r?(o.first="",o.highlight=e.displayName.slice(0,this._inputValue.length),o.last=e.displayName.slice(this._inputValue.length,e.displayName.length)):r===e.displayName.length?(o.first=e.displayName.slice(0,r),o.highlight=e.displayName.slice(r,e.displayName.length),o.last=""):(o.first=e.displayName.slice(0,r),o.highlight=e.displayName.slice(r,r+this._inputValue.length),o.last=e.displayName.slice(r+this._inputValue.length,e.displayName.length)):o.last=e.displayName,t.dy`
      <div class="channel-display">
        <div class="showing">
          <span class="channel-name-text">${o.first}</span
          ><span class="channel-name-text highlight-search-text">${o.highlight}</span
          ><span class="channel-name-text">${o.last}</span>
        </div>
      </div>
    `}renderError(){return this.renderTemplate("error",null,"error")||t.dy`
        <div class="message-parent">
          <div label="search-error-text" aria-label="We didn't find any matches." class="search-error-text">
            ${this.strings.noResultsFound}
          </div>
        </div>
      `}renderLoading(){return this.renderTemplate("loading",null,"loading")||t.dy`
        <div class="message-parent">
          <mgt-spinner></mgt-spinner>
          <div label="loading-text" aria-label="loading" class="loading-text">
            ${this.strings.loadingMessage}
          </div>
        </div>
      `}loadState(){return Do(this,void 0,void 0,(function*(){const t=e.Providers.globalProvider;let o;if(t&&t.state===e.ProviderState.SignedIn){const e=t.graph.forComponent(this);if(!(yield t.getAccessTokenForScopes(...Ro.requiredScopes)))return;o=yield function(e){return t=this,o=void 0,n=function*(){const t=yield e.api("/me/joinedTeams").select(["displayName","id","isArchived"]).get();return t?t.value:null},new((r=void 0)||(r=Promise))((function(e,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(t){var o;t.done?e(t.value):(o=t.value,o instanceof r?o:new r((function(e){e(o)}))).then(s,a)}c((n=n.apply(t,o||[])).next())}));var t,o,r,n}(e),o=o.filter((e=>!e.isArchived));const r=e.createBatch();for(const e of o)r.get(e.id,`teams/${e.id}/channels`);const n=yield r.executeAll();for(const e of o){const t=n.get(e.id);t&&t.content&&t.content.value&&(e.channels=t.content.value.map((e=>({item:e}))))}this.items=o.map((e=>({channels:e.channels,item:e})))}this.filterList(),this.resetFocusState()}))}handleItemClick(e){e.channels?e.isExpanded=!e.isExpanded:this.selectChannel(e),this._focusedIndex=-1,this.resetFocusState()}handleInputChanged(e){this._inputValue!==e.target.textContent&&(this._inputValue=e.target.textContent,this.gainedFocus(),this.debouncedSearch||(this.debouncedSearch=l((()=>{this.filterList()}),400)),this.debouncedSearch())}filterList(){this.items&&(this._treeViewState=this.generateTreeViewState(this.items,this._inputValue),this._focusedIndex=-1,this.resetFocusState())}generateTreeViewState(e,t="",o=null){const r=[];if(t=t.toLowerCase(),e)for(const n of e){let e;if(0===t.length||n.item.displayName.toLowerCase().includes(t))e={item:n.item,parent:o},n.channels&&(e.channels=this.generateTreeViewState(n.channels,"",e),e.isExpanded=t.length>0);else if(n.channels){const r={item:n.item,parent:o},i=this.generateTreeViewState(n.channels,t,r);i.length>0&&(e=r,e.channels=i,e.isExpanded=!0)}e&&r.push(e)}return r}generateFocusList(e){if(!e||0===e.length)return[];let t=[];for(const o of e)t.push(o),o.channels&&o.isExpanded&&(t=[...t,...this.generateFocusList(o.channels)]);return t}resetFocusState(){this._focusList=this.generateFocusList(this._treeViewState),this.requestUpdate()}loadTeamsIfNotLoaded(){this.items||this.isLoadingState||this.requestStateUpdate()}handleWindowClick(e){e.target!==this&&this.lostFocus()}onUserKeyDown(e){if(13===e.keyCode&&e.preventDefault(),0===this._treeViewState.length)return;const t=this._focusList[this._focusedIndex];switch(e.keyCode){case 40:this._focusedIndex=(this._focusedIndex+1)%this._focusList.length,this.requestUpdate(),e.preventDefault();break;case 38:-1===this._focusedIndex&&(this._focusedIndex=this._focusList.length),this._focusedIndex=(this._focusedIndex-1+this._focusList.length)%this._focusList.length,this.requestUpdate(),e.preventDefault();break;case 39:t&&t.channels&&!t.isExpanded&&(t.isExpanded=!0,this.resetFocusState(),e.preventDefault());break;case 37:t&&t.channels&&t.isExpanded&&(t.isExpanded=!1,this.resetFocusState(),e.preventDefault());break;case 9:if(!t){this.lostFocus();break}case 13:t&&t.channels?(t.isExpanded=!t.isExpanded,this.resetFocusState(),e.preventDefault()):t&&!t.channels&&(this.selectChannel(t),this.resetFocusState(),this._focusedIndex=-1,e.preventDefault());break;case 8:0===this._inputValue.length&&this._selectedItemState&&(this.selectChannel(null),e.preventDefault());break;case 27:this.selectChannel(this._selectedItemState),this._focusedIndex=-1,this.resetFocusState(),e.preventDefault()}}gainedFocus(){this._isFocused=!0;const e=this._input;e&&e.focus(),this._isDropdownVisible=!0}lostFocus(){this._isFocused=!1;const e=this._input;e&&(e.textContent=this._inputValue=""),this._isDropdownVisible=!1,this.filterList()}selectChannel(e){this._selectedItemState!==e&&(this._selectedItemState=e,this.fireCustomEvent("selectionChanged",e?[this.selectedItem]:[]));const t=this._input;t&&(t.textContent=this._inputValue=""),this.requestUpdate(),this.lostFocus()}};Lo._config={useTeamsBasedScopes:!1},Oo([(0,t.Cb)({attribute:!1}),No("design:type",Object)],Lo.prototype,"_isDropdownVisible",void 0),Lo=Ro=Oo([(0,t.Mo)("mgt-teams-channel-picker"),No("design:paramtypes",[])],Lo);const Uo={cancelNewTaskSubtitle:"cancel",newTaskPlaceholder:"Task...",addTaskButtonSubtitle:"Add",removeTaskSubtitle:"Delete Task"};var Mo=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},Fo=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class Ho extends e.MgtTemplatedComponent{constructor(){super(),this.clearState(),this._previousMediaQuery=this.mediaQuery,this.onResize=this.onResize.bind(this)}get newTaskName(){return this._newTaskName}get strings(){return Uo}attributeChangedCallback(e,t,o){switch(super.attributeChangedCallback(e,t,o),e){case"target-id":case"initial-id":this.clearState(),this.requestStateUpdate()}}connectedCallback(){super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}render(){const o=e.Providers.globalProvider;if(!o||o.state!==e.ProviderState.SignedIn)return t.dy``;if(this.isLoadingState)return this.renderLoadingTask();const r=this.hideHeader?null:this.renderHeader(),n=this._isNewTaskVisible?this.renderNewTaskPanel():null,i=this.isLoadingState?this.renderLoadingTask():this.renderTasks();return t.dy`
      ${r} ${n}
      <div class="Tasks" dir=${this.direction}>
        ${i}
      </div>
    `}renderHeader(){const e=this.renderHeaderContent(),o=g({AddBarItem:!0,NewTaskButton:!0,hidden:this.readOnly||this._isNewTaskVisible});return t.dy`
      <div class="Header" dir=${this.direction}>
        ${e}
        <button class="${o}" @click="${()=>this.showNewTaskPanel()}">
          <span class="TaskIcon"></span>
          <span>${this.strings.addTaskButtonSubtitle}</span>
        </button>
      </div>
    `}renderLoadingTask(){return t.dy`
      <div class="Task LoadingTask">
        <div class="TaskContent">
          <div class="TaskCheckContainer">
            <div class="TaskCheck"></div>
          </div>
          <div class="TaskDetailsContainer">
            <div class="TaskTitle"></div>
            <div class="TaskDetails">
              <span class="TaskDetail">
                <div class="TaskDetailIcon"></div>
                <div class="TaskDetailName"></div>
              </span>
              <span class="TaskDetail">
                <div class="TaskDetailIcon"></div>
                <div class="TaskDetailName"></div>
              </span>
            </div>
          </div>
        </div>
      </div>
    `}renderNewTaskPanel(){const e=this._newTaskName,o=t.dy`
      <input
        type="text"
        placeholder="${this.strings.newTaskPlaceholder}"
        .value="${e}"
        label="new-taskName-input"
        aria-label="new-taskName-input"
        role="input"
        @input="${e=>{this._newTaskName=e.target.value,this.requestUpdate()}}"
      />
    `,r=g({Disabled:!(this._isNewTaskBeingAdded||e&&e.length),TaskAddButtonContainer:!0}),n=this._isNewTaskBeingAdded?null:t.dy`
          <div class="TaskIcon TaskCancel" @click="${()=>this.hideNewTaskPanel()}">
            <span>${this.strings.cancelNewTaskSubtitle}</span>
          </div>
          <div class="TaskIcon TaskAdd" @click="${()=>this.addTask()}">
            <span></span>
          </div>
        `,i=this.renderNewTaskDetails();return t.dy`
      <div dir=${this.direction} class="Task NewTask Incomplete">
        <div class="TaskContent">
          <div class="TaskDetailsContainer">
            <div class="TaskTitle">
              ${o}
            </div>
            <div class="TaskDetails">
              ${i}
            </div>
          </div>
        </div>
        <div class="${r}">
          ${n}
        </div>
      </div>
    `}renderBucketIcon(){return t.dy`
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M14 2H2V4H3H5H6H10H11H13H14V2ZM10 5H6V6H10V5ZM5 5H3V14H13V5H11V6C11 6.55228 10.5523 7 10 7H6C5.44772 7 5 6.55228 5 6V5ZM1 5H2V14V15H3H13H14V14V5H15V4V2V1H14H2H1V2V4V5Z"
          fill="#3C3C3C"
        />
      </svg>
    `}addTask(){return e=this,t=void 0,r=function*(){if(!this._isNewTaskBeingAdded&&this.newTaskName){this._isNewTaskBeingAdded=!0,yield this.requestUpdate();try{yield this.createNewTask()}finally{this._isNewTaskBeingAdded=!1,this._isNewTaskVisible=!1,this.requestUpdate()}}},new((o=void 0)||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}));var e,t,o,r}clearNewTaskData(){this._newTaskName=""}clearState(){this.clearNewTaskData(),this._isNewTaskVisible=!1,this.requestUpdate()}handleTaskClick(e,t){this.fireCustomEvent("taskClick",{task:t})}dateToInputValue(e){return e?new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().split("T")[0]:null}showNewTaskPanel(){this._isNewTaskVisible=!0,this.requestUpdate()}hideNewTaskPanel(){this._isNewTaskVisible=!1,this.clearNewTaskData(),this.requestUpdate()}onResize(){this.mediaQuery!==this._previousMediaQuery&&(this._previousMediaQuery=this.mediaQuery,this.requestUpdate())}}Mo([(0,t.Cb)({attribute:"read-only",type:Boolean}),Fo("design:type",Boolean)],Ho.prototype,"readOnly",void 0),Mo([(0,t.Cb)({attribute:"hide-header",type:Boolean}),Fo("design:type",Boolean)],Ho.prototype,"hideHeader",void 0),Mo([(0,t.Cb)({attribute:"hide-options",type:Boolean}),Fo("design:type",Boolean)],Ho.prototype,"hideOptions",void 0),Mo([(0,t.Cb)({attribute:"target-id",type:String}),Fo("design:type",String)],Ho.prototype,"targetId",void 0),Mo([(0,t.Cb)({attribute:"initial-id",type:String}),Fo("design:type",String)],Ho.prototype,"initialId",void 0);var qo,$o,Bo,jo=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};!function(e){e[e.notStarted=0]="notStarted",e[e.inProgress=1]="inProgress",e[e.completed=2]="completed",e[e.deferred=3]="deferred",e[e.waitingOnOthers=4]="waitingOnOthers"}(qo||(qo={})),function(e){e[e.low=0]="low",e[e.normal=1]="normal",e[e.high=2]="high"}($o||($o={})),function(e){e[e.none=0]="none",e[e.default=1]="default",e[e.flaggedEmails=2]="flaggedEmails",e[e.unknownFutureValue=3]="unknownFutureValue"}(Bo||(Bo={}));const zo=[t.iv`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--task-border:2px solid #e1dfdd;--task-complete-border:2px dotted #e1dfdd;--task-new-add-button-disabled-background:#edebe9;--task-icon-color:#000000}.mgt-dark{--task-border:2px solid #797775;--task-complete-border:2px dotted #797775;--task-new-add-button-disabled-background:#4f4f4f;--task-icon-color:#ffffff}:host{font-family:var(--default-font-family);display:flex;flex-direction:column;background-color:var(--background-color-sub1,#faf9f8);padding:var(--tasks-padding,12px);color:var(--color-sub1,#323130)}:host .TaskIcon{font-family:FabricMDL2Icons;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .TaskIcon.Divider{vertical-align:initial;margin:0 12px;font-size:16px}:host .Header{padding:var(--tasks-header-padding,0);margin:var(--tasks-header-margin,0 0 12px 0);padding:var(--tasks-title-padding,0);display:flex;align-items:center;justify-content:space-between}:host .Header .header__loading{max-width:90px;width:100%;height:20px;background:#f2f2f2}:host .Header select{font-family:var(--default-font-family, "Segoe UI");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px);border:none;-moz-appearance:none;-webkit-appearance:none;cursor:pointer}:host .Header select::-ms-expand{display:none}:host .Header .PlanTitle{font-family:var(--default-font-family, "Segoe UI");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px)}:host .Header .AddBar{display:flex}:host .Header .AddBar .AddBarItem{flex:1 1 auto}:host .Header .NewTaskDue{display:flex}:host .Header .NewTaskDue input{flex:1 1 auto;background-color:var(--background-color-sub1,#faf9f8)}:host .Header .TitleCont{flex:1 1 auto;display:flex;align-items:center;height:var(--tasks-new-button-height,34px)}:host .Header .NewTaskButton{flex:0 0 auto;display:flex;justify-content:center;align-items:center;width:var(--tasks-new-button-width,auto);height:var(--tasks-new-button-height,32px);border-radius:2px;padding:0 20px;background:var(--tasks-new-button-background,#0078d4);border:var(--tasks-new-button-border,solid 1px transparent);color:var(--tasks-new-button-color,#fff);user-select:none;-moz-user-select:none;-ms-user-select:none;cursor:pointer}:host .Header .NewTaskButton span{font-size:14px;font-weight:600;letter-spacing:.1px;line-height:14px}:host .Header .NewTaskButton .TaskIcon{margin-right:8px}:host .Header .NewTaskButton.hidden{visibility:hidden}:host .Header .NewTaskButton:hover{background:var(--tasks-new-button-hover-background,#106ebe)}:host .Header .NewTaskButton:active{background:var(--tasks-new-button-active-background,#005a9e)}:host .Task{position:relative;margin:var(--task-margin,0 0 18px 0);padding:var(--task-padding,0 0 0 0);background-color:var(--tasks-background-color,var(--background-color,#fff));border:var(--task-border,2px solid #e1dfdd)}:host .Task .TaskContent{display:flex}:host .Task .TaskContent .Divider{position:absolute;height:2px;left:0;right:0;bottom:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskContent .TaskDetailsContainer{flex:1;display:grid;display:-ms-grid;grid-template-columns:auto 1fr;-ms-grid-columns:auto 1fr;grid-template-rows:auto auto auto auto;-ms-grid-rows:auto auto auto auto;justify-content:space-between;align-items:flex-start;color:var(--task-detail-color,var(--color-sub2,#797775));font-size:12px;font-weight:600;white-space:nowrap;margin-bottom:12px}:host .Task .TaskContent .TaskDetailsContainer .TaskDetail{width:100%;height:100%;margin:4px 24px 6px 0;display:flex;justify-content:flex-start;align-items:center}:host .Task .TaskContent .TaskDetailsContainer .TaskTitle{color:var(--task-title-color,var(--title-color-subtitle,#323130));font-size:14px;font-weight:600;grid-row:1;-ms-grid-row:1;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2;margin:22px 0 4px}:host .Task .TaskContent .TaskDetailsContainer .TaskGroup{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer .TaskBucket{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer .TaskDue{justify-content:flex-end;align-items:flex-start;grid-row:4;-ms-grid-row:4;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2}:host .Task .TaskContent .TaskDetailsContainer.tablet{grid-template-columns:1fr .5fr 1fr .5fr;-ms-grid-columns:1fr .5fr 1fr .5fr;grid-template-rows:auto auto;-ms-grid-rows:auto auto}:host .Task .TaskContent .TaskDetailsContainer.tablet.NoPlan{grid-template-columns:0 1fr 1fr 1fr;-ms-grid-columns:0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDetail{margin:4px 24px 6px 0}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskTitle{grid-row:1;-ms-grid-row:1;grid-column:1/5;-ms-grid-column:1;-ms-grid-column-span:4}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskGroup{grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskBucket{grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskAssignee{grid-row:2;-ms-grid-row:2;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDue{justify-content:flex-start;align-items:center;grid-row:2;-ms-grid-row:2;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop{grid-template-columns:2fr 1fr .5fr 1fr .5fr;-ms-grid-columns:2fr 1fr .5fr 1fr .5fr;grid-template-rows:auto;-ms-grid-rows:auto;margin:0}:host .Task .TaskContent .TaskDetailsContainer.desktop.NoPlan{grid-template-columns:2fr 0 1fr 1fr 1fr;-ms-grid-columns:2fr 0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDetail{margin:0 24px 0 0}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskTitle{padding:0;grid-row:1;-ms-grid-row:1;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskGroup{min-height:61px;grid-row:1;-ms-grid-row:1;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskBucket{grid-row:1;-ms-grid-row:1;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskAssignee{grid-row:1;-ms-grid-row:1;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDue{justify-content:flex-start;align-items:center;grid-row:1;-ms-grid-row:1;grid-column:5;-ms-grid-column:5}:host .Task .TaskContent .TaskDetailsContainer svg{vertical-align:middle;margin-right:4px}:host .Task .TaskContent .TaskDetailsContainer svg path{fill:var(--task-detail-color,var(--color-sub2,#797775))}:host .Task .TaskContent .TaskDetailsContainer select,:host .Task .TaskContent .TaskDetailsContainer span{vertical-align:middle}:host .Task .TaskContent .TaskDetailsContainer .TaskIcon{color:#797775;margin-right:8px}:host .Task .TaskContent .TaskDetailsContainer mgt-people{color:var(--task-detail-color,var(--color-sub2,#797775));font-size:16px}:host .Task .TaskContent .TaskDetailsContainer mgt-person{display:inline-block}:host .Task .TaskContent .TaskDetailsContainer .Picker{background-color:var(--background-color-sub1,#faf9f8);-webkit-background-clip:padding-box;-moz-background-clip:padding-box;background-clip:padding-box;width:var(--mgt-flyout-set-width,350px);color:var(--task-detail-color,var(--color-sub2,#797775))}:host .Task .TaskContent .TaskDetailsContainer .Picker mgt-people-picker{--separator-margin:0px 10px 0px 10px}:host .Task .TaskContent .TaskDetailsContainer input,:host .Task .TaskContent .TaskDetailsContainer select{color:var(--task-detail-color,var(--color-sub2,#797775));font-size:.9em;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskCheckContainer{font-family:FabricMDL2Icons;display:inline-block;border-radius:50%;color:#fff;cursor:pointer;display:flex;align-items:var(--task-icon-alignment,flex-start);margin:21px 10px 20px 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer.Complete .TaskCheck{background-color:var(--task-icon-background-completed,#00ad56);border:var(--task-icon-border-completed,solid 1px #fff);color:var(--task-icon-color-completed,#fff)}:host .Task .TaskCheckContainer.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#979593)}:host .Task .TaskCheckContainer .TaskCheck{font-family:FabricMDL2Icons;font-size:12px;display:inline-block;width:18px;height:18px;border-radius:var(--task-icon-border-radius,50%);border:var(--task-icon-border,solid 1px #797775);color:var(--task-icon-color,#000);display:flex;justify-content:center;align-items:center;background-color:var(--task-icon-background,transparent);user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer .TaskCheck.Loading .TaskCheckContent{animation:rotateIcon 2s infinite linear}:host .Task .TaskOptions{cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;margin:16px 8px 0 0}:host .Task.ReadOnly .TaskCheckContainer{cursor:default}:host .Task.Complete{background:var(--task-complete-background,var(--background-color-sub1,#faf9f8));border:var(--task-complete-border,2px dotted #e1dfdd)}:host .Task.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#979593)}:host .Task.NewTask{margin:var(--task-new-margin,var(--task-margin,0 0 24px 0));display:flex;flex-direction:row}:host .Task.NewTask .SelfAssign{display:none}:host .Task.NewTask .AssignTo{border:0;background:0 0}:host .Task.NewTask .FakeCheckBox{width:15px;height:15px;cursor:pointer;margin:0 5px 0 5px}:host .Task.NewTask .FakeCheckBox::after{font-family:FabricMDL2Icons;content:'\uE739'}:host .Task.NewTask .FakeCheckBox~:checked{font-family:FabricMDL2Icons;content:'\uE73A'}:host .Task.NewTask .TaskContent{flex:1 1 auto;align-content:center;vertical-align:middle;margin:0 0 0 12px}:host .Task.NewTask .TaskContent .TaskDetailsContainer{display:flex;flex-direction:column;align-items:stretch;margin:0}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle{display:flex}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input{flex:1;font-family:var(--default-font-family, "Segoe UI");margin:var(--task-new-input-margin,0 24px 0 16px);padding:var(--task-new-input-padding,6px);font-size:var(--task-new-input-font-size,14px);font-weight:600;border:var(--task-new-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:hover{border-bottom:1px solid #106ebe}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:active{border-bottom:1px solid #005a9e}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:focus{border-bottom:1px solid #0078d4}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails{display:flex;justify-content:stretch;align-items:center;flex-wrap:wrap;margin:14px 0 14px 4px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskGroup{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskBucket{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskDue{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskAssignee{margin:8px 16px;min-width:80px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .TaskPeople label{display:flex;align-content:center;align-items:center}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select{font-family:var(--default-font-family);font-size:12px;font-weight:600;border:var(--task-new-select-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;padding:4px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:hover,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:hover{border-bottom:1px solid #106ebe}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:active,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:active{border-bottom:1px solid #005a9e}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:focus,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:focus{border-bottom:1px solid #0078d4}:host .Task.NewTask .TaskAddButtonContainer{flex:0 0 auto;display:flex}:host .Task.NewTask .TaskAddButtonContainer .TaskAdd,:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{height:100%;max-width:50px;min-width:50px;flex:1 1 auto;justify-content:center;align-items:center;display:flex;cursor:pointer}:host .Task.NewTask .TaskAddButtonContainer .TaskAdd{color:#fff;background:var(--task-new-add-button-background,#0078d4)}:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{font-family:var(--default-font-family, "Segoe UI");font-size:14px;font-weight:600;color:var(--task-new-cancel-button-color,var(--color-sub1,#323130));margin:0 12px 0 32px}:host .Task.NewTask .TaskAddButtonContainer.Disabled .TaskAdd{background:var(--task-new-add-button-disabled-background,#eaeaea);cursor:default}:host .Task.LoadingTask .TaskCheckContainer{cursor:default}:host .Task.LoadingTask .TaskDetails{display:flex}:host .Task.LoadingTask .TaskCheck{background:#f2f2f2;border-color:#f2f2f2;cursor:default}:host .Task.LoadingTask .TaskDetailIcon{width:16px;height:16px;margin:5px;background:#f2f2f2}:host .Task.LoadingTask .TaskTitle{background:#f2f2f2;max-width:400px;height:20px;margin-right:20px!important}:host .Task.LoadingTask .TaskDetail{margin-right:12px;display:flex;flex-direction:row;align-items:center}:host .Task.LoadingTask .TaskDetailName{width:81px;height:10px;background:#f2f2f2}@keyframes rotateIcon{from{transform:rotate(0)}to{transform:rotate(360deg)}}[dir=rtl] mgt-arrow-options{--arrow-options-left:auto}[dir=rtl] mgt-dot-options{--dot-options-translateX:translateX(60px)}[dir=rtl] .TaskDetails{margin-right:14px!important}[dir=rtl] .TaskIcon{margin-left:8px}[dir=rtl] .TaskDetail svg{margin-left:4px}
`],Vo={cancelNewTaskSubtitle:"cancel",newTaskPlaceholder:"Task...",addTaskButtonSubtitle:"Add",removeTaskSubtitle:"Delete Task"};var Go=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};let Ko=class extends Ho{constructor(){super(),this._graph=null,this._newTaskDueDate=null,this._newTaskListId="",this._currentList=null,this._lists=[],this._tasks=[],this._loadingTasks=[],this._isLoadingTasks=!1}static get styles(){return zo}get strings(){return Vo}static get requiredScopes(){return["tasks.read","tasks.readwrite"]}renderTasks(){if(this._isLoadingTasks)return this.renderLoadingTask();let e=this._tasks;e&&this.taskFilter&&(e=e.filter((e=>this.taskFilter(e))));const o=Ie(e,(e=>e.id),(e=>this.renderTask(e)));return t.dy`
      ${o}
    `}renderNewTaskDetails(){const e=this._lists.filter((e=>this._currentList&&e.id===this._currentList.id||!this._currentList&&e.id===this._newTaskListId));e.length>0&&!this._newTaskListId&&(this._newTaskListId=e[0].id);const o=this._currentList?t.dy`
          <span class="NewTaskGroup">
            ${this.renderBucketIcon()}
            <span>${this._currentList.displayName}</span>
          </span>
        `:t.dy`
          <span class="NewTaskGroup">
            ${this.renderBucketIcon()}
            <select
              .value="${this._newTaskListId}"
              @change="${e=>{this._newTaskListId=e.target.value}}"
            >
              ${e.map((e=>t.dy`
                  <option value="${e.id}">${e.displayName}</option>
                `))}
            </select>
          </span>
        `,r=t.dy`
      <span class="NewTaskDue">
        <input
          type="date"
          label="new-taskDate-input"
          aria-label="new-taskDate-input"
          role="input"
          .value="${this.dateToInputValue(this._newTaskDueDate)}"
          @change="${e=>{const t=e.target.value;this._newTaskDueDate=t?new Date(t+"T17:00"):null}}"
        />
      </span>
    `;return t.dy`
      ${o} ${r}
    `}renderHeaderContent(){if(this.isLoadingState)return t.dy`
        <div class="header__loading"></div>
      `;const e=this._lists||[],o=this._currentList,r=this.targetId;let n;if(r&&e.length){const o=e.find((e=>e.id===r));o&&(n=t.dy`
          <span class="PlanTitle">
            ${o.displayName}
          </span>
        `)}else if(o){const r={};for(const t of e)r[t.displayName]=()=>this.loadTaskList(t);n=t.dy`
        <mgt-arrow-options .value="${o.displayName}" .options="${r}"></mgt-arrow-options>
      `}return t.dy`
      <span class="TitleCont">
        ${n}
      </span>
    `}renderTask(e){const o={task:e,list:this._currentList};if(this.hasTemplate("task"))return this.renderTemplate("task",o,e.id);const r=qo[e.status]===qo.completed,n=this._loadingTasks.includes(e.id),i={Complete:!n&&r,Loading:n,TaskCheck:!0,TaskIcon:!0},s=n?t.dy`
          
        `:r?t.dy`
          
        `:null;let c=null;if(this.hasTemplate("task-details"))c=this.renderTemplate("task-details",o,`task-details-${e.id}`);else{const o=e.dueDateTime?t.dy`
            <div class="TaskDetail TaskDue">
              <span>Due ${a(new Date(e.dueDateTime.dateTime))}</span>
            </div>
          `:null;c=t.dy`
        <div class="TaskTitle">
          ${e.title}
        </div>
        <div class="TaskDetail TaskBucket">
          ${this.renderBucketIcon()}
          <span>${this._currentList.displayName}</span>
        </div>
        ${o}
      `}const l=this.readOnly||this.hideOptions?null:t.dy`
            <div class="TaskOptions">
              <mgt-dot-options
                .options="${{[this.strings.removeTaskSubtitle]:t=>this.removeTask(t,e.id)}}"
              ></mgt-dot-options>
            </div>
          `,d=g({Complete:r,Incomplete:!r,ReadOnly:this.readOnly,Task:!0}),u=g({Complete:r,Incomplete:!r,TaskCheckContainer:!0});return t.dy`
      <div class=${d}>
        <div class="TaskContent" @click="${t=>this.handleTaskClick(t,e)}}">
          <span class=${u} @click="${t=>this.handleTaskCheckClick(t,e)}">
            <span class=${g(i)}>
              <span class="TaskCheckContent">${s}</span>
            </span>
          </span>
          <div class="TaskDetailsContainer ${this.mediaQuery}">
            ${c}
          </div>
          ${l}
          <div class="Divider"></div>
        </div>
      </div>
    `}loadState(){return Go(this,void 0,void 0,(function*(){const t=e.Providers.globalProvider;if(!t||t.state!==e.ProviderState.SignedIn)return;if(!this._graph){const e=t.graph.forComponent(this);this._graph=e}let o=this._lists;if(!o||!o.length){if(this.targetId){const t=yield function(t,o){return jo(this,void 0,void 0,(function*(){return yield t.api(`/me/todo/lists/${o}`).header("Cache-Control","no-store").middlewareOptions((0,e.prepScopes)("Tasks.Read")).get()}))}(this._graph,this.targetId);o=t?[t]:[]}else o=yield function(t){return jo(this,void 0,void 0,(function*(){const o=yield t.api("/me/todo/lists").header("Cache-Control","no-store").middlewareOptions((0,e.prepScopes)("Tasks.Read")).get();return o&&o.value}))}(this._graph);this._tasks=[],this._currentList=null,this._lists=o}let r=this._currentList;!r&&o&&o.length&&(this.initialId&&(r=o.find((e=>e.id===this.initialId))),r||(r=o[0]),this._tasks=[],this._currentList=r),r&&(yield this.loadTaskList(r))}))}createNewTask(){return Go(this,void 0,void 0,(function*(){const t=this._currentList.id,o={title:this.newTaskName};this._newTaskDueDate&&(o.dueDateTime={dateTime:this._newTaskDueDate.toLocaleDateString(),timeZone:"UTC"});const r=yield function(t,o,r){return jo(this,void 0,void 0,(function*(){return yield t.api(`/me/todo/lists/${o}/tasks`).header("Cache-Control","no-store").middlewareOptions((0,e.prepScopes)("Tasks.ReadWrite")).post(r)}))}(this._graph,t,o);this._tasks.unshift(r)}))}clearNewTaskData(){super.clearNewTaskData(),this._newTaskDueDate=null,this._newTaskListId=null}clearState(){super.clearState(),this._currentList=null,this._lists=[],this._tasks=[],this._loadingTasks=[],this._isLoadingTasks=!1}loadTaskList(t){return Go(this,void 0,void 0,(function*(){this._isLoadingTasks=!0,this._currentList=t,this.requestUpdate(),this._tasks=yield function(t,o){return jo(this,void 0,void 0,(function*(){const r=yield t.api(`/me/todo/lists/${o}/tasks`).header("Cache-Control","no-store").middlewareOptions((0,e.prepScopes)("Tasks.Read")).get();return r&&r.value}))}(this._graph,t.id),this._isLoadingTasks=!1,this.requestUpdate()}))}updateTaskStatus(t,o){return Go(this,void 0,void 0,(function*(){this._loadingTasks=[...this._loadingTasks,t.id],this.requestUpdate(),t.status=o;const r=this._currentList.id;t=yield function(t,o,r,n){return jo(this,void 0,void 0,(function*(){return yield t.api(`/me/todo/lists/${o}/tasks/${r}`).header("Cache-Control","no-store").middlewareOptions((0,e.prepScopes)("Tasks.ReadWrite")).patch(n)}))}(this._graph,r,t.id,t);const n=this._tasks.findIndex((e=>e.id===t.id));this._tasks[n]=t,this._loadingTasks=this._loadingTasks.filter((e=>e!==t.id)),this.requestUpdate()}))}removeTask(t,o){return Go(this,void 0,void 0,(function*(){this._tasks=this._tasks.filter((e=>e.id!==o)),this.requestUpdate();const t=this._currentList.id;yield function(t,o,r){return jo(this,void 0,void 0,(function*(){yield t.api(`/me/todo/lists/${o}/tasks/${r}`).header("Cache-Control","no-store").middlewareOptions((0,e.prepScopes)("Tasks.ReadWrite")).delete()}))}(this._graph,t,o),this._tasks=this._tasks.filter((e=>e.id!==o))}))}handleTaskCheckClick(e,t){this.readOnly||(qo[t.status]===qo.completed?this.updateTaskStatus(t,qo.notStarted):this.updateTaskStatus(t,qo.completed),e.stopPropagation(),e.preventDefault())}};Ko=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s}([(0,t.Mo)("mgt-todo"),function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}("design:paramtypes",[])],Ko);var Wo,Qo=o(655),Jo=function(){function e(){}return e.createNewGuid=function(){var t=window.crypto;if(t&&t.getRandomValues){var o=new Uint8Array(16);return t.getRandomValues(o),o[6]|=64,o[6]&=79,o[8]|=128,o[8]&=191,e.decimalToHex(o[0])+e.decimalToHex(o[1])+e.decimalToHex(o[2])+e.decimalToHex(o[3])+"-"+e.decimalToHex(o[4])+e.decimalToHex(o[5])+"-"+e.decimalToHex(o[6])+e.decimalToHex(o[7])+"-"+e.decimalToHex(o[8])+e.decimalToHex(o[9])+"-"+e.decimalToHex(o[10])+e.decimalToHex(o[11])+e.decimalToHex(o[12])+e.decimalToHex(o[13])+e.decimalToHex(o[14])+e.decimalToHex(o[15])}for(var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",n="0123456789abcdef",i=0,s="",a=0;a<36;a++)"-"!==r[a]&&"4"!==r[a]&&(i=16*Math.random()|0),"x"===r[a]?s+=n[i]:"y"===r[a]?(i&=3,s+=n[i|=8]):s+=r[a];return s},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e.base64Encode=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(Number("0x"+t))})))},e.base64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))},e.deserialize=function(e){var t,o=/\+/g,r=/([^&=]+)=([^&]*)/g,n=function(e){return decodeURIComponent(e.replace(o," "))},i={};for(t=r.exec(e);t;)i[n(t[1])]=n(t[2]),t=r.exec(e);return i},e}(),Yo=function(){function e(){}return Object.defineProperty(e,"libraryName",{get:function(){return"Msal.js"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"claims",{get:function(){return"claims"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clientId",{get:function(){return"clientId"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cachePrefix",{get:function(){return"msal"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"scopes",{get:function(){return"scopes"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"upn",{get:function(){return"upn"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"domain_hint",{get:function(){return"domain_hint"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt",{get:function(){return"prompt"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"resourceDelimiter",{get:function(){return"|"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cacheDelimiter",{get:function(){return"."},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"login",{get:function(){return"LOGIN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"unknown",{get:function(){return"UNKNOWN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ADFS",{get:function(){return"adfs"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"common",{get:function(){return"common"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"openidScope",{get:function(){return"openid"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"profileScope",{get:function(){return"profile"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"oidcScopes",{get:function(){return[this.openidScope,this.profileScope]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeSilent",{get:function(){return"silentInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"inProgress",{get:function(){return"inProgress"},enumerable:!0,configurable:!0}),e._popUpWidth=483,e._popUpHeight=600,e}();!function(e){e.SCOPE="scope",e.STATE="state",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.EXPIRES_IN="expires_in",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info"}(Wo||(Wo={}));var Zo,Xo,er,tr="id_token",or="token",rr="id_token token";!function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireTokenAccount",e.SESSION_STATE="session.state",e.STATE_LOGIN="state.login",e.STATE_ACQ_TOKEN="state.acquireToken",e.STATE_RENEW="state.renew",e.NONCE_IDTOKEN="nonce.idtoken",e.LOGIN_REQUEST="login.request",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.INTERACTION_STATUS="interaction_status",e.REDIRECT_REQUEST="redirect_request"}(Zo||(Zo={})),function(e){e.IDTOKEN="idtoken",e.CLIENT_INFO="client.info"}(Xo||(Xo={})),function(e){e.LOGIN_ERROR="login.error",e.ERROR="error",e.ERROR_DESC="error.description"}(er||(er={}));var nr,ir=".well-known/openid-configuration";!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ID_TOKEN="id_token",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(nr||(nr={}));var sr,ar=[nr.SID,nr.LOGIN_HINT],cr="GET",lr={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"},dr="unexpected_error",ur="Unexpected error in authentication.",pr="no_window_object",hr="No window object available. Details:",fr=function(e){function t(o,r){var n=e.call(this,r)||this;return Object.setPrototypeOf(n,t.prototype),n.errorCode=o,n.errorMessage=r,n.name="AuthError",n}return Qo.ZT(t,e),t.createUnexpectedError=function(e){return new t(dr,ur+": "+e)},t.createNoWindowObjectError=function(e){return new t(pr,hr+" "+e)},t}(Error),gr=function(){function e(){}return e.isEmpty=function(e){return void 0===e||!e||0===e.length},e.validateAndParseJsonCacheKey=function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}},e}(),mr="endpoints_resolution_error",vr="Error: could not resolve endpoints. Please check network and try again.",br="popup_window_error",yr="Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",kr="token_renewal_error",wr="Token renewal operation failed due to timeout.",Cr="invalid_id_token",Tr="Invalid ID token format.",Sr="invalid_state_error",_r="Invalid state.",Ir="nonce_mismatch_error",xr="Nonce is not matching, Nonce received: ",Er="login_progress_error",Ar="Login_In_Progress: Error during login call - login is already in progress.",Pr="acquiretoken_progress_error",Rr="AcquireToken_In_Progress: Error during login call - login is already in progress.",Or="user_cancelled",Nr="User cancelled the flow.",Dr="callback_error",Lr="Error occurred in token received callback function.",Ur="user_login_error",Mr="User login is required. For silent calls, request must contain either sid or login_hint",Fr="user_non_existent",Hr="User object does not exist. Please call a login API.",qr="client_info_decoding_error",$r="The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause.",Br="client_info_not_populated_error",jr="The service did not populate client_info in the response, Please verify with the service team",zr="null_or_empty_id_token",Vr="The idToken is null or empty. Please review the trace to determine the root cause.",Gr="id_token_parsing_error",Kr="ID token cannot be parsed. Please review stack trace to determine root cause.",Wr="token_encoding_error",Qr="The token to be decoded is not encoded correctly.",Jr="invalid_interaction_type",Yr="The interaction type passed to the handler was incorrect or unknown",Zr="cannot_parse_cache",Xr="The cached token key is not a valid JSON and cannot be parsed",en="block_token_requests",tn="Token calls are blocked in hidden iframes",on=function(e){function t(o,r){var n=e.call(this,o,r)||this;return n.name="ClientAuthError",Object.setPrototypeOf(n,t.prototype),n}return Qo.ZT(t,e),t.createEndpointResolutionError=function(e){var o=vr;return e&&!gr.isEmpty(e)&&(o+=" Details: "+e),new t(mr,o)},t.createPopupWindowError=function(e){var o=yr;return e&&!gr.isEmpty(e)&&(o+=" Details: "+e),new t(br,o)},t.createTokenRenewalTimeoutError=function(){return new t(kr,wr)},t.createInvalidIdTokenError=function(e){return new t(Cr,Tr+" Given token: "+e)},t.createInvalidStateError=function(e,o){return new t(Sr,_r+" "+e+", state expected : "+o+".")},t.createNonceMismatchError=function(e,o){return new t(Ir,xr+" "+e+", nonce expected : "+o+".")},t.createLoginInProgressError=function(){return new t(Er,Ar)},t.createAcquireTokenInProgressError=function(){return new t(Pr,Rr)},t.createUserCancelledError=function(){return new t(Or,Nr)},t.createErrorInCallbackFunction=function(e){return new t(Dr,Lr+" "+e+".")},t.createUserLoginRequiredError=function(){return new t(Ur,Mr)},t.createUserDoesNotExistError=function(){return new t(Fr,Hr)},t.createClientInfoDecodingError=function(e){return new t(qr,$r+" Failed with error: "+e)},t.createClientInfoNotPopulatedError=function(e){return new t(Br,jr+" Failed with error: "+e)},t.createIdTokenNullOrEmptyError=function(e){return new t(zr,Vr+" Raw ID Token Value: "+e)},t.createIdTokenParsingError=function(e){return new t(Gr,Kr+" Failed with error: "+e)},t.createTokenEncodingError=function(e){return new t(Wr,Qr+" Attempted to decode: "+e)},t.createInvalidInteractionTypeError=function(){return new t(Jr,Yr)},t.createCacheParseError=function(e){return new t(Zr,"invalid key: "+e+", "+Xr)},t.createBlockTokenRequestsInHiddenIframeError=function(){return new t(en,tn)},t}(fr),rn="no_config_set",nn="Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object.",sn="storage_not_supported",an="The value for the cacheLocation is not supported.",cn="no_redirect_callbacks",ln="No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics.",dn="invalid_callback_object",un="The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics.",pn="scopes_required",hn="Scopes are required to obtain an access token.",fn="empty_input_scopes_error",gn="Scopes cannot be passed as empty array.",mn="nonarray_input_scopes_error",vn="Scopes cannot be passed as non-array.",bn="invalid_prompt_value",yn="Supported prompt values are 'login', 'select_account', 'consent' and 'none'",kn={code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},wn={code:"authority_uri_insecure",desc:"Authority URIs must use https."},Cn={code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},Tn="untrusted_authority",Sn="The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter or set validateAuthority=false.",_n="b2c_known_authorities_not_set",In="Must set known authorities when validateAuthority is set to True and using B2C",xn="claims_request_parsing_error",En="Could not parse the given claims request object.",An={code:"empty_request_error",desc:"Request object is required."},Pn="invalid_guid_sent_as_correlationId",Rn="Please set the correlationId as a valid guid",On={code:"telemetry_config_error",desc:"Telemetry config is not configured with required values"},Nn="sso_silent_error",Dn="request must contain either sid or login_hint",Ln="authority_metadata_error",Un="Invalid authorityMetadata. Must be a JSON object containing authorization_endpoint, end_session_endpoint, and issuer fields.",Mn=function(e){function t(o,r){var n=e.call(this,o,r)||this;return n.name="ClientConfigurationError",Object.setPrototypeOf(n,t.prototype),n}return Qo.ZT(t,e),t.createNoSetConfigurationError=function(){return new t(rn,""+nn)},t.createStorageNotSupportedError=function(e){return new t(sn,an+" Given location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(cn,ln)},t.createInvalidCallbackObjectError=function(e){return new t(dn,un+" Given value for callback function: "+e)},t.createEmptyScopesArrayError=function(e){return new t(fn,gn+" Given value: "+e+".")},t.createScopesNonArrayError=function(e){return new t(mn,vn+" Given value: "+e+".")},t.createScopesRequiredError=function(e){return new t(pn,hn+" Given value: "+e)},t.createInvalidPromptError=function(e){return new t(bn,yn+" Given value: "+e)},t.createClaimsRequestParsingError=function(e){return new t(xn,En+" Given value: "+e)},t.createEmptyRequestError=function(){return new t(An.code,An.desc)},t.createInvalidCorrelationIdError=function(){return new t(Pn,Rn)},t.createKnownAuthoritiesNotSetError=function(){return new t(_n,In)},t.createInvalidAuthorityTypeError=function(){return new t(kn.code,kn.desc)},t.createUntrustedAuthorityError=function(e){return new t(Tn,Sn+" Provided Authority: "+e)},t.createTelemetryConfigError=function(e){var o={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"};return new t(On.code,On.desc+" mising values: "+Object.keys(o).reduce((function(t,r){return e[r]?t:t.concat([r+" ("+o[r]+")"])}),[]).join(","))},t.createSsoSilentError=function(){return new t(Nn,Dn)},t.createInvalidAuthorityMetadataError=function(){return new t(Ln,Un)},t}(on),Fn=function(){function e(){}return e.isIntersectingScopes=function(e,t){for(var o=this.trimAndConvertArrayToLowerCase(e.slice()),r=this.trimAndConvertArrayToLowerCase(t.slice()),n=0;n<r.length;n++)if(o.indexOf(r[n].toLowerCase())>-1)return!0;return!1},e.containsScope=function(e,t){var o=this.trimAndConvertArrayToLowerCase(e.slice());return this.trimAndConvertArrayToLowerCase(t.slice()).every((function(e){return o.indexOf(e.toString().toLowerCase())>=0}))},e.trimAndConvertToLowerCase=function(e){return e.trim().toLowerCase()},e.trimAndConvertArrayToLowerCase=function(e){var t=this;return e.map((function(e){return t.trimAndConvertToLowerCase(e)}))},e.trimScopes=function(e){return e.map((function(e){return e.trim()}))},e.removeElement=function(e,t){var o=this.trimAndConvertToLowerCase(t);return e.filter((function(e){return e!==o}))},e.parseScope=function(e){var t="";if(e)for(var o=0;o<e.length;++o)t+=o!==e.length-1?e[o]+" ":e[o];return t},e.validateInputScope=function(e,t){if(e){if(!Array.isArray(e))throw Mn.createScopesNonArrayError(e);if(e.length<1&&t)throw Mn.createEmptyScopesArrayError(e.toString())}else if(t)throw Mn.createScopesRequiredError(e)},e.getScopeFromState=function(e){if(e){var t=e.indexOf(Yo.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},e.appendScopes=function(e,t){if(e){var o=t?this.trimAndConvertArrayToLowerCase(t.slice()):null,r=this.trimAndConvertArrayToLowerCase(e.slice());return o?r.concat(o):r}return null},e.onlyContainsOidcScopes=function(e){var t=e.length,o=0;return e.indexOf(Yo.openidScope)>-1&&(o+=1),e.indexOf(Yo.profileScope)>-1&&(o+=1),t>0&&t===o},e.containsAnyOidcScopes=function(e){var t=e.indexOf(Yo.openidScope)>-1,o=e.indexOf(Yo.profileScope)>-1;return t||o},e.onlyContainsClientId=function(e,t){return!!e&&e.indexOf(t)>-1&&1===e.length},e.appendDefaultScopes=function(e){var t=e;return-1===t.indexOf(Yo.openidScope)&&t.push(Yo.openidScope),-1===t.indexOf(Yo.profileScope)&&t.push(Yo.profileScope),t},e.removeDefaultScopes=function(e){return e.filter((function(e){return e!==Yo.openidScope&&e!==Yo.profileScope}))},e.translateClientIdIfSingleScope=function(e,t){return this.onlyContainsClientId(e,t)?Yo.oidcScopes:e},e}(),Hn=function(){function e(){}return e.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),o=e.authorityInstance.AuthorizationEndpoint;return o.indexOf("?")<0?o+="?":o+="&",""+o+t.join("&")},e.createNavigationUrlString=function(e){var t=Fn.appendDefaultScopes(e.scopes),o=[];return o.push("response_type="+e.responseType),o.push("scope="+encodeURIComponent(Fn.parseScope(t))),o.push("client_id="+encodeURIComponent(e.clientId)),o.push("redirect_uri="+encodeURIComponent(e.redirectUri)),o.push("state="+encodeURIComponent(e.state)),o.push("nonce="+encodeURIComponent(e.nonce)),o.push("client_info=1"),o.push("x-client-SKU="+e.xClientSku),o.push("x-client-Ver="+e.xClientVer),e.promptValue&&o.push("prompt="+encodeURIComponent(e.promptValue)),e.claimsValue&&o.push("claims="+encodeURIComponent(e.claimsValue)),e.queryParameters&&o.push(e.queryParameters),e.extraQueryParameters&&o.push(e.extraQueryParameters),o.push("client-request-id="+encodeURIComponent(e.correlationId)),o},e.getCurrentUrl=function(){return window.location.href.split("?")[0].split("#")[0]},e.removeHashFromUrl=function(e){return e.split("#")[0]},e.replaceTenantPath=function(e,t){var o=e.toLowerCase(),r=this.GetUrlComponents(o),n=r.PathSegments;return!t||0===n.length||n[0]!==Yo.common&&n[0]!==nr.ORGANIZATIONS&&n[0]!==nr.CONSUMERS||(n[0]=t),this.constructAuthorityUriFromObject(r,n)},e.constructAuthorityUriFromObject=function(e,t){return this.CanonicalizeUri(e.Protocol+"//"+e.HostNameAndPort+"/"+t.join("/"))},e.isCommonAuthority=function(e){var t=this.CanonicalizeUri(e),o=this.GetUrlComponents(t).PathSegments;return 0!==o.length&&o[0]===Yo.common},e.isOrganizationsAuthority=function(e){var t=this.CanonicalizeUri(e),o=this.GetUrlComponents(t).PathSegments;return 0!==o.length&&o[0]===nr.ORGANIZATIONS},e.isConsumersAuthority=function(e){var t=this.CanonicalizeUri(e),o=this.GetUrlComponents(t).PathSegments;return 0!==o.length&&o[0]===nr.CONSUMERS},e.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),o=e.match(t);if(!o||o.length<6)throw"Valid url required";var r={Protocol:o[1],HostNameAndPort:o[4],AbsolutePath:o[5]},n=r.AbsolutePath.split("/");return n=n.filter((function(e){return e&&e.length>0})),r.PathSegments=n,o[6]&&(r.Search=o[6]),o[8]&&(r.Hash=o[8]),r},e.CanonicalizeUri=function(t){return t&&(t=t.toLowerCase()),t&&!e.endsWith(t,"/")&&(t+="/"),t},e.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},e.urlRemoveQueryStringParameter=function(e,t){if(gr.isEmpty(e))return e;var o=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(o,""),o=new RegExp("("+t+"=)[^&]+&"),e=e.replace(o,""),o=new RegExp("("+t+"=)[^&]+"),e.replace(o,"")},e.getHashFromUrl=function(e){var t=e.indexOf("#"),o=e.indexOf("#/");return o>-1?e.substring(o+2):t>-1?e.substring(t+1):e},e.urlContainsHash=function(t){var o=e.deserializeHash(t);return o.hasOwnProperty(Wo.ERROR_DESCRIPTION)||o.hasOwnProperty(Wo.ERROR)||o.hasOwnProperty(Wo.ACCESS_TOKEN)||o.hasOwnProperty(Wo.ID_TOKEN)},e.deserializeHash=function(t){var o=e.getHashFromUrl(t);return Jo.deserialize(o)},e.getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t.split("/")[0]},e}(),qn=function(e,t,o,r,n){this.authority=Hn.CanonicalizeUri(e),this.clientId=t,this.scopes=o,this.homeAccountIdentifier=Jo.base64Encode(r)+"."+Jo.base64Encode(n)},$n=function(e,t,o,r){this.accessToken=e,this.idToken=t,this.expiresIn=o,this.homeAccountIdentifier=r},Bn="1.4.11",jn=function(){function e(e,t,o,r,n,i,s){this.authorityInstance=e,this.clientId=t,this.nonce=Jo.createNewGuid(),this.scopes=n?n.slice():Yo.oidcScopes,this.scopes=Fn.trimScopes(this.scopes),this.state=i,this.correlationId=s,this.xClientSku="MSAL.JS",this.xClientVer=Bn,this.responseType=o,this.redirectUri=r}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!0,configurable:!0}),e.prototype.populateQueryParams=function(t,o,r,n){var i={};o&&(o.prompt&&(this.promptValue=o.prompt),o.claimsRequest&&(this.claimsValue=o.claimsRequest),e.isSSOParam(o)&&(i=this.constructUnifiedCacheQueryParameter(o,null))),r&&(i=this.constructUnifiedCacheQueryParameter(null,r)),i=this.addHintParameters(t,i);var s=o?o.extraQueryParameters:null;this.queryParameters=e.generateQueryParametersString(i),this.extraQueryParameters=e.generateQueryParametersString(s,n)},e.prototype.constructUnifiedCacheQueryParameter=function(e,t){var o,r;if(e)if(e.account){var n=e.account;n.sid?(o=nr.SID,r=n.sid):n.userName&&(o=nr.LOGIN_HINT,r=n.userName)}else e.sid?(o=nr.SID,r=e.sid):e.loginHint&&(o=nr.LOGIN_HINT,r=e.loginHint);else t&&t.hasOwnProperty(Yo.upn)&&(o=nr.ID_TOKEN,r=t.upn);return this.addSSOParameter(o,r)},e.prototype.addHintParameters=function(e,t){return e&&!t[nr.SID]&&(!t[nr.LOGIN_HINT]&&e.sid&&this.promptValue===lr.NONE?t=this.addSSOParameter(nr.SID,e.sid,t):!t[nr.LOGIN_HINT]&&e.userName&&!gr.isEmpty(e.userName)&&(t=this.addSSOParameter(nr.LOGIN_HINT,e.userName,t))),t},e.prototype.addSSOParameter=function(e,t,o){if(o||(o={}),!t)return o;switch(e){case nr.SID:o[nr.SID]=t;break;case nr.ID_TOKEN:case nr.LOGIN_HINT:o[nr.LOGIN_HINT]=t}return o},e.generateQueryParametersString=function(e,t){var o=null;return e&&Object.keys(e).forEach((function(r){r===Yo.domain_hint&&(t||e[nr.SID])||(o?o+="&"+r+"="+encodeURIComponent(e[r]):o=r+"="+encodeURIComponent(e[r]))})),o},e.isSSOParam=function(e){return!(!e||!(e.account||e.sid||e.loginHint))},e.determineResponseType=function(e,t){return Fn.onlyContainsOidcScopes(t)?tr:e?this.responseTypeForMatchingAccounts(t):rr},e.responseTypeForMatchingAccounts=function(e){return Fn.containsAnyOidcScopes(e)?rr:or},e}(),zn=function(){function e(){}return e.prototype.sendRequestAsync=function(e,t,o){var r=this;return new Promise((function(o,n){var i=new XMLHttpRequest;if(i.open(t,e,!0),i.onload=function(){var e;(i.status<200||i.status>=300)&&n(r.handleError(i.responseText));try{e=JSON.parse(i.responseText)}catch(e){n(r.handleError(i.responseText))}var t={statusCode:i.status,body:e};o(t)},i.onerror=function(){n(i.status)},t!==cr)throw"not implemented";i.send()}))},e.prototype.handleError=function(e){var t;try{if((t=JSON.parse(e)).error)return t.error;throw e}catch(t){return e}},e}(),Vn=function(){function e(){}return e.setTrustedAuthoritiesFromConfig=function(t,o){t&&!this.getTrustedHostList().length&&o.forEach((function(t){e.TrustedHostList.push(t.toLowerCase())}))},e.getAliases=function(e,t,o){return Qo.mG(this,void 0,void 0,(function(){var r,n,i;return Qo.Jh(this,(function(s){return r=new zn,cr,n="https://login.microsoftonline.com/common//discovery/instance?api-version=1.1&authorization_endpoint="+e+"oauth2/v2.0/authorize",i=t.createAndStartHttpEvent(o,"GET",n,"getAliases"),[2,r.sendRequestAsync(n,"GET",!0).then((function(e){return i.httpResponseStatus=e.statusCode,t.stopEvent(i),e.body.metadata})).catch((function(e){throw i.serverErrorCode=e,t.stopEvent(i),e}))]}))}))},e.setTrustedAuthoritiesFromNetwork=function(t,o,r){return Qo.mG(this,void 0,void 0,(function(){var n;return Qo.Jh(this,(function(i){switch(i.label){case 0:return[4,this.getAliases(t,o,r)];case 1:return i.sent().forEach((function(t){t.aliases.forEach((function(t){e.TrustedHostList.push(t.toLowerCase())}))})),n=Hn.GetUrlComponents(t).HostNameAndPort,e.getTrustedHostList().length&&!e.IsInTrustedHostList(n)&&e.TrustedHostList.push(n.toLowerCase()),[2]}}))}))},e.getTrustedHostList=function(){return this.TrustedHostList},e.IsInTrustedHostList=function(e){return this.TrustedHostList.indexOf(e.toLowerCase())>-1},e.TrustedHostList=[],e}();!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs"}(sr||(sr={}));var Gn,Kn=function(){function e(e,t,o){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri(),this.tenantDiscoveryResponse=o}return e.isAdfs=function(e){var t=Hn.GetUrlComponents(e).PathSegments;return t.length&&t[0].toLowerCase()===Yo.ADFS},Object.defineProperty(e.prototype,"AuthorityType",{get:function(){return e.isAdfs(this.canonicalAuthority)?sr.Adfs:sr.Default},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),e.prototype.validateResolved=function(){if(!this.hasCachedMetadata())throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(e.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(e){this.canonicalAuthority=Hn.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=Hn.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.AuthorityType===sr.Adfs?""+this.CanonicalAuthority+ir:this.CanonicalAuthority+"v2.0/"+ir},enumerable:!0,configurable:!0}),e.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch(e){throw kn}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw wn;if(!e.PathSegments||e.PathSegments.length<1)throw Cn},e.prototype.DiscoverEndpoints=function(e,t,o){var r=new zn,n=t.createAndStartHttpEvent(o,"GET",e,"openIdConfigurationEndpoint");return r.sendRequestAsync(e,"GET",!0).then((function(e){return n.httpResponseStatus=e.statusCode,t.stopEvent(n),{AuthorizationEndpoint:e.body.authorization_endpoint,EndSessionEndpoint:e.body.end_session_endpoint,Issuer:e.body.issuer}})).catch((function(e){throw n.serverErrorCode=e,t.stopEvent(n),e}))},e.prototype.resolveEndpointsAsync=function(e,t){return Qo.mG(this,void 0,void 0,(function(){var o,r,n;return Qo.Jh(this,(function(i){switch(i.label){case 0:return this.IsValidationEnabled?(o=this.canonicalAuthorityUrlComponents.HostNameAndPort,0!==Vn.getTrustedHostList().length?[3,2]:[4,Vn.setTrustedAuthoritiesFromNetwork(this.canonicalAuthority,e,t)]):[3,3];case 1:i.sent(),i.label=2;case 2:if(!Vn.IsInTrustedHostList(o))throw Mn.createUntrustedAuthorityError(o);i.label=3;case 3:return r=this.GetOpenIdConfigurationEndpoint(),n=this,[4,this.DiscoverEndpoints(r,e,t)];case 4:return n.tenantDiscoveryResponse=i.sent(),[2,this.tenantDiscoveryResponse]}}))}))},e.prototype.hasCachedMetadata=function(){return!!(this.tenantDiscoveryResponse&&this.tenantDiscoveryResponse.AuthorizationEndpoint&&this.tenantDiscoveryResponse.EndSessionEndpoint&&this.tenantDiscoveryResponse.Issuer)},e.prototype.GetOpenIdConfigurationEndpoint=function(){return this.DefaultOpenIdConfigurationEndpoint},e}(),Wn=function(){function e(t,o){if(!t||gr.isEmpty(t))return this.uid="",void(this.utid="");try{var r=Jo.base64Decode(t),n=JSON.parse(r);n&&(n.hasOwnProperty("uid")&&(this.uid=o?e.stripPolicyFromUid(n.uid,o):n.uid),n.hasOwnProperty("utid")&&(this.utid=n.utid))}catch(e){throw on.createClientInfoDecodingError(e)}}return Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(e){this._uid=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(e){this._utid=e},enumerable:!0,configurable:!0}),e.createClientInfoFromIdToken=function(t,o){var r={uid:t.subject,utid:""};return new e(Jo.base64Encode(JSON.stringify(r)),o)},e.stripPolicyFromUid=function(e,t){var o=e.split("-"),r=t.split("/").reverse(),n="";return gr.isEmpty(r[0])?r.length>1&&(n=r[1]):n=r[0],o[o.length-1]===n?o.slice(0,o.length-1).join("-"):e},e.prototype.encodeClientInfo=function(){var e=JSON.stringify({uid:this.uid,utid:this.utid});return Jo.base64Encode(e)},e}(),Qn=function(){function e(){}return e.parseExpiresIn=function(e){return e||(e="3599"),parseInt(e,10)},e.now=function(){return Math.round((new Date).getTime()/1e3)},e.relativeNowMs=function(){return window.performance.now()},e}(),Jn=function(){function e(){}return e.decodeJwt=function(e){if(gr.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},e.validateExpirationIsWithinOffset=function(e,t){var o=t||300;return e&&e>Qn.now()+o},e.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var o=t.JWSPayload,r=Jo.base64Decode(o);return r?JSON.parse(r):null}catch(e){}return null},e}(),Yn=function(e){if(gr.isEmpty(e))throw on.createIdTokenNullOrEmptyError(e);try{this.rawIdToken=e,this.claims=Jn.extractIdToken(e),this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")?this.preferredName=this.claims.preferred_username:this.claims.hasOwnProperty("upn")&&(this.preferredName=this.claims.upn),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid),this.claims.hasOwnProperty("cloud_instance_host_name")&&(this.cloudInstance=this.claims.cloud_instance_host_name))}catch(e){throw on.createIdTokenParsingError(e)}},Zn=function(e,t){this.key=e,this.value=t},Xn=function(){function e(e){if(!window)throw fr.createNoWindowObjectError("Browser storage class could not find window object");if(void 0===window[e]||null===window[e])throw Mn.createStorageNotSupportedError(e);this.cacheLocation=e}return e.prototype.setItem=function(e,t,o){window[this.cacheLocation].setItem(e,t),o&&this.setItemCookie(e,t)},e.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this.cacheLocation].getItem(e)},e.prototype.removeItem=function(e){return window[this.cacheLocation].removeItem(e)},e.prototype.clear=function(){return window[this.cacheLocation].clear()},e.prototype.setItemCookie=function(e,t,o){var r=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";o&&(r+="expires="+this.getCookieExpirationTime(o)+";"),document.cookie=r},e.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",o=document.cookie.split(";"),r=0;r<o.length;r++){for(var n=o[r];" "===n.charAt(0);)n=n.substring(1);if(0===n.indexOf(t))return decodeURIComponent(n.substring(t.length,n.length))}return""},e.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},e.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+24*e*60*60*1e3).toUTCString()},e}(),ei=function(){function e(){}return e.validateRequest=function(e,t,o,r){if(!t&&!e)throw Mn.createEmptyRequestError();var n,i;e&&(n=t?Fn.appendScopes(e.scopes,e.extraScopesToConsent):e.scopes,Fn.validateInputScope(n,!t),n=Fn.translateClientIdIfSingleScope(n,o),this.validatePromptParameter(e.prompt),i=this.validateEQParameters(e.extraQueryParameters,e.claimsRequest),this.validateClaimsRequest(e.claimsRequest));var s=this.validateAndGenerateState(e&&e.state,r),a=this.validateAndGenerateCorrelationId(e&&e.correlationId);return Qo.pi({},e,{extraQueryParameters:i,scopes:n,state:s,correlationId:a})},e.validatePromptParameter=function(e){if(e&&[lr.LOGIN,lr.SELECT_ACCOUNT,lr.CONSENT,lr.NONE].indexOf(e)<0)throw Mn.createInvalidPromptError(e)},e.validateEQParameters=function(e,t){var o=Qo.pi({},e);return o?(t&&delete o[Yo.claims],ar.forEach((function(e){o[e]&&delete o[e]})),o):null},e.validateClaimsRequest=function(e){if(e)try{JSON.parse(e)}catch(e){throw Mn.createClaimsRequestParsingError(e)}},e.validateAndGenerateState=function(t,o){return gr.isEmpty(t)?e.generateLibraryState(o):""+e.generateLibraryState(o)+Yo.resourceDelimiter+t},e.generateLibraryState=function(e){var t={id:Jo.createNewGuid(),ts:Qn.now(),method:e},o=JSON.stringify(t);return Jo.base64Encode(o)},e.parseLibraryState=function(e){var t=decodeURIComponent(e).split(Yo.resourceDelimiter)[0];if(Jo.isGuid(t))return{id:t,ts:Qn.now(),method:Yo.interactionTypeRedirect};try{var o=Jo.base64Decode(t);return JSON.parse(o)}catch(t){throw on.createInvalidStateError(e,null)}},e.validateAndGenerateCorrelationId=function(e){if(e&&!Jo.isGuid(e))throw Mn.createInvalidCorrelationIdError();return Jo.isGuid(e)?e:Jo.createNewGuid()},e.createRequestSignature=function(e){return""+e.scopes.join(" ").toLowerCase()+Yo.resourceDelimiter+e.authority},e}(),ti=function(e){function t(t,o,r){var n=e.call(this,o)||this;return n.clientId=t,n.rollbackEnabled=!0,n.migrateCacheEntries(r),n}return Qo.ZT(t,e),t.prototype.migrateCacheEntries=function(t){var o,r=this,n=Yo.cachePrefix+"."+Xo.IDTOKEN,i=Yo.cachePrefix+"."+Xo.CLIENT_INFO,s=Yo.cachePrefix+"."+er.ERROR,a=Yo.cachePrefix+"."+er.ERROR_DESC,c=e.prototype.getItem.call(this,n);if(c)try{o=new Yn(c)}catch(e){return}if(o&&o.claims&&o.claims.aud===this.clientId){var l=[c,e.prototype.getItem.call(this,i),e.prototype.getItem.call(this,s),e.prototype.getItem.call(this,a)];[Xo.IDTOKEN,Xo.CLIENT_INFO,er.ERROR,er.ERROR_DESC].forEach((function(e,o){return r.duplicateCacheEntry(e,l[o],t)}))}},t.prototype.duplicateCacheEntry=function(e,t,o){t&&this.setItem(e,t,o)},t.prototype.generateCacheKey=function(e,t){try{return JSON.parse(e),e}catch(o){return 0===e.indexOf(""+Yo.cachePrefix)||0===e.indexOf(Yo.adalIdToken)?e:t?Yo.cachePrefix+"."+this.clientId+"."+e:Yo.cachePrefix+"."+e}},t.prototype.matchKeyForType=function(e,t,o,r){var n=gr.validateAndParseJsonCacheKey(e);if(!n)return null;var i=e.match(t)&&e.match(o),s=!1;switch(r){case Wo.ACCESS_TOKEN:s=!!e.match(Yo.scopes);break;case Wo.ID_TOKEN:s=!e.match(Yo.scopes)}return i&&s?n:null},t.prototype.setItem=function(t,o,r){e.prototype.setItem.call(this,this.generateCacheKey(t,!0),o,r),this.rollbackEnabled&&!r&&e.prototype.setItem.call(this,this.generateCacheKey(t,!1),o,r)},t.prototype.getItem=function(t,o){return e.prototype.getItem.call(this,this.generateCacheKey(t,!0),o)},t.prototype.removeItem=function(t){e.prototype.removeItem.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.removeItem.call(this,this.generateCacheKey(t,!1))},t.prototype.resetCacheItems=function(){var t,o=window[this.cacheLocation];for(t in o)o.hasOwnProperty(t)&&-1!==t.indexOf(Yo.cachePrefix)&&e.prototype.removeItem.call(this,t)},t.prototype.resetTempCacheItems=function(t){var o=this,r=t&&ei.parseLibraryState(t).id,n=this.tokenRenewalInProgress(t),i=window[this.cacheLocation];r&&!n&&Object.keys(i).forEach((function(t){-1!==t.indexOf(r)&&(o.removeItem(t),e.prototype.clearItemCookie.call(o,t))})),this.removeItem(Zo.INTERACTION_STATUS),this.removeItem(Zo.REDIRECT_REQUEST)},t.prototype.setItemCookie=function(t,o,r){e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!0),o,r),this.rollbackEnabled&&e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!1),o,r)},t.prototype.clearItemCookie=function(t){e.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!1))},t.prototype.getItemCookie=function(t){return e.prototype.getItemCookie.call(this,this.generateCacheKey(t,!0))},t.prototype.getAllTokensByType=function(e,t,o){var r=this;return Object.keys(window[this.cacheLocation]).reduce((function(n,i){var s=r.matchKeyForType(i,e,t,o);if(s){var a=r.getItem(i);if(a)try{var c=new Zn(s,JSON.parse(a));return n.concat([c])}catch(e){return n}}return n}),[])},t.prototype.getAllAccessTokens=function(e,t){return this.getAllTokensByType(e,t,Wo.ACCESS_TOKEN)},t.prototype.getAllIdTokens=function(e,t){return this.getAllTokensByType(e,t,Wo.ID_TOKEN)},t.prototype.getAllTokens=function(e,t){var o=this.getAllAccessTokens(e,t),r=this.getAllIdTokens(e,t);return o.concat(r)},t.prototype.tokenRenewalInProgress=function(e){var o=this.getItem(t.generateTemporaryCacheKey(Zo.RENEW_STATUS,e));return!(!o||o!==Yo.inProgress)},t.prototype.clearMsalCookie=function(o){var r=this;o?(this.clearItemCookie(t.generateTemporaryCacheKey(Zo.NONCE_IDTOKEN,o)),this.clearItemCookie(t.generateTemporaryCacheKey(Zo.STATE_LOGIN,o)),this.clearItemCookie(t.generateTemporaryCacheKey(Zo.LOGIN_REQUEST,o)),this.clearItemCookie(t.generateTemporaryCacheKey(Zo.STATE_ACQ_TOKEN,o))):document.cookie.split(";").forEach((function(t){var o=t.trim().split("=")[0];o.indexOf(Yo.cachePrefix)>-1&&e.prototype.clearItemCookie.call(r,o)}))},t.generateAcquireTokenAccountKey=function(e,t){var o=ei.parseLibraryState(t).id;return""+Zo.ACQUIRE_TOKEN_ACCOUNT+Yo.resourceDelimiter+e+Yo.resourceDelimiter+o},t.generateAuthorityKey=function(e){return t.generateTemporaryCacheKey(Zo.AUTHORITY,e)},t.generateTemporaryCacheKey=function(e,t){var o=ei.parseLibraryState(t).id;return""+e+Yo.resourceDelimiter+o},t}(Xn),oi=function(){function e(e,t,o,r,n,i,s){this.accountIdentifier=e,this.homeAccountIdentifier=t,this.userName=o,this.name=r,this.idToken=n,this.idTokenClaims=n,this.sid=i,this.environment=s}return e.createAccount=function(t,o){var r,n=t.objectId||t.subject,i=o?o.uid:"",s=o?o.utid:"";return gr.isEmpty(i)||(r=gr.isEmpty(s)?Jo.base64Encode(i):Jo.base64Encode(i)+"."+Jo.base64Encode(s)),new e(n,r,t.preferredName,t.name,t.claims,t.sid,t.issuer)},e.compareAccounts=function(e,t){return!!(e&&t&&e.homeAccountIdentifier&&t.homeAccountIdentifier&&e.homeAccountIdentifier===t.homeAccountIdentifier)},e}(),ri=function(){function e(){}return e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return!(!window.opener||window.opener===window)},e.generateFrameName=function(e,t){return""+e+Yo.resourceDelimiter+t},e.monitorIframeForHash=function(t,o,r,n){return new Promise((function(i,s){var a=Qn.relativeNowMs()+o;n.verbose("monitorWindowForIframe polling started");var c=setInterval((function(){if(Qn.relativeNowMs()>a)return n.error("monitorIframeForHash unable to find hash in url, timing out"),n.errorPii("monitorIframeForHash polling timed out for url: "+r),clearInterval(c),void s(on.createTokenRenewalTimeoutError());var e;try{e=t.location.href}catch(e){}e&&Hn.urlContainsHash(e)&&(n.verbose("monitorIframeForHash found url in hash"),clearInterval(c),i(t.location.hash))}),e.POLLING_INTERVAL_MS)}))},e.monitorPopupForHash=function(t,o,r,n){return new Promise((function(i,s){var a=o/e.POLLING_INTERVAL_MS,c=0;n.verbose("monitorWindowForHash polling started");var l=setInterval((function(){if(t.closed)return n.error("monitorWindowForHash window closed"),clearInterval(l),void s(on.createUserCancelledError());var o;try{o=t.location.href}catch(e){}if(o&&"about:blank"!==o)if(c++,o&&Hn.urlContainsHash(o)){n.verbose("monitorPopupForHash found url in hash"),clearInterval(l);var d=t.location.hash;e.clearUrlFragment(t),i(d)}else c>a&&(n.error("monitorPopupForHash unable to find hash in url, timing out"),n.errorPii("monitorPopupForHash polling timed out for url: "+r),clearInterval(l),s(on.createTokenRenewalTimeoutError()))}),e.POLLING_INTERVAL_MS)}))},e.loadFrame=function(e,t,o,r){var n=this;return r.infoPii("LoadFrame: "+t),new Promise((function(i,s){setTimeout((function(){var o=n.loadFrameSync(e,t,r);o?i(o):s("Unable to load iframe with name: "+t)}),o)}))},e.loadFrameSync=function(t,o,r){var n=e.addHiddenIFrame(o,r);return n?(""!==n.src&&"about:blank"!==n.src||(n.src=t,r.infoPii("Frame Name : "+o+" Navigated to: "+t)),n):null},e.addHiddenIFrame=function(e,t){if(void 0===e)return null;t.infoPii("Add msal frame to document:"+e);var o=document.getElementById(e);if(!o){if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var r=document.createElement("iframe");r.setAttribute("id",e),r.setAttribute("aria-hidden","true"),r.style.visibility="hidden",r.style.position="absolute",r.style.width=r.style.height="0",r.style.border="0",r.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),o=document.getElementsByTagName("body")[0].appendChild(r)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+e+"' id='"+e+"' style='display:none'></iframe>");window.frames&&window.frames[e]&&(o=window.frames[e])}return o},e.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},e.getIframeWithHash=function(e){var t=document.getElementsByTagName("iframe");return Array.apply(null,Array(t.length)).map((function(e,o){return t.item(o)})).filter((function(t){try{return t.contentWindow.location.hash===e}catch(e){return!1}}))[0]},e.getPopups=function(){return window.openedWindows||(window.openedWindows=[]),window.openedWindows},e.getPopUpWithHash=function(t){return e.getPopups().filter((function(e){try{return e.location.hash===t}catch(e){return!1}}))[0]},e.trackPopup=function(t){e.getPopups().push(t)},e.closePopups=function(){e.getPopups().forEach((function(e){return e.close()}))},e.blockReloadInHiddenIframes=function(){if(Hn.urlContainsHash(window.location.hash)&&e.isInIframe())throw on.createBlockTokenRequestsInHiddenIframeError()},e.checkIfBackButtonIsPressed=function(e){var t=e.getItem(Zo.REDIRECT_REQUEST);if(t&&!Hn.urlContainsHash(window.location.hash)){var o=t.split(Yo.resourceDelimiter);o.shift();var r=o.length>0?o.join(Yo.resourceDelimiter):null;e.resetTempCacheItems(r)}},e.clearUrlFragment=function(e){e.location.hash="","function"==typeof e.history.replaceState&&e.history.replaceState(null,null,""+e.location.pathname+e.location.search)},e.POLLING_INTERVAL_MS=50,e}(),ni=function(){function e(){}return e.setResponseIdToken=function(e,t){if(!e)return null;if(!t)return e;var o=Number(t.expiration);return o&&!e.expiresOn&&(e.expiresOn=new Date(1e3*o)),Qo.pi({},e,{idToken:t,idTokenClaims:t.claims,uniqueId:t.objectId||t.subject,tenantId:t.tenantId})},e.buildAuthResponse=function(t,o,r,n,i,s){switch(r.responseType){case tr:return o=Qo.pi({},o,{tokenType:Wo.ID_TOKEN,account:n,scopes:i,accountState:s}),(o=e.setResponseIdToken(o,t)).idToken?o:null;case rr:return(o=e.setResponseIdToken(o,t))&&o.accessToken&&o.idToken?o:null;case or:return e.setResponseIdToken(o,t);default:return null}},e}(),ii=function(){function e(){}return e.saveMetadataFromNetwork=function(e,t,o){return Qo.mG(this,void 0,void 0,(function(){var r;return Qo.Jh(this,(function(n){switch(n.label){case 0:return[4,e.resolveEndpointsAsync(t,o)];case 1:return r=n.sent(),this.metadataMap.set(e.CanonicalAuthority,r),[2,r]}}))}))},e.getMetadata=function(e){return this.metadataMap.get(e)},e.saveMetadataFromConfig=function(e,t){try{if(t){var o=JSON.parse(t);if(!o.authorization_endpoint||!o.end_session_endpoint||!o.issuer)throw Mn.createInvalidAuthorityMetadataError();this.metadataMap.set(e,{AuthorizationEndpoint:o.authorization_endpoint,EndSessionEndpoint:o.end_session_endpoint,Issuer:o.issuer})}}catch(e){throw Mn.createInvalidAuthorityMetadataError()}},e.CreateInstance=function(e,t,o){return gr.isEmpty(e)?null:(o&&this.saveMetadataFromConfig(e,o),new Kn(e,t,this.metadataMap.get(e)))},e.metadataMap=new Map,e}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(Gn||(Gn={}));var si=function(){function e(e,t){void 0===t&&(t={}),this.level=Gn.Info;var o=t.correlationId,r=void 0===o?"":o,n=t.level,i=void 0===n?Gn.Info:n,s=t.piiLoggingEnabled,a=void 0!==s&&s;this.localCallback=e,this.correlationId=r,this.level=i,this.piiLoggingEnabled=a}return e.prototype.logMessage=function(e,t,o){if(!(e>this.level||!this.piiLoggingEnabled&&o)){var r,n=(new Date).toUTCString();r=gr.isEmpty(this.correlationId)?n+":1.4.11-"+Gn[e]+(o?"-pii":"")+" "+t:n+":"+this.correlationId+"-1.4.11-"+Gn[e]+(o?"-pii":"")+" "+t,this.executeCallback(e,r,o)}},e.prototype.executeCallback=function(e,t,o){this.localCallback&&this.localCallback(e,t,o)},e.prototype.error=function(e){this.logMessage(Gn.Error,e,!1)},e.prototype.errorPii=function(e){this.logMessage(Gn.Error,e,!0)},e.prototype.warning=function(e){this.logMessage(Gn.Warning,e,!1)},e.prototype.warningPii=function(e){this.logMessage(Gn.Warning,e,!0)},e.prototype.info=function(e){this.logMessage(Gn.Info,e,!1)},e.prototype.infoPii=function(e){this.logMessage(Gn.Info,e,!0)},e.prototype.verbose=function(e){this.logMessage(Gn.Verbose,e,!1)},e.prototype.verbosePii=function(e){this.logMessage(Gn.Verbose,e,!0)},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},e}(),ai={clientId:"",authority:null,validateAuthority:!0,authorityMetadata:"",knownAuthorities:[],redirectUri:function(){return Hn.getCurrentUrl()},postLogoutRedirectUri:function(){return Hn.getCurrentUrl()},navigateToLoginRequestUrl:!0},ci={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},li={logger:new si(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},di={isAngular:!1,unprotectedResources:new Array,protectedResourceMap:new Map},ui="server_unavailable",pi="Server is temporarily unavailable.",hi="unknown_server_error",fi=function(e){function t(o,r){var n=e.call(this,o,r)||this;return n.name="ServerError",Object.setPrototypeOf(n,t.prototype),n}return Qo.ZT(t,e),t.createServerUnavailableError=function(){return new t(ui,pi)},t.createUnknownServerError=function(e){return new t(hi,e)},t}(fr),gi="interaction_required",mi="consent_required",vi="login_required",bi=function(e){function t(o,r){var n=e.call(this,o,r)||this;return n.name="InteractionRequiredAuthError",Object.setPrototypeOf(n,t.prototype),n}return Qo.ZT(t,e),t.isInteractionRequiredError=function(e){return e&&[gi,mi,vi].indexOf(e)>-1},t.createLoginRequiredAuthError=function(e){return new t(vi,e)},t.createInteractionRequiredAuthError=function(e){return new t(gi,e)},t.createConsentRequiredAuthError=function(e){return new t(mi,e)},t}(fi);function yi(e){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:e,fromCache:!1}}var ki="event_name",wi="elapsed_time",Ci=function(e){var t=Hn.GetUrlComponents(e);if(Kn.isAdfs(e))return e;var o=t.PathSegments;if(o&&o.length>=2){var r="tfp"===o[1]?2:1;r<o.length&&(o[r]="<tenant>")}return t.Protocol+"//"+t.HostNameAndPort+"/"+o.join("/")},Ti=function(e){return Jo.base64Encode(e)},Si=function(e){return"msal."+(e||"")},_i=function(){return!!("undefined"!=typeof window&&"performance"in window&&window.performance.mark&&window.performance.measure)};const Ii=function(){function e(e,t,o){var r;this.eventId=Jo.createNewGuid(),this.label=o,this.event=((r={})[Si(ki)]=e,r[Si(wi)]=-1,r["Microsoft.MSAL.correlation_id"]=t,r)}return e.prototype.setElapsedTime=function(e){this.event[Si(wi)]=e},e.prototype.stop=function(){var e,t,o;this.setElapsedTime(+Date.now()-+this.startTimestamp),e=this.displayName,t=this.perfStartMark,o=this.perfEndMark,_i()&&(window.performance.mark(o),window.performance.measure(e,t,o),window.performance.clearMeasures(e),window.performance.clearMarks(t),window.performance.clearMarks(o))},e.prototype.start=function(){var e;this.startTimestamp=Date.now(),this.event[Si("start_time")]=this.startTimestamp,e=this.perfStartMark,_i()&&window.performance.mark(e)},Object.defineProperty(e.prototype,"telemetryCorrelationId",{get:function(){return this.event["Microsoft.MSAL.correlation_id"]},set:function(e){this.event["Microsoft.MSAL.correlation_id"]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventName",{get:function(){return this.event[Si(ki)]},enumerable:!0,configurable:!0}),e.prototype.get=function(){return Qo.pi({},this.event,{eventId:this.eventId})},Object.defineProperty(e.prototype,"key",{get:function(){return this.telemetryCorrelationId+"_"+this.eventId+"-"+this.eventName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayName",{get:function(){return"Msal-"+this.label+"-"+this.telemetryCorrelationId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"perfStartMark",{get:function(){return"start-"+this.key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"perfEndMark",{get:function(){return"end-"+this.key},enumerable:!0,configurable:!0}),e}(),xi=function(e){function t(t,o,r,n){var i=e.call(this,Si("default_event"),o,"DefaultEvent")||this;return i.event[Si("client_id")]=r,i.event[Si("sdk_plaform")]=t.sdk,i.event[Si("sdk_version")]=t.sdkVersion,i.event[Si("application_name")]=t.applicationName,i.event[Si("application_version")]=t.applicationVersion,i.event[Si("effective_connection_speed")]=t.networkInformation&&t.networkInformation.connectionSpeed,i.event.Microsoft_MSAL_ui_event_count=i.getEventCount(Si("ui_event"),n),i.event.Microsoft_MSAL_http_event_count=i.getEventCount(Si("http_event"),n),i.event.Microsoft_MSAL_cache_event_count=i.getEventCount(Si("cache_event"),n),i}return Qo.ZT(t,e),t.prototype.getEventCount=function(e,t){return t[e]?t[e]:0},t}(Ii);var Ei,Ai,Pi,Ri=Si("authority"),Oi=Si("authority_type"),Ni=Si("ui_behavior"),Di=Si("tenant_id"),Li=Si("user_id"),Ui=Si("was_successful"),Mi=Si("api_error_code"),Fi=Si("login_hint");!function(e){e[e.AcquireTokenRedirect=2001]="AcquireTokenRedirect",e[e.AcquireTokenSilent=2002]="AcquireTokenSilent",e[e.AcquireTokenPopup=2003]="AcquireTokenPopup",e[e.LoginRedirect=2004]="LoginRedirect",e[e.LoginPopup=2005]="LoginPopup",e[e.Logout=2006]="Logout"}(Ai||(Ai={})),function(e){e.AcquireTokenRedirect="AcquireTokenRedirect",e.AcquireTokenSilent="AcquireTokenSilent",e.AcquireTokenPopup="AcquireTokenPopup",e.LoginRedirect="LoginRedirect",e.LoginPopup="LoginPopup",e.Logout="Logout"}(Pi||(Pi={}));var Hi=((Ei={})[Pi.AcquireTokenSilent]=Ai.AcquireTokenSilent,Ei[Pi.AcquireTokenPopup]=Ai.AcquireTokenPopup,Ei[Pi.AcquireTokenRedirect]=Ai.AcquireTokenRedirect,Ei[Pi.LoginPopup]=Ai.LoginPopup,Ei[Pi.LoginRedirect]=Ai.LoginRedirect,Ei[Pi.Logout]=Ai.Logout,Ei);const qi=function(e){function t(t,o,r){var n=e.call(this,Si("api_event"),t,r)||this;return r&&(n.apiCode=Hi[r],n.apiEventIdentifier=r),n.piiEnabled=o,n}return Qo.ZT(t,e),Object.defineProperty(t.prototype,"apiEventIdentifier",{set:function(e){this.event["msal.api_telem_id"]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiCode",{set:function(e){this.event["msal.api_id"]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authority",{set:function(e){this.event[Ri]=Ci(e).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiErrorCode",{set:function(e){this.event[Mi]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tenantId",{set:function(e){this.event[Di]=this.piiEnabled&&e?Ti(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"accountId",{set:function(e){this.event[Li]=this.piiEnabled&&e?Ti(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wasSuccessful",{get:function(){return!0===this.event[Ui]},set:function(e){this.event[Ui]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loginHint",{set:function(e){this.event[Fi]=this.piiEnabled&&e?Ti(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authorityType",{set:function(e){this.event[Oi]=e.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"promptType",{set:function(e){this.event[Ni]=e.toLowerCase()},enumerable:!0,configurable:!0}),t}(Ii);var $i=Si("http_path"),Bi=Si("user_agent"),ji=Si("query_parameters"),zi=Si("api_version"),Vi=Si("response_code"),Gi=Si("oauth_error_code"),Ki=Si("http_method"),Wi=Si("request_id_header"),Qi=Si("spe_info"),Ji=Si("server_error_code"),Yi=Si("server_sub_error_code"),Zi=Si("url");const Xi=function(e){function t(t,o){return e.call(this,Si("http_event"),t,o)||this}return Qo.ZT(t,e),Object.defineProperty(t.prototype,"url",{set:function(e){var t=Ci(e);this.event[Zi]=t&&t.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpPath",{set:function(e){this.event[$i]=Ci(e).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userAgent",{set:function(e){this.event[Bi]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"queryParams",{set:function(e){this.event[ji]=jn.generateQueryParametersString(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiVersion",{set:function(e){this.event[zi]=e.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpResponseStatus",{set:function(e){this.event[Vi]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"oAuthErrorCode",{set:function(e){this.event[Gi]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpMethod",{set:function(e){this.event[Ki]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"requestIdHeader",{set:function(e){this.event[Wi]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speInfo",{set:function(e){this.event[Qi]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverErrorCode",{set:function(e){this.event[Ji]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverSubErrorCode",{set:function(e){this.event[Yi]=e},enumerable:!0,configurable:!0}),t}(Ii),es=function(){function e(e,t,o){this.completedEvents={},this.inProgressEvents={},this.eventCountByCorrelationId={},this.onlySendFailureTelemetry=!1,this.telemetryPlatform=Qo.pi({sdk:Yo.libraryName,sdkVersion:Bn,networkInformation:{connectionSpeed:"undefined"!=typeof navigator&&navigator.connection&&navigator.connection.effectiveType}},e.platform),this.clientId=e.clientId,this.onlySendFailureTelemetry=e.onlySendFailureTelemetry,this.telemetryEmitter=t,this.logger=o}return e.getTelemetrymanagerStub=function(e,t){return new this({platform:{applicationName:"UnSetStub",applicationVersion:"0.0"},clientId:e},(function(){}),t)},e.prototype.startEvent=function(e){this.logger.verbose("Telemetry Event started: "+e.key),this.telemetryEmitter&&(e.start(),this.inProgressEvents[e.key]=e)},e.prototype.stopEvent=function(e){if(this.logger.verbose("Telemetry Event stopped: "+e.key),this.telemetryEmitter&&this.inProgressEvents[e.key]){e.stop(),this.incrementEventCount(e);var t=this.completedEvents[e.telemetryCorrelationId];this.completedEvents[e.telemetryCorrelationId]=(t||[]).concat([e]),delete this.inProgressEvents[e.key]}},e.prototype.flush=function(e){var t=this;if(this.logger.verbose("Flushing telemetry events: "+e),this.telemetryEmitter&&this.completedEvents[e]){var o=this.getOrphanedEvents(e);o.forEach((function(e){return t.incrementEventCount(e)}));var r=this.completedEvents[e].concat(o);delete this.completedEvents[e];var n=this.eventCountByCorrelationId[e];if(delete this.eventCountByCorrelationId[e],r&&r.length){var i=new xi(this.telemetryPlatform,e,this.clientId,n),s=r.concat([i]);this.telemetryEmitter(s.map((function(e){return e.get()})))}}},e.prototype.createAndStartApiEvent=function(e,t){var o=new qi(e,this.logger.isPiiLoggingEnabled(),t);return this.startEvent(o),o},e.prototype.stopAndFlushApiEvent=function(e,t,o,r){t.wasSuccessful=o,r&&(t.apiErrorCode=r),this.stopEvent(t),this.flush(e)},e.prototype.createAndStartHttpEvent=function(e,t,o,r){var n=new Xi(e,r);return n.url=o,n.httpMethod=t,this.startEvent(n),n},e.prototype.incrementEventCount=function(e){var t,o=e.eventName,r=this.eventCountByCorrelationId[e.telemetryCorrelationId];r?r[o]=r[o]?r[o]+1:1:this.eventCountByCorrelationId[e.telemetryCorrelationId]=((t={})[o]=1,t)},e.prototype.getOrphanedEvents=function(e){var t=this;return Object.keys(this.inProgressEvents).reduce((function(o,r){if(-1!==r.indexOf(e)){var n=t.inProgressEvents[r];return delete t.inProgressEvents[r],o.concat([n])}return o}),[])},e}();var ts=function(){function e(){}return e.filterTokenCacheItemsByScope=function(e,t){return e.filter((function(e){var o=e.key.scopes.split(" "),r=Fn.removeDefaultScopes(t);return 0===r.length?Fn.containsScope(o,t):Fn.containsScope(o,r)}))},e.filterTokenCacheItemsByAuthority=function(e,t){return e.filter((function(e){return Hn.CanonicalizeUri(e.key.authority)===t}))},e.filterTokenCacheItemsByDomain=function(e,t){return e.filter((function(e){return Hn.GetUrlComponents(e.key.authority).HostNameAndPort===t}))},e}(),os=function(){function e(e){this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=function(e){var t=e.auth,o=e.cache,r=void 0===o?{}:o,n=e.system,i=void 0===n?{}:n,s=e.framework,a=void 0===s?{}:s;return{auth:Qo.pi({},ai,t),cache:Qo.pi({},ci,r),system:Qo.pi({},li,i),framework:Qo.pi({},di,a)}}(e),this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId),Vn.setTrustedAuthoritiesFromConfig(this.config.auth.validateAuthority,this.config.auth.knownAuthorities),ii.saveMetadataFromConfig(this.config.auth.authority,this.config.auth.authorityMetadata),this.authority=this.config.auth.authority||"https://login.microsoftonline.com/common",this.cacheStorage=new ti(this.clientId,this.config.cache.cacheLocation,this.inCookie),window.activeRenewals={},window.renewStates=[],window.callbackMappedToRenewStates={},window.promiseMappedToRenewStates={},window.msal=this;var t=window.location.hash,o=Hn.urlContainsHash(t);ri.checkIfBackButtonIsPressed(this.cacheStorage),o&&this.getResponseState(t).method===Yo.interactionTypeRedirect&&this.handleRedirectAuthenticationResponse(t)}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=ii.CreateInstance(e,this.config.auth.validateAuthority)},enumerable:!0,configurable:!0}),e.prototype.getAuthorityInstance=function(){return this.authorityInstance},e.prototype.handleRedirectCallback=function(e,t){if(!e)throw Mn.createInvalidCallbackObjectError(e);t?(this.tokenReceivedCallback=e,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=e,this.redirectError?this.authErrorHandler(Yo.interactionTypeRedirect,this.redirectError,this.redirectResponse):this.redirectResponse&&this.authResponseHandler(Yo.interactionTypeRedirect,this.redirectResponse)},e.prototype.urlContainsHash=function(e){return this.logger.verbose("UrlContainsHash has been called"),Hn.urlContainsHash(e)},e.prototype.authResponseHandler=function(e,t,o){if(this.logger.verbose("AuthResponseHandler has been called"),e===Yo.interactionTypeRedirect)this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback?(this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling success callback with response"),this.tokenReceivedCallback(t)):this.authResponseCallback&&(this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with response"),this.authResponseCallback(null,t));else{if(e!==Yo.interactionTypePopup)throw on.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, resolving"),o(t)}},e.prototype.authErrorHandler=function(e,t,o,r){if(this.logger.verbose("AuthErrorHandler has been called"),this.cacheStorage.removeItem(Zo.INTERACTION_STATUS),e===Yo.interactionTypeRedirect)if(this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback)this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling error callback"),this.errorReceivedCallback(t,o.accountState);else{if(!this.authResponseCallback)throw this.logger.verbose("handleRedirectCallback has not been called and no callbacks are registered, throwing error"),t;this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with error"),this.authResponseCallback(t,o)}else{if(e!==Yo.interactionTypePopup)throw on.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, rejecting"),r(t)}},e.prototype.loginRedirect=function(e){this.logger.verbose("LoginRedirect has been called");var t=ei.validateRequest(e,!0,this.clientId,Yo.interactionTypeRedirect);this.acquireTokenInteractive(Yo.interactionTypeRedirect,!0,t,null,null)},e.prototype.acquireTokenRedirect=function(e){this.logger.verbose("AcquireTokenRedirect has been called");var t=ei.validateRequest(e,!1,this.clientId,Yo.interactionTypeRedirect);this.acquireTokenInteractive(Yo.interactionTypeRedirect,!1,t,null,null)},e.prototype.loginPopup=function(e){var t=this;this.logger.verbose("LoginPopup has been called");var o=ei.validateRequest(e,!0,this.clientId,Yo.interactionTypePopup),r=this.telemetryManager.createAndStartApiEvent(o.correlationId,Pi.LoginPopup);return new Promise((function(e,r){t.acquireTokenInteractive(Yo.interactionTypePopup,!0,o,e,r)})).then((function(e){return t.logger.verbose("Successfully logged in"),t.telemetryManager.stopAndFlushApiEvent(o.correlationId,r,!0),e})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(o.state),t.telemetryManager.stopAndFlushApiEvent(o.correlationId,r,!1,e.errorCode),e}))},e.prototype.acquireTokenPopup=function(e){var t=this;this.logger.verbose("AcquireTokenPopup has been called");var o=ei.validateRequest(e,!1,this.clientId,Yo.interactionTypePopup),r=this.telemetryManager.createAndStartApiEvent(o.correlationId,Pi.AcquireTokenPopup);return new Promise((function(e,r){t.acquireTokenInteractive(Yo.interactionTypePopup,!1,o,e,r)})).then((function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(o.correlationId,r,!0),e})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(o.state),t.telemetryManager.stopAndFlushApiEvent(o.correlationId,r,!1,e.errorCode),e}))},e.prototype.acquireTokenInteractive=function(e,t,o,r,n){var i=this;this.logger.verbose("AcquireTokenInteractive has been called"),ri.blockReloadInHiddenIframes();var s,a=this.cacheStorage.getItem(Zo.INTERACTION_STATUS);if(e===Yo.interactionTypeRedirect&&this.cacheStorage.setItem(Zo.REDIRECT_REQUEST,""+Yo.inProgress+Yo.resourceDelimiter+o.state),a===Yo.inProgress){var c=t?on.createLoginInProgressError():on.createAcquireTokenInProgressError(),l=yi(this.getAccountState(o.state));return this.cacheStorage.resetTempCacheItems(o.state),void this.authErrorHandler(e,c,l,n)}if(o&&o.account&&!t?(s=o.account,this.logger.verbose("Account set from request")):(s=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),s||jn.isSSOParam(o))this.logger.verbose("User session exists, login not required"),this.acquireTokenHelper(s,e,t,o,r,n);else{if(!t)return this.logger.verbose("AcquireToken call, no context or account given"),this.logger.info("User login is required"),l=yi(this.getAccountState(o.state)),this.cacheStorage.resetTempCacheItems(o.state),void this.authErrorHandler(e,on.createUserLoginRequiredError(),l,n);if(this.extractADALIdToken()&&!o.scopes){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken");var d=this.buildIDTokenRequest(o);this.silentLogin=!0,this.acquireTokenSilent(d).then((function(t){i.silentLogin=!1,i.logger.info("Unified cache call is successful"),i.authResponseHandler(e,t,r)}),(function(s){i.silentLogin=!1,i.logger.error("Error occurred during unified cache ATS: "+s),i.acquireTokenHelper(null,e,t,o,r,n)}))}else this.logger.verbose("Login call but no token found, proceed to login"),this.acquireTokenHelper(null,e,t,o,r,n)}},e.prototype.acquireTokenHelper=function(e,t,o,r,n,i){return Qo.mG(this,void 0,void 0,(function(){var s,a,c,l,d,u,p,h,f,g;return Qo.Jh(this,(function(m){switch(m.label){case 0:this.logger.verbose("AcquireTokenHelper has been called"),this.logger.verbose("Interaction type: "+t+". isLoginCall: "+o),this.cacheStorage.setItem(Zo.INTERACTION_STATUS,Yo.inProgress),s=r.scopes?r.scopes.join(" ").toLowerCase():Yo.oidcScopes.join(" "),this.logger.verbosePii("Request signature: "+s),c=r&&r.authority?ii.CreateInstance(r.authority,this.config.auth.validateAuthority,r.authorityMetadata):this.authorityInstance,m.label=1;case 1:return m.trys.push([1,11,,12]),c.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,ii.saveMetadataFromNetwork(c,this.telemetryManager,r.correlationId)]);case 2:return m.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),m.label=4;case 4:if(d=o?tr:this.getTokenType(e,r.scopes),u=r.redirectStartPage||window.location.href,a=new jn(c,this.clientId,d,this.getRedirectUri(r&&r.redirectUri),r.scopes,r.state,r.correlationId),this.logger.verbose("Finished building server authentication request"),this.updateCacheEntries(a,e,o,u),this.logger.verbose("Updating cache entries"),a.populateQueryParams(e,r),this.logger.verbose("Query parameters populated from account"),p=Hn.createNavigateUrl(a)+Yo.response_mode_fragment,t===Yo.interactionTypeRedirect)o?this.logger.verbose("Interaction type redirect but login call is true. State not cached"):(this.cacheStorage.setItem(ti.generateTemporaryCacheKey(Zo.STATE_ACQ_TOKEN,r.state),a.state,this.inCookie),this.logger.verbose("State cached for redirect"),this.logger.verbosePii("State cached: "+a.state));else{if(t!==Yo.interactionTypePopup)throw this.logger.verbose("Invalid interaction error. State not cached"),on.createInvalidInteractionTypeError();window.renewStates.push(a.state),window.requestType=o?Yo.login:Yo.renewToken,this.logger.verbose("State saved to window"),this.logger.verbosePii("State saved: "+a.state),this.registerCallback(a.state,s,n,i)}if(t!==Yo.interactionTypePopup)return[3,9];this.logger.verbose("Interaction type is popup. Generating popup window");try{l=this.openPopup(p,"msal",Yo.popUpWidth,Yo.popUpHeight),ri.trackPopup(l)}catch(e){if(this.logger.info(br+":"+yr),this.cacheStorage.setItem(er.ERROR,br),this.cacheStorage.setItem(er.ERROR_DESC,yr),i)return i(on.createPopupWindowError()),[2]}if(!l)return[3,8];m.label=5;case 5:return m.trys.push([5,7,,8]),[4,ri.monitorPopupForHash(l,this.config.system.loadFrameTimeout,p,this.logger)];case 6:return h=m.sent(),this.handleAuthenticationResponse(h),this.cacheStorage.removeItem(Zo.INTERACTION_STATUS),this.logger.info("Closing popup window"),this.config.framework.isAngular&&this.broadcast("msal:popUpHashChanged",h),ri.closePopups(),[3,8];case 7:return f=m.sent(),i&&i(f),this.config.framework.isAngular?this.broadcast("msal:popUpClosed",f.errorCode+Yo.resourceDelimiter+f.errorMessage):(this.cacheStorage.removeItem(Zo.INTERACTION_STATUS),l.close()),[3,8];case 8:return[3,10];case 9:r.onRedirectNavigate?(this.logger.verbose("Invoking onRedirectNavigate callback"),!1!==r.onRedirectNavigate(p)?(this.logger.verbose("onRedirectNavigate did not return false, navigating"),this.navigateWindow(p)):this.logger.verbose("onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(p)),m.label=10;case 10:return[3,12];case 11:return g=m.sent(),this.logger.error(g),this.cacheStorage.resetTempCacheItems(r.state),this.authErrorHandler(t,on.createEndpointResolutionError(g.toString),yi(r.state),i),l&&l.close(),[3,12];case 12:return[2]}}))}))},e.prototype.ssoSilent=function(e){if(this.logger.verbose("ssoSilent has been called"),!e)throw Mn.createEmptyRequestError();if(!e.sid&&!e.loginHint)throw Mn.createSsoSilentError();return this.acquireTokenSilent(Qo.pi({},e,{scopes:Yo.oidcScopes}))},e.prototype.acquireTokenSilent=function(e){var t=this;this.logger.verbose("AcquireTokenSilent has been called");var o=ei.validateRequest(e,!1,this.clientId,Yo.interactionTypeSilent),r=this.telemetryManager.createAndStartApiEvent(o.correlationId,Pi.AcquireTokenSilent),n=ei.createRequestSignature(o);return new Promise((function(e,r){return Qo.mG(t,void 0,void 0,(function(){var t,i,s,a,c,l,d,u,p,h,f;return Qo.Jh(this,(function(g){switch(g.label){case 0:if(ri.blockReloadInHiddenIframes(),t=o.scopes.join(" ").toLowerCase(),this.logger.verbosePii("Serialized scopes: "+t),o.account?(i=o.account,this.logger.verbose("Account set from request")):(i=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),s=this.cacheStorage.getItem(Yo.adalIdToken),!i&&!o.sid&&!o.loginHint&&gr.isEmpty(s))return this.logger.info("User login is required"),[2,r(on.createUserLoginRequiredError())];if(a=this.getTokenType(i,o.scopes),this.logger.verbose("Response type: "+a),c=new jn(ii.CreateInstance(o.authority,this.config.auth.validateAuthority,o.authorityMetadata),this.clientId,a,this.getRedirectUri(o.redirectUri),o.scopes,o.state,o.correlationId),this.logger.verbose("Finished building server authentication request"),jn.isSSOParam(o)||i?(c.populateQueryParams(i,o,null,!0),this.logger.verbose("Query parameters populated from existing SSO or account")):i||gr.isEmpty(s)?this.logger.verbose("No additional query parameters added"):(l=Jn.extractIdToken(s),this.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken to populate query parameters"),c.populateQueryParams(i,null,l,!0)),!(d=o.claimsRequest||c.claimsValue)&&!o.forceRefresh)try{p=this.getCachedToken(c,i)}catch(e){u=e}return p?(this.logger.verbose("Token found in cache lookup"),this.logger.verbosePii("Scopes found: "+JSON.stringify(p.scopes)),e(p),[2,null]):[3,1];case 1:return u?(this.logger.infoPii(u.errorCode+":"+u.errorMessage),r(u),[2,null]):[3,2];case 2:void 0,h=d?"Skipped cache lookup since claims were given":o.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"No valid token found in cache lookup",this.logger.verbose(h),c.authorityInstance||(c.authorityInstance=o.authority?ii.CreateInstance(o.authority,this.config.auth.validateAuthority,o.authorityMetadata):this.authorityInstance),this.logger.verbosePii("Authority instance: "+c.authority),g.label=3;case 3:return g.trys.push([3,7,,8]),c.authorityInstance.hasCachedMetadata()?[3,5]:(this.logger.verbose("No cached metadata for authority"),[4,ii.saveMetadataFromNetwork(c.authorityInstance,this.telemetryManager,o.correlationId)]);case 4:return g.sent(),this.logger.verbose("Authority has been updated with endpoint discovery response"),[3,6];case 5:this.logger.verbose("Cached metadata found for authority"),g.label=6;case 6:return window.activeRenewals[n]?(this.logger.verbose("Renewing token in progress. Registering callback"),this.registerCallback(window.activeRenewals[n],n,e,r)):o.scopes&&Fn.onlyContainsOidcScopes(o.scopes)?(this.logger.verbose("OpenID Connect scopes only, renewing idToken"),this.silentLogin=!0,this.renewIdToken(n,e,r,i,c)):(this.logger.verbose("Renewing access token"),this.renewToken(n,e,r,i,c)),[3,8];case 7:return f=g.sent(),this.logger.error(f),r(on.createEndpointResolutionError(f.toString())),[2,null];case 8:return[2]}}))}))})).then((function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(o.correlationId,r,!0),e})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(o.state),t.telemetryManager.stopAndFlushApiEvent(o.correlationId,r,!1,e.errorCode),e}))},e.prototype.openPopup=function(e,t,o,r){this.logger.verbose("OpenPopup has been called");try{var n=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=s/2-o/2+n,l=a/2-r/2+i,d=window.open(e,t,"width="+o+", height="+r+", top="+l+", left="+c+", scrollbars=yes");if(!d)throw on.createPopupWindowError();return d.focus&&d.focus(),d}catch(e){throw this.cacheStorage.removeItem(Zo.INTERACTION_STATUS),on.createPopupWindowError(e.toString())}},e.prototype.loadIframeTimeout=function(e,t,o){return Qo.mG(this,void 0,void 0,(function(){var r,n,i,s,a;return Qo.Jh(this,(function(c){switch(c.label){case 0:return r=window.activeRenewals[o],this.logger.verbosePii("Set loading state to pending for: "+o+":"+r),this.cacheStorage.setItem(ti.generateTemporaryCacheKey(Zo.RENEW_STATUS,r),Yo.inProgress),this.config.system.navigateFrameWait?[4,ri.loadFrame(e,t,this.config.system.navigateFrameWait,this.logger)]:[3,2];case 1:return i=c.sent(),[3,3];case 2:i=ri.loadFrameSync(e,t,this.logger),c.label=3;case 3:n=i,c.label=4;case 4:return c.trys.push([4,6,,7]),[4,ri.monitorIframeForHash(n.contentWindow,this.config.system.loadFrameTimeout,e,this.logger)];case 5:return(s=c.sent())&&this.handleAuthenticationResponse(s),[3,7];case 6:throw a=c.sent(),this.cacheStorage.getItem(ti.generateTemporaryCacheKey(Zo.RENEW_STATUS,r))===Yo.inProgress&&(this.logger.verbose("Loading frame has timed out after: "+this.config.system.loadFrameTimeout/1e3+" seconds for scope/authority "+o+":"+r),r&&window.callbackMappedToRenewStates[r]&&window.callbackMappedToRenewStates[r](null,a),this.cacheStorage.removeItem(ti.generateTemporaryCacheKey(Zo.RENEW_STATUS,r))),ri.removeHiddenIframe(n),a;case 7:return ri.removeHiddenIframe(n),[2]}}))}))},e.prototype.navigateWindow=function(e,t){if(!e||gr.isEmpty(e))throw this.logger.info("Navigate url is empty"),fr.createUnexpectedError("Navigate url is empty");var o=t||window,r=t?"Navigated Popup window to:"+e:"Navigate to:"+e;this.logger.infoPii(r),o.location.assign(e)},e.prototype.registerCallback=function(e,t,o,r){var n=this;window.activeRenewals[t]=e,window.promiseMappedToRenewStates[e]||(window.promiseMappedToRenewStates[e]=[]),window.promiseMappedToRenewStates[e].push({resolve:o,reject:r}),window.callbackMappedToRenewStates[e]||(window.callbackMappedToRenewStates[e]=function(o,r){window.activeRenewals[t]=null;for(var i=0;i<window.promiseMappedToRenewStates[e].length;++i)try{if(r)window.promiseMappedToRenewStates[e][i].reject(r);else{if(!o)throw n.cacheStorage.resetTempCacheItems(e),fr.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[e][i].resolve(o)}}catch(e){n.logger.warning(e)}window.promiseMappedToRenewStates[e]=null,window.callbackMappedToRenewStates[e]=null})},e.prototype.logout=function(e){this.logger.verbose("Logout has been called"),this.logoutAsync(e)},e.prototype.logoutAsync=function(e){return Qo.mG(this,void 0,void 0,(function(){var t,o,r,n,i,s;return Qo.Jh(this,(function(a){switch(a.label){case 0:t=e||Jo.createNewGuid(),o=this.telemetryManager.createAndStartApiEvent(t,Pi.Logout),this.clearCache(),this.account=null,a.label=1;case 1:return a.trys.push([1,5,,6]),this.authorityInstance.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,ii.saveMetadataFromNetwork(this.authorityInstance,this.telemetryManager,e)]);case 2:return a.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),a.label=4;case 4:return r="client-request-id="+t,n=void 0,this.getPostLogoutRedirectUri()?(n="&post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri()),this.logger.verbose("redirectUri found and set")):(n="",this.logger.verbose("No redirectUri set for app. postLogoutQueryParam is empty")),i=void 0,this.authorityInstance.EndSessionEndpoint?(i=this.authorityInstance.EndSessionEndpoint+"?"+r+n,this.logger.verbose("EndSessionEndpoint found and urlNavigate set"),this.logger.verbosePii("urlNavigate set to: "+this.authorityInstance.EndSessionEndpoint)):(i=this.authority+"oauth2/v2.0/logout?"+r+n,this.logger.verbose("No endpoint, urlNavigate set to default")),this.telemetryManager.stopAndFlushApiEvent(t,o,!0),this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(i),[3,6];case 5:return s=a.sent(),this.telemetryManager.stopAndFlushApiEvent(t,o,!1,s.errorCode),[3,6];case 6:return[2]}}))}))},e.prototype.clearCache=function(){this.logger.verbose("Clearing cache"),window.renewStates=[];for(var e=this.cacheStorage.getAllTokens(Yo.clientId,Yo.homeAccountIdentifier),t=0;t<e.length;t++)this.cacheStorage.removeItem(JSON.stringify(e[t].key));this.cacheStorage.resetCacheItems(),this.cacheStorage.clearMsalCookie(),this.logger.verbose("Cache cleared")},e.prototype.clearCacheForScope=function(e){this.logger.verbose("Clearing access token from cache");for(var t=this.cacheStorage.getAllAccessTokens(Yo.clientId,Yo.homeAccountIdentifier),o=0;o<t.length;o++){var r=t[o];r.value.accessToken===e&&(this.cacheStorage.removeItem(JSON.stringify(r.key)),this.logger.verbosePii("Access token removed: "+r.key))}},e.prototype.isCallback=function(e){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),this.logger.verbose("isCallback has been called"),Hn.urlContainsHash(e)},e.prototype.processCallBack=function(e,t,o){var r,n;this.logger.info("ProcessCallBack has been called. Processing callback from redirect response"),t||(this.logger.verbose("StateInfo is null, getting stateInfo from hash"),t=this.getResponseState(e));try{r=this.saveTokenFromHash(e,t)}catch(e){n=e}try{this.cacheStorage.clearMsalCookie(t.state);var i=this.getAccountState(t.state);if(r){if(t.requestType===Yo.renewToken||r.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("Acquiring token interactive in progress"),this.logger.verbose("Response tokenType set to "+Wo.ACCESS_TOKEN),r.tokenType=Wo.ACCESS_TOKEN):t.requestType===Yo.login&&(this.logger.verbose("Response tokenType set to "+Wo.ID_TOKEN),r.tokenType=Wo.ID_TOKEN),!o)return this.logger.verbose("Setting redirectResponse"),void(this.redirectResponse=r)}else if(!o)return this.logger.verbose("Response is null, setting redirectResponse with state"),this.redirectResponse=yi(i),this.redirectError=n,void this.cacheStorage.resetTempCacheItems(t.state);this.logger.verbose("Calling callback provided to processCallback"),o(r,n)}catch(e){throw this.logger.error("Error occurred in token received callback function: "+e),on.createErrorInCallbackFunction(e.toString())}},e.prototype.handleAuthenticationResponse=function(e){this.logger.verbose("HandleAuthenticationResponse has been called");var t=e||window.location.hash,o=this.getResponseState(t);this.logger.verbose("Obtained state from response");var r=window.callbackMappedToRenewStates[o.state];this.processCallBack(t,o,r)},e.prototype.handleRedirectAuthenticationResponse=function(e){this.logger.info("Returned from redirect url"),this.logger.verbose("HandleRedirectAuthenticationResponse has been called"),ri.clearUrlFragment(window),this.logger.verbose("Window.location.hash cleared");var t=this.getResponseState(e);if(this.config.auth.navigateToLoginRequestUrl&&window.parent===window){this.logger.verbose("Window.parent is equal to window, not in popup or iframe. Navigation to login request url after login turned on");var o=this.cacheStorage.getItem(ti.generateTemporaryCacheKey(Zo.LOGIN_REQUEST,t.state),this.inCookie);if(!o||"null"===o)return this.logger.error("Unable to get valid login request url from cache, redirecting to home page"),void window.location.assign("/");this.logger.verbose("Valid login request url obtained from cache");var r=Hn.removeHashFromUrl(window.location.href),n=Hn.removeHashFromUrl(o);if(r!==n)return this.logger.verbose("Current url is not login request url, navigating"),this.logger.verbosePii("CurrentUrl: "+r+", finalRedirectUrl: "+n),void window.location.assign(""+n+e);this.logger.verbose("Current url matches login request url");var i=Hn.GetUrlComponents(o);i.Hash&&(this.logger.verbose("Login request url contains hash, resetting non-msal hash"),window.location.hash=i.Hash)}else this.config.auth.navigateToLoginRequestUrl||this.logger.verbose("Default navigation to start page after login turned off");this.processCallBack(e,t,null)},e.prototype.getResponseState=function(e){this.logger.verbose("GetResponseState has been called");var t,o=Hn.deserializeHash(e);if(!o)throw fr.createUnexpectedError("Hash was not parsed correctly.");if(!o.hasOwnProperty(Wo.STATE))throw fr.createUnexpectedError("Hash does not contain state.");this.logger.verbose("Hash contains state. Creating stateInfo object");var r=ei.parseLibraryState(o.state);if((t={requestType:Yo.unknown,state:o.state,timestamp:r.ts,method:r.method,stateMatch:!1}).state===this.cacheStorage.getItem(ti.generateTemporaryCacheKey(Zo.STATE_LOGIN,t.state),this.inCookie)||t.state===this.silentAuthenticationState)return this.logger.verbose("State matches cached state, setting requestType to login"),t.requestType=Yo.login,t.stateMatch=!0,t;if(t.state===this.cacheStorage.getItem(ti.generateTemporaryCacheKey(Zo.STATE_ACQ_TOKEN,t.state),this.inCookie))return this.logger.verbose("State matches cached state, setting requestType to renewToken"),t.requestType=Yo.renewToken,t.stateMatch=!0,t;if(!t.stateMatch){this.logger.verbose("State does not match cached state, setting requestType to type from window"),t.requestType=window.requestType;for(var n=window.renewStates,i=0;i<n.length;i++)if(n[i]===t.state){this.logger.verbose("Matching state found for request"),t.stateMatch=!0;break}t.stateMatch||this.logger.verbose("Matching state not found for request")}return t},e.prototype.getCachedToken=function(e,t){this.logger.verbose("GetCachedToken has been called");var o=e.scopes,r=this.getCachedIdToken(e,t),n=this.getCachedAccessToken(e,t,o),i=this.getAccountState(e.state);return ni.buildAuthResponse(r,n,e,t,o,i)},e.prototype.getTokenCacheItemByAuthority=function(e,t,o,r){var n,i=this;return 1===(n=Hn.isCommonAuthority(e)||Hn.isOrganizationsAuthority(e)||Hn.isConsumersAuthority(e)?ts.filterTokenCacheItemsByDomain(t,Hn.GetUrlComponents(e).HostNameAndPort):ts.filterTokenCacheItemsByAuthority(t,e)).length?n[0]:n.length>1?(this.logger.warning("Multiple matching tokens found. Cleaning cache and requesting a new token."),n.forEach((function(e){i.cacheStorage.removeItem(JSON.stringify(e.key))})),null):(this.logger.verbose("No matching tokens of type "+r+" found"),null)},e.prototype.getCachedIdToken=function(e,t){this.logger.verbose("Getting all cached tokens of type ID Token");var o=this.cacheStorage.getAllIdTokens(this.clientId,t?t.homeAccountIdentifier:null),r=e.authority||this.authority,n=this.getTokenCacheItemByAuthority(r,o,null,Wo.ID_TOKEN);if(n){if(this.logger.verbose("Evaluating ID token found"),this.evaluateTokenExpiration(n)){this.logger.verbose("ID token expiration is within offset, using ID token found in cache");var i=n.value;return i?this.logger.verbose("ID Token found in cache is valid and unexpired"):this.logger.verbose("ID Token found in cache is invalid"),i?new Yn(i.idToken):null}return this.logger.verbose("Cached ID token is expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(n.key)),null}return this.logger.verbose("No tokens found"),null},e.prototype.getCachedAccessToken=function(e,t,o){this.logger.verbose("Getting all cached tokens of type Access Token");var r=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null),n=ts.filterTokenCacheItemsByScope(r,o),i=e.authority||this.authority,s=this.getTokenCacheItemByAuthority(i,n,o,Wo.ACCESS_TOKEN);if(s){if(e.authorityInstance=ii.CreateInstance(s.key.authority,this.config.auth.validateAuthority),this.logger.verbose("Evaluating access token found"),this.evaluateTokenExpiration(s)){if(this.logger.verbose("Access token expiration is within offset, using access token found in cache"),!t&&!(t=this.getAccount()))throw fr.createUnexpectedError("Account should not be null here.");var a=this.getAccountState(e.state);return{uniqueId:"",tenantId:"",tokenType:Wo.ACCESS_TOKEN,idToken:null,idTokenClaims:null,accessToken:s.value.accessToken,scopes:s.key.scopes.split(" "),expiresOn:new Date(1e3*Number(s.value.expiresIn)),account:t,accountState:a,fromCache:!0}}return this.logger.verbose("Access token expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(s.key)),null}return this.logger.verbose("No matching token found when filtering by scope and authority"),null},e.prototype.evaluateTokenExpiration=function(e){var t=Number(e.value.expiresIn);return Jn.validateExpirationIsWithinOffset(t,this.config.system.tokenRenewalOffsetSeconds)},e.prototype.extractADALIdToken=function(){this.logger.verbose("ExtractADALIdToken has been called");var e=this.cacheStorage.getItem(Yo.adalIdToken);return gr.isEmpty(e)?null:Jn.extractIdToken(e)},e.prototype.renewToken=function(e,t,o,r,n){this.logger.verbose("RenewToken has been called"),this.logger.verbosePii("RenewToken scope and authority: "+e);var i=ri.generateFrameName("msalRenewFrame",e);ri.addHiddenIFrame(i,this.logger),this.updateCacheEntries(n,r,!1),this.logger.verbosePii("RenewToken expected state: "+n.state);var s=Hn.urlRemoveQueryStringParameter(Hn.createNavigateUrl(n),Yo.prompt)+Yo.prompt_none+Yo.response_mode_fragment;window.renewStates.push(n.state),window.requestType=Yo.renewToken,this.logger.verbose("Set window.renewState and requestType"),this.registerCallback(n.state,e,t,o),this.logger.infoPii("Navigate to: "+s),this.loadIframeTimeout(s,i,e).catch((function(e){return o(e)}))},e.prototype.renewIdToken=function(e,t,o,r,n){this.logger.info("RenewIdToken has been called");var i=ri.generateFrameName("msalIdTokenFrame",e);ri.addHiddenIFrame(i,this.logger),this.updateCacheEntries(n,r,!1),this.logger.verbose("RenewIdToken expected state: "+n.state);var s=Hn.urlRemoveQueryStringParameter(Hn.createNavigateUrl(n),Yo.prompt)+Yo.prompt_none+Yo.response_mode_fragment;this.silentLogin?(this.logger.verbose("Silent login is true, set silentAuthenticationState"),window.requestType=Yo.login,this.silentAuthenticationState=n.state):(this.logger.verbose("Not silent login, set window.renewState and requestType"),window.requestType=Yo.renewToken,window.renewStates.push(n.state)),this.registerCallback(n.state,e,t,o),this.logger.infoPii('Navigate to:" '+s),this.loadIframeTimeout(s,i,e).catch((function(e){return o(e)}))},e.prototype.saveToken=function(e,t,o,r,n){var i=new qn(t,this.clientId,o,r.uid,r.utid),s=new $n(e.accessToken,e.idToken.rawIdToken,n.toString(),r.encodeClientInfo());return this.cacheStorage.setItem(JSON.stringify(i),JSON.stringify(s)),n?(this.logger.verbose("New expiration set for token"),e.expiresOn=new Date(1e3*n)):this.logger.error("Could not parse expiresIn parameter for access token"),e},e.prototype.saveIdToken=function(e,t,o,r,n){this.logger.verbose("SaveIdToken has been called");var i=Qo.pi({},e);i.scopes=Yo.oidcScopes,i.accessToken=o[Wo.ID_TOKEN];var s=Number(n.expiration);return this.logger.verbose("Saving ID token to cache"),this.saveToken(i,t,void 0,r,s)},e.prototype.saveAccessToken=function(e,t,o,r){this.logger.verbose("SaveAccessToken has been called");var n=Qo.pi({},e),i=o[Wo.SCOPE],s=i.split(" "),a=this.cacheStorage.getAllAccessTokens(this.clientId,t);this.logger.verbose("Retrieving all access tokens from cache and removing duplicates");for(var c=0;c<a.length;c++){var l=a[c];if(l.key.homeAccountIdentifier===e.account.homeAccountIdentifier){var d=l.key.scopes.split(" ");Fn.isIntersectingScopes(d,s)&&this.cacheStorage.removeItem(JSON.stringify(l.key))}}n.accessToken=o[Wo.ACCESS_TOKEN],n.scopes=s;var u=Qn.parseExpiresIn(o[Wo.EXPIRES_IN]),p=ei.parseLibraryState(o[Wo.STATE]).ts+u;return this.logger.verbose("Saving access token to cache"),this.saveToken(n,t,i,r,p)},e.prototype.saveTokenFromHash=function(e,t){this.logger.verbose("SaveTokenFromHash has been called"),this.logger.info("State status: "+t.stateMatch+"; Request type: "+t.requestType);var o,r={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:"",fromCache:!1},n=Hn.deserializeHash(e),i="",s="",a=null;if(n.hasOwnProperty(Wo.ERROR_DESCRIPTION)||n.hasOwnProperty(Wo.ERROR)){if(this.logger.verbose("Server returned an error"),this.logger.infoPii("Error : "+n[Wo.ERROR]+"; Error description: "+n[Wo.ERROR_DESCRIPTION]),this.cacheStorage.setItem(er.ERROR,n[Wo.ERROR]),this.cacheStorage.setItem(er.ERROR_DESC,n[Wo.ERROR_DESCRIPTION]),t.requestType===Yo.login&&(this.logger.verbose("RequestType is login, caching login error, generating authorityKey"),this.cacheStorage.setItem(er.LOGIN_ERROR,n[Wo.ERROR_DESCRIPTION]+":"+n[Wo.ERROR]),i=ti.generateAuthorityKey(t.state)),t.requestType===Yo.renewToken){this.logger.verbose("RequestType is renewToken, generating acquireTokenAccountKey"),i=ti.generateAuthorityKey(t.state);var c=this.getAccount(),l=void 0;c&&!gr.isEmpty(c.homeAccountIdentifier)?(l=c.homeAccountIdentifier,this.logger.verbose("AccountId is set")):(l=Yo.no_account,this.logger.verbose("AccountId is set as no_account")),s=ti.generateAcquireTokenAccountKey(l,t.state)}var d=n[Wo.ERROR],u=n[Wo.ERROR_DESCRIPTION];o=bi.isInteractionRequiredError(d)||bi.isInteractionRequiredError(u)?new bi(n[Wo.ERROR],n[Wo.ERROR_DESCRIPTION]):new fi(n[Wo.ERROR],n[Wo.ERROR_DESCRIPTION])}else if(this.logger.verbose("Server returns success"),t.stateMatch){this.logger.info("State is right"),n.hasOwnProperty(Wo.SESSION_STATE)&&(this.logger.verbose("Fragment has session state, caching"),this.cacheStorage.setItem(ti.generateTemporaryCacheKey(Zo.SESSION_STATE,t.state),n[Wo.SESSION_STATE])),r.accountState=this.getAccountState(t.state);var p=void 0;if(n.hasOwnProperty(Wo.ACCESS_TOKEN)){this.logger.info("Fragment has access token"),r.accessToken=n[Wo.ACCESS_TOKEN],n.hasOwnProperty(Wo.SCOPE)&&(r.scopes=n[Wo.SCOPE].split(" ")),n.hasOwnProperty(Wo.ID_TOKEN)?(this.logger.verbose("Fragment has id_token"),a=new Yn(n[Wo.ID_TOKEN])):(this.logger.verbose("No idToken on fragment, getting idToken from cache"),a=new Yn(this.cacheStorage.getItem(Xo.IDTOKEN))),r=ni.setResponseIdToken(r,a);var h=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,a);this.logger.verbose("Got authority from cache"),n.hasOwnProperty(Wo.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),p=new Wn(n[Wo.CLIENT_INFO],h)):this.authorityInstance.AuthorityType===sr.Adfs?p=Wn.createClientInfoFromIdToken(a,h):this.logger.warning("ClientInfo not received in the response from AAD"),r.account=oi.createAccount(a,p),this.logger.verbose("Account object created from response");var f=void 0;r.account&&!gr.isEmpty(r.account.homeAccountIdentifier)?(this.logger.verbose("AccountKey set"),f=r.account.homeAccountIdentifier):(this.logger.verbose("AccountKey set as no_account"),f=Yo.no_account),s=ti.generateAcquireTokenAccountKey(f,t.state);var g=ti.generateAcquireTokenAccountKey(Yo.no_account,t.state);this.logger.verbose("AcquireTokenAccountKey generated");var m=this.cacheStorage.getItem(s),v=void 0;gr.isEmpty(m)?gr.isEmpty(this.cacheStorage.getItem(g))||(this.logger.verbose("No acquireToken account retrieved from cache"),r=this.saveAccessToken(r,h,n,p)):(v=JSON.parse(m),this.logger.verbose("AcquireToken request account retrieved from cache"),r.account&&v&&oi.compareAccounts(r.account,v)?(r=this.saveAccessToken(r,h,n,p),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}if(n.hasOwnProperty(Wo.ID_TOKEN))if(this.logger.info("Fragment has idToken"),a=new Yn(n[Wo.ID_TOKEN]),h=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,a),r=ni.setResponseIdToken(r,a),n.hasOwnProperty(Wo.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),p=new Wn(n[Wo.CLIENT_INFO],h)):this.authorityInstance.AuthorityType===sr.Adfs?p=Wn.createClientInfoFromIdToken(a,h):this.logger.warning("ClientInfo not received in the response from AAD"),this.account=oi.createAccount(a,p),r.account=this.account,this.logger.verbose("Account object created from response"),a&&a.nonce){this.logger.verbose("IdToken has nonce");var b=this.cacheStorage.getItem(ti.generateTemporaryCacheKey(Zo.NONCE_IDTOKEN,t.state),this.inCookie);a.nonce!==b?(this.account=null,this.cacheStorage.setItem(er.LOGIN_ERROR,"Nonce Mismatch. Expected Nonce: "+b+",Actual Nonce: "+a.nonce),this.logger.error("Nonce Mismatch. Expected Nonce: "+b+", Actual Nonce: "+a.nonce),o=on.createNonceMismatchError(b,a.nonce)):(this.logger.verbose("Nonce matches, saving idToken to cache"),this.cacheStorage.setItem(Xo.IDTOKEN,n[Wo.ID_TOKEN],this.inCookie),this.cacheStorage.setItem(Xo.CLIENT_INFO,p.encodeClientInfo(),this.inCookie),this.saveIdToken(r,h,n,p,a))}else this.logger.verbose("No idToken or no nonce. Cache key for Authority set as state"),i=t.state,s=t.state,this.logger.error("Invalid id_token received in the response"),o=on.createInvalidIdTokenError(a),this.cacheStorage.setItem(er.ERROR,o.errorCode),this.cacheStorage.setItem(er.ERROR_DESC,o.errorMessage)}else{this.logger.verbose("State mismatch"),i=t.state,s=t.state;var y=this.cacheStorage.getItem(ti.generateTemporaryCacheKey(Zo.STATE_LOGIN,t.state),this.inCookie);this.logger.error("State Mismatch. Expected State: "+y+", Actual State: "+t.state),o=on.createInvalidStateError(t.state,y),this.cacheStorage.setItem(er.ERROR,o.errorCode),this.cacheStorage.setItem(er.ERROR_DESC,o.errorMessage)}if(this.cacheStorage.removeItem(ti.generateTemporaryCacheKey(Zo.RENEW_STATUS,t.state)),this.cacheStorage.resetTempCacheItems(t.state),this.logger.verbose("Status set to complete, temporary cache cleared"),this.inCookie&&(this.logger.verbose("InCookie is true, setting authorityKey in cookie"),this.cacheStorage.setItemCookie(i,"",-1),this.cacheStorage.clearMsalCookie(t.state)),o)throw o;if(!r)throw fr.createUnexpectedError("Response is null");return r},e.prototype.populateAuthority=function(e,t,o,r){this.logger.verbose("PopulateAuthority has been called");var n=ti.generateAuthorityKey(e),i=o.getItem(n,t);return gr.isEmpty(i)?i:Hn.replaceTenantPath(i,r.tenantId)},e.prototype.getAccount=function(){if(this.account)return this.account;var e=this.cacheStorage.getItem(Xo.IDTOKEN,this.inCookie),t=this.cacheStorage.getItem(Xo.CLIENT_INFO,this.inCookie);if(!gr.isEmpty(e)&&!gr.isEmpty(t)){var o=new Yn(e),r=new Wn(t,"");return this.account=oi.createAccount(o,r),this.account}return null},e.prototype.getAccountState=function(e){if(e){var t=e.indexOf(Yo.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return e},e.prototype.getAllAccounts=function(){for(var e=[],t=this.cacheStorage.getAllAccessTokens(Yo.clientId,Yo.homeAccountIdentifier),o=0;o<t.length;o++){var r=new Yn(t[o].value.idToken),n=new Wn(t[o].value.homeAccountIdentifier,""),i=oi.createAccount(r,n);e.push(i)}return this.getUniqueAccounts(e)},e.prototype.getUniqueAccounts=function(e){if(!e||e.length<=1)return e;for(var t=[],o=[],r=0;r<e.length;++r)e[r].homeAccountIdentifier&&-1===t.indexOf(e[r].homeAccountIdentifier)&&(t.push(e[r].homeAccountIdentifier),o.push(e[r]));return o},e.prototype.broadcast=function(e,t){var o=new CustomEvent(e,{detail:t});window.dispatchEvent(o)},e.prototype.getCachedTokenInternal=function(e,t,o,r){var n=t||this.getAccount();if(!n)return null;var i=this.authorityInstance?this.authorityInstance:ii.CreateInstance(this.authority,this.config.auth.validateAuthority),s=this.getTokenType(n,e),a=new jn(i,this.clientId,s,this.getRedirectUri(),e,o,r);return this.getCachedToken(a,t)},e.prototype.getScopesForEndpoint=function(e){if(this.config.framework.unprotectedResources.length>0)for(var t=0;t<this.config.framework.unprotectedResources.length;t++)if(e.indexOf(this.config.framework.unprotectedResources[t])>-1)return null;if(this.config.framework.protectedResourceMap.size>0)for(var o=0,r=Array.from(this.config.framework.protectedResourceMap.keys());o<r.length;o++){var n=r[o];if(e.indexOf(n)>-1)return this.config.framework.protectedResourceMap.get(n)}return e.indexOf("http://")>-1||e.indexOf("https://")>-1?Hn.getHostFromUri(e)===Hn.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},e.prototype.getLoginInProgress=function(){return this.cacheStorage.getItem(Zo.INTERACTION_STATUS)===Yo.inProgress},e.prototype.setInteractionInProgress=function(e){e?this.cacheStorage.setItem(Zo.INTERACTION_STATUS,Yo.inProgress):this.cacheStorage.removeItem(Zo.INTERACTION_STATUS)},e.prototype.setloginInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getAcquireTokenInProgress=function(){return this.cacheStorage.getItem(Zo.INTERACTION_STATUS)===Yo.inProgress},e.prototype.setAcquireTokenInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.getRedirectUri=function(e){return e||("function"==typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri)},e.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},e.prototype.getCurrentConfiguration=function(){if(!this.config)throw Mn.createNoSetConfigurationError();return this.config},e.prototype.getTokenType=function(e,t){var o=oi.compareAccounts(e,this.getAccount());return jn.determineResponseType(o,t)},e.prototype.setAccountCache=function(e,t){var o=e?this.getAccountId(e):Yo.no_account,r=ti.generateAcquireTokenAccountKey(o,t);this.cacheStorage.setItem(r,JSON.stringify(e))},e.prototype.setAuthorityCache=function(e,t){var o=ti.generateAuthorityKey(e);this.cacheStorage.setItem(o,Hn.CanonicalizeUri(t),this.inCookie)},e.prototype.updateCacheEntries=function(e,t,o,r){r&&this.cacheStorage.setItem(ti.generateTemporaryCacheKey(Zo.LOGIN_REQUEST,e.state),r,this.inCookie),o?this.cacheStorage.setItem(ti.generateTemporaryCacheKey(Zo.STATE_LOGIN,e.state),e.state,this.inCookie):this.setAccountCache(t,e.state),this.setAuthorityCache(e.state,e.authority),this.cacheStorage.setItem(ti.generateTemporaryCacheKey(Zo.NONCE_IDTOKEN,e.state),e.nonce,this.inCookie)},e.prototype.getAccountId=function(e){return gr.isEmpty(e.homeAccountIdentifier)?Yo.no_account:e.homeAccountIdentifier},e.prototype.buildIDTokenRequest=function(e){return{scopes:Yo.oidcScopes,authority:this.authority,account:this.getAccount(),extraQueryParameters:e.extraQueryParameters,correlationId:e.correlationId}},e.prototype.getTelemetryManagerFromConfig=function(e,t){if(!e)return es.getTelemetrymanagerStub(t,this.logger);var o=e.applicationName,r=e.applicationVersion,n=e.telemetryEmitter;if(!o||!r||!n)throw Mn.createTelemetryConfigError(e);return new es({platform:{applicationName:o,applicationVersion:r},clientId:t},n,this.logger)},e}(),rs=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class ns extends e.IProvider{constructor(e){super(),this.sessionStorageRequestedScopesKey="mgt-requested-scopes",this.sessionStorageDeniedScopesKey="mgt-denied-scopes",this.initProvider(e)}get userAgentApplication(){return this._userAgentApplication}get name(){return"MgtMsalProvider"}trySilentSignIn(){return rs(this,void 0,void 0,(function*(){try{if(this._userAgentApplication.isCallback(window.location.hash))return;this._userAgentApplication.getAccount()&&(yield this.getAccessToken(null))?this.setState(e.ProviderState.SignedIn):this.setState(e.ProviderState.SignedOut)}catch(t){this.setState(e.ProviderState.SignedOut)}}))}login(t){return rs(this,void 0,void 0,(function*(){let o=t||{loginHint:this._loginHint,scopes:this.scopes};if(this._prompt&&(o.prompt=this._prompt),this._domainHint&&(o.extraQueryParameters={domain_hint:this._domainHint}),this._loginType===e.LoginType.Popup){const t=yield this._userAgentApplication.loginPopup(o);this.setState(t.account?e.ProviderState.SignedIn:e.ProviderState.SignedOut)}else this._userAgentApplication.loginRedirect(o)}))}logout(){return rs(this,void 0,void 0,(function*(){this._userAgentApplication.logout(),this.setState(e.ProviderState.SignedOut)}))}getAccessToken(t){return rs(this,void 0,void 0,(function*(){const o=t&&t.scopes||this.scopes,r={loginHint:this._loginHint,scopes:o};this._domainHint&&(r.extraQueryParameters={domain_hint:this._domainHint});try{return(yield this._userAgentApplication.acquireTokenSilent(r)).accessToken}catch(t){if(!this.requiresInteraction(t))throw this.setState(e.ProviderState.SignedOut),t;if(this._loginType===e.LoginType.Redirect){if(this.areScopesDenied(o))throw t;this.setRequestedScopes(o),this._userAgentApplication.acquireTokenRedirect(r)}else try{return(yield this._userAgentApplication.acquireTokenPopup(r)).accessToken}catch(e){throw e}}throw null}))}updateScopes(e){this.scopes=e}requiresInteraction(e){return!(!e||!e.errorCode||-1===e.errorCode.indexOf("consent_required")&&-1===e.errorCode.indexOf("interaction_required")&&-1===e.errorCode.indexOf("login_required"))}setRequestedScopes(e){e&&sessionStorage.setItem(this.sessionStorageRequestedScopesKey,JSON.stringify(e))}getRequestedScopes(){const e=sessionStorage.getItem(this.sessionStorageRequestedScopesKey);return e?JSON.parse(e):null}clearRequestedScopes(){sessionStorage.removeItem(this.sessionStorageRequestedScopesKey)}addDeniedScopes(e){if(e){let t=this.getDeniedScopes()||[];t=t.concat(e);let o=t.indexOf("openid");-1!==o&&t.splice(o,1),o=t.indexOf("profile"),-1!==o&&t.splice(o,1),sessionStorage.setItem(this.sessionStorageDeniedScopesKey,JSON.stringify(t))}}getDeniedScopes(){const e=sessionStorage.getItem(this.sessionStorageDeniedScopesKey);return e?JSON.parse(e):null}areScopesDenied(e){if(e){const t=this.getDeniedScopes();if(t&&t.filter((t=>-1!==e.indexOf(t))).length>0)return!0}return!1}initProvider(t){let o,r;if(this.scopes=void 0!==t.scopes?t.scopes:["user.read"],this._loginType=void 0!==t.loginType?t.loginType:e.LoginType.Redirect,this._loginHint=t.loginHint,this._domainHint=t.domainHint,this._prompt=void 0!==t.prompt?t.prompt:"select_account","clientId"in t){if(!t.clientId)throw new Error("clientId must be provided");{const e=t.options||{auth:{clientId:t.clientId}};e.auth.clientId=t.clientId,e.cache=e.cache||{},e.cache.cacheLocation=e.cache.cacheLocation||"localStorage",void 0!==e.cache.storeAuthStateInCookie&&null!==e.cache.storeAuthStateInCookie||(e.cache.storeAuthStateInCookie=!0),t.authority&&(e.auth.authority=t.authority),t.redirectUri&&(e.auth.redirectUri=t.redirectUri),r=t.clientId,o=new os(e)}}else{if(!("userAgentApplication"in t))throw new Error("either clientId or userAgentApplication must be provided");if(!t.userAgentApplication)throw new Error("userAgentApplication must be provided");o=t.userAgentApplication,r=o.getCurrentConfiguration().auth.clientId}this.clientId=r,this._userAgentApplication=o,this._userAgentApplication.handleRedirectCallback((e=>this.tokenReceivedCallback(e)),((e,t)=>this.errorReceivedCallback(e,t))),this.graph=(0,e.createFromProvider)(this),this.trySilentSignIn()}tokenReceivedCallback(t){"id_token"===t.tokenType&&this.setState(e.ProviderState.SignedIn),this.clearRequestedScopes()}errorReceivedCallback(e,t){const o=this.getRequestedScopes();o&&this.addDeniedScopes(o),this.clearRequestedScopes()}}var is=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},ss=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let as=class extends e.MgtBaseProvider{constructor(){super(...arguments),this.clientId=""}get isAvailable(){return!0}initializeProvider(){if(this.clientId){const t={clientId:this.clientId,domainHint:this.domainHint,prompt:this.prompt};if(this.loginType&&this.loginType.length>1){let o=this.loginType.toLowerCase();o=o[0].toUpperCase()+o.slice(1);const r=e.LoginType[o];t.loginType=r}if(this.authority&&(t.authority=this.authority),this.scopes){const e=this.scopes.split(",");e&&e.length>0&&(t.scopes=e)}this.redirectUri&&(t.redirectUri=this.redirectUri),this.provider=new ns(t),e.Providers.globalProvider=this.provider}}};is([(0,t.Cb)({attribute:"client-id",type:String}),ss("design:type",Object)],as.prototype,"clientId",void 0),is([(0,t.Cb)({attribute:"login-type",type:String}),ss("design:type",Object)],as.prototype,"loginType",void 0),is([(0,t.Cb)(),ss("design:type",Object)],as.prototype,"authority",void 0),is([(0,t.Cb)({attribute:"scopes",type:String}),ss("design:type",Object)],as.prototype,"scopes",void 0),is([(0,t.Cb)({attribute:"redirect-uri",type:String}),ss("design:type",Object)],as.prototype,"redirectUri",void 0),is([(0,t.Cb)({attribute:"domain-hint",type:String}),ss("design:type",Object)],as.prototype,"domainHint",void 0),is([(0,t.Cb)({attribute:"prompt",type:String}),ss("design:type",Object)],as.prototype,"prompt",void 0),as=is([(0,t.Mo)("mgt-msal-provider")],as);var cs=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class ls extends ns{constructor(t){super({clientId:t.clientId,loginType:e.LoginType.Redirect,options:t.msalOptions,scopes:t.scopes}),this._msalOptions=t.msalOptions,this._authPopupUrl=t.authPopupUrl,e.TeamsHelper.microsoftTeamsLib.initialize()}static get isAvailable(){return e.TeamsHelper.isAvailable}static get microsoftTeamsLib(){return e.TeamsHelper.microsoftTeamsLib}static set microsoftTeamsLib(t){e.TeamsHelper.microsoftTeamsLib=t}get name(){return"MgtTeamsProvider"}static handleAuth(){return cs(this,void 0,void 0,(function*(){const t=e.TeamsHelper.microsoftTeamsLib;if(!t)return void console.error("Make sure you have referenced the Microsoft Teams sdk before using the TeamsProvider");t.initialize(),sessionStorage.getItem(this._sessionStorageLogoutInProgress)&&t.authentication.notifySuccess();const o=new URL(window.location.href).searchParams.get("signout"),r=localStorage.getItem(this._localStorageParametersKey);let n;if(n=r?JSON.parse(r):{},!n.clientId)return void t.authentication.notifyFailure("no clientId provided");const i=n.scopes?n.scopes.split(","):null,s=n.options||{auth:{clientId:n.clientId}};s.system=s.system||{},s.system.loadFrameTimeout=1e4;const a=new ns({clientId:n.clientId,options:s,scopes:i});if(a.userAgentApplication.urlContainsHash(window.location.hash))return;const c=()=>cs(this,void 0,void 0,(function*(){if(a.state===e.ProviderState.SignedOut){if(o)return void t.authentication.notifySuccess();sessionStorage.getItem(this._sessionStorageLoginInProgress)||(sessionStorage.setItem(this._sessionStorageLoginInProgress,"true"),a.login({loginHint:n.loginHint,scopes:i||a.scopes}))}else if(a.state===e.ProviderState.SignedIn){if(o)return sessionStorage.setItem(this._sessionStorageLogoutInProgress,"true"),void(yield a.logout());try{const e=yield a.getAccessTokenForScopes(...a.scopes);t.authentication.notifySuccess(e)}catch(e){t.authentication.notifyFailure(e)}}}));a.onStateChanged(c),c()}))}login(){return cs(this,void 0,void 0,(function*(){this.setState(e.ProviderState.Loading);const t=e.TeamsHelper.microsoftTeamsLib;return new Promise(((o,r)=>{t.getContext((n=>{this.teamsContext=n;const i={clientId:this.clientId,loginHint:n.loginHint,options:this._msalOptions,scopes:this.scopes.join(",")};localStorage.setItem(ls._localStorageParametersKey,JSON.stringify(i));const s=new URL(this._authPopupUrl,new URL(window.location.href));t.authentication.authenticate({failureCallback:t=>{this.setState(e.ProviderState.SignedOut),r()},successCallback:e=>{this.trySilentSignIn(),o()},url:s.href})}))}))}))}logout(){return cs(this,void 0,void 0,(function*(){const t=e.TeamsHelper.microsoftTeamsLib;return new Promise(((e,o)=>{t.getContext((r=>{this.teamsContext=r;const n=new URL(this._authPopupUrl,new URL(window.location.href));n.searchParams.append("signout","true"),t.authentication.authenticate({failureCallback:e=>{this.trySilentSignIn(),o()},successCallback:t=>{this.trySilentSignIn(),e()},url:n.href})}))}))}))}getAccessToken(t){return cs(this,void 0,void 0,(function*(){if(!this.teamsContext&&e.TeamsHelper.microsoftTeamsLib){const t=e.TeamsHelper.microsoftTeamsLib;t.initialize(),this.teamsContext=yield t.getContext()}const o={scopes:t&&t.scopes||this.scopes};this.teamsContext&&this.teamsContext.loginHint&&(o.loginHint=this.teamsContext.loginHint);try{return(yield this.userAgentApplication.acquireTokenSilent(o)).accessToken}catch(e){if(this.requiresInteraction(e))return null;throw e}}))}}ls._localStorageParametersKey="msg-teamsprovider-auth-parameters",ls._sessionStorageLoginInProgress="msg-teamsprovider-login-in-progress",ls._sessionStorageLogoutInProgress="msg-teamsprovider-logout-in-progress";var ds=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},us=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let ps=class extends e.MgtBaseProvider{constructor(){super(...arguments),this.clientId="",this.authPopupUrl=""}get isAvailable(){return ls.isAvailable}initializeProvider(){if(this.clientId&&this.authPopupUrl){const t={authPopupUrl:this.authPopupUrl,clientId:this.clientId};if(this.scopes){const e=this.scopes.split(",");e&&e.length>0&&(t.scopes=e)}if(this.authority){const e={auth:{authority:this.authority,clientId:this.clientId}};t.msalOptions=e}this.provider=new ls(t),e.Providers.globalProvider=this.provider}}};ds([(0,t.Cb)({attribute:"client-id",type:String}),us("design:type",Object)],ps.prototype,"clientId",void 0),ds([(0,t.Cb)({attribute:"auth-popup-url",type:String}),us("design:type",Object)],ps.prototype,"authPopupUrl",void 0),ds([(0,t.Cb)(),us("design:type",Object)],ps.prototype,"authority",void 0),ds([(0,t.Cb)({attribute:"scopes",type:String}),us("design:type",Object)],ps.prototype,"scopes",void 0),ps=ds([(0,t.Mo)("mgt-teams-provider")],ps);var hs=o(533),fs=o(418),gs=o(994);class ms{constructor(e){this._getCustomHeaders=e}execute(e){return t=this,o=void 0,n=function*(){if(this._getCustomHeaders){const t=yield this._getCustomHeaders();for(const o in t)t.hasOwnProperty(o)&&(0,gs.rn)(e.request,e.options,o,t[o])}return yield this.nextMiddleware.execute(e)},new((r=void 0)||(r=Promise))((function(e,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(t){var o;t.done?e(t.value):(o=t.value,o instanceof r?o:new r((function(e){e(o)}))).then(s,a)}c((n=n.apply(t,o||[])).next())}));var t,o,r,n}setNext(e){this.nextMiddleware=e}}class vs extends e.Graph{constructor(t,o){const r=[new N.vU(new N.WI),new N.Pw,new hs.i(fs.l),new ms(o),new N.LW];super(N.KU.initWithMiddleware({baseUrl:t,middleware:(0,e.chainMiddleware)(...r)}))}}class bs extends e.IProvider{constructor(t,o=null){super(),this.graph=new vs(t,o),this.graph.api("me").get().then((t=>{null!=t?this.setState(e.ProviderState.SignedIn):this.setState(e.ProviderState.SignedOut)}),(t=>{this.setState(e.ProviderState.SignedOut)}))}get name(){return"MgtProxyProvider"}getAccessToken(){return null}}var ys=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s};let ks=class extends e.MgtBaseProvider{get isAvailable(){return!0}initializeProvider(){void 0!==this.graphProxyUrl&&(this.provider=new bs(this.graphProxyUrl),e.Providers.globalProvider=this.provider)}};ys([(0,t.Cb)({attribute:"graph-proxy-url"}),function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}("design:type",String)],ks.prototype,"graphProxyUrl",void 0),ks=ys([(0,t.Mo)("mgt-proxy-provider")],ks);var ws=function(e,t){return(ws=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};function Cs(e,t){function o(){this.constructor=e}ws(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}var Ts=function(){return(Ts=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function Ss(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function _s(e,t){var o,r,n,i,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){s.label=i[1];break}if(6===i[0]&&s.label<n[1]){s.label=n[1],n=i;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(i);break}n[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function Is(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var r,n,i=o.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return s}function xs(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Is(arguments[t]));return e}var Es=function(e,t){return(Es=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};function As(e,t){function o(){this.constructor=e}Es(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}var Ps=function(){return(Ps=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function Rs(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function Os(e,t){var o,r,n,i,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){s.label=i[1];break}if(6===i[0]&&s.label<n[1]){s.label=n[1],n=i;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(i);break}n[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function Ns(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var r=Array(e),n=0;for(t=0;t<o;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,n++)r[n]=i[s];return r}var Ds,Ls,Us,Ms,Fs,Hs={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",ADFS:"adfs",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"AUTO_DISCOVER",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},qs=[Hs.OPENID_SCOPE,Hs.PROFILE_SCOPE,Hs.OFFLINE_ACCESS_SCOPE],$s=Ns(qs,[Hs.EMAIL_SCOPE]);!function(e){e.CONTENT_TYPE="Content-Type",e.RETRY_AFTER="Retry-After"}(Ds||(Ds={})),function(e){e.ID_TOKEN="idtoken",e.CLIENT_INFO="client.info",e.ADAL_ID_TOKEN="adal.idtoken",e.ERROR="error",e.ERROR_DESC="error.description"}(Ls||(Ls={})),function(e){e.COMMON="common",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers"}(Us||(Us={})),function(e){e.CLIENT_ID="client_id",e.REDIRECT_URI="redirect_uri",e.RESPONSE_TYPE="response_type",e.RESPONSE_MODE="response_mode",e.GRANT_TYPE="grant_type",e.CLAIMS="claims",e.SCOPE="scope",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.REFRESH_TOKEN="refresh_token",e.EXPIRES_IN="expires_in",e.STATE="state",e.NONCE="nonce",e.PROMPT="prompt",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info",e.CODE="code",e.CODE_CHALLENGE="code_challenge",e.CODE_CHALLENGE_METHOD="code_challenge_method",e.CODE_VERIFIER="code_verifier",e.CLIENT_REQUEST_ID="client-request-id",e.X_CLIENT_SKU="x-client-SKU",e.X_CLIENT_VER="x-client-VER",e.X_CLIENT_OS="x-client-OS",e.X_CLIENT_CPU="x-client-CPU",e.X_CLIENT_CURR_TELEM="x-client-current-telemetry",e.X_CLIENT_LAST_TELEM="x-client-last-telemetry",e.X_MS_LIB_CAPABILITY="x-ms-lib-capability",e.POST_LOGOUT_URI="post_logout_redirect_uri",e.ID_TOKEN_HINT="id_token_hint",e.DEVICE_CODE="device_code",e.CLIENT_SECRET="client_secret",e.CLIENT_ASSERTION="client_assertion",e.CLIENT_ASSERTION_TYPE="client_assertion_type",e.TOKEN_TYPE="token_type",e.REQ_CNF="req_cnf",e.OBO_ASSERTION="assertion",e.REQUESTED_TOKEN_USE="requested_token_use",e.ON_BEHALF_OF="on_behalf_of",e.FOCI="foci"}(Ms||(Ms={})),function(e){e.ACCESS_TOKEN="access_token",e.XMS_CC="xms_cc"}(Fs||(Fs={}));var Bs,js={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"};!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.DOMAIN_HINT="domain_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(Bs||(Bs={}));var zs,Vs,Gs,Ks,Ws,Qs,Js,Ys={PLAIN:"plain",S256:"S256"};!function(e){e.QUERY="query",e.FRAGMENT="fragment",e.FORM_POST="form_post"}(zs||(zs={})),function(e){e.IMPLICIT_GRANT="implicit",e.AUTHORIZATION_CODE_GRANT="authorization_code",e.CLIENT_CREDENTIALS_GRANT="client_credentials",e.RESOURCE_OWNER_PASSWORD_GRANT="password",e.REFRESH_TOKEN_GRANT="refresh_token",e.DEVICE_CODE_GRANT="device_code",e.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"}(Vs||(Vs={})),function(e){e.MSSTS_ACCOUNT_TYPE="MSSTS",e.ADFS_ACCOUNT_TYPE="ADFS",e.MSAV1_ACCOUNT_TYPE="MSA",e.GENERIC_ACCOUNT_TYPE="Generic"}(Gs||(Gs={})),function(e){e.CACHE_KEY_SEPARATOR="-",e.CLIENT_INFO_SEPARATOR="."}(Ks||(Ks={})),function(e){e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",e.REFRESH_TOKEN="RefreshToken"}(Ws||(Ws={})),function(e){e.ACCOUNT="Account",e.CREDENTIAL="Credential",e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.REFRESH_TOKEN="RefreshToken",e.APP_METADATA="AppMetadata",e.TEMPORARY="TempCache",e.TELEMETRY="Telemetry",e.UNDEFINED="Undefined",e.THROTTLING="Throttling"}(Qs||(Qs={})),function(e){e[e.ADFS=1001]="ADFS",e[e.MSA=1002]="MSA",e[e.MSSTS=1003]="MSSTS",e[e.GENERIC=1004]="GENERIC",e[e.ACCESS_TOKEN=2001]="ACCESS_TOKEN",e[e.REFRESH_TOKEN=2002]="REFRESH_TOKEN",e[e.ID_TOKEN=2003]="ID_TOKEN",e[e.APP_METADATA=3001]="APP_METADATA",e[e.UNDEFINED=9999]="UNDEFINED"}(Js||(Js={}));var Zs,Xs="appmetadata",ea="1",ta="authority-metadata";!function(e){e.CONFIG="config",e.CACHE="cache",e.NETWORK="network"}(Zs||(Zs={}));var oa,ra={SCHEMA_VERSION:2,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"};!function(e){e.POP="pop",e.BEARER="Bearer"}(oa||(oa={}));var na,ia,sa="throttling";!function(e){e.username="username",e.password="password"}(na||(na={})),function(e){e[e.httpSuccess=200]="httpSuccess",e[e.httpBadRequest=400]="httpBadRequest"}(ia||(ia={}));var aa,ca,la,da,ua,pa,ha="interaction_in_progress";!function(e){e.LocalStorage="localStorage",e.SessionStorage="sessionStorage",e.MemoryStorage="memoryStorage"}(aa||(aa={})),function(e){e.GET="GET",e.POST="POST"}(ca||(ca={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",e.SESSION_STATE="session.state",e.REQUEST_STATE="request.state",e.NONCE_IDTOKEN="nonce.id_token",e.ORIGIN_URI="request.origin",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.REQUEST_PARAMS="request.params",e.SCOPES="scopes",e.INTERACTION_STATUS_KEY="interaction.status"}(la||(la={})),function(e){e[e.acquireTokenRedirect=861]="acquireTokenRedirect",e[e.acquireTokenPopup=862]="acquireTokenPopup",e[e.ssoSilent=863]="ssoSilent",e[e.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",e[e.handleRedirectPromise=865]="handleRedirectPromise",e[e.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",e[e.logout=961]="logout",e[e.logoutPopup=962]="logoutPopup"}(da||(da={})),function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent"}(ua||(ua={})),function(e){e.Startup="startup",e.Login="login",e.Logout="logout",e.AcquireToken="acquireToken",e.SsoSilent="ssoSilent",e.HandleRedirect="handleRedirect",e.None="none"}(pa||(pa={}));var fa,ga={scopes:qs},ma="jwk";!function(e){e.React="@azure/msal-react",e.Angular="@azure/msal-angular"}(fa||(fa={}));var va,ba=function(){function e(){}return e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e}(),ya=function(){function e(e){this.cryptoObj=e}return e.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,ba.decimalToHex(e[0])+ba.decimalToHex(e[1])+ba.decimalToHex(e[2])+ba.decimalToHex(e[3])+"-"+ba.decimalToHex(e[4])+ba.decimalToHex(e[5])+"-"+ba.decimalToHex(e[6])+ba.decimalToHex(e[7])+"-"+ba.decimalToHex(e[8])+ba.decimalToHex(e[9])+"-"+ba.decimalToHex(e[10])+ba.decimalToHex(e[11])+ba.decimalToHex(e[12])+ba.decimalToHex(e[13])+ba.decimalToHex(e[14])+ba.decimalToHex(e[15])}catch(e){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",o="0123456789abcdef",r=0,n="",i=0;i<36;i++)"-"!==t[i]&&"4"!==t[i]&&(r=16*Math.random()|0),"x"===t[i]?n+=o[r]:"y"===t[i]?(r&=3,n+=o[r|=8]):n+=t[i];return n}},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e}(),ka=function(){function e(){}return e.stringToUtf8Arr=function(e){for(var t,o=0,r=e.length,n=0;n<r;n++)o+=(t=e.charCodeAt(n))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var i=new Uint8Array(o),s=0,a=0;s<o;a++)(t=e.charCodeAt(a))<128?i[s++]=t:t<2048?(i[s++]=192+(t>>>6),i[s++]=128+(63&t)):t<65536?(i[s++]=224+(t>>>12),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t)):t<2097152?(i[s++]=240+(t>>>18),i[s++]=128+(t>>>12&63),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t)):t<67108864?(i[s++]=248+(t>>>24),i[s++]=128+(t>>>18&63),i[s++]=128+(t>>>12&63),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t)):(i[s++]=252+(t>>>30),i[s++]=128+(t>>>24&63),i[s++]=128+(t>>>18&63),i[s++]=128+(t>>>12&63),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t));return i},e.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),o=new Uint8Array(t),r=0;r<e.length;r++)o[r]=e.charCodeAt(r);return t},e.utf8ArrToString=function(e){for(var t="",o=void 0,r=e.length,n=0;n<r;n++)o=e[n],t+=String.fromCharCode(o>251&&o<254&&n+5<r?1073741824*(o-252)+(e[++n]-128<<24)+(e[++n]-128<<18)+(e[++n]-128<<12)+(e[++n]-128<<6)+e[++n]-128:o>247&&o<252&&n+4<r?(o-248<<24)+(e[++n]-128<<18)+(e[++n]-128<<12)+(e[++n]-128<<6)+e[++n]-128:o>239&&o<248&&n+3<r?(o-240<<18)+(e[++n]-128<<12)+(e[++n]-128<<6)+e[++n]-128:o>223&&o<240&&n+2<r?(o-224<<12)+(e[++n]-128<<6)+e[++n]-128:o>191&&o<224&&n+1<r?(o-192<<6)+e[++n]-128:o);return t},e}(),wa=function(){function e(){}return e.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))},e.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},e.prototype.encode=function(e){var t=ka.stringToUtf8Arr(e);return this.base64EncArr(t)},e.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,o="",r=void 0,n=e.length,i=0,s=0;s<n;s++)r=s%3,i|=e[s]<<(16>>>r&24),2!==r&&e.length-s!=1||(o+=String.fromCharCode(this.uint6ToB64(i>>>18&63),this.uint6ToB64(i>>>12&63),this.uint6ToB64(i>>>6&63),this.uint6ToB64(63&i)),i=0);return 0===t?o:o.substring(0,o.length-t)+(1===t?"=":"==")},e.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},e}(),Ca=function(){function e(){}return e.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var o=this.base64DecToArr(t);return ka.utf8ArrToString(o)},e.prototype.base64DecToArr=function(e,t){for(var o=e.replace(/[^A-Za-z0-9\+\/]/g,""),r=o.length,n=t?Math.ceil((3*r+1>>>2)/t)*t:3*r+1>>>2,i=new Uint8Array(n),s=void 0,a=void 0,c=0,l=0,d=0;d<r;d++)if(a=3&d,c|=this.b64ToUint6(o.charCodeAt(d))<<18-6*a,3===a||r-d==1){for(s=0;s<3&&l<n;s++,l++)i[l]=c>>>(16>>>s&24)&255;c=0}return i},e.prototype.b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0},e}(),Ta="unexpected_error",Sa="Unexpected error in authentication.",_a=function(e){function t(o,r,n){var i=this,s=r?o+": "+r:o;return i=e.call(this,s)||this,Object.setPrototypeOf(i,t.prototype),i.errorCode=o||Hs.EMPTY_STRING,i.errorMessage=r||"",i.subError=n||"",i.name="AuthError",i}return As(t,e),t.createUnexpectedError=function(e){return new t(Ta,Sa+": "+e)},t}(Error),Ia="client_info_decoding_error",xa="The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause.",Ea="client_info_empty_error",Aa="The client info was empty. Please review the trace to determine the root cause.",Pa="token_parsing_error",Ra="Token cannot be parsed. Please review stack trace to determine root cause.",Oa="null_or_empty_token",Na="The token is null or empty. Please review the trace to determine the root cause.",Da="endpoints_resolution_error",La="Error: could not resolve endpoints. Please check network and try again.",Ua="network_error",Ma="Network request failed. Please check network trace to determine root cause.",Fa="openid_config_error",Ha="Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",qa="hash_not_deserialized",$a="The hash parameters could not be deserialized. Please review the trace to determine the root cause.",Ba="invalid_state",ja="State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState().",za="state_mismatch",Va="State mismatch error. Please check your network. Continued requests may cause cache overflow.",Ga="state_not_found",Ka="State not found",Wa="nonce_mismatch",Qa="Nonce mismatch error. This may be caused by a race condition in concurrent requests.",Ja="nonce_not_found",Ya="nonce not found",Za="no_tokens_found",Xa="No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken().",ec="multiple_matching_tokens",tc="The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",oc="multiple_matching_accounts",rc="The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",nc="multiple_matching_appMetadata",ic="The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",sc="request_cannot_be_made",ac="Token request cannot be made without authorization code or refresh token.",cc="cannot_append_empty_scope",lc="Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info.",dc="cannot_remove_empty_scope",uc="Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info.",pc="cannot_append_scopeset",hc="Cannot append ScopeSet due to error.",fc="empty_input_scopeset",gc="Empty input ScopeSet cannot be processed.",mc="device_code_polling_cancelled",vc="Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",bc="device_code_expired",yc="Device code is expired.",kc="no_account_in_silent_request",wc="Please pass an account object, silent flow is not supported without account information",Cc="invalid_cache_record",Tc="Cache record object was null or undefined.",Sc="invalid_cache_environment",_c="Invalid environment when attempting to create cache entry",Ic="no_account_found",xc="No account found in cache for given key.",Ec="no cache plugin set on CacheManager",Ac="ICachePlugin needs to be set before using readFromStorage or writeFromStorage",Pc="no_crypto_object",Rc="No crypto object detected. This is required for the following operation: ",Oc="invalid_cache_type",Nc="Invalid cache type",Dc="unexpected_account_type",Lc="Unexpected account type.",Uc="unexpected_credential_type",Mc="Unexpected credential type.",Fc="invalid_assertion",Hc="Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",qc="invalid_client_credential",$c="Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",Bc="token_refresh_required",jc="Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",zc="user_timeout_reached",Vc="User defined timeout for device code polling reached",Gc="token_claims_cnf_required_for_signedjwt",Kc="Cannot generate a POP jwt if the token_claims are not populated",Wc="authorization_code_missing_from_server_response",Qc="Server response does not contain an authorization code to proceed",Jc=function(e){function t(o,r){var n=e.call(this,o,r)||this;return n.name="ClientAuthError",Object.setPrototypeOf(n,t.prototype),n}return As(t,e),t.createClientInfoDecodingError=function(e){return new t(Ia,xa+" Failed with error: "+e)},t.createClientInfoEmptyError=function(){return new t(Ea,""+Aa)},t.createTokenParsingError=function(e){return new t(Pa,Ra+" Failed with error: "+e)},t.createTokenNullOrEmptyError=function(e){return new t(Oa,Na+" Raw Token Value: "+e)},t.createEndpointDiscoveryIncompleteError=function(e){return new t(Da,La+" Detail: "+e)},t.createNetworkError=function(e,o){return new t(Ua,Ma+" | Fetch client threw: "+o+" | Attempted to reach: "+e.split("?")[0])},t.createUnableToGetOpenidConfigError=function(e){return new t(Fa,Ha+" Attempted to retrieve endpoints from: "+e)},t.createHashNotDeserializedError=function(e){return new t(qa,$a+" Given Object: "+e)},t.createInvalidStateError=function(e,o){return new t(Ba,ja+" Invalid State: "+e+", Root Err: "+o)},t.createStateMismatchError=function(){return new t(za,Va)},t.createStateNotFoundError=function(e){return new t(Ga,Ka+":  "+e)},t.createNonceMismatchError=function(){return new t(Wa,Qa)},t.createNonceNotFoundError=function(e){return new t(Ja,Ya+":  "+e)},t.createNoTokensFoundError=function(){return new t(Za,Xa)},t.createMultipleMatchingTokensInCacheError=function(){return new t(ec,tc+".")},t.createMultipleMatchingAccountsInCacheError=function(){return new t(oc,rc)},t.createMultipleMatchingAppMetadataInCacheError=function(){return new t(nc,ic)},t.createTokenRequestCannotBeMadeError=function(){return new t(sc,ac)},t.createAppendEmptyScopeToSetError=function(e){return new t(cc,lc+" Given Scope: "+e)},t.createRemoveEmptyScopeFromSetError=function(e){return new t(dc,uc+" Given Scope: "+e)},t.createAppendScopeSetError=function(e){return new t(pc,hc+" Detail Error: "+e)},t.createEmptyInputScopeSetError=function(e){return new t(fc,gc+" Given ScopeSet: "+e)},t.createDeviceCodeCancelledError=function(){return new t(mc,""+vc)},t.createDeviceCodeExpiredError=function(){return new t(bc,""+yc)},t.createNoAccountInSilentRequestError=function(){return new t(kc,""+wc)},t.createNullOrUndefinedCacheRecord=function(){return new t(Cc,Tc)},t.createInvalidCacheEnvironmentError=function(){return new t(Sc,_c)},t.createNoAccountFoundError=function(){return new t(Ic,xc)},t.createCachePluginError=function(){return new t(Ec,""+Ac)},t.createNoCryptoObjectError=function(e){return new t(Pc,""+Rc+e)},t.createInvalidCacheTypeError=function(){return new t(Oc,""+Nc)},t.createUnexpectedAccountTypeError=function(){return new t(Dc,""+Lc)},t.createUnexpectedCredentialTypeError=function(){return new t(Uc,""+Mc)},t.createInvalidAssertionError=function(){return new t(Fc,""+Hc)},t.createInvalidCredentialError=function(){return new t(qc,""+$c)},t.createRefreshRequiredError=function(){return new t(Bc,jc)},t.createUserTimeoutReachedError=function(){return new t(zc,Vc)},t.createTokenClaimsRequiredError=function(){return new t(Gc,Kc)},t.createNoAuthCodeInServerResponseError=function(){return new t(Wc,Qc)},t}(_a),Yc=function(){function e(){}return e.decodeAuthToken=function(t){if(e.isEmpty(t))throw Jc.createTokenNullOrEmptyError(t);var o=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!o||o.length<4)throw Jc.createTokenParsingError("Given token is malformed: "+JSON.stringify(t));return{header:o[1],JWSPayload:o[2],JWSSig:o[3]}},e.isEmpty=function(e){return void 0===e||!e||0===e.length},e.isEmptyObj=function(t){if(t&&!e.isEmpty(t))try{var o=JSON.parse(t);return 0===Object.keys(o).length}catch(e){}return!0},e.startsWith=function(e,t){return 0===e.indexOf(t)},e.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},e.queryStringToObject=function(e){var t,o=/\+/g,r=/([^&=]+)=([^&]*)/g,n=function(e){return decodeURIComponent(decodeURIComponent(e.replace(o," ")))},i={};for(t=r.exec(e);t;)i[n(t[1])]=n(t[2]),t=r.exec(e);return i},e.trimArrayEntries=function(e){return e.map((function(e){return e.trim()}))},e.removeEmptyStringsFromArray=function(t){return t.filter((function(t){return!e.isEmpty(t)}))},e.jsonParseHelper=function(e){try{return JSON.parse(e)}catch(e){return null}},e.matchPattern=function(e,t){return new RegExp(e.replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)},e}(),Zc="pkce_not_created",Xc="The PKCE code challenge and verifier could not be generated.",el="crypto_nonexistent",tl="The crypto object or function is not available.",ol="http_method_not_implemented",rl="The HTTP method given has not been implemented in this library.",nl="empty_navigate_uri",il="Navigation URI is empty. Please check stack trace for more info.",sl="hash_empty_error",al="Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash.",cl="no_state_in_hash",ll="Hash does not contain state. Please verify that the request originated from msal.",dl="hash_does_not_contain_known_properties",ul="Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.",pl="unable_to_parse_state",hl="Unable to parse state. Please verify that the request originated from msal.",fl="state_interaction_type_mismatch",gl="Hash contains state but the interaction type does not match the caller.",ml="interaction_in_progress",vl="Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors.",bl="popup_window_error",yl="Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",kl="empty_window_error",wl="window.open returned null or undefined window object.",Cl="user_cancelled",Tl="User cancelled the flow.",Sl="monitor_window_timeout",_l="Token acquisition in popup failed due to timeout.",Il="monitor_window_timeout",xl="Token acquisition in iframe failed due to timeout.",El="redirect_in_iframe",Al="Code flow is not supported inside an iframe. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",Pl="block_iframe_reload",Rl="Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors",Ol="block_nested_popups",Nl="Request was blocked inside a popup because MSAL detected it was running in a popup.",Dl="iframe_closed_prematurely",Ll="The iframe being monitored was closed prematurely.",Ul="silent_sso_error",Ml="Silent SSO could not be completed - insufficient information was provided. Please provide either a loginHint or sid.",Fl="no_account_error",Hl="No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",ql="silent_prompt_value_error",$l="The value given for the prompt value is not valid for silent requests - must be set to 'none'.",Bl="no_token_request_cache_error",jl="No token request in found in cache.",zl="unable_to_parse_token_request_cache_error",Vl="The cached token request could not be parsed.",Gl="no_cached_authority_error",Kl="No cached authority found.",Wl="auth_request_not_set_error",Ql="Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",Jl="invalid_cache_type",Yl="Invalid cache type",Zl="non_browser_environment",Xl="Login and token requests are not supported in non-browser environments.",ed="database_not_open",td="Database is not open!",od="no_network_connectivity",rd="No network connectivity. Check your internet connection.",nd="post_request_failed",id="Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",sd="get_request_failed",ad="Network request failed. Please check the network trace to determine root cause.",cd="failed_to_parse_response",ld="Failed to parse network response. Check network trace.",dd=function(e){function t(o,r){var n=e.call(this,o,r)||this;return Object.setPrototypeOf(n,t.prototype),n.name="BrowserAuthError",n}return Cs(t,e),t.createPkceNotGeneratedError=function(e){return new t(Zc,Xc+" Detail:"+e)},t.createCryptoNotAvailableError=function(e){return new t(el,tl+" Detail:"+e)},t.createHttpMethodNotImplementedError=function(e){return new t(ol,rl+" Given Method: "+e)},t.createEmptyNavigationUriError=function(){return new t(nl,il)},t.createEmptyHashError=function(e){return new t(sl,al+" Given Url: "+e)},t.createHashDoesNotContainStateError=function(){return new t(cl,ll)},t.createHashDoesNotContainKnownPropertiesError=function(){return new t(dl,ul)},t.createUnableToParseStateError=function(){return new t(pl,hl)},t.createStateInteractionTypeMismatchError=function(){return new t(fl,gl)},t.createInteractionInProgressError=function(){return new t(ml,vl)},t.createPopupWindowError=function(e){var o=yl;return o=Yc.isEmpty(e)?o:o+" Details: "+e,new t(bl,o)},t.createEmptyWindowCreatedError=function(){return new t(kl,wl)},t.createUserCancelledError=function(){return new t(Cl,Tl)},t.createMonitorPopupTimeoutError=function(){return new t(Sl,_l)},t.createMonitorIframeTimeoutError=function(){return new t(Il,xl)},t.createRedirectInIframeError=function(e){return new t(El,Al+" (window.parent !== window) => "+e)},t.createBlockReloadInHiddenIframeError=function(){return new t(Pl,Rl)},t.createBlockAcquireTokenInPopupsError=function(){return new t(Ol,Nl)},t.createIframeClosedPrematurelyError=function(){return new t(Dl,Ll)},t.createSilentSSOInsufficientInfoError=function(){return new t(Ul,Ml)},t.createNoAccountError=function(){return new t(Fl,Hl)},t.createSilentPromptValueError=function(e){return new t(ql,$l+" Given value: "+e)},t.createUnableToParseTokenRequestCacheError=function(){return new t(zl,Vl)},t.createNoTokenRequestCacheError=function(){return new t(Bl,jl)},t.createAuthRequestNotSetError=function(){return new t(Wl,Ql)},t.createNoCachedAuthorityError=function(){return new t(Gl,Kl)},t.createInvalidCacheTypeError=function(){return new t(Jl,""+Yl)},t.createNonBrowserEnvironmentError=function(){return new t(Zl,Xl)},t.createDatabaseNotOpenError=function(){return new t(ed,td)},t.createNoNetworkConnectivityError=function(){return new t(od,rd)},t.createPostRequestFailedError=function(e,o){return new t(nd,id+" | Network client threw: "+e+" | Attempted to reach: "+o.split("?")[0])},t.createGetRequestFailedError=function(e,o){return new t(sd,ad+" | Network client threw: "+e+" | Attempted to reach: "+o.split("?")[0])},t.createFailedToParseNetworkResponseError=function(e){return new t(cd,ld+" | Attempted to reach: "+e.split("?")[0])},t}(_a),ud=function(){function e(e){this.base64Encode=new wa,this.cryptoObj=e}return e.prototype.generateCodes=function(){return Ss(this,void 0,void 0,(function(){var e,t;return _s(this,(function(o){switch(o.label){case 0:return e=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(e)];case 1:return t=o.sent(),[2,{verifier:e,challenge:t}]}}))}))},e.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);return this.cryptoObj.getRandomValues(e),this.base64Encode.urlEncodeArr(e)}catch(e){throw dd.createPkceNotGeneratedError(e)}},e.prototype.generateCodeChallengeFromVerifier=function(e){return Ss(this,void 0,void 0,(function(){var t,o;return _s(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(e)];case 1:return t=r.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw o=r.sent(),dd.createPkceNotGeneratedError(o);case 3:return[2]}}))}))},e}(),pd="SHA-256",hd=new Uint8Array([1,0,1]),fd=function(){function e(){if(!this.hasCryptoAPI())throw dd.createCryptoNotAvailableError("Browser crypto or msCrypto object not available.");this._keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:pd,modulusLength:2048,publicExponent:hd}}return e.prototype.sha256Digest=function(e){return Ss(this,void 0,void 0,(function(){var t;return _s(this,(function(o){return t=ka.stringToUtf8Arr(e),[2,this.hasIECrypto()?this.getMSCryptoDigest(pd,t):this.getSubtleCryptoDigest(pd,t)]}))}))},e.prototype.getRandomValues=function(e){var t=window.msCrypto||window.crypto;if(!t.getRandomValues)throw dd.createCryptoNotAvailableError("getRandomValues does not exist.");t.getRandomValues(e)},e.prototype.generateKeyPair=function(e,t){return Ss(this,void 0,void 0,(function(){return _s(this,(function(o){return[2,this.hasIECrypto()?this.msCryptoGenerateKey(e,t):window.crypto.subtle.generateKey(this._keygenAlgorithmOptions,e,t)]}))}))},e.prototype.exportJwk=function(e){return Ss(this,void 0,void 0,(function(){return _s(this,(function(t){return[2,this.hasIECrypto()?this.msCryptoExportJwk(e):window.crypto.subtle.exportKey(ma,e)]}))}))},e.prototype.importJwk=function(t,o,r){return Ss(this,void 0,void 0,(function(){var n,i;return _s(this,(function(s){return n=e.getJwkString(t),i=ka.stringToArrayBuffer(n),[2,this.hasIECrypto()?this.msCryptoImportKey(i,o,r):window.crypto.subtle.importKey(ma,t,this._keygenAlgorithmOptions,o,r)]}))}))},e.prototype.sign=function(e,t){return Ss(this,void 0,void 0,(function(){return _s(this,(function(o){return[2,this.hasIECrypto()?this.msCryptoSign(e,t):window.crypto.subtle.sign(this._keygenAlgorithmOptions,e,t)]}))}))},e.prototype.hasCryptoAPI=function(){return this.hasIECrypto()||this.hasBrowserCrypto()},e.prototype.hasIECrypto=function(){return"msCrypto"in window},e.prototype.hasBrowserCrypto=function(){return"crypto"in window},e.prototype.getSubtleCryptoDigest=function(e,t){return Ss(this,void 0,void 0,(function(){return _s(this,(function(o){return[2,window.crypto.subtle.digest(e,t)]}))}))},e.prototype.getMSCryptoDigest=function(e,t){return Ss(this,void 0,void 0,(function(){return _s(this,(function(o){return[2,new Promise((function(o,r){var n=window.msCrypto.subtle.digest(e,t.buffer);n.addEventListener("complete",(function(e){o(e.target.result)})),n.addEventListener("error",(function(e){r(e)}))}))]}))}))},e.prototype.msCryptoGenerateKey=function(e,t){return Ss(this,void 0,void 0,(function(){var o=this;return _s(this,(function(r){return[2,new Promise((function(r,n){var i=window.msCrypto.subtle.generateKey(o._keygenAlgorithmOptions,e,t);i.addEventListener("complete",(function(e){r(e.target.result)})),i.addEventListener("error",(function(e){n(e)}))}))]}))}))},e.prototype.msCryptoExportJwk=function(e){return Ss(this,void 0,void 0,(function(){return _s(this,(function(t){return[2,new Promise((function(t,o){var r=window.msCrypto.subtle.exportKey(ma,e);r.addEventListener("complete",(function(e){var r=e.target.result,n=ka.utf8ArrToString(new Uint8Array(r)).replace(/\r/g,"").replace(/\n/g,"").replace(/\t/g,"").split(" ").join("").replace("\0","");try{t(JSON.parse(n))}catch(e){o(e)}})),r.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.prototype.msCryptoImportKey=function(e,t,o){return Ss(this,void 0,void 0,(function(){var r=this;return _s(this,(function(n){return[2,new Promise((function(n,i){var s=window.msCrypto.subtle.importKey(ma,e,r._keygenAlgorithmOptions,t,o);s.addEventListener("complete",(function(e){n(e.target.result)})),s.addEventListener("error",(function(e){i(e)}))}))]}))}))},e.prototype.msCryptoSign=function(e,t){return Ss(this,void 0,void 0,(function(){var o=this;return _s(this,(function(r){return[2,new Promise((function(r,n){var i=window.msCrypto.subtle.sign(o._keygenAlgorithmOptions,e,t);i.addEventListener("complete",(function(e){r(e.target.result)})),i.addEventListener("error",(function(e){n(e)}))}))]}))}))},e.getJwkString=function(e){return JSON.stringify(e,Object.keys(e).sort())},e}(),gd=function(){function e(e,t,o){this.dbName=e,this.tableName=t,this.version=o,this.dbOpen=!1}return e.prototype.open=function(){return Ss(this,void 0,void 0,(function(){var e=this;return _s(this,(function(t){return[2,new Promise((function(t,o){var r=window.indexedDB.open(e.dbName,e.version);r.addEventListener("upgradeneeded",(function(t){t.target.result.createObjectStore(e.tableName)})),r.addEventListener("success",(function(o){var r=o;e.db=r.target.result,e.dbOpen=!0,t()})),r.addEventListener("error",(function(e){return o(e)}))}))]}))}))},e.prototype.get=function(e){return Ss(this,void 0,void 0,(function(){var t=this;return _s(this,(function(o){switch(o.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:o.sent(),o.label=2;case 2:return[2,new Promise((function(o,r){if(!t.db)return r(dd.createDatabaseNotOpenError());var n=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).get(e);n.addEventListener("success",(function(e){o(e.target.result)})),n.addEventListener("error",(function(e){return r(e)}))}))]}}))}))},e.prototype.put=function(e,t){return Ss(this,void 0,void 0,(function(){var o=this;return _s(this,(function(r){switch(r.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:r.sent(),r.label=2;case 2:return[2,new Promise((function(r,n){if(!o.db)return n(dd.createDatabaseNotOpenError());var i=o.db.transaction([o.tableName],"readwrite").objectStore(o.tableName).put(t,e);i.addEventListener("success",(function(e){r(e.target.result)})),i.addEventListener("error",(function(e){return n(e)}))}))]}}))}))},e}(),md=function(){function e(){this.browserCrypto=new fd,this.b64Encode=new wa,this.b64Decode=new Ca,this.guidGenerator=new ya(this.browserCrypto),this.pkceGenerator=new ud(this.browserCrypto),this.cache=new gd(e.DB_NAME,e.TABLE_NAME,e.DB_VERSION)}return e.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},e.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},e.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},e.prototype.generatePkceCodes=function(){return Ss(this,void 0,void 0,(function(){return _s(this,(function(e){return[2,this.pkceGenerator.generateCodes()]}))}))},e.prototype.getPublicKeyThumbprint=function(t){return Ss(this,void 0,void 0,(function(){var o,r,n,i,s,a,c,l;return _s(this,(function(d){switch(d.label){case 0:return[4,this.browserCrypto.generateKeyPair(e.EXTRACTABLE,e.POP_KEY_USAGES)];case 1:return o=d.sent(),[4,this.browserCrypto.exportJwk(o.publicKey)];case 2:return r=d.sent(),n={e:r.e,kty:r.kty,n:r.n},i=fd.getJwkString(n),[4,this.browserCrypto.sha256Digest(i)];case 3:return s=d.sent(),a=this.b64Encode.urlEncodeArr(new Uint8Array(s)),[4,this.browserCrypto.exportJwk(o.privateKey)];case 4:return c=d.sent(),[4,this.browserCrypto.importJwk(c,!1,["sign"])];case 5:return l=d.sent(),this.cache.put(a,{privateKey:l,publicKey:o.publicKey,requestMethod:t.resourceRequestMethod,requestUri:t.resourceRequestUri}),[2,a]}}))}))},e.prototype.signJwt=function(e,t){return Ss(this,void 0,void 0,(function(){var o,r,n,i,s,a,c,l,d,u;return _s(this,(function(p){switch(p.label){case 0:return[4,this.cache.get(t)];case 1:return o=p.sent(),[4,this.browserCrypto.exportJwk(o.publicKey)];case 2:return r=p.sent(),n=fd.getJwkString(r),i={alg:r.alg,type:ma},s=this.b64Encode.urlEncode(JSON.stringify(i)),e.cnf={jwk:JSON.parse(n)},a=this.b64Encode.urlEncode(JSON.stringify(e)),c=s+"."+a,l=ka.stringToArrayBuffer(c),[4,this.browserCrypto.sign(o.privateKey,l)];case 3:return d=p.sent(),u=this.b64Encode.urlEncodeArr(new Uint8Array(d)),[2,c+"."+u]}}))}))},e.POP_KEY_USAGES=["sign","verify"],e.EXTRACTABLE=!0,e.DB_VERSION=1,e.DB_NAME="msal.db",e.TABLE_NAME=e.DB_NAME+".keys",e}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(va||(va={}));var vd,bd=function(){function e(e,t,o){this.level=va.Info,this.localCallback=e.loggerCallback||function(){},this.piiLoggingEnabled=e.piiLoggingEnabled||!1,this.level=e.logLevel||va.Info,this.packageName=t||Hs.EMPTY_STRING,this.packageVersion=o||Hs.EMPTY_STRING}return e.prototype.clone=function(t,o){return new e({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level},t,o)},e.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var o=(new Date).toUTCString(),r=(Yc.isEmpty(this.correlationId)?"["+o+"] : ":"["+o+"] : ["+this.correlationId+"]")+" : "+this.packageName+"@"+this.packageVersion+" : "+va[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,r,t.containsPii||!1)}},e.prototype.executeCallback=function(e,t,o){this.localCallback&&this.localCallback(e,t,o)},e.prototype.error=function(e,t){this.logMessage(e,{logLevel:va.Error,containsPii:!1,correlationId:t||""})},e.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:va.Error,containsPii:!0,correlationId:t||""})},e.prototype.warning=function(e,t){this.logMessage(e,{logLevel:va.Warning,containsPii:!1,correlationId:t||""})},e.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:va.Warning,containsPii:!0,correlationId:t||""})},e.prototype.info=function(e,t){this.logMessage(e,{logLevel:va.Info,containsPii:!1,correlationId:t||""})},e.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:va.Info,containsPii:!0,correlationId:t||""})},e.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:va.Verbose,containsPii:!1,correlationId:t||""})},e.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:va.Verbose,containsPii:!0,correlationId:t||""})},e.prototype.trace=function(e,t){this.logMessage(e,{logLevel:va.Trace,containsPii:!1,correlationId:t||""})},e.prototype.tracePii=function(e,t){this.logMessage(e,{logLevel:va.Trace,containsPii:!0,correlationId:t||""})},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},e}(),yd={createNewGuid:function(){throw _a.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw _a.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw _a.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return Rs(this,void 0,void 0,(function(){return Os(this,(function(e){throw _a.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")}))}))},getPublicKeyThumbprint:function(){return Rs(this,void 0,void 0,(function(){return Os(this,(function(e){throw _a.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")}))}))},signJwt:function(){return Rs(this,void 0,void 0,(function(){return Os(this,(function(e){throw _a.createUnexpectedError("Crypto interface - signJwt() has not been implemented")}))}))}},kd="redirect_uri_empty",wd="A redirect URI is required for all calls, and none has been set.",Cd="post_logout_uri_empty",Td="A post logout redirect has not been set.",Sd="claims_request_parsing_error",_d="Could not parse the given claims request object.",Id="authority_uri_insecure",xd="Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",Ed="url_parse_error",Ad="URL could not be parsed into appropriate segments.",Pd="empty_url_error",Rd="URL was empty or null.",Od="empty_input_scopes_error",Nd="Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",Dd="nonarray_input_scopes_error",Ld="Scopes cannot be passed as non-array.",Ud="clientid_input_scopes_error",Md="Client ID can only be provided as a single scope.",Fd="invalid_prompt_value",Hd="Supported prompt values are 'login', 'select_account', 'consent' and 'none'.  Please see here for valid configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",qd="invalid_claims",$d="Given claims parameter must be a stringified JSON object.",Bd="token_request_empty",jd="Token request was empty and not found in cache.",zd="logout_request_empty",Vd="The logout request was null or undefined.",Gd="invalid_code_challenge_method",Kd='code_challenge_method passed is invalid. Valid values are "plain" and "S256".',Wd="pkce_params_missing",Qd="Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",Jd="invalid_cloud_discovery_metadata",Yd="Invalid cloudDiscoveryMetadata provided. Must be a JSON object containing tenant_discovery_endpoint and metadata fields",Zd="invalid_authority_metadata",Xd="Invalid authorityMetadata provided. Must by a JSON object containing authorization_endpoint, token_endpoint, end_session_endpoint, issuer fields.",eu="untrusted_authority",tu="The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",ou=function(e){function t(o,r){var n=e.call(this,o,r)||this;return n.name="ClientConfigurationError",Object.setPrototypeOf(n,t.prototype),n}return As(t,e),t.createRedirectUriEmptyError=function(){return new t(kd,wd)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(Cd,Td)},t.createClaimsRequestParsingError=function(e){return new t(Sd,_d+" Given value: "+e)},t.createInsecureAuthorityUriError=function(e){return new t(Id,xd+" Given URI: "+e)},t.createUrlParseError=function(e){return new t(Ed,Ad+" Given Error: "+e)},t.createUrlEmptyError=function(){return new t(Pd,Rd)},t.createScopesNonArrayError=function(e){return new t(Dd,Ld+" Given Scopes: "+e)},t.createEmptyScopesArrayError=function(e){return new t(Od,Nd+" Given Scopes: "+e)},t.createClientIdSingleScopeError=function(e){return new t(Ud,Md+" Given Scopes: "+e)},t.createInvalidPromptError=function(e){return new t(Fd,Hd+" Given value: "+e)},t.createInvalidClaimsRequestError=function(){return new t(qd,$d)},t.createEmptyLogoutRequestError=function(){return new t(zd,Vd)},t.createEmptyTokenRequestError=function(){return new t(Bd,jd)},t.createInvalidCodeChallengeMethodError=function(){return new t(Gd,Kd)},t.createInvalidCodeChallengeParamsError=function(){return new t(Wd,Qd)},t.createInvalidCloudDiscoveryMetadataError=function(){return new t(Jd,Yd)},t.createInvalidAuthorityMetadataError=function(){return new t(Zd,Xd)},t.createUntrustedAuthorityError=function(){return new t(eu,tu)},t}(Jc),ru=function(){function e(t){if(this._urlString=t,Yc.isEmpty(this._urlString))throw ou.createUrlEmptyError();Yc.isEmpty(this.getHash())&&(this._urlString=e.canonicalizeUri(t))}return Object.defineProperty(e.prototype,"urlString",{get:function(){return this._urlString},enumerable:!0,configurable:!0}),e.canonicalizeUri=function(e){return e&&(e=e.toLowerCase(),Yc.endsWith(e,"?")?e=e.slice(0,-1):Yc.endsWith(e,"?/")&&(e=e.slice(0,-2)),Yc.endsWith(e,"/")||(e+="/")),e},e.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(e){throw ou.createUrlParseError(e)}if(!e.HostNameAndPort||!e.PathSegments)throw ou.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw ou.createInsecureAuthorityUriError(this.urlString)},e.prototype.urlRemoveQueryStringParameter=function(e){var t=new RegExp("(\\&"+e+"=)[^&]+");return this._urlString=this.urlString.replace(t,""),t=new RegExp("("+e+"=)[^&]+&"),this._urlString=this.urlString.replace(t,""),t=new RegExp("("+e+"=)[^&]+"),this._urlString=this.urlString.replace(t,""),this.urlString},e.appendQueryString=function(e,t){return Yc.isEmpty(t)?e:e.indexOf("?")<0?e+"?"+t:e+"&"+t},e.removeHashFromUrl=function(t){return e.canonicalizeUri(t.split("#")[0])},e.prototype.replaceTenantPath=function(t){var o=this.getUrlComponents(),r=o.PathSegments;return!t||0===r.length||r[0]!==Us.COMMON&&r[0]!==Us.ORGANIZATIONS||(r[0]=t),e.constructAuthorityUriFromObject(o)},e.prototype.getHash=function(){return e.parseHash(this.urlString)},e.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw ou.createUrlParseError("Given url string: "+this.urlString);var o={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},r=o.AbsolutePath.split("/");return r=r.filter((function(e){return e&&e.length>0})),o.PathSegments=r,!Yc.isEmpty(o.QueryString)&&o.QueryString.endsWith("/")&&(o.QueryString=o.QueryString.substring(0,o.QueryString.length-1)),o},e.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),o=e.match(t);if(!o)throw ou.createUrlParseError("Given url string: "+e);return o[2]},e.getAbsoluteUrl=function(t,o){if(t[0]===Hs.FORWARD_SLASH){var r=new e(o).getUrlComponents();return r.Protocol+"//"+r.HostNameAndPort+t}return t},e.parseHash=function(e){var t=e.indexOf("#"),o=e.indexOf("#/");return o>-1?e.substring(o+2):t>-1?e.substring(t+1):""},e.constructAuthorityUriFromObject=function(t){return new e(t.Protocol+"//"+t.HostNameAndPort+"/"+t.PathSegments.join("/"))},e.getDeserializedHash=function(t){if(Yc.isEmpty(t))return{};var o=e.parseHash(t),r=Yc.queryStringToObject(Yc.isEmpty(o)?t:o);if(!r)throw Jc.createHashNotDeserializedError(JSON.stringify(r));return r},e.hashContainsKnownProperties=function(t){if(Yc.isEmpty(t))return!1;var o=e.getDeserializedHash(t);return!!(o.code||o.error_description||o.error||o.state)},e}(),nu=function(e){function t(o,r,n){var i=e.call(this,o,r,n)||this;return i.name="ServerError",Object.setPrototypeOf(i,t.prototype),i}return As(t,e),t}(_a),iu=function(){function e(){}return e.generateThrottlingStorageKey=function(e){return"throttling."+JSON.stringify(e)},e.preProcess=function(t,o){var r,n=e.generateThrottlingStorageKey(o),i=t.getThrottlingCache(n);if(i){if(i.throttleTime<Date.now())return void t.removeItem(n,Qs.THROTTLING);throw new nu((null===(r=i.errorCodes)||void 0===r?void 0:r.join(" "))||Hs.EMPTY_STRING,i.errorMessage,i.subError)}},e.postProcess=function(t,o,r){if(e.checkResponseStatus(r)||e.checkResponseForRetryAfter(r)){var n={throttleTime:e.calculateThrottleTime(parseInt(r.headers[Ds.RETRY_AFTER])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};t.setThrottlingCache(e.generateThrottlingStorageKey(o),n)}},e.checkResponseStatus=function(e){return 429===e.status||e.status>=500&&e.status<600},e.checkResponseForRetryAfter=function(e){return!!e.headers&&e.headers.hasOwnProperty(Ds.RETRY_AFTER)&&(e.status<200||e.status>=300)},e.calculateThrottleTime=function(e){e<=0&&(e=0);var t=Date.now()/1e3;return Math.floor(1e3*Math.min(t+(e||60),t+3600))},e.removeThrottle=function(e,t,o,r,n){var i={clientId:t,authority:o,scopes:r,homeAccountIdentifier:n},s=this.generateThrottlingStorageKey(i);return e.removeItem(s,Qs.THROTTLING)},e}(),su=["interaction_required","consent_required","login_required"],au=["message_only","additional_action","basic_action","user_password_expired","consent_required"],cu=function(e){function t(o,r,n){var i=e.call(this,o,r,n)||this;return i.name="InteractionRequiredAuthError",Object.setPrototypeOf(i,t.prototype),i}return As(t,e),t.isInteractionRequiredError=function(e,t,o){var r=!!e&&su.indexOf(e)>-1,n=!!o&&au.indexOf(o)>-1,i=!!t&&su.some((function(e){return t.indexOf(e)>-1}));return r||i||n},t}(nu);function lu(e,t){if(Yc.isEmpty(e))throw Jc.createClientInfoEmptyError();try{var o=t.base64Decode(e);return JSON.parse(o)}catch(e){throw Jc.createClientInfoDecodingError(e)}}!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs"}(vd||(vd={}));var du,uu=function(){function e(){}return e.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(Ks.CACHE_KEY_SEPARATOR).toLowerCase()},e.prototype.generateAccountKey=function(){return e.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},e.prototype.generateType=function(){switch(this.authorityType){case Gs.ADFS_ACCOUNT_TYPE:return Js.ADFS;case Gs.MSAV1_ACCOUNT_TYPE:return Js.MSA;case Gs.MSSTS_ACCOUNT_TYPE:return Js.MSSTS;case Gs.GENERIC_ACCOUNT_TYPE:return Js.GENERIC;default:throw Jc.createUnexpectedAccountTypeError()}},e.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims}},e.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||"",e.tenantId||""].join(Ks.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAccount=function(t,o,r,n,i,s,a){var c,l,d,u,p,h,f=new e;f.authorityType=Gs.MSSTS_ACCOUNT_TYPE,f.clientInfo=t,f.homeAccountId=o;var g=r.getPreferredCache();if(Yc.isEmpty(g))throw Jc.createInvalidCacheEnvironmentError();return f.environment=g,f.realm=(null===(c=null==n?void 0:n.claims)||void 0===c?void 0:c.tid)||"",f.oboAssertion=i,n&&(f.idTokenClaims=n.claims,f.localAccountId=(null===(l=null==n?void 0:n.claims)||void 0===l?void 0:l.oid)||(null===(d=null==n?void 0:n.claims)||void 0===d?void 0:d.sub)||"",f.username=(null===(u=null==n?void 0:n.claims)||void 0===u?void 0:u.preferred_username)||((null===(p=null==n?void 0:n.claims)||void 0===p?void 0:p.emails)?n.claims.emails[0]:""),f.name=null===(h=null==n?void 0:n.claims)||void 0===h?void 0:h.name),f.cloudGraphHostName=s,f.msGraphHost=a,f},e.createGenericAccount=function(t,o,r,n,i,s){var a,c,l,d,u=new e;u.authorityType=t.authorityType===vd.Adfs?Gs.ADFS_ACCOUNT_TYPE:Gs.GENERIC_ACCOUNT_TYPE,u.homeAccountId=o,u.realm="",u.oboAssertion=n;var p=t.getPreferredCache();if(Yc.isEmpty(p))throw Jc.createInvalidCacheEnvironmentError();return r&&(u.localAccountId=(null===(a=null==r?void 0:r.claims)||void 0===a?void 0:a.oid)||(null===(c=null==r?void 0:r.claims)||void 0===c?void 0:c.sub)||"",u.username=(null===(l=null==r?void 0:r.claims)||void 0===l?void 0:l.upn)||"",u.name=(null===(d=null==r?void 0:r.claims)||void 0===d?void 0:d.name)||"",u.idTokenClaims=null==r?void 0:r.claims),u.environment=p,u.cloudGraphHostName=i,u.msGraphHost=s,u},e.generateHomeAccountId=function(e,t,o,r,n){var i,s=(null===(i=null==n?void 0:n.claims)||void 0===i?void 0:i.sub)?n.claims.sub:Hs.EMPTY_STRING;if(t===vd.Adfs)return s;if(e){var a=lu(e,r);if(!Yc.isEmpty(a.uid)&&!Yc.isEmpty(a.utid))return""+a.uid+Ks.CLIENT_INFO_SEPARATOR+a.utid}return o.verbose("No client info in response"),s},e.isAccountEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")},e.accountInfoIsEqual=function(e,t,o){if(!e||!t)return!1;var r=!0;if(o){var n=e.idTokenClaims||{},i=t.idTokenClaims||{};r=n.iat===i.iat&&n.nonce===i.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&r},e}();function pu(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("end_session_endpoint")&&e.hasOwnProperty("issuer")}!function(e){e.AAD="AAD",e.OIDC="OIDC"}(du||(du={}));var hu,fu=function(){function e(){}return e.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},e.isTokenExpired=function(t,o){var r=Number(t)||0;return e.nowSeconds()+o>r},e}(),gu=function(){function e(){this.expiresAt=fu.nowSeconds()+86400}return e.prototype.updateCloudDiscoveryMetadata=function(e,t){this.aliases=e.aliases,this.preferred_cache=e.preferred_cache,this.preferred_network=e.preferred_network,this.aliasesFromNetwork=t},e.prototype.updateEndpointMetadata=function(e,t){this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.end_session_endpoint=e.end_session_endpoint,this.issuer=e.issuer,this.endpointsFromNetwork=t},e.prototype.updateCanonicalAuthority=function(e){this.canonical_authority=e},e.prototype.resetExpiresAt=function(){this.expiresAt=fu.nowSeconds()+86400},e.prototype.isExpired=function(){return this.expiresAt<=fu.nowSeconds()},e.isAuthorityMetadataEntity=function(e,t){return!!t&&0===e.indexOf(ta)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("end_session_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")},e}(),mu=function(){function e(e){this.networkInterface=e}return e.prototype.detectRegion=function(e){return Rs(this,void 0,void 0,(function(){var t,o,r,n;return Os(this,(function(i){switch(i.label){case 0:if(t=e)return[3,7];i.label=1;case 1:return i.trys.push([1,6,,7]),[4,this.getRegionFromIMDS(Hs.IMDS_VERSION)];case 2:return(o=i.sent()).status===ia.httpSuccess&&(t=o.body),o.status!==ia.httpBadRequest?[3,5]:[4,this.getCurrentVersion()];case 3:return(r=i.sent())?[4,this.getRegionFromIMDS(r)]:[2,null];case 4:(n=i.sent()).status===ia.httpSuccess&&(t=n.body),i.label=5;case 5:return[3,7];case 6:return i.sent(),[2,null];case 7:return[2,t||null]}}))}))},e.prototype.getRegionFromIMDS=function(t){return Rs(this,void 0,void 0,(function(){return Os(this,(function(o){return[2,this.networkInterface.sendGetRequestAsync(Hs.IMDS_ENDPOINT+"?api-version="+t+"&format=text",e.IMDS_OPTIONS,Hs.IMDS_TIMEOUT)]}))}))},e.prototype.getCurrentVersion=function(){return Rs(this,void 0,void 0,(function(){var t;return Os(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.networkInterface.sendGetRequestAsync(Hs.IMDS_ENDPOINT+"?format=json",e.IMDS_OPTIONS)];case 1:return(t=o.sent()).status===ia.httpBadRequest&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?[2,t.body["newest-versions"][0]]:[2,null];case 2:return o.sent(),[2,null];case 3:return[2]}}))}))},e.IMDS_OPTIONS={headers:{Metadata:"true"}},e}(),vu=function(){function e(e,t,o,r){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=o,this.authorityOptions=r,this.regionDiscovery=new mu(t)}return Object.defineProperty(e.prototype,"authorityType",{get:function(){var e=this.canonicalAuthorityUrlComponents.PathSegments;return e.length&&e[0].toLowerCase()===Hs.ADFS?vd.Adfs:vd.Default},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new ru(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.authorization_endpoint);return this.replaceTenant(e)}throw Jc.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint);return this.replaceTenant(e)}throw Jc.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));return this.replaceTenant(e)}throw Jc.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.end_session_endpoint);return this.replaceTenant(e)}throw Jc.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.issuer);return this.replaceTenant(e)}throw Jc.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),e.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},e.prototype.replacePath=function(e){var t=e,o=new ru(this.metadata.canonical_authority).getUrlComponents().PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((function(e,r){var n=o[r];e!==n&&(t=t.replace("/"+n+"/","/"+e+"/"))})),t},Object.defineProperty(e.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===vd.Adfs||this.protocolMode===du.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),e.prototype.discoveryComplete=function(){return!!this.metadata},e.prototype.resolveEndpointsAsync=function(){return Rs(this,void 0,void 0,(function(){var e,t,o,r;return Os(this,(function(n){switch(n.label){case 0:return(e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort))||(e=new gu).updateCanonicalAuthority(this.canonicalAuthority),[4,this.updateCloudDiscoveryMetadata(e)];case 1:return t=n.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network),[4,this.updateEndpointMetadata(e)];case 2:return o=n.sent(),t!==Zs.CACHE&&o!==Zs.CACHE&&(e.resetExpiresAt(),e.updateCanonicalAuthority(this.canonicalAuthority)),r=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache),this.cacheManager.setAuthorityMetadata(r,e),this.metadata=e,[2]}}))}))},e.prototype.updateEndpointMetadata=function(t){var o;return Rs(this,void 0,void 0,(function(){var r,n,i;return Os(this,(function(s){switch(s.label){case 0:return(r=this.getEndpointMetadataFromConfig())?(t.updateEndpointMetadata(r,!1),[2,Zs.CONFIG]):this.isAuthoritySameType(t)&&t.endpointsFromNetwork&&!t.isExpired()?[2,Zs.CACHE]:[4,this.getEndpointMetadataFromNetwork()];case 1:return(r=s.sent())?(null===(o=this.authorityOptions.azureRegionConfiguration)||void 0===o?void 0:o.azureRegion)?[4,this.regionDiscovery.detectRegion(this.authorityOptions.azureRegionConfiguration.environmentRegion)]:[3,3]:[3,4];case 2:n=s.sent(),(i=this.authorityOptions.azureRegionConfiguration.azureRegion===Hs.AZURE_REGION_AUTO_DISCOVER_FLAG?n:this.authorityOptions.azureRegionConfiguration.azureRegion)&&(r=e.replaceWithRegionalInformation(r,i)),s.label=3;case 3:return t.updateEndpointMetadata(r,!0),[2,Zs.NETWORK];case 4:throw Jc.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}}))}))},e.prototype.isAuthoritySameType=function(e){return new ru(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length},e.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw ou.createInvalidAuthorityMetadataError()}return null},e.prototype.getEndpointMetadataFromNetwork=function(){return Rs(this,void 0,void 0,(function(){var e;return Os(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint)];case 1:return[2,pu((e=t.sent()).body)?e.body:null];case 2:return t.sent(),[2,null];case 3:return[2]}}))}))},e.prototype.updateCloudDiscoveryMetadata=function(e){return Rs(this,void 0,void 0,(function(){var t;return Os(this,(function(o){switch(o.label){case 0:return(t=this.getCloudDiscoveryMetadataFromConfig())?(e.updateCloudDiscoveryMetadata(t,!1),[2,Zs.CONFIG]):this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!e.isExpired()?[2,Zs.CACHE]:[4,this.getCloudDiscoveryMetadataFromNetwork()];case 1:if(t=o.sent())return e.updateCloudDiscoveryMetadata(t,!0),[2,Zs.NETWORK];throw ou.createUntrustedAuthorityError()}}))}))},e.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityOptions.cloudDiscoveryMetadata)try{var t=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),o=e.getCloudDiscoveryMetadataFromNetworkResponse(t.metadata,this.hostnameAndPort);if(o)return o}catch(e){throw ou.createInvalidCloudDiscoveryMetadataError()}return this.isInKnownAuthorities()?e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort):null},e.prototype.getCloudDiscoveryMetadataFromNetwork=function(){return Rs(this,void 0,void 0,(function(){var t,o,r,n;return Os(this,(function(i){switch(i.label){case 0:t=""+Hs.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",o=null,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(t)];case 2:return r=i.sent(),0===(n=function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(r.body)?r.body.metadata:[]).length?[2,null]:(o=e.getCloudDiscoveryMetadataFromNetworkResponse(n,this.hostnameAndPort),[3,4]);case 3:return i.sent(),[2,null];case 4:return o||(o=e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,o]}}))}))},e.prototype.isInKnownAuthorities=function(){var e=this;return this.authorityOptions.knownAuthorities.filter((function(t){return ru.getDomainFromUrl(t).toLowerCase()===e.hostnameAndPort})).length>0},e.createCloudDiscoveryMetadataFromHost=function(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}},e.getCloudDiscoveryMetadataFromNetworkResponse=function(e,t){for(var o=0;o<e.length;o++){var r=e[o];if(r.aliases.indexOf(t)>-1)return r}return null},e.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw Jc.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},e.prototype.isAlias=function(e){return this.metadata.aliases.indexOf(e)>-1},e.isPublicCloudAuthority=function(e){return Hs.KNOWN_PUBLIC_CLOUDS.includes(e)},e.buildRegionalAuthorityString=function(e,t,o){var r=new ru(e);r.validateAsUri();var n=r.getUrlComponents(),i=t+"."+n.HostNameAndPort;this.isPublicCloudAuthority(n.HostNameAndPort)&&(i=t+"."+Hs.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX);var s=ru.constructAuthorityUriFromObject(Ps(Ps({},r.getUrlComponents()),{HostNameAndPort:i})).urlString;return o?s+"?"+o:s},e.replaceWithRegionalInformation=function(t,o){return t.authorization_endpoint=e.buildRegionalAuthorityString(t.authorization_endpoint,o),t.token_endpoint=e.buildRegionalAuthorityString(t.token_endpoint,o,"allowestsrnonmsi=true"),t.end_session_endpoint=e.buildRegionalAuthorityString(t.end_session_endpoint,o),t},e}(),bu=function(){function e(){}return e.createDiscoveredInstance=function(t,o,r,n){return Rs(this,void 0,void 0,(function(){var i,s;return Os(this,(function(a){switch(a.label){case 0:i=e.createInstance(t,o,r,n),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,i.resolveEndpointsAsync()];case 2:return a.sent(),[2,i];case 3:throw s=a.sent(),Jc.createEndpointDiscoveryIncompleteError(s);case 4:return[2]}}))}))},e.createInstance=function(e,t,o,r){if(Yc.isEmpty(e))throw ou.createUrlEmptyError();return new vu(e,t,o,r)},e}(),yu="4.3.0",ku=function(){function e(){}return e.prototype.generateAccountId=function(){return e.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},e.prototype.generateCredentialId=function(){return e.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},e.prototype.generateTarget=function(){return e.generateTargetForCacheKey(this.target)},e.prototype.generateCredentialKey=function(){return e.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId)},e.prototype.generateType=function(){switch(this.credentialType){case Ws.ID_TOKEN:return Js.ID_TOKEN;case Ws.ACCESS_TOKEN:return Js.ACCESS_TOKEN;case Ws.REFRESH_TOKEN:return Js.REFRESH_TOKEN;default:throw Jc.createUnexpectedCredentialTypeError()}},e.getCredentialType=function(e){return-1!==e.indexOf(Ws.ACCESS_TOKEN.toLowerCase())?-1!==e.indexOf(Ws.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())?Ws.ACCESS_TOKEN_WITH_AUTH_SCHEME:Ws.ACCESS_TOKEN:-1!==e.indexOf(Ws.ID_TOKEN.toLowerCase())?Ws.ID_TOKEN:-1!==e.indexOf(Ws.REFRESH_TOKEN.toLowerCase())?Ws.REFRESH_TOKEN:Hs.NOT_DEFINED},e.generateCredentialCacheKey=function(e,t,o,r,n,i,s){return[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(o,r,n,s),this.generateTargetForCacheKey(i)].join(Ks.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateAccountIdForCacheKey=function(e,t){return[e,t].join(Ks.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateCredentialIdForCacheKey=function(e,t,o,r){return[e,e===Ws.REFRESH_TOKEN&&r||t,o||""].join(Ks.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateTargetForCacheKey=function(e){return(e||"").toLowerCase()},e}(),wu=function(){function e(e){var t=this,o=e?Yc.trimArrayEntries(Ns(e)):[],r=o?Yc.removeEmptyStringsFromArray(o):[];this.validateInputScopes(r),this.scopes=new Set,r.forEach((function(e){return t.scopes.add(e)}))}return e.fromString=function(t){return new e((t=t||"").split(" "))},e.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw ou.createEmptyScopesArrayError(e)},e.prototype.containsScope=function(t){var o=new e(this.printScopesLowerCase().split(" "));return!Yc.isEmpty(t)&&o.scopes.has(t.toLowerCase())},e.prototype.containsScopeSet=function(e){var t=this;return!(!e||e.scopes.size<=0)&&this.scopes.size>=e.scopes.size&&e.asArray().every((function(e){return t.containsScope(e)}))},e.prototype.containsOnlyOIDCScopes=function(){var e=this,t=0;return $s.forEach((function(o){e.containsScope(o)&&(t+=1)})),this.scopes.size===t},e.prototype.appendScope=function(e){Yc.isEmpty(e)||this.scopes.add(e.trim())},e.prototype.appendScopes=function(e){var t=this;try{e.forEach((function(e){return t.appendScope(e)}))}catch(e){throw Jc.createAppendScopeSetError(e)}},e.prototype.removeScope=function(e){if(Yc.isEmpty(e))throw Jc.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},e.prototype.removeOIDCScopes=function(){var e=this;$s.forEach((function(t){e.scopes.delete(t)}))},e.prototype.unionScopeSets=function(e){if(!e)throw Jc.createEmptyInputScopeSetError(e);var t=new Set;return e.scopes.forEach((function(e){return t.add(e.toLowerCase())})),this.scopes.forEach((function(e){return t.add(e.toLowerCase())})),t},e.prototype.intersectingScopeSets=function(e){if(!e)throw Jc.createEmptyInputScopeSetError(e);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();var t=this.unionScopeSets(e),o=e.getScopeCount(),r=this.getScopeCount();return t.size<r+o},e.prototype.getScopeCount=function(){return this.scopes.size},e.prototype.asArray=function(){var e=[];return this.scopes.forEach((function(t){return e.push(t)})),e},e.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):""},e.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},e}(),Cu=function(){function e(t,o){if(Yc.isEmpty(t))throw Jc.createTokenNullOrEmptyError(t);this.rawToken=t,this.claims=e.extractTokenClaims(t,o)}return e.extractTokenClaims=function(e,t){var o=Yc.decodeAuthToken(e);try{var r=o.JWSPayload,n=t.base64Decode(r);return JSON.parse(n)}catch(e){throw Jc.createTokenParsingError(e)}},e}(),Tu=function(){function e(e,t){this.clientId=e,this.cryptoImpl=t}return e.prototype.getAllAccounts=function(){var t=this,o=this.getAccountsFilteredBy(),r=Object.keys(o).map((function(e){return o[e]}));return r.length<1?[]:r.map((function(o){var r=e.toObject(new uu,o).getAccountInfo(),n=t.readIdTokenFromCache(t.clientId,r);return n&&!r.idTokenClaims&&(r.idTokenClaims=new Cu(n.secret,t.cryptoImpl).claims),r}))},e.prototype.saveCacheRecord=function(e){if(!e)throw Jc.createNullOrUndefinedCacheRecord();e.account&&this.setAccount(e.account),e.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken&&this.saveAccessToken(e.accessToken),e.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata)},e.prototype.saveAccessToken=function(e){var t=this,o=this.getCredentialsFilteredBy({clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm}),r=wu.fromString(e.target),n=Object.keys(o.accessTokens).map((function(e){return o.accessTokens[e]}));n&&n.forEach((function(e){wu.fromString(e.target).intersectingScopeSets(r)&&t.removeCredential(e)})),this.setAccessTokenCredential(e)},e.prototype.getAccountsFilteredBy=function(e){return this.getAccountsFilteredByInternal(e?e.homeAccountId:"",e?e.environment:"",e?e.realm:"")},e.prototype.getAccountsFilteredByInternal=function(e,t,o){var r=this,n=this.getKeys(),i={};return n.forEach((function(n){var s=r.getAccount(n);s&&(e&&!r.matchHomeAccountId(s,e)||t&&!r.matchEnvironment(s,t)||o&&!r.matchRealm(s,o)||(i[n]=s))})),i},e.prototype.getCredentialsFilteredBy=function(e){return this.getCredentialsFilteredByInternal(e.homeAccountId,e.environment,e.credentialType,e.clientId,e.familyId,e.realm,e.target,e.oboAssertion)},e.prototype.getCredentialsFilteredByInternal=function(e,t,o,r,n,i,s,a){var c=this,l=this.getKeys(),d={idTokens:{},accessTokens:{},refreshTokens:{}};return l.forEach((function(l){var u=ku.getCredentialType(l);if(u!==Hs.NOT_DEFINED){var p=c.getSpecificCredential(l,u);if(p&&(!a||c.matchOboAssertion(p,a))&&(!e||c.matchHomeAccountId(p,e))&&(!t||c.matchEnvironment(p,t))&&(!i||c.matchRealm(p,i))&&(!o||c.matchCredentialType(p,o))&&(!r||c.matchClientId(p,r))&&(!n||c.matchFamilyId(p,n))&&(!s||c.matchTarget(p,s)))switch(u){case Ws.ID_TOKEN:d.idTokens[l]=p;break;case Ws.ACCESS_TOKEN:case Ws.ACCESS_TOKEN_WITH_AUTH_SCHEME:d.accessTokens[l]=p;break;case Ws.REFRESH_TOKEN:d.refreshTokens[l]=p}}})),d},e.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)},e.prototype.getAppMetadataFilteredByInternal=function(e,t){var o=this,r=this.getKeys(),n={};return r.forEach((function(r){if(o.isAppMetadata(r)){var i=o.getAppMetadata(r);i&&(e&&!o.matchEnvironment(i,e)||t&&!o.matchClientId(i,t)||(n[r]=i))}})),n},e.prototype.getAuthorityMetadataByAlias=function(e){var t=this,o=this.getAuthorityMetadataKeys(),r=null;return o.forEach((function(o){if(t.isAuthorityMetadata(o)&&-1!==o.indexOf(t.clientId)){var n=t.getAuthorityMetadata(o);n&&-1!==n.aliases.indexOf(e)&&(r=n)}})),r},e.prototype.removeAllAccounts=function(){var e=this;return this.getKeys().forEach((function(t){e.getAccount(t)&&e.removeAccount(t)})),!0},e.prototype.removeAccount=function(e){var t=this.getAccount(e);if(!t)throw Jc.createNoAccountFoundError();return this.removeAccountContext(t)&&this.removeItem(e,Qs.ACCOUNT)},e.prototype.removeAccountContext=function(e){var t=this,o=this.getKeys(),r=e.generateAccountId();return o.forEach((function(e){var o=ku.getCredentialType(e);if(o!==Hs.NOT_DEFINED){var n=t.getSpecificCredential(e,o);n&&r===n.generateAccountId()&&t.removeCredential(n)}})),!0},e.prototype.removeCredential=function(e){var t=e.generateCredentialKey();return this.removeItem(t,Qs.CREDENTIAL)},e.prototype.removeAppMetadata=function(){var e=this;return this.getKeys().forEach((function(t){e.isAppMetadata(t)&&e.removeItem(t,Qs.APP_METADATA)})),!0},e.prototype.readCacheRecord=function(e,t,o,r,n){var i=this.readAccountFromCache(e),s=this.readIdTokenFromCache(t,e),a=this.readAccessTokenFromCache(t,e,o,n),c=this.readRefreshTokenFromCache(t,e,!1),l=this.readAppMetadataFromCache(r,t);return i&&s&&(i.idTokenClaims=new Cu(s.secret,this.cryptoImpl).claims),{account:i,idToken:s,accessToken:a,refreshToken:c,appMetadata:l}},e.prototype.readAccountFromCache=function(e){var t=uu.generateAccountCacheKey(e);return this.getAccount(t)},e.prototype.readIdTokenFromCache=function(e,t){var o={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:Ws.ID_TOKEN,clientId:e,realm:t.tenantId},r=this.getCredentialsFilteredBy(o),n=Object.keys(r.idTokens).map((function(e){return r.idTokens[e]})),i=n.length;if(i<1)return null;if(i>1)throw Jc.createMultipleMatchingTokensInCacheError();return n[0]},e.prototype.readAccessTokenFromCache=function(e,t,o,r){var n=r===oa.POP?Ws.ACCESS_TOKEN_WITH_AUTH_SCHEME:Ws.ACCESS_TOKEN,i={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:n,clientId:e,realm:t.tenantId,target:o.printScopesLowerCase()},s=this.getCredentialsFilteredBy(i),a=Object.keys(s.accessTokens).map((function(e){return s.accessTokens[e]})),c=a.length;if(c<1)return null;if(c>1)throw Jc.createMultipleMatchingTokensInCacheError();return a[0]},e.prototype.readRefreshTokenFromCache=function(e,t,o){var r=o?ea:void 0,n={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:Ws.REFRESH_TOKEN,clientId:e,familyId:r},i=this.getCredentialsFilteredBy(n),s=Object.keys(i.refreshTokens).map((function(e){return i.refreshTokens[e]}));return s.length<1?null:s[0]},e.prototype.readAppMetadataFromCache=function(e,t){var o={environment:e,clientId:t},r=this.getAppMetadataFilteredBy(o),n=Object.keys(r).map((function(e){return r[e]})),i=n.length;if(i<1)return null;if(i>1)throw Jc.createMultipleMatchingAppMetadataInCacheError();return n[0]},e.prototype.isAppMetadataFOCI=function(e,t){var o=this.readAppMetadataFromCache(e,t);return!(!o||o.familyId!==ea)},e.prototype.matchHomeAccountId=function(e,t){return!(!e.homeAccountId||t!==e.homeAccountId)},e.prototype.matchOboAssertion=function(e,t){return!(!e.oboAssertion||t!==e.oboAssertion)},e.prototype.matchEnvironment=function(e,t){var o=this.getAuthorityMetadataByAlias(t);return!!(o&&o.aliases.indexOf(e.environment)>-1)},e.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},e.prototype.matchClientId=function(e,t){return!(!e.clientId||t!==e.clientId)},e.prototype.matchFamilyId=function(e,t){return!(!e.familyId||t!==e.familyId)},e.prototype.matchRealm=function(e,t){return!(!e.realm||t!==e.realm)},e.prototype.matchTarget=function(e,t){if(e.credentialType!==Ws.ACCESS_TOKEN&&e.credentialType!==Ws.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)return!1;var o=wu.fromString(e.target),r=wu.fromString(t);return r.containsOnlyOIDCScopes()?r.removeScope(Hs.OFFLINE_ACCESS_SCOPE):r.removeOIDCScopes(),o.containsScopeSet(r)},e.prototype.isAppMetadata=function(e){return-1!==e.indexOf(Xs)},e.prototype.isAuthorityMetadata=function(e){return-1!==e.indexOf(ta)},e.prototype.generateAuthorityMetadataCacheKey=function(e){return"authority-metadata-"+this.clientId+"-"+e},e.prototype.getSpecificCredential=function(e,t){switch(t){case Ws.ID_TOKEN:return this.getIdTokenCredential(e);case Ws.ACCESS_TOKEN:case Ws.ACCESS_TOKEN_WITH_AUTH_SCHEME:return this.getAccessTokenCredential(e);case Ws.REFRESH_TOKEN:return this.getRefreshTokenCredential(e);default:return null}},e.toObject=function(e,t){for(var o in t)e[o]=t[o];return e},e}(),Su=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return As(t,e),t.prototype.setAccount=function(){throw _a.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},t.prototype.getAccount=function(){throw _a.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},t.prototype.setIdTokenCredential=function(){throw _a.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getIdTokenCredential=function(){throw _a.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAccessTokenCredential=function(){throw _a.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getAccessTokenCredential=function(){throw _a.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setRefreshTokenCredential=function(){throw _a.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getRefreshTokenCredential=function(){throw _a.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAppMetadata=function(){throw _a.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAppMetadata=function(){throw _a.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.setServerTelemetry=function(){throw _a.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.getServerTelemetry=function(){throw _a.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.setAuthorityMetadata=function(){throw _a.createUnexpectedError("Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadata=function(){throw _a.createUnexpectedError("Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadataKeys=function(){throw _a.createUnexpectedError("Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.")},t.prototype.setThrottlingCache=function(){throw _a.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.getThrottlingCache=function(){throw _a.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.removeItem=function(){throw _a.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},t.prototype.containsKey=function(){throw _a.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},t.prototype.getKeys=function(){throw _a.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},t.prototype.clear=function(){throw _a.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")},t}(Tu),_u={tokenRenewalOffsetSeconds:300},Iu={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:va.Info},xu={sendGetRequestAsync:function(){return Rs(this,void 0,void 0,(function(){return Os(this,(function(e){throw _a.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")}))}))},sendPostRequestAsync:function(){return Rs(this,void 0,void 0,(function(){return Os(this,(function(e){throw _a.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")}))}))}},Eu={sku:Hs.SKU,version:yu,cpu:"",os:""},Au={clientSecret:"",clientAssertion:void 0},Pu=function(){function e(e,t){this.networkClient=e,this.cacheManager=t}return e.prototype.sendPostRequest=function(e,t,o){return Rs(this,void 0,void 0,(function(){var r,n;return Os(this,(function(i){switch(i.label){case 0:iu.preProcess(this.cacheManager,e),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(t,o)];case 2:return r=i.sent(),[3,4];case 3:throw(n=i.sent())instanceof _a?n:Jc.createNetworkError(t,n);case 4:return iu.postProcess(this.cacheManager,e,r),[2,r]}}))}))},e}(),Ru=function(){function e(e){this.config=function(e){var t,o=e.authOptions,r=e.systemOptions,n=e.loggerOptions,i=e.storageInterface,s=e.networkInterface,a=e.cryptoInterface,c=e.clientCredentials,l=e.libraryInfo,d=e.serverTelemetryManager,u=e.persistencePlugin,p=e.serializableCache;return{authOptions:(t=o,Ps({clientCapabilities:[]},t)),systemOptions:Ps(Ps({},_u),r),loggerOptions:Ps(Ps({},Iu),n),storageInterface:i||new Su(o.clientId,yd),networkInterface:s||xu,cryptoInterface:a||yd,clientCredentials:c||Au,libraryInfo:Ps(Ps({},Eu),l),serverTelemetryManager:d||null,persistencePlugin:u||null,serializableCache:p||null}}(e),this.logger=new bd(this.config.loggerOptions,"@azure/msal-common",yu),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new Pu(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority}return e.prototype.createDefaultTokenRequestHeaders=function(){var e={};return e[Ds.CONTENT_TYPE]=Hs.URL_FORM_CONTENT_TYPE,e},e.prototype.executePostToTokenEndpoint=function(e,t,o,r){return Rs(this,void 0,void 0,(function(){var n;return Os(this,(function(i){switch(i.label){case 0:return[4,this.networkManager.sendPostRequest(r,e,{body:t,headers:o})];case 1:return n=i.sent(),this.config.serverTelemetryManager&&n.status<500&&429!==n.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,n]}}))}))},e.prototype.updateAuthority=function(e){if(!e.discoveryComplete())throw Jc.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=e},e}(),Ou=function(){function e(){}return e.validateRedirectUri=function(e){if(Yc.isEmpty(e))throw ou.createRedirectUriEmptyError()},e.validatePrompt=function(e){if([js.LOGIN,js.SELECT_ACCOUNT,js.CONSENT,js.NONE].indexOf(e)<0)throw ou.createInvalidPromptError(e)},e.validateClaims=function(e){try{JSON.parse(e)}catch(e){throw ou.createInvalidClaimsRequestError()}},e.validateCodeChallengeParams=function(e,t){if(Yc.isEmpty(e)||Yc.isEmpty(t))throw ou.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},e.validateCodeChallengeMethod=function(e){if([Ys.PLAIN,Ys.S256].indexOf(e)<0)throw ou.createInvalidCodeChallengeMethodError()},e.sanitizeEQParams=function(e,t){return e?(t.forEach((function(t,o){e[o]&&delete e[o]})),e):{}},e}(),Nu=function(){function e(){this.parameters=new Map}return e.prototype.addResponseTypeCode=function(){this.parameters.set(Ms.RESPONSE_TYPE,encodeURIComponent(Hs.CODE_RESPONSE_TYPE))},e.prototype.addResponseMode=function(e){this.parameters.set(Ms.RESPONSE_MODE,encodeURIComponent(e||zs.QUERY))},e.prototype.addScopes=function(e,t){void 0===t&&(t=!0);var o=t?Ns(e||[],qs):e||[],r=new wu(o);this.parameters.set(Ms.SCOPE,encodeURIComponent(r.printScopes()))},e.prototype.addClientId=function(e){this.parameters.set(Ms.CLIENT_ID,encodeURIComponent(e))},e.prototype.addRedirectUri=function(e){Ou.validateRedirectUri(e),this.parameters.set(Ms.REDIRECT_URI,encodeURIComponent(e))},e.prototype.addPostLogoutRedirectUri=function(e){Ou.validateRedirectUri(e),this.parameters.set(Ms.POST_LOGOUT_URI,encodeURIComponent(e))},e.prototype.addIdTokenHint=function(e){this.parameters.set(Ms.ID_TOKEN_HINT,encodeURIComponent(e))},e.prototype.addDomainHint=function(e){this.parameters.set(Bs.DOMAIN_HINT,encodeURIComponent(e))},e.prototype.addLoginHint=function(e){this.parameters.set(Bs.LOGIN_HINT,encodeURIComponent(e))},e.prototype.addSid=function(e){this.parameters.set(Bs.SID,encodeURIComponent(e))},e.prototype.addClaims=function(e,t){var o=this.addClientCapabilitiesToClaims(e,t);Ou.validateClaims(o),this.parameters.set(Ms.CLAIMS,encodeURIComponent(o))},e.prototype.addCorrelationId=function(e){this.parameters.set(Ms.CLIENT_REQUEST_ID,encodeURIComponent(e))},e.prototype.addLibraryInfo=function(e){this.parameters.set(Ms.X_CLIENT_SKU,e.sku),this.parameters.set(Ms.X_CLIENT_VER,e.version),this.parameters.set(Ms.X_CLIENT_OS,e.os),this.parameters.set(Ms.X_CLIENT_CPU,e.cpu)},e.prototype.addPrompt=function(e){Ou.validatePrompt(e),this.parameters.set(""+Ms.PROMPT,encodeURIComponent(e))},e.prototype.addState=function(e){Yc.isEmpty(e)||this.parameters.set(Ms.STATE,encodeURIComponent(e))},e.prototype.addNonce=function(e){this.parameters.set(Ms.NONCE,encodeURIComponent(e))},e.prototype.addCodeChallengeParams=function(e,t){if(Ou.validateCodeChallengeParams(e,t),!e||!t)throw ou.createInvalidCodeChallengeParamsError();this.parameters.set(Ms.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(Ms.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},e.prototype.addAuthorizationCode=function(e){this.parameters.set(Ms.CODE,encodeURIComponent(e))},e.prototype.addDeviceCode=function(e){this.parameters.set(Ms.DEVICE_CODE,encodeURIComponent(e))},e.prototype.addRefreshToken=function(e){this.parameters.set(Ms.REFRESH_TOKEN,encodeURIComponent(e))},e.prototype.addCodeVerifier=function(e){this.parameters.set(Ms.CODE_VERIFIER,encodeURIComponent(e))},e.prototype.addClientSecret=function(e){this.parameters.set(Ms.CLIENT_SECRET,encodeURIComponent(e))},e.prototype.addClientAssertion=function(e){this.parameters.set(Ms.CLIENT_ASSERTION,encodeURIComponent(e))},e.prototype.addClientAssertionType=function(e){this.parameters.set(Ms.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},e.prototype.addOboAssertion=function(e){this.parameters.set(Ms.OBO_ASSERTION,encodeURIComponent(e))},e.prototype.addRequestTokenUse=function(e){this.parameters.set(Ms.REQUESTED_TOKEN_USE,encodeURIComponent(e))},e.prototype.addGrantType=function(e){this.parameters.set(Ms.GRANT_TYPE,encodeURIComponent(e))},e.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},e.prototype.addExtraQueryParameters=function(e){var t=this;Ou.sanitizeEQParams(e,this.parameters),Object.keys(e).forEach((function(o){t.parameters.set(o,e[o])}))},e.prototype.addClientCapabilitiesToClaims=function(e,t){var o;if(e)try{o=JSON.parse(e)}catch(e){throw ou.createInvalidClaimsRequestError()}else o={};return t&&t.length>0&&(o.hasOwnProperty(Fs.ACCESS_TOKEN)||(o[Fs.ACCESS_TOKEN]={}),o[Fs.ACCESS_TOKEN][Fs.XMS_CC]={values:t}),JSON.stringify(o)},e.prototype.addUsername=function(e){this.parameters.set(na.username,e)},e.prototype.addPassword=function(e){this.parameters.set(na.password,e)},e.prototype.addPopToken=function(e){Yc.isEmpty(e)||(this.parameters.set(Ms.TOKEN_TYPE,oa.POP),this.parameters.set(Ms.REQ_CNF,encodeURIComponent(e)))},e.prototype.addServerTelemetry=function(e){this.parameters.set(Ms.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue()),this.parameters.set(Ms.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())},e.prototype.addThrottling=function(){this.parameters.set(Ms.X_MS_LIB_CAPABILITY,"retry-after, h429")},e.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach((function(t,o){e.push(o+"="+t)})),e.join("&")},e}(),Du=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return As(t,e),t.createIdTokenEntity=function(e,o,r,n,i,s){var a=new t;return a.credentialType=Ws.ID_TOKEN,a.homeAccountId=e,a.environment=o,a.clientId=n,a.secret=r,a.realm=i,a.oboAssertion=s,a},t.isIdTokenEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===Ws.ID_TOKEN},t}(ku),Lu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return As(t,e),t.createAccessTokenEntity=function(e,o,r,n,i,s,a,c,l,d,u,p){var h,f=new t;f.homeAccountId=e,f.credentialType=Ws.ACCESS_TOKEN,f.secret=r;var g=fu.nowSeconds();if(f.cachedAt=g.toString(),f.expiresOn=a.toString(),f.extendedExpiresOn=c.toString(),d&&(f.refreshOn=d.toString()),f.environment=o,f.clientId=n,f.realm=i,f.target=s,f.oboAssertion=p,f.tokenType=Yc.isEmpty(u)?oa.BEARER:u,f.tokenType===oa.POP){f.credentialType=Ws.ACCESS_TOKEN_WITH_AUTH_SCHEME;var m=Cu.extractTokenClaims(r,l);if(!(null===(h=null==m?void 0:m.cnf)||void 0===h?void 0:h.kid))throw Jc.createTokenClaimsRequiredError();f.keyId=m.cnf.kid}return f},t.isAccessTokenEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.hasOwnProperty("target")&&(e.credentialType===Ws.ACCESS_TOKEN||e.credentialType===Ws.ACCESS_TOKEN_WITH_AUTH_SCHEME)},t}(ku),Uu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return As(t,e),t.createRefreshTokenEntity=function(e,o,r,n,i,s){var a=new t;return a.clientId=n,a.credentialType=Ws.REFRESH_TOKEN,a.environment=o,a.homeAccountId=e,a.secret=r,a.oboAssertion=s,i&&(a.familyId=i),a},t.isRefreshTokenEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===Ws.REFRESH_TOKEN},t}(ku),Mu=function(e,t,o,r,n){this.account=e||null,this.idToken=t||null,this.accessToken=o||null,this.refreshToken=r||null,this.appMetadata=n||null},Fu=function(){function e(){}return e.setRequestState=function(t,o,r){var n=e.generateLibraryState(t,r);return Yc.isEmpty(o)?n:""+n+Hs.RESOURCE_DELIM+o},e.generateLibraryState=function(e,t){if(!e)throw Jc.createNoCryptoObjectError("generateLibraryState");var o={id:e.createNewGuid()};t&&(o.meta=t);var r=JSON.stringify(o);return e.base64Encode(r)},e.parseRequestState=function(e,t){if(!e)throw Jc.createNoCryptoObjectError("parseRequestState");if(Yc.isEmpty(t))throw Jc.createInvalidStateError(t,"Null, undefined or empty state");try{var o=decodeURIComponent(t).split(Hs.RESOURCE_DELIM),r=o[0],n=o.length>1?o.slice(1).join(Hs.RESOURCE_DELIM):"",i=e.base64Decode(r),s=JSON.parse(i);return{userRequestState:Yc.isEmpty(n)?"":n,libraryState:s}}catch(e){throw Jc.createInvalidStateError(t,e)}},e}();!function(e){e.SW="sw",e.UHW="uhw"}(hu||(hu={}));var Hu,qu=function(){function e(e){this.cryptoUtils=e}return e.prototype.generateCnf=function(e){return Rs(this,void 0,void 0,(function(){var t,o;return Os(this,(function(r){switch(r.label){case 0:return[4,this.cryptoUtils.getPublicKeyThumbprint(e)];case 1:return t=r.sent(),o={kid:t,xms_ksl:hu.SW},[2,this.cryptoUtils.base64Encode(JSON.stringify(o))]}}))}))},e.prototype.signPopToken=function(e,t){var o;return Rs(this,void 0,void 0,(function(){var r,n,i,s,a,c;return Os(this,(function(l){switch(l.label){case 0:if(r=Cu.extractTokenClaims(e,this.cryptoUtils),n=t.resourceRequestMethod,i=t.resourceRequestUri,s=t.shrClaims,a=i?new ru(i):void 0,c=null==a?void 0:a.getUrlComponents(),!(null===(o=null==r?void 0:r.cnf)||void 0===o?void 0:o.kid))throw Jc.createTokenClaimsRequiredError();return[4,this.cryptoUtils.signJwt({at:e,ts:fu.nowSeconds(),m:null==n?void 0:n.toUpperCase(),u:null==c?void 0:c.HostNameAndPort,nonce:this.cryptoUtils.createNewGuid(),p:null==c?void 0:c.AbsolutePath,q:(null==c?void 0:c.QueryString)?[[],c.QueryString]:void 0,client_claims:s||void 0},r.cnf.kid)];case 1:return[2,l.sent()]}}))}))},e}(),$u=function(){function e(){}return e.prototype.generateAppMetadataKey=function(){return e.generateAppMetadataCacheKey(this.environment,this.clientId)},e.generateAppMetadataCacheKey=function(e,t){return[Xs,e,t].join(Ks.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAppMetadataEntity=function(t,o,r){var n=new e;return n.clientId=t,n.environment=o,r&&(n.familyId=r),n},e.isAppMetadataEntity=function(e,t){return!!t&&0===e.indexOf(Xs)&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment")},e}(),Bu=function(){function e(e,t){this.cache=e,this.hasChanged=t}return Object.defineProperty(e.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!0,configurable:!0}),e}(),ju=function(){function e(e,t,o,r,n,i){this.clientId=e,this.cacheStorage=t,this.cryptoObj=o,this.logger=r,this.serializableCache=n,this.persistencePlugin=i}return e.prototype.validateServerAuthorizationCodeResponse=function(e,t,o){if(!e.state||!t)throw e.state?Jc.createStateNotFoundError("Cached State"):Jc.createStateNotFoundError("Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw Jc.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(cu.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new cu(e.error||Hs.EMPTY_STRING,e.error_description,e.suberror);throw new nu(e.error||Hs.EMPTY_STRING,e.error_description,e.suberror)}e.client_info&&lu(e.client_info,o)},e.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(cu.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new cu(e.error,e.error_description,e.suberror);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new nu(e.error,t,e.suberror)}},e.prototype.handleServerTokenResponse=function(t,o,r,n,i,s,a){return Rs(this,void 0,void 0,(function(){var c,l,d,u,p;return Os(this,(function(h){switch(h.label){case 0:if(t.id_token&&(c=new Cu(t.id_token||Hs.EMPTY_STRING,this.cryptoObj),i&&!Yc.isEmpty(i.nonce)&&c.claims.nonce!==i.nonce))throw Jc.createNonceMismatchError();this.homeAccountIdentifier=uu.generateHomeAccountId(t.client_info||Hs.EMPTY_STRING,o.authorityType,this.logger,this.cryptoObj,c),i&&i.state&&(l=Fu.parseRequestState(this.cryptoObj,i.state)),d=this.generateCacheRecord(t,o,r,c,n.scopes,s,i),h.label=1;case 1:return h.trys.push([1,,4,7]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),u=new Bu(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(u)]):[3,3];case 2:h.sent(),h.label=3;case 3:return a&&d.account&&(p=d.account.generateAccountKey(),!this.cacheStorage.getAccount(p))?(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,e.generateAuthenticationResult(this.cryptoObj,o,d,!1,n,c,l)]):(this.cacheStorage.saveCacheRecord(d),[3,7]);case 4:return this.persistencePlugin&&this.serializableCache&&u?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(u)]):[3,6];case 5:h.sent(),h.label=6;case 6:return[7];case 7:return[2,e.generateAuthenticationResult(this.cryptoObj,o,d,!1,n,c,l)]}}))}))},e.prototype.generateCacheRecord=function(e,t,o,r,n,i,s){var a,c,l=t.getPreferredCache();if(Yc.isEmpty(l))throw Jc.createInvalidCacheEnvironmentError();!Yc.isEmpty(e.id_token)&&r&&(a=Du.createIdTokenEntity(this.homeAccountIdentifier,l,e.id_token||Hs.EMPTY_STRING,this.clientId,r.claims.tid||Hs.EMPTY_STRING,i),c=this.generateAccountEntity(e,r,t,i,s));var d=null;if(!Yc.isEmpty(e.access_token)){var u=e.scope?wu.fromString(e.scope):new wu(n||[]),p=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,h=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,f=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,g=o+p,m=g+h,v=f&&f>0?o+f:void 0;d=Lu.createAccessTokenEntity(this.homeAccountIdentifier,l,e.access_token||Hs.EMPTY_STRING,this.clientId,r?r.claims.tid||Hs.EMPTY_STRING:t.tenant,u.printScopes(),g,m,this.cryptoObj,v,e.token_type,i)}var b=null;Yc.isEmpty(e.refresh_token)||(b=Uu.createRefreshTokenEntity(this.homeAccountIdentifier,l,e.refresh_token||Hs.EMPTY_STRING,this.clientId,e.foci,i));var y=null;return Yc.isEmpty(e.foci)||(y=$u.createAppMetadataEntity(this.clientId,l,e.foci)),new Mu(c,a,d,b,y)},e.prototype.generateAccountEntity=function(e,t,o,r,n){var i=o.authorityType,s=n?n.cloud_graph_host_name:"",a=n?n.msgraph_host:"";if(i===vd.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),uu.createGenericAccount(o,this.homeAccountIdentifier,t,r,s,a);if(Yc.isEmpty(e.client_info)&&"AAD"===o.protocolMode)throw Jc.createClientInfoEmptyError();return e.client_info?uu.createAccount(e.client_info,this.homeAccountIdentifier,o,t,r,s,a):uu.createGenericAccount(o,this.homeAccountIdentifier,t,r,s,a)},e.generateAuthenticationResult=function(e,t,o,r,n,i,s){var a,c,l;return Rs(this,void 0,void 0,(function(){var d,u,p,h,f,g,m;return Os(this,(function(v){switch(v.label){case 0:return d="",u=[],p=null,f=Hs.EMPTY_STRING,o.accessToken?o.accessToken.tokenType!==oa.POP?[3,2]:[4,new qu(e).signPopToken(o.accessToken.secret,n)]:[3,4];case 1:return d=v.sent(),[3,3];case 2:d=o.accessToken.secret,v.label=3;case 3:u=wu.fromString(o.accessToken.target).asArray(),p=new Date(1e3*Number(o.accessToken.expiresOn)),h=new Date(1e3*Number(o.accessToken.extendedExpiresOn)),v.label=4;case 4:return o.appMetadata&&(f=o.appMetadata.familyId===ea?ea:Hs.EMPTY_STRING),g=(null==i?void 0:i.claims.oid)||(null==i?void 0:i.claims.sub)||Hs.EMPTY_STRING,m=(null==i?void 0:i.claims.tid)||Hs.EMPTY_STRING,[2,{authority:t.canonicalAuthority,uniqueId:g,tenantId:m,scopes:u,account:o.account?o.account.getAccountInfo():null,idToken:i?i.rawToken:Hs.EMPTY_STRING,idTokenClaims:i?i.claims:{},accessToken:d,fromCache:r,expiresOn:p,extExpiresOn:h,familyId:f,tokenType:(null===(a=o.accessToken)||void 0===a?void 0:a.tokenType)||Hs.EMPTY_STRING,state:s?s.userRequestState:Hs.EMPTY_STRING,cloudGraphHostName:(null===(c=o.account)||void 0===c?void 0:c.cloudGraphHostName)||Hs.EMPTY_STRING,msGraphHost:(null===(l=o.account)||void 0===l?void 0:l.msGraphHost)||Hs.EMPTY_STRING}]}}))}))},e}(),zu=function(e){function t(t){return e.call(this,t)||this}return As(t,e),t.prototype.getAuthCodeUrl=function(e){return Rs(this,void 0,void 0,(function(){var t;return Os(this,(function(o){return t=this.createAuthCodeUrlQueryString(e),[2,ru.appendQueryString(this.authority.authorizationEndpoint,t)]}))}))},t.prototype.acquireToken=function(e,t){return Rs(this,void 0,void 0,(function(){var o,r,n;return Os(this,(function(i){switch(i.label){case 0:if(this.logger.info("in acquireToken call"),!e||Yc.isEmpty(e.code))throw Jc.createTokenRequestCannotBeMadeError();return o=fu.nowSeconds(),[4,this.executeTokenRequest(this.authority,e)];case 1:return r=i.sent(),(n=new ju(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(r.body),[4,n.handleServerTokenResponse(r.body,this.authority,o,e,t)];case 2:return[2,i.sent()]}}))}))},t.prototype.handleFragmentResponse=function(e,t){var o=new ju(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),r=new ru(e),n=ru.getDeserializedHash(r.getHash());if(o.validateServerAuthorizationCodeResponse(n,t,this.cryptoUtils),!n.code)throw Jc.createNoAuthCodeInServerResponseError();return Ps(Ps({},n),{code:n.code})},t.prototype.getLogoutUri=function(e){if(!e)throw ou.createEmptyLogoutRequestError();e.account?this.cacheManager.removeAccount(uu.generateAccountCacheKey(e.account)):this.cacheManager.clear();var t=this.createLogoutUrlQueryString(e);return Yc.isEmpty(t)?this.authority.endSessionEndpoint:this.authority.endSessionEndpoint+"?"+t},t.prototype.executeTokenRequest=function(e,t){return Rs(this,void 0,void 0,(function(){var o,r,n,i,s;return Os(this,(function(a){switch(a.label){case 0:return o={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes},[4,this.createTokenRequestBody(t)];case 1:return r=a.sent(),n=this.createTokenQueryParameters(t),i=this.createDefaultTokenRequestHeaders(),s=Yc.isEmpty(n)?e.tokenEndpoint:e.tokenEndpoint+"?"+n,[2,this.executePostToTokenEndpoint(s,r,i,o)]}}))}))},t.prototype.createTokenQueryParameters=function(e){var t=new Nu;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},t.prototype.createTokenRequestBody=function(e){return Rs(this,void 0,void 0,(function(){var t,o,r,n;return Os(this,(function(i){switch(i.label){case 0:return(t=new Nu).addClientId(this.config.authOptions.clientId),t.addRedirectUri(e.redirectUri),t.addScopes(e.scopes),t.addAuthorizationCode(e.code),t.addLibraryInfo(this.config.libraryInfo),t.addThrottling(),this.serverTelemetryManager&&t.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(o=this.config.clientCredentials.clientAssertion,t.addClientAssertion(o.assertion),t.addClientAssertionType(o.assertionType)),t.addGrantType(Vs.AUTHORIZATION_CODE_GRANT),t.addClientInfo(),e.authenticationScheme!==oa.POP?[3,2]:[4,new qu(this.cryptoUtils).generateCnf(e)];case 1:r=i.sent(),t.addPopToken(r),i.label=2;case 2:return n=e.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(n),(!Yc.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),[2,t.createQueryString()]}}))}))},t.prototype.createAuthCodeUrlQueryString=function(e){var t=new Nu;t.addClientId(this.config.authOptions.clientId);var o=Ns(e.scopes||[],e.extraScopesToConsent||[]);t.addScopes(o),t.addRedirectUri(e.redirectUri);var r=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(r),t.addResponseMode(e.responseMode),t.addResponseTypeCode(),t.addLibraryInfo(this.config.libraryInfo),t.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&t.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&t.addPrompt(e.prompt),e.domainHint&&t.addDomainHint(e.domainHint),e.prompt!==js.SELECT_ACCOUNT)if(e.sid&&e.prompt===js.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),t.addSid(e.sid);else if(e.account){var n=this.extractAccountSid(e.account);n&&e.prompt===js.NONE?(this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),t.addSid(n)):e.loginHint?(this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),t.addLoginHint(e.loginHint)):e.account.username&&(this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),t.addLoginHint(e.account.username))}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),t.addLoginHint(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&t.addNonce(e.nonce),e.state&&t.addState(e.state),(!Yc.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},t.prototype.createLogoutUrlQueryString=function(e){var t=new Nu;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),t.createQueryString()},t.prototype.extractAccountSid=function(e){return e.idTokenClaims&&e.idTokenClaims.sid||null},t}(Ru),Vu=function(e){function t(t){return e.call(this,t)||this}return As(t,e),t.prototype.acquireToken=function(e){return Rs(this,void 0,void 0,(function(){var t,o,r;return Os(this,(function(n){switch(n.label){case 0:return t=fu.nowSeconds(),[4,this.executeTokenRequest(e,this.authority)];case 1:return o=n.sent(),(r=new ju(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(o.body),[2,r.handleServerTokenResponse(o.body,this.authority,t,e,void 0,void 0,!0)]}}))}))},t.prototype.acquireTokenByRefreshToken=function(e){return Rs(this,void 0,void 0,(function(){var t,o;return Os(this,(function(r){if(!e)throw ou.createEmptyTokenRequestError();if(!e.account)throw Jc.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(e.account.environment,this.config.authOptions.clientId))try{return[2,this.acquireTokenWithCachedRefreshToken(e,!0)]}catch(r){if(t=r instanceof Jc&&r.errorCode===Za,o=r instanceof nu&&"invalid_grant"===r.errorCode&&"client_mismatch"===r.subError,t||o)return[2,this.acquireTokenWithCachedRefreshToken(e,!1)];throw r}return[2,this.acquireTokenWithCachedRefreshToken(e,!1)]}))}))},t.prototype.acquireTokenWithCachedRefreshToken=function(e,t){return Rs(this,void 0,void 0,(function(){var o,r;return Os(this,(function(n){if(!(o=this.cacheManager.readRefreshTokenFromCache(this.config.authOptions.clientId,e.account,t)))throw Jc.createNoTokensFoundError();return r=Ps(Ps({},e),{refreshToken:o.secret,authenticationScheme:e.authenticationScheme||oa.BEARER}),[2,this.acquireToken(r)]}))}))},t.prototype.executeTokenRequest=function(e,t){return Rs(this,void 0,void 0,(function(){var o,r,n,i,s;return Os(this,(function(a){switch(a.label){case 0:return[4,this.createTokenRequestBody(e)];case 1:return o=a.sent(),r=this.createTokenQueryParameters(e),n=this.createDefaultTokenRequestHeaders(),i={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes},s=ru.appendQueryString(t.tokenEndpoint,r),[2,this.executePostToTokenEndpoint(s,o,n,i)]}}))}))},t.prototype.createTokenQueryParameters=function(e){var t=new Nu;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},t.prototype.createTokenRequestBody=function(e){return Rs(this,void 0,void 0,(function(){var t,o,r,n,i,s;return Os(this,(function(a){switch(a.label){case 0:return(t=new Nu).addClientId(this.config.authOptions.clientId),t.addScopes(e.scopes),t.addGrantType(Vs.REFRESH_TOKEN_GRANT),t.addClientInfo(),t.addLibraryInfo(this.config.libraryInfo),t.addThrottling(),this.serverTelemetryManager&&t.addServerTelemetry(this.serverTelemetryManager),o=e.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(o),t.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(r=this.config.clientCredentials.clientAssertion,t.addClientAssertion(r.assertion),t.addClientAssertionType(r.assertionType)),e.authenticationScheme!==oa.POP?[3,2]:(n=new qu(this.cryptoUtils),s=(i=t).addPopToken,[4,n.generateCnf(e)]);case 1:s.apply(i,[a.sent()]),a.label=2;case 2:return(!Yc.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),[2,t.createQueryString()]}}))}))},t}(Ru),Gu=function(e){function t(t){return e.call(this,t)||this}return As(t,e),t.prototype.acquireToken=function(e){return Rs(this,void 0,void 0,(function(){var t;return Os(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.acquireCachedToken(e)];case 1:return[2,o.sent()];case 2:if((t=o.sent())instanceof Jc&&t.errorCode===Bc)return[2,new Vu(this.config).acquireTokenByRefreshToken(e)];throw t;case 3:return[2]}}))}))},t.prototype.acquireCachedToken=function(e){return Rs(this,void 0,void 0,(function(){var t,o,r,n;return Os(this,(function(i){switch(i.label){case 0:if(!e)throw ou.createEmptyTokenRequestError();if(!e.account)throw Jc.createNoAccountInSilentRequestError();if(t=new wu(e.scopes||[]),o=e.authority||this.authority.getPreferredCache(),r=e.authenticationScheme||oa.BEARER,n=this.cacheManager.readCacheRecord(e.account,this.config.authOptions.clientId,t,o,r),e.forceRefresh||!Yc.isEmptyObj(e.claims)||!n.accessToken||fu.isTokenExpired(n.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds)||n.accessToken.refreshOn&&fu.isTokenExpired(n.accessToken.refreshOn,0))throw Jc.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(n,e)];case 1:return[2,i.sent()]}}))}))},t.prototype.generateResultFromCacheRecord=function(e,t){return Rs(this,void 0,void 0,(function(){var o;return Os(this,(function(r){switch(r.label){case 0:return e.idToken&&(o=new Cu(e.idToken.secret,this.config.cryptoInterface)),[4,ju.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,o)];case 1:return[2,r.sent()]}}))}))},t}(Ru),Ku=function(){function e(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return e.isServerTelemetryEntity=function(e,t){var o=0===e.indexOf(ra.CACHE_KEY),r=!0;return t&&(r=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),o&&r},e}(),Wu=function(){function e(e,t){this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.forceRefresh=e.forceRefresh||!1,this.wrapperSKU=e.wrapperSKU||Hs.EMPTY_STRING,this.wrapperVer=e.wrapperVer||Hs.EMPTY_STRING,this.telemetryCacheKey=ra.CACHE_KEY+Ks.CACHE_KEY_SEPARATOR+e.clientId}return e.prototype.generateCurrentRequestHeaderValue=function(){var e=this.forceRefresh?1:0,t=""+this.apiId+ra.VALUE_SEPARATOR+e,o=[this.wrapperSKU,this.wrapperVer].join(ra.VALUE_SEPARATOR);return[ra.SCHEMA_VERSION,t,o].join(ra.CATEGORY_SEPARATOR)},e.prototype.generateLastRequestHeaderValue=function(){var t=this.getLastRequests(),o=e.maxErrorsToSend(t),r=t.failedRequests.slice(0,2*o).join(ra.VALUE_SEPARATOR),n=t.errors.slice(0,o).join(ra.VALUE_SEPARATOR),i=t.errors.length,s=[i,o<i?ra.OVERFLOW_TRUE:ra.OVERFLOW_FALSE].join(ra.VALUE_SEPARATOR);return[ra.SCHEMA_VERSION,t.cacheHits,r,n,s].join(ra.CATEGORY_SEPARATOR)},e.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.errors.length>=ra.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),Yc.isEmpty(e.subError)?Yc.isEmpty(e.errorCode)?e&&e.toString()?t.errors.push(e.toString()):t.errors.push(ra.UNKNOWN_ERROR):t.errors.push(e.errorCode):t.errors.push(e.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)},e.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits},e.prototype.getLastRequests=function(){var e=new Ku;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e},e.prototype.clearTelemetryCache=function(){var t=this.getLastRequests(),o=e.maxErrorsToSend(t);if(o===t.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{var r=new Ku;r.failedRequests=t.failedRequests.slice(2*o),r.errors=t.errors.slice(o),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r)}},e.maxErrorsToSend=function(e){var t,o=0,r=0,n=e.errors.length;for(t=0;t<n;t++){var i=e.failedRequests[2*t]||Hs.EMPTY_STRING,s=e.failedRequests[2*t+1]||Hs.EMPTY_STRING,a=e.errors[t]||Hs.EMPTY_STRING;if(!((r+=i.toString().length+s.toString().length+a.length+3)<ra.MAX_LAST_HEADER_BYTES))break;o+=1}return o},e}(),Qu=function(){function e(){}return e.isThrottlingEntity=function(e,t){var o=!1;e&&(o=0===e.indexOf(sa));var r=!0;return t&&(r=t.hasOwnProperty("throttleTime")),o&&r},e}(),Ju="redirect_uri_empty",Yu="A redirect URI is required for all calls, and none has been set.",Zu="post_logout_uri_empty",Xu="A post logout redirect has not been set.",ep="storage_not_supported",tp="Given storage configuration option was not supported.",op="no_redirect_callbacks",rp="No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics.",np="invalid_callback_object",ip="The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics.",sp="stubbed_public_client_application_called",ap="Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",cp="in_mem_redirect_unavailable",lp="Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true.",dp=function(e){function t(o,r){var n=e.call(this,o,r)||this;return n.name="BrowserConfigurationAuthError",Object.setPrototypeOf(n,t.prototype),n}return Cs(t,e),t.createRedirectUriEmptyError=function(){return new t(Ju,Yu)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(Zu,Xu)},t.createStorageNotSupportedError=function(e){return new t(ep,tp+" Given Location: "+e)},t.createInvalidCallbackObjectError=function(e){return new t(np,ip+" Given value for callback function: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(op,rp)},t.createStubPcaInstanceCalledError=function(){return new t(sp,ap)},t.createInMemoryRedirectUnavailableError=function(){return new t(cp,lp)},t}(_a),up=function(){function e(e){this.validateWindowStorage(e),this.windowStorage=window[e]}return e.prototype.validateWindowStorage=function(e){if(e!==aa.LocalStorage&&e!==aa.SessionStorage)throw dp.createStorageNotSupportedError(e);if(!window[e])throw dp.createStorageNotSupportedError(e)},e.prototype.getItem=function(e){return this.windowStorage.getItem(e)},e.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)},e.prototype.removeItem=function(e){this.windowStorage.removeItem(e)},e.prototype.getKeys=function(){return Object.keys(this.windowStorage)},e.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},e}(),pp=function(){function e(){this.cache=new Map}return e.prototype.getItem=function(e){return this.cache.get(e)||null},e.prototype.setItem=function(e,t){this.cache.set(e,t)},e.prototype.removeItem=function(e){this.cache.delete(e)},e.prototype.getKeys=function(){var e=[];return this.cache.forEach((function(t,o){e.push(o)})),e},e.prototype.containsKey=function(e){return this.cache.has(e)},e.prototype.clear=function(){this.cache.clear()},e}(),hp=function(){function e(){}return e.extractBrowserRequestState=function(e,t){if(Yc.isEmpty(t))return null;try{return Fu.parseRequestState(e,t).libraryState.meta}catch(e){throw Jc.createInvalidStateError(t,e)}},e.parseServerResponseFromHash=function(e){if(!e)return{};var t=new ru(e);return ru.getDeserializedHash(t.getHash())},e}(),fp=function(e){function t(t,o,r,n){var i=e.call(this,t,r)||this;return i.COOKIE_LIFE_MULTIPLIER=864e5,i.cacheConfig=o,i.logger=n,i.internalStorage=new pp,i.browserStorage=i.setupBrowserStorage(i.cacheConfig.cacheLocation),i.temporaryCacheStorage=i.setupTemporaryCacheStorage(i.cacheConfig.cacheLocation),i.migrateCacheEntries(),i}return Cs(t,e),t.prototype.setupBrowserStorage=function(e){switch(e){case aa.LocalStorage:case aa.SessionStorage:try{return new up(e)}catch(e){this.logger.verbose(e);break}}return this.cacheConfig.cacheLocation=aa.MemoryStorage,new pp},t.prototype.setupTemporaryCacheStorage=function(e){switch(e){case aa.LocalStorage:case aa.SessionStorage:try{return new up(aa.SessionStorage)}catch(e){return this.logger.verbose(e),this.internalStorage}case aa.MemoryStorage:default:return this.internalStorage}},t.prototype.migrateCacheEntries=function(){var e=this,t=Hs.CACHE_PREFIX+"."+Ls.ID_TOKEN,o=Hs.CACHE_PREFIX+"."+Ls.CLIENT_INFO,r=Hs.CACHE_PREFIX+"."+Ls.ERROR,n=Hs.CACHE_PREFIX+"."+Ls.ERROR_DESC,i=[this.browserStorage.getItem(t),this.browserStorage.getItem(o),this.browserStorage.getItem(r),this.browserStorage.getItem(n)];[Ls.ID_TOKEN,Ls.CLIENT_INFO,Ls.ERROR,Ls.ERROR_DESC].forEach((function(t,o){return e.migrateCacheEntry(t,i[o])}))},t.prototype.migrateCacheEntry=function(e,t){t&&this.setTemporaryCache(e,t,!0)},t.prototype.validateAndParseJson=function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}},t.prototype.getItem=function(e){return this.browserStorage.getItem(e)},t.prototype.setItem=function(e,t){this.browserStorage.setItem(e,t)},t.prototype.getAccount=function(e){var t=this.getItem(e);if(!t)return null;var o=this.validateAndParseJson(t);return o&&uu.isAccountEntity(o)?Tu.toObject(new uu,o):null},t.prototype.setAccount=function(e){this.logger.trace("BrowserCacheManager.setAccount called");var t=e.generateAccountKey();this.setItem(t,JSON.stringify(e))},t.prototype.getIdTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null;var o=this.validateAndParseJson(t);return o&&Du.isIdTokenEntity(o)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),Tu.toObject(new Du,o)):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null)},t.prototype.setIdTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getAccessTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null;var o=this.validateAndParseJson(t);return o&&Lu.isAccessTokenEntity(o)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),Tu.toObject(new Lu,o)):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null)},t.prototype.setAccessTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getRefreshTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null;var o=this.validateAndParseJson(t);return o&&Uu.isRefreshTokenEntity(o)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),Tu.toObject(new Uu,o)):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null)},t.prototype.setRefreshTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getAppMetadata=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var o=this.validateAndParseJson(t);return o&&$u.isAppMetadataEntity(e,o)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),Tu.toObject(new $u,o)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)},t.prototype.setAppMetadata=function(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");var t=e.generateAppMetadataKey();this.setItem(t,JSON.stringify(e))},t.prototype.getServerTelemetry=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var o=this.validateAndParseJson(t);return o&&Ku.isServerTelemetryEntity(e,o)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),Tu.toObject(new Ku,o)):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)},t.prototype.setServerTelemetry=function(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))},t.prototype.getAuthorityMetadata=function(e){var t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var o=this.validateAndParseJson(t);return o&&gu.isAuthorityMetadataEntity(e,o)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),Tu.toObject(new gu,o)):null},t.prototype.getAuthorityMetadataKeys=function(){var e=this;return this.internalStorage.getKeys().filter((function(t){return e.isAuthorityMetadata(t)}))},t.prototype.setAuthorityMetadata=function(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))},t.prototype.getThrottlingCache=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var o=this.validateAndParseJson(t);return o&&Qu.isThrottlingEntity(e,o)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),Tu.toObject(new Qu,o)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)},t.prototype.setThrottlingCache=function(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))},t.prototype.getTemporaryCache=function(e,t){var o=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){var r=this.getItemCookie(o);if(r)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),r}var n=this.temporaryCacheStorage.getItem(o);if(!n){if(this.cacheConfig.cacheLocation===aa.LocalStorage){var i=this.browserStorage.getItem(o);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),i}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),n},t.prototype.setTemporaryCache=function(e,t,o){var r=o?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(r,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(r,t))},t.prototype.removeItem=function(e){return this.browserStorage.removeItem(e),this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e)),!0},t.prototype.containsKey=function(e){return this.browserStorage.containsKey(e)||this.temporaryCacheStorage.containsKey(e)},t.prototype.getKeys=function(){return xs(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},t.prototype.clear=function(){var e=this;this.removeAllAccounts(),this.removeAppMetadata(),this.getKeys().forEach((function(t){!e.browserStorage.containsKey(t)&&!e.temporaryCacheStorage.containsKey(t)||-1===t.indexOf(Hs.CACHE_PREFIX)&&-1===t.indexOf(e.clientId)||e.removeItem(t)})),this.internalStorage.clear()},t.prototype.setItemCookie=function(e,t,o){var r=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";o&&(r+="expires="+this.getCookieExpirationTime(o)+";"),this.cacheConfig.secureCookies&&(r+="Secure;"),document.cookie=r},t.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",o=document.cookie.split(";"),r=0;r<o.length;r++){for(var n=o[r];" "===n.charAt(0);)n=n.substring(1);if(0===n.indexOf(t))return decodeURIComponent(n.substring(t.length,n.length))}return""},t.prototype.clearMsalCookies=function(){var e=this,t=Hs.CACHE_PREFIX+"."+this.clientId;document.cookie.split(";").forEach((function(o){for(;" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t)){var r=o.split("=")[0];e.clearItemCookie(r)}}))},t.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},t.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},t.prototype.getCache=function(){return this.browserStorage},t.prototype.setCache=function(){},t.prototype.generateCacheKey=function(e){return this.validateAndParseJson(e)?JSON.stringify(e):Yc.startsWith(e,Hs.CACHE_PREFIX)||Yc.startsWith(e,Ls.ADAL_ID_TOKEN)?e:Hs.CACHE_PREFIX+"."+this.clientId+"."+e},t.prototype.generateAuthorityKey=function(e){var t=Fu.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(la.AUTHORITY+"."+t)},t.prototype.generateNonceKey=function(e){var t=Fu.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(la.NONCE_IDTOKEN+"."+t)},t.prototype.generateStateKey=function(e){var t=Fu.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(la.REQUEST_STATE+"."+t)},t.prototype.getCachedAuthority=function(e){var t=this.generateStateKey(e),o=this.getTemporaryCache(t);if(!o)return null;var r=this.generateAuthorityKey(o);return this.getTemporaryCache(r)},t.prototype.updateCacheEntries=function(e,t,o){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var r=this.generateStateKey(e);this.setTemporaryCache(r,e,!1);var n=this.generateNonceKey(e);this.setTemporaryCache(n,t,!1);var i=this.generateAuthorityKey(e);this.setTemporaryCache(i,o,!1)},t.prototype.resetRequestCache=function(e){var t=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),Yc.isEmpty(e)||this.getKeys().forEach((function(o){-1!==o.indexOf(e)&&t.removeItem(o)})),e&&(this.removeItem(this.generateStateKey(e)),this.removeItem(this.generateNonceKey(e)),this.removeItem(this.generateAuthorityKey(e))),this.removeItem(this.generateCacheKey(la.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(la.ORIGIN_URI)),this.removeItem(this.generateCacheKey(la.URL_HASH)),this.removeItem(this.generateCacheKey(la.INTERACTION_STATUS_KEY))},t.prototype.cleanRequestByState=function(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){var t=this.generateStateKey(e),o=this.temporaryCacheStorage.getItem(t);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+o),this.resetRequestCache(o||"")}this.clearMsalCookies()},t.prototype.cleanRequestByInteractionType=function(e){var t=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach((function(o){if(-1!==o.indexOf(la.REQUEST_STATE)){var r=t.temporaryCacheStorage.getItem(o);if(r){var n=hp.extractBrowserRequestState(t.cryptoImpl,r);n&&n.interactionType===e&&(t.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+r),t.resetRequestCache(r))}}})),this.clearMsalCookies()},t.prototype.cacheCodeRequest=function(e,t){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var o=t.base64Encode(JSON.stringify(e));this.setTemporaryCache(la.REQUEST_PARAMS,o,!0)},t.prototype.getCachedRequest=function(e,t){this.logger.trace("BrowserCacheManager.getCachedRequest called");var o=this.getTemporaryCache(la.REQUEST_PARAMS,!0);if(!o)throw dd.createNoTokenRequestCacheError();var r=this.validateAndParseJson(t.base64Decode(o));if(!r)throw dd.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(la.REQUEST_PARAMS)),Yc.isEmpty(r.authority)){var n=this.generateAuthorityKey(e),i=this.getTemporaryCache(n);if(!i)throw dd.createNoCachedAuthorityError();r.authority=i}return r},t}(Tu),gp={sendGetRequestAsync:function(){return Promise.reject(_a.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented for the Network interface."))},sendPostRequestAsync:function(){return Promise.reject(_a.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented for the Network interface."))}},mp=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return Ss(this,void 0,void 0,(function(){var o,r,n;return _s(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,fetch(e,{method:ca.GET,headers:this.getFetchHeaders(t)})];case 1:return o=i.sent(),[3,3];case 2:throw r=i.sent(),window.navigator.onLine?dd.createGetRequestFailedError(r,e):dd.createNoNetworkConnectivityError();case 3:return i.trys.push([3,5,,6]),n={headers:this.getHeaderDict(o.headers)},[4,o.json()];case 4:return[2,(n.body=i.sent(),n.status=o.status,n)];case 5:throw i.sent(),dd.createFailedToParseNetworkResponseError(e);case 6:return[2]}}))}))},e.prototype.sendPostRequestAsync=function(e,t){return Ss(this,void 0,void 0,(function(){var o,r,n,i;return _s(this,(function(s){switch(s.label){case 0:o=t&&t.body||"",s.label=1;case 1:return s.trys.push([1,3,,4]),[4,fetch(e,{method:ca.POST,headers:this.getFetchHeaders(t),body:o})];case 2:return r=s.sent(),[3,4];case 3:throw n=s.sent(),window.navigator.onLine?dd.createPostRequestFailedError(n,e):dd.createNoNetworkConnectivityError();case 4:return s.trys.push([4,6,,7]),i={headers:this.getHeaderDict(r.headers)},[4,r.json()];case 5:return[2,(i.body=s.sent(),i.status=r.status,i)];case 6:throw s.sent(),dd.createFailedToParseNetworkResponseError(e);case 7:return[2]}}))}))},e.prototype.getFetchHeaders=function(e){var t=new Headers;if(!e||!e.headers)return t;var o=e.headers;return Object.keys(o).forEach((function(e){t.append(e,o[e])})),t},e.prototype.getHeaderDict=function(e){var t={};return e.forEach((function(e,o){t[o]=e})),t},e}(),vp=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return Ss(this,void 0,void 0,(function(){return _s(this,(function(o){return[2,this.sendRequestAsync(e,ca.GET,t)]}))}))},e.prototype.sendPostRequestAsync=function(e,t){return Ss(this,void 0,void 0,(function(){return _s(this,(function(o){return[2,this.sendRequestAsync(e,ca.POST,t)]}))}))},e.prototype.sendRequestAsync=function(e,t,o){var r=this;return new Promise((function(n,i){var s=new XMLHttpRequest;if(s.open(t,e,!0),r.setXhrHeaders(s,o),s.onload=function(){(s.status<200||s.status>=300)&&(t===ca.POST?i(dd.createPostRequestFailedError("Failed with status "+s.status,e)):i(dd.createGetRequestFailedError("Failed with status "+s.status,e)));try{var o=JSON.parse(s.responseText),a={headers:r.getHeaderDict(s),body:o,status:s.status};n(a)}catch(t){i(dd.createFailedToParseNetworkResponseError(e))}},s.onerror=function(){window.navigator.onLine?t===ca.POST?i(dd.createPostRequestFailedError("Failed with status "+s.status,e)):i(dd.createGetRequestFailedError("Failed with status "+s.status,e)):i(dd.createNoNetworkConnectivityError())},t===ca.POST&&o&&o.body)s.send(o.body);else{if(t!==ca.GET)throw dd.createHttpMethodNotImplementedError(t);s.send()}}))},e.prototype.setXhrHeaders=function(e,t){if(t&&t.headers){var o=t.headers;Object.keys(o).forEach((function(t){e.setRequestHeader(t,o[t])}))}},e.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),o={};return t.forEach((function(e){var t=e.split(": "),r=t.shift(),n=t.join(": ");r&&n&&(o[r]=n)})),o},e}(),bp=function(){function e(){}return e.clearHash=function(e){e.location.hash=Hs.EMPTY_STRING,"function"==typeof e.history.replaceState&&e.history.replaceState(null,Hs.EMPTY_STRING,""+e.location.pathname+e.location.search)},e.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""},e.isInIframe=function(){return window.parent!==window},e.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},e.getHomepage=function(){var e=new ru(window.location.href).getUrlComponents();return e.Protocol+"//"+e.HostNameAndPort+"/"},e.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new mp:new vp},e.blockReloadInHiddenIframes=function(){if(ru.hashContainsKnownProperties(window.location.hash)&&e.isInIframe())throw dd.createBlockReloadInHiddenIframeError()},e.blockRedirectInIframe=function(t,o){var r=e.isInIframe();if(t===ua.Redirect&&r&&!o)throw dd.createRedirectInIframeError(r)},e.blockAcquireTokenInPopups=function(){if(window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf("msal."))throw dd.createBlockAcquireTokenInPopupsError()},e.blockNonBrowserEnvironment=function(e){if(!e)throw dd.createNonBrowserEnvironmentError()},e.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),o=e.indexOf("Trident/"),r=e.indexOf("Edge/");return t>0||o>0||r>0},e}(),yp=function(){function e(){}return e.prototype.navigateInternal=function(t,o){return e.defaultNavigateWindow(t,o)},e.prototype.navigateExternal=function(t,o){return e.defaultNavigateWindow(t,o)},e.defaultNavigateWindow=function(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((function(e){setTimeout((function(){e(!0)}),t.timeout)}))},e}(),kp=function(){function e(e,t,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=o}return e.prototype.handleCodeResponse=function(e,t,o,r){return Ss(this,void 0,void 0,(function(){var n,i,s,a,c,l;return _s(this,(function(d){switch(d.label){case 0:if(Yc.isEmpty(e))throw dd.createEmptyHashError(e);if(n=this.browserStorage.generateStateKey(t),!(i=this.browserStorage.getTemporaryCache(n)))throw Jc.createStateNotFoundError("Cached State");return s=this.authModule.handleFragmentResponse(e,i),a=this.browserStorage.generateNonceKey(i),c=this.browserStorage.getTemporaryCache(a),this.authCodeRequest.code=s.code,s.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(s.cloud_instance_host_name,o,r)]:[3,2];case 1:d.sent(),d.label=2;case 2:return s.nonce=c||void 0,s.state=i,[4,this.authModule.acquireToken(this.authCodeRequest,s)];case 3:return l=d.sent(),this.browserStorage.cleanRequestByState(t),[2,l]}}))}))},e.prototype.updateTokenEndpointAuthority=function(e,t,o){return Ss(this,void 0,void 0,(function(){var r,n;return _s(this,(function(i){switch(i.label){case 0:return r="https://"+e+"/"+t.tenant+"/",[4,bu.createDiscoveredInstance(r,o,this.browserStorage,t.options)];case 1:return n=i.sent(),this.authModule.updateAuthority(n),[2]}}))}))},e}(),wp=function(e){function t(t,o,r,n){var i=e.call(this,t,o,r)||this;return i.browserCrypto=n,i}return Cs(t,e),t.prototype.initiateAuthRequest=function(e,t){return Ss(this,void 0,void 0,(function(){var o;return _s(this,(function(r){switch(r.label){case 0:return this.authModule.logger.verbose("RedirectHandler.initiateAuthRequest called"),Yc.isEmpty(e)?[3,7]:(t.redirectStartPage&&(this.authModule.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set to true, caching start page"),this.browserStorage.setTemporaryCache(la.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(la.INTERACTION_STATUS_KEY,ha,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.authModule.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to:"+e),o={apiId:da.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1},"function"!=typeof t.onRedirectNavigate?[3,4]:(this.authModule.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1===t.onRedirectNavigate(e)?[3,2]:(this.authModule.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,t.navigationClient.navigateExternal(e,o)])));case 1:return r.sent(),[2];case 2:return this.authModule.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.authModule.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,t.navigationClient.navigateExternal(e,o)];case 5:return r.sent(),[2];case 6:return[3,8];case 7:throw this.authModule.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),dd.createEmptyNavigationUriError();case 8:return[2]}}))}))},t.prototype.handleCodeResponse=function(e,t,o,r,n){return Ss(this,void 0,void 0,(function(){var i,s,a,c,l,d;return _s(this,(function(u){switch(u.label){case 0:if(this.authModule.logger.verbose("RedirectHandler.handleCodeResponse called"),Yc.isEmpty(e))throw dd.createEmptyHashError(e);if(this.browserStorage.removeItem(this.browserStorage.generateCacheKey(la.INTERACTION_STATUS_KEY)),i=this.browserStorage.generateStateKey(t),!(s=this.browserStorage.getTemporaryCache(i)))throw Jc.createStateNotFoundError("Cached State");return a=this.authModule.handleFragmentResponse(e,s),c=this.browserStorage.generateNonceKey(s),l=this.browserStorage.getTemporaryCache(c),this.authCodeRequest.code=a.code,a.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(a.cloud_instance_host_name,o,r)]:[3,2];case 1:u.sent(),u.label=2;case 2:return a.nonce=l||void 0,a.state=s,n&&iu.removeThrottle(this.browserStorage,n,this.authCodeRequest.authority,this.authCodeRequest.scopes),[4,this.authModule.acquireToken(this.authCodeRequest,a)];case 3:return d=u.sent(),this.browserStorage.cleanRequestByState(t),[2,d]}}))}))},t}(kp),Cp=function(){function e(e,t){this.browserStorage=e,this.logger=t,this.unloadWindow=this.unloadWindow.bind(this)}return e.prototype.openPopup=function(t,o,r){try{var n=void 0;if(r?(n=r,this.logger.verbosePii("Navigating popup window to: "+t),n.location.assign(t)):void 0===r&&(this.logger.verbosePii("Opening popup window to: "+t),n=e.openSizedPopup(t,o)),!n)throw dd.createEmptyWindowCreatedError();return n.focus&&n.focus(),this.currentWindow=n,window.addEventListener("beforeunload",this.unloadWindow),n}catch(e){throw this.logger.error("error opening popup "+e.message),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(la.INTERACTION_STATUS_KEY)),dd.createPopupWindowError(e.toString())}},e.openSizedPopup=function(e,t){var o=window.screenLeft?window.screenLeft:window.screenX,r=window.screenTop?window.screenTop:window.screenY,n=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,i=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,s=Math.max(0,n/2-241.5+o),a=Math.max(0,i/2-300+r);return window.open(e,t,"width=483, height=600, top="+a+", left="+s+", scrollbars=yes")},e.prototype.unloadWindow=function(e){this.browserStorage.cleanRequestByInteractionType(ua.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()},e.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(la.INTERACTION_STATUS_KEY))},e.prototype.monitorPopupForSameOrigin=function(e){var t=this;return new Promise((function(o,r){var n=setInterval((function(){if(e.closed)return t.cleanPopup(),clearInterval(n),void r(dd.createUserCancelledError());var i=Hs.EMPTY_STRING;try{i=e.location.href}catch(e){}Yc.isEmpty(i)||"about:blank"===i||(clearInterval(n),o())}),50)}))},e.generatePopupName=function(e,t){return"msal."+e+"."+t.scopes.join("-")+"."+t.authority+"."+t.correlationId},e.generateLogoutPopupName=function(e,t){return"msal."+e+"."+(t.account&&t.account.homeAccountId)+"."+t.correlationId},e}(),Tp=function(e){function t(t,o,r){var n=e.call(this,t,o,r)||this;return n.popupUtils=new Cp(o,t.logger),n}return Cs(t,e),t.prototype.initiateAuthRequest=function(e,t){if(Yc.isEmpty(e))throw this.authModule.logger.error("Navigate url is empty"),dd.createEmptyNavigationUriError();return this.browserStorage.setTemporaryCache(la.INTERACTION_STATUS_KEY,ha,!0),this.authModule.logger.infoPii("Navigate to:"+e),this.popupUtils.openPopup(e,t.popupName,t.popup)},t.prototype.monitorPopupForHash=function(e){var t=this;return this.popupUtils.monitorPopupForSameOrigin(e).then((function(){var o=e.location.hash;if(bp.clearHash(e),t.popupUtils.cleanPopup(e),!o)throw dd.createEmptyHashError(e.location.href);if(ru.hashContainsKnownProperties(o))return o;throw dd.createHashDoesNotContainKnownPropertiesError()}))},t}(kp),Sp=function(e){function t(t,o,r,n){var i=e.call(this,t,o,r)||this;return i.navigateFrameWait=n,i}return Cs(t,e),t.prototype.initiateAuthRequest=function(e){return Ss(this,void 0,void 0,(function(){var t;return _s(this,(function(o){switch(o.label){case 0:if(Yc.isEmpty(e))throw this.authModule.logger.info("Navigate url is empty"),dd.createEmptyNavigationUriError();return this.navigateFrameWait?[4,this.loadFrame(e)]:[3,2];case 1:return t=o.sent(),[3,3];case 2:t=this.loadFrameSync(e),o.label=3;case 3:return[2,t]}}))}))},t.prototype.monitorIframeForHash=function(e,t){var o=this;return new Promise((function(r,n){t<6e3&&o.authModule.logger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+t+"ms) than the default (6000ms). This may result in timeouts.");var i=window.performance.now()+t,s=setInterval((function(){if(window.performance.now()>i)return o.removeHiddenIframe(e),clearInterval(s),void n(dd.createMonitorIframeTimeoutError());var t=Hs.EMPTY_STRING,a=e.contentWindow;try{t=a?a.location.href:Hs.EMPTY_STRING}catch(e){}if(!Yc.isEmpty(t)){var c=a?a.location.hash:Hs.EMPTY_STRING;return ru.hashContainsKnownProperties(c)?(o.removeHiddenIframe(e),clearInterval(s),void r(c)):void 0}}),50)}))},t.prototype.loadFrame=function(e){var t=this;return new Promise((function(o,r){var n=t.createHiddenIframe();setTimeout((function(){n?(n.src=e,o(n)):r("Unable to load iframe")}),t.navigateFrameWait)}))},t.prototype.loadFrameSync=function(e){var t=this.createHiddenIframe();return t.src=e,t},t.prototype.createHiddenIframe=function(){var e=document.createElement("iframe");return e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(e),e},t.prototype.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},t}(kp),_p="2.14.2";!function(e){e.LOGIN_START="msal:loginStart",e.LOGIN_SUCCESS="msal:loginSuccess",e.LOGIN_FAILURE="msal:loginFailure",e.ACQUIRE_TOKEN_START="msal:acquireTokenStart",e.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",e.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",e.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",e.SSO_SILENT_START="msal:ssoSilentStart",e.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",e.SSO_SILENT_FAILURE="msal:ssoSilentFailure",e.HANDLE_REDIRECT_START="msal:handleRedirectStart",e.HANDLE_REDIRECT_END="msal:handleRedirectEnd",e.POPUP_OPENED="msal:popupOpened",e.LOGOUT_START="msal:logoutStart",e.LOGOUT_SUCCESS="msal:logoutSuccess",e.LOGOUT_FAILURE="msal:logoutFailure",e.LOGOUT_END="msal:logoutEnd"}(Hu||(Hu={}));var Ip,xp=function(e){function t(t){return e.call(this,t)||this}return Cs(t,e),t.prototype.loginRedirect=function(e){return Ss(this,void 0,void 0,(function(){return _s(this,(function(t){return this.logger.verbose("loginRedirect called"),[2,this.acquireTokenRedirect(e||ga)]}))}))},t.prototype.loginPopup=function(e){return this.logger.verbose("loginPopup called"),this.acquireTokenPopup(e||ga)},t.prototype.acquireTokenSilent=function(e){return Ss(this,void 0,void 0,(function(){var t,o,r,n,i,s;return _s(this,(function(a){switch(a.label){case 0:if(this.preflightBrowserEnvironmentCheck(ua.Silent),this.logger.verbose("acquireTokenSilent called"),!(t=e.account||this.getActiveAccount()))throw dd.createNoAccountError();o=Ts(Ts(Ts({},e),this.initializeBaseRequest(e)),{account:t,forceRefresh:e.forceRefresh||!1}),this.emitEvent(Hu.ACQUIRE_TOKEN_START,ua.Silent,e),a.label=1;case 1:return a.trys.push([1,4,,9]),r=this.initializeServerTelemetryManager(da.acquireTokenSilent_silentFlow,o.correlationId),[4,this.createSilentFlowClient(r,o.authority)];case 2:return[4,a.sent().acquireCachedToken(o)];case 3:return n=a.sent(),this.emitEvent(Hu.ACQUIRE_TOKEN_SUCCESS,ua.Silent,n),[2,n];case 4:a.sent(),a.label=5;case 5:return a.trys.push([5,7,,8]),[4,this.acquireTokenByRefreshToken(o)];case 6:return i=a.sent(),this.emitEvent(Hu.ACQUIRE_TOKEN_SUCCESS,ua.Silent,i),[2,i];case 7:throw s=a.sent(),this.emitEvent(Hu.ACQUIRE_TOKEN_FAILURE,ua.Silent,null,s),s;case 8:return[3,9];case 9:return[2]}}))}))},t}(function(){function e(e){if(this.isBrowserEnvironment="undefined"!=typeof window,this.config=function(e,t){var o=e.auth,r=e.cache,n=e.system,i={clientId:"",authority:""+Hs.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:"",authorityMetadata:"",redirectUri:"",postLogoutRedirectUri:"",navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:du.AAD},s={cacheLocation:aa.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1},a={loggerCallback:function(){},logLevel:va.Info,piiLoggingEnabled:!1},c=Ts(Ts({},_u),{loggerOptions:a,networkClient:t?bp.getBrowserNetworkClient():gp,navigationClient:new yp,loadFrameTimeout:0,windowHashTimeout:n&&n.loadFrameTimeout||6e4,iframeHashTimeout:n&&n.loadFrameTimeout||6e3,navigateFrameWait:t&&bp.detectIEOrEdge()?500:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1});return{auth:Ts(Ts({},i),o),cache:Ts(Ts({},s),r),system:Ts(Ts({},c),n)}}(e,this.isBrowserEnvironment),this.activeLocalAccountId=null,this.eventCallbacks=new Map,this.logger=new bd(this.config.system.loggerOptions,"@azure/msal-browser",_p),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,!this.isBrowserEnvironment)return this.browserStorage=(t=this.config.auth.clientId,o=this.logger,r={cacheLocation:aa.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1},new fp(t,r,yd,o)),void(this.browserCrypto=yd);var t,o,r;this.browserCrypto=new md,this.browserStorage=new fp(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger)}return e.prototype.handleRedirectPromise=function(e){return Ss(this,void 0,void 0,(function(){var t,o,r,n=this;return _s(this,(function(i){return this.emitEvent(Hu.HANDLE_REDIRECT_START,ua.Redirect),this.logger.verbose("handleRedirectPromise called"),t=this.getAllAccounts(),this.isBrowserEnvironment?(o=e||Hs.EMPTY_STRING,void 0===(r=this.redirectResponse.get(o))?(this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),r=this.handleRedirectResponse(e).then((function(e){return e&&(t.length<n.getAllAccounts().length?(n.emitEvent(Hu.LOGIN_SUCCESS,ua.Redirect,e),n.logger.verbose("handleRedirectResponse returned result, login success")):(n.emitEvent(Hu.ACQUIRE_TOKEN_SUCCESS,ua.Redirect,e),n.logger.verbose("handleRedirectResponse returned result, acquire token success"))),n.emitEvent(Hu.HANDLE_REDIRECT_END,ua.Redirect),e})).catch((function(e){throw t.length>0?n.emitEvent(Hu.ACQUIRE_TOKEN_FAILURE,ua.Redirect,null,e):n.emitEvent(Hu.LOGIN_FAILURE,ua.Redirect,null,e),n.emitEvent(Hu.HANDLE_REDIRECT_END,ua.Redirect),e})),this.redirectResponse.set(o,r)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,r]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])}))}))},e.prototype.handleRedirectResponse=function(e){return Ss(this,void 0,void 0,(function(){var t,o,r,n,i,s,a,c,l;return _s(this,(function(d){switch(d.label){case 0:if(!this.interactionInProgress())return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(t=this.getRedirectResponseHash(e||window.location.hash)))return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(ua.Redirect),[2,null];try{o=this.validateAndExtractStateFromHash(t,ua.Redirect),bp.clearHash(window),this.logger.verbose("State extracted from hash")}catch(e){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+e),this.browserStorage.cleanRequestByInteractionType(ua.Redirect),[2,null]}return r=this.browserStorage.getTemporaryCache(la.ORIGIN_URI,!0)||"",n=ru.removeHashFromUrl(r),i=ru.removeHashFromUrl(window.location.href),n===i&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(t,o)]):[3,2];case 1:return s=d.sent(),r.indexOf("#")>-1&&bp.replaceHash(r),[2,s];case 2:return this.config.auth.navigateToLoginRequestUrl?[3,3]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(t,o)]);case 3:return bp.isInIframe()?[3,8]:(this.browserStorage.setTemporaryCache(la.URL_HASH,t,!0),a={apiId:da.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},c=!0,r&&"null"!==r?[3,5]:(l=bp.getHomepage(),this.browserStorage.setTemporaryCache(la.ORIGIN_URI,l,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(l,a)]));case 4:return c=d.sent(),[3,7];case 5:return this.logger.verbose("Navigating to loginRequestUrl: "+r),[4,this.navigationClient.navigateInternal(r,a)];case 6:c=d.sent(),d.label=7;case 7:if(!c)return[2,this.handleHash(t,o)];d.label=8;case 8:return[2,null]}}))}))},e.prototype.getRedirectResponseHash=function(e){this.logger.verbose("getRedirectResponseHash called");var t=ru.hashContainsKnownProperties(e),o=this.browserStorage.getTemporaryCache(la.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(la.URL_HASH)),t?(this.logger.verbose("Hash contains known properties, returning response hash"),e):(this.logger.verbose("Hash does not contain known properties, returning cached hash"),o)},e.prototype.validateAndExtractStateFromHash=function(e,t){this.logger.verbose("validateAndExtractStateFromHash called");var o=ru.getDeserializedHash(e);if(!o.state)throw dd.createHashDoesNotContainStateError();var r=hp.extractBrowserRequestState(this.browserCrypto,o.state);if(!r)throw dd.createUnableToParseStateError();if(r.interactionType!==t)throw dd.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash"),o.state},e.prototype.handleHash=function(e,t){return Ss(this,void 0,void 0,(function(){var o,r,n,i,s;return _s(this,(function(a){switch(a.label){case 0:this.logger.verbose("handleHash called"),o=this.browserStorage.getCachedRequest(t,this.browserCrypto),r=this.initializeServerTelemetryManager(da.handleRedirectPromise,o.correlationId),a.label=1;case 1:if(a.trys.push([1,4,,5]),!(n=this.browserStorage.getCachedAuthority(t)))throw dd.createNoCachedAuthorityError();return[4,this.createAuthCodeClient(r,n)];case 2:return i=a.sent(),[4,new wp(i,this.browserStorage,o,this.browserCrypto).handleCodeResponse(e,t,i.authority,this.networkClient,this.config.auth.clientId)];case 3:return[2,a.sent()];case 4:throw s=a.sent(),r.cacheFailedRequest(s),this.browserStorage.cleanRequestByInteractionType(ua.Redirect),s;case 5:return[2]}}))}))},e.prototype.acquireTokenRedirect=function(e){return Ss(this,void 0,void 0,(function(){var t,o,r,n,i,s,a,c,l;return _s(this,(function(d){switch(d.label){case 0:this.preflightBrowserEnvironmentCheck(ua.Redirect),this.logger.verbose("acquireTokenRedirect called"),(t=this.getAllAccounts().length>0)?this.emitEvent(Hu.ACQUIRE_TOKEN_START,ua.Redirect,e):this.emitEvent(Hu.LOGIN_START,ua.Redirect,e),o=this.preflightInteractiveRequest(e,ua.Redirect),r=this.initializeServerTelemetryManager(da.acquireTokenRedirect,o.correlationId),d.label=1;case 1:return d.trys.push([1,5,,6]),[4,this.initializeAuthorizationCodeRequest(o)];case 2:return n=d.sent(),[4,this.createAuthCodeClient(r,o.authority)];case 3:return i=d.sent(),s=new wp(i,this.browserStorage,n,this.browserCrypto),[4,i.getAuthCodeUrl(o)];case 4:return a=d.sent(),c=this.getRedirectStartPage(e.redirectStartPage),[2,s.initiateAuthRequest(a,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:c,onRedirectNavigate:e.onRedirectNavigate})];case 5:throw l=d.sent(),t?this.emitEvent(Hu.ACQUIRE_TOKEN_FAILURE,ua.Redirect,null,l):this.emitEvent(Hu.LOGIN_FAILURE,ua.Redirect,null,l),r.cacheFailedRequest(l),this.browserStorage.cleanRequestByState(o.state),l;case 6:return[2]}}))}))},e.prototype.acquireTokenPopup=function(e){var t;try{this.preflightBrowserEnvironmentCheck(ua.Popup),this.logger.verbose("acquireTokenPopup called"),t=this.preflightInteractiveRequest(e,ua.Popup)}catch(e){return Promise.reject(e)}var o=Cp.generatePopupName(this.config.auth.clientId,t);if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(t,o);this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");var r=Cp.openSizedPopup("about:blank",o);return this.acquireTokenPopupAsync(t,o,r)},e.prototype.acquireTokenPopupAsync=function(e,t,o){return Ss(this,void 0,void 0,(function(){var r,n,i,s,a,c,l,d,u,p,h,f;return _s(this,(function(g){switch(g.label){case 0:this.logger.verbose("acquireTokenPopupAsync called"),(r=this.getAllAccounts()).length>0?this.emitEvent(Hu.ACQUIRE_TOKEN_START,ua.Popup,e):this.emitEvent(Hu.LOGIN_START,ua.Popup,e),n=this.initializeServerTelemetryManager(da.acquireTokenPopup,e.correlationId),g.label=1;case 1:return g.trys.push([1,7,,8]),[4,this.initializeAuthorizationCodeRequest(e)];case 2:return i=g.sent(),[4,this.createAuthCodeClient(n,e.authority)];case 3:return[4,(s=g.sent()).getAuthCodeUrl(e)];case 4:return a=g.sent(),c=new Tp(s,this.browserStorage,i),l={popup:o,popupName:t},d=c.initiateAuthRequest(a,l),this.emitEvent(Hu.POPUP_OPENED,ua.Popup,{popupWindow:d},null),[4,c.monitorPopupForHash(d)];case 5:return u=g.sent(),p=this.validateAndExtractStateFromHash(u,ua.Popup),iu.removeThrottle(this.browserStorage,this.config.auth.clientId,i.authority,i.scopes),[4,c.handleCodeResponse(u,p,s.authority,this.networkClient)];case 6:return h=g.sent(),r.length<this.getAllAccounts().length?this.emitEvent(Hu.LOGIN_SUCCESS,ua.Popup,h):this.emitEvent(Hu.ACQUIRE_TOKEN_SUCCESS,ua.Popup,h),[2,h];case 7:throw f=g.sent(),r.length>0?this.emitEvent(Hu.ACQUIRE_TOKEN_FAILURE,ua.Popup,null,f):this.emitEvent(Hu.LOGIN_FAILURE,ua.Popup,null,f),o&&o.close(),n.cacheFailedRequest(f),this.browserStorage.cleanRequestByState(e.state),f;case 8:return[2]}}))}))},e.prototype.ssoSilent=function(e){return Ss(this,void 0,void 0,(function(){var t,o;return _s(this,(function(r){switch(r.label){case 0:this.preflightBrowserEnvironmentCheck(ua.Silent),this.logger.verbose("ssoSilent called"),this.emitEvent(Hu.SSO_SILENT_START,ua.Silent,e),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.acquireTokenByIframe(e,da.ssoSilent)];case 2:return t=r.sent(),this.emitEvent(Hu.SSO_SILENT_SUCCESS,ua.Silent,t),[2,t];case 3:throw o=r.sent(),this.emitEvent(Hu.SSO_SILENT_FAILURE,ua.Silent,null,o),o;case 4:return[2]}}))}))},e.prototype.acquireTokenByIframe=function(e,t){return Ss(this,void 0,void 0,(function(){var o,r,n,i,s,a;return _s(this,(function(c){switch(c.label){case 0:if(this.logger.verbose("acquireTokenByIframe called"),Yc.isEmpty(e.loginHint)&&Yc.isEmpty(e.sid)&&(!e.account||Yc.isEmpty(e.account.username)))throw dd.createSilentSSOInsufficientInfoError();if(e.prompt&&e.prompt!==js.NONE)throw dd.createSilentPromptValueError(e.prompt);o=this.initializeAuthorizationRequest(Ts(Ts({},e),{prompt:js.NONE}),ua.Silent),r=this.initializeServerTelemetryManager(t,o.correlationId),c.label=1;case 1:return c.trys.push([1,6,,7]),[4,this.initializeAuthorizationCodeRequest(o)];case 2:return n=c.sent(),[4,this.createAuthCodeClient(r,o.authority)];case 3:return[4,(i=c.sent()).getAuthCodeUrl(o)];case 4:return s=c.sent(),[4,this.silentTokenHelper(s,n,i)];case 5:return[2,c.sent()];case 6:throw a=c.sent(),r.cacheFailedRequest(a),this.browserStorage.cleanRequestByState(o.state),a;case 7:return[2]}}))}))},e.prototype.acquireTokenByRefreshToken=function(e){return Ss(this,void 0,void 0,(function(){var t,o,r,n,i,s;return _s(this,(function(a){switch(a.label){case 0:this.emitEvent(Hu.ACQUIRE_TOKEN_NETWORK_START,ua.Silent,e),bp.blockReloadInHiddenIframes(),t=Ts(Ts({},e),this.initializeBaseRequest(e)),o=this.initializeServerTelemetryManager(da.acquireTokenSilent_silentFlow,t.correlationId),a.label=1;case 1:return a.trys.push([1,4,,7]),[4,this.createRefreshTokenClient(o,t.authority)];case 2:return[4,a.sent().acquireTokenByRefreshToken(t)];case 3:return[2,a.sent()];case 4:return r=a.sent(),o.cacheFailedRequest(r),n=r instanceof nu,i=r instanceof cu,s="invalid_grant"===r.errorCode,n&&s&&!i?(this.logger.verbose("Refresh token expired or invalid, attempting acquire token by iframe"),[4,this.acquireTokenByIframe(e,da.acquireTokenSilent_authCode)]):[3,6];case 5:return[2,a.sent()];case 6:throw r;case 7:return[2]}}))}))},e.prototype.silentTokenHelper=function(e,t,o){return Ss(this,void 0,void 0,(function(){var r,n,i,s;return _s(this,(function(a){switch(a.label){case 0:return[4,(r=new Sp(o,this.browserStorage,t,this.config.system.navigateFrameWait)).initiateAuthRequest(e)];case 1:return n=a.sent(),[4,r.monitorIframeForHash(n,this.config.system.iframeHashTimeout)];case 2:return i=a.sent(),s=this.validateAndExtractStateFromHash(i,ua.Silent),[2,r.handleCodeResponse(i,s,o.authority,this.networkClient)]}}))}))},e.prototype.logout=function(e){return Ss(this,void 0,void 0,(function(){return _s(this,(function(t){return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead."),[2,this.logoutRedirect(e)]}))}))},e.prototype.logoutRedirect=function(e){return Ss(this,void 0,void 0,(function(){var t,o,r,n,i,s;return _s(this,(function(a){switch(a.label){case 0:this.preflightBrowserEnvironmentCheck(ua.Redirect),this.logger.verbose("logoutRedirect called"),t=this.initializeLogoutRequest(e),o=this.initializeServerTelemetryManager(da.logout,t.correlationId),a.label=1;case 1:return a.trys.push([1,9,,10]),this.emitEvent(Hu.LOGOUT_START,ua.Redirect,e),[4,this.createAuthCodeClient(o,e&&e.authority)];case 2:return r=a.sent(),n=r.getLogoutUri(t),t.account&&!uu.accountInfoIsEqual(t.account,this.getActiveAccount(),!1)||(this.logger.verbose("Setting active account to null"),this.setActiveAccount(null)),i={apiId:da.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},this.emitEvent(Hu.LOGOUT_SUCCESS,ua.Redirect,t),e&&"function"==typeof e.onRedirectNavigate?!1===e.onRedirectNavigate(n)?[3,4]:(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),[4,this.navigationClient.navigateExternal(n,i)]):[3,6];case 3:return a.sent(),[2];case 4:this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),a.label=5;case 5:return[3,8];case 6:return[4,this.navigationClient.navigateExternal(n,i)];case 7:return a.sent(),[2];case 8:return[3,10];case 9:throw s=a.sent(),o.cacheFailedRequest(s),this.emitEvent(Hu.LOGOUT_FAILURE,ua.Redirect,null,s),s;case 10:return this.emitEvent(Hu.LOGOUT_END,ua.Redirect),[2]}}))}))},e.prototype.logoutPopup=function(e){var t;try{this.preflightBrowserEnvironmentCheck(ua.Popup),this.logger.verbose("logoutPopup called"),t=this.initializeLogoutRequest(e)}catch(e){return Promise.reject(e)}var o,r=Cp.generateLogoutPopupName(this.config.auth.clientId,t);this.config.system.asyncPopups?this.logger.verbose("asyncPopups set to true"):(this.logger.verbose("asyncPopup set to false, opening popup"),o=Cp.openSizedPopup("about:blank",r));var n=e&&e.authority,i=e&&e.mainWindowRedirectUri;return this.logoutPopupAsync(t,r,n,o,i)},e.prototype.logoutPopupAsync=function(e,t,o,r,n){return Ss(this,void 0,void 0,(function(){var i,s,a,c,l,d,u,p,h;return _s(this,(function(f){switch(f.label){case 0:this.logger.verbose("logoutPopupAsync called"),this.emitEvent(Hu.LOGOUT_START,ua.Popup,e),i=this.initializeServerTelemetryManager(da.logoutPopup,e.correlationId),f.label=1;case 1:return f.trys.push([1,7,,8]),this.browserStorage.setTemporaryCache(la.INTERACTION_STATUS_KEY,ha,!0),[4,this.createAuthCodeClient(i,o)];case 2:s=f.sent(),a=s.getLogoutUri(e),e.account&&!uu.accountInfoIsEqual(e.account,this.getActiveAccount(),!1)||(this.logger.verbose("Setting active account to null"),this.setActiveAccount(null)),this.emitEvent(Hu.LOGOUT_SUCCESS,ua.Popup,e),c=new Cp(this.browserStorage,this.logger),l=c.openPopup(a,t,r),this.emitEvent(Hu.POPUP_OPENED,ua.Popup,{popupWindow:l},null),f.label=3;case 3:return f.trys.push([3,5,,6]),[4,c.monitorPopupForSameOrigin(l)];case 4:return f.sent(),this.logger.verbose("Popup successfully redirected to postLogoutRedirectUri"),[3,6];case 5:return d=f.sent(),this.logger.verbose("Error occurred while monitoring popup for same origin. Session on server may remain active. Error: "+d),[3,6];case 6:return c.cleanPopup(l),n?(u={apiId:da.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},p=ru.getAbsoluteUrl(n,bp.getCurrentUri()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecing main window to: "+p),this.navigationClient.navigateInternal(p,u)):this.logger.verbose("No main window navigation requested"),[3,8];case 7:throw h=f.sent(),r&&r.close(),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(la.INTERACTION_STATUS_KEY)),this.emitEvent(Hu.LOGOUT_FAILURE,ua.Popup,null,h),i.cacheFailedRequest(h),h;case 8:return this.emitEvent(Hu.LOGOUT_END,ua.Popup),[2]}}))}))},e.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},e.prototype.getAccountByUsername=function(e){var t=this.getAllAccounts();return!Yc.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching username found, returning"),this.logger.verbosePii("Returning signed-in accounts matching username: "+e),t.filter((function(t){return t.username.toLowerCase()===e.toLowerCase()}))[0]||null):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)},e.prototype.getAccountByHomeId=function(e){var t=this.getAllAccounts();return!Yc.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching homeAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching homeAccountId: "+e),t.filter((function(t){return t.homeAccountId===e}))[0]||null):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)},e.prototype.getAccountByLocalId=function(e){var t=this.getAllAccounts();return!Yc.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching localAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching localAccountId: "+e),t.filter((function(t){return t.localAccountId===e}))[0]||null):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)},e.prototype.setActiveAccount=function(e){e?(this.logger.verbose("setActiveAccount: Active account set"),this.activeLocalAccountId=e.localAccountId):(this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.activeLocalAccountId=null)},e.prototype.getActiveAccount=function(){return this.activeLocalAccountId?this.getAccountByLocalId(this.activeLocalAccountId):(this.logger.verbose("getActiveAccount: No active account"),null)},e.prototype.getRedirectUri=function(e){this.logger.verbose("getRedirectUri called");var t=e||this.config.auth.redirectUri||bp.getCurrentUri();return ru.getAbsoluteUrl(t,bp.getCurrentUri())},e.prototype.getRedirectStartPage=function(e){this.logger.verbose("getRedirectStartPage called");var t=e||window.location.href;return ru.getAbsoluteUrl(t,bp.getCurrentUri())},e.prototype.getDiscoveredAuthority=function(e){return Ss(this,void 0,void 0,(function(){var t;return _s(this,(function(o){switch(o.label){case 0:return this.logger.verbose("getDiscoveredAuthority called"),t={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},e?(this.logger.verbose("Creating discovered authority with request authority"),[4,bu.createDiscoveredInstance(e,this.config.system.networkClient,this.browserStorage,t)]):[3,2];case 1:return[2,o.sent()];case 2:return this.logger.verbose("Creating discovered authority with configured authority"),[4,bu.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,t)];case 3:return[2,o.sent()]}}))}))},e.prototype.interactionInProgress=function(){return this.browserStorage.getTemporaryCache(la.INTERACTION_STATUS_KEY,!0)===ha},e.prototype.createAuthCodeClient=function(e,t){return Ss(this,void 0,void 0,(function(){var o;return _s(this,(function(r){switch(r.label){case 0:return this.logger.verbose("createAuthCodeClient called"),[4,this.getClientConfiguration(e,t)];case 1:return o=r.sent(),[2,new zu(o)]}}))}))},e.prototype.createSilentFlowClient=function(e,t){return Ss(this,void 0,void 0,(function(){var o;return _s(this,(function(r){switch(r.label){case 0:return this.logger.verbose("createSilentFlowClient called"),[4,this.getClientConfiguration(e,t)];case 1:return o=r.sent(),[2,new Gu(o)]}}))}))},e.prototype.createRefreshTokenClient=function(e,t){return Ss(this,void 0,void 0,(function(){var o;return _s(this,(function(r){switch(r.label){case 0:return this.logger.verbose("createRefreshTokenClient called"),[4,this.getClientConfiguration(e,t)];case 1:return o=r.sent(),[2,new Vu(o)]}}))}))},e.prototype.getClientConfiguration=function(e,t){return Ss(this,void 0,void 0,(function(){var o;return _s(this,(function(r){switch(r.label){case 0:return this.logger.verbose("getClientConfiguration called"),[4,this.getDiscoveredAuthority(t)];case 1:return o=r.sent(),[2,{authOptions:{clientId:this.config.auth.clientId,authority:o,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds},loggerOptions:{loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:"msal.js.browser",version:_p,cpu:"",os:""}}]}}))}))},e.prototype.preflightInteractiveRequest=function(e,t){if(this.logger.verbose("preflightInteractiveRequest called, validating app environment"),bp.blockReloadInHiddenIframes(),this.interactionInProgress())throw dd.createInteractionInProgressError();return this.initializeAuthorizationRequest(e,t)},e.prototype.preflightBrowserEnvironmentCheck=function(e){if(this.logger.verbose("preflightBrowserEnvironmentCheck started"),bp.blockNonBrowserEnvironment(this.isBrowserEnvironment),bp.blockRedirectInIframe(e,this.config.system.allowRedirectInIframe),bp.blockReloadInHiddenIframes(),bp.blockAcquireTokenInPopups(),e===ua.Redirect&&this.config.cache.cacheLocation===aa.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw dp.createInMemoryRedirectUnavailableError()},e.prototype.initializeBaseRequest=function(e){this.logger.verbose("Initializing BaseAuthRequest");var t=e.authority||this.config.auth.authority,o=xs(e&&e.scopes||[]),r=e&&e.correlationId||this.browserCrypto.createNewGuid();return e.authenticationScheme?this.logger.verbose('Authentication Scheme set to "'+e.authenticationScheme+'" as configured in Auth request'):(e.authenticationScheme=oa.BEARER,this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request')),Ts(Ts({},e),{correlationId:r,authority:t,scopes:o})},e.prototype.initializeServerTelemetryManager=function(e,t,o){this.logger.verbose("initializeServerTelemetryManager called");var r={clientId:this.config.auth.clientId,correlationId:t,apiId:e,forceRefresh:o||!1,wrapperSKU:this.wrapperSKU,wrapperVer:this.wrapperVer};return new Wu(r,this.browserStorage)},e.prototype.initializeAuthorizationRequest=function(e,t){this.logger.verbose("initializeAuthorizationRequest called");var o=this.getRedirectUri(e.redirectUri),r={interactionType:t},n=Fu.setRequestState(this.browserCrypto,e&&e.state||"",r),i=Ts(Ts({},this.initializeBaseRequest(e)),{redirectUri:o,state:n,nonce:e.nonce||this.browserCrypto.createNewGuid(),responseMode:zs.FRAGMENT}),s=e.account||this.getActiveAccount();if(s&&(this.logger.verbose("Setting validated request account"),this.logger.verbosePii("Setting validated request account: "+s),i.account=s),Yc.isEmpty(i.loginHint)){var a=this.browserStorage.getTemporaryCache(Ls.ADAL_ID_TOKEN);if(a){var c=new Cu(a,this.browserCrypto);this.browserStorage.removeItem(Ls.ADAL_ID_TOKEN),c.claims&&c.claims.upn&&(this.logger.verbose("No SSO params used and ADAL token retrieved, setting ADAL upn as loginHint"),i.loginHint=c.claims.upn)}}return this.browserStorage.updateCacheEntries(i.state,i.nonce,i.authority),i},e.prototype.initializeAuthorizationCodeRequest=function(e){return Ss(this,void 0,void 0,(function(){var t,o;return _s(this,(function(r){switch(r.label){case 0:return[4,this.browserCrypto.generatePkceCodes()];case 1:return t=r.sent(),o=Ts(Ts({},e),{redirectUri:e.redirectUri,code:"",codeVerifier:t.verifier}),e.codeChallenge=t.challenge,e.codeChallengeMethod=Hs.S256_CODE_CHALLENGE_METHOD,[2,o]}}))}))},e.prototype.initializeLogoutRequest=function(e){if(this.logger.verbose("initializeLogoutRequest called"),this.interactionInProgress())throw dd.createInteractionInProgressError();var t=Ts({correlationId:this.browserCrypto.createNewGuid()},e);return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not settibng post logout redirect uri"):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request"),t.postLogoutRedirectUri=ru.getAbsoluteUrl(e.postLogoutRedirectUri,bp.getCurrentUri())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect"):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri"),t.postLogoutRedirectUri=ru.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,bp.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page"),t.postLogoutRedirectUri=ru.getAbsoluteUrl(bp.getCurrentUri(),bp.getCurrentUri())),t},e.prototype.emitEvent=function(e,t,o,r){var n=this;if(this.isBrowserEnvironment){var i={eventType:e,interactionType:t||null,payload:o||null,error:r||null,timestamp:Date.now()};this.logger.info("Emitting event: "+e),this.eventCallbacks.forEach((function(t,o){n.logger.verbose("Emitting event to callback "+o+": "+e),t.apply(null,[i])}))}},e.prototype.addEventCallback=function(e){if(this.isBrowserEnvironment){var t=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: "+t),t}return null},e.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback "+e+" removed.")},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.initializeWrapperLibrary=function(e,t){this.wrapperSKU=e,this.wrapperVer=t},e.prototype.setNavigationClient=function(e){this.navigationClient=e},e}()),Ep=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};!function(e){e.SELECT_ACCOUNT="select_account",e.LOGIN="login",e.CONSENT="consent"}(Ip||(Ip={}));class Ap extends e.IProvider{constructor(e){super(),this.sessionStorageRequestedScopesKey="mgt-requested-scopes",this.sessionStorageDeniedScopesKey="mgt-denied-scopes",this.homeAccountKey="275f3731-e4a4-468a-bf9c-baca24b31e26",this.initProvider(e)}get publicClientApplication(){return this._publicClientApplication}get name(){return"MgtMsal2Provider"}initProvider(t){return Ep(this,void 0,void 0,(function*(){if(!t.clientId)throw new Error("clientId must be provided");{const o=t.options||{auth:{clientId:t.clientId}};this.ms_config=o,this.ms_config.auth.clientId=t.clientId,t.authority&&(this.ms_config.auth.authority=t.authority),t.redirectUri&&(this.ms_config.auth.redirectUri=t.redirectUri),this.ms_config.cache=o.cache||{},this.ms_config.cache.cacheLocation=o.cache.cacheLocation||"localStorage",void 0!==this.ms_config.cache.storeAuthStateInCookie&&null!==this.ms_config.cache.storeAuthStateInCookie||(this.ms_config.cache.storeAuthStateInCookie=!0),t.redirectUri&&(this.ms_config.auth.redirectUri=t.redirectUri),this.ms_config.system=o.system||{},this.ms_config.system.iframeHashTimeout=o.system.iframeHashTimeout||1e4,this._loginType=void 0!==t.loginType?t.loginType:e.LoginType.Redirect,this._loginHint=void 0!==t.loginHint?t.loginHint:null,this._sid=void 0!==t.sid?t.sid:null,this._domainHint=void 0!==t.domainHint?t.domainHint:null,this.scopes=void 0!==t.scopes?t.scopes:["user.read"],this._publicClientApplication=new xp(this.ms_config),this._prompt=void 0!==t.prompt?t.prompt:Ip.SELECT_ACCOUNT,this.graph=(0,e.createFromProvider)(this);try{const e=yield this._publicClientApplication.handleRedirectPromise();null!==e?this.handleResponse(null==e?void 0:e.account):this.trySilentSignIn()}catch(e){throw e}}}))}trySilentSignIn(){return Ep(this,void 0,void 0,(function*(){let t={scopes:this.scopes,domainHint:this._domainHint};if(this._sid||this._loginHint){t.sid=this._sid,t.loginHint=this._loginHint;try{this.setState(e.ProviderState.Loading);const o=yield this._publicClientApplication.ssoSilent(t);o&&this.handleResponse(null==o?void 0:o.account)}catch(t){this.setState(e.ProviderState.SignedOut)}}else{const t=this.getAccount();if(t&&(yield this.getAccessToken(null)))return void this.handleResponse(t);this.setState(e.ProviderState.SignedOut)}}))}login(){return Ep(this,void 0,void 0,(function*(){const t={scopes:this.scopes,loginHint:this._loginHint,prompt:this._prompt,domainHint:this._domainHint};if(this._loginType==e.LoginType.Popup){const e=yield this._publicClientApplication.loginPopup(t);this.handleResponse(null==e?void 0:e.account)}else{const e=Object.assign({},t);this._publicClientApplication.loginRedirect(e)}}))}getAllAccounts(){let e=[];return this._publicClientApplication.getAllAccounts().forEach((t=>{e.push({username:t.username,id:t.homeAccountId})})),e}setActiveAccount(e){this._publicClientApplication.setActiveAccount(this._publicClientApplication.getAccountByHomeId(e.id)),this.setStoredAccount(),super.setActiveAccount(e)}handleResponse(t){null!==t?(this.setActiveAccount({username:t.name,id:t.homeAccountId}),this.setState(e.ProviderState.SignedIn)):this.setState(e.ProviderState.SignedOut),this.clearRequestedScopes()}setStoredAccount(){this.clearStoredAccount(),window[this.ms_config.cache.cacheLocation].setItem(this.homeAccountKey,this._publicClientApplication.getActiveAccount().homeAccountId)}getStoredAccount(){let e=null;return e=window[this.ms_config.cache.cacheLocation].getItem(this.homeAccountKey),this._publicClientApplication.getAccountByHomeId(e)}clearStoredAccount(){window[this.ms_config.cache.cacheLocation].removeItem(this.homeAccountKey)}setRequestedScopes(e){e&&sessionStorage.setItem(this.sessionStorageRequestedScopesKey,JSON.stringify(e))}addDeniedScopes(e){if(e){let t=this.getDeniedScopes()||[];t=t.concat(e);let o=t.indexOf("openid");-1!==o&&t.splice(o,1),o=t.indexOf("profile"),-1!==o&&t.splice(o,1),sessionStorage.setItem(this.sessionStorageDeniedScopesKey,JSON.stringify(t))}}getDeniedScopes(){const e=sessionStorage.getItem(this.sessionStorageDeniedScopesKey);return e?JSON.parse(e):null}areScopesDenied(e){if(e){const t=this.getDeniedScopes();if(t&&t.filter((t=>-1!==e.indexOf(t))).length>0)return!0}return!1}clearRequestedScopes(){sessionStorage.removeItem(this.sessionStorageRequestedScopesKey)}getAccount(){return this.getStoredAccount()||(this._publicClientApplication.getAllAccounts().length>0?this._publicClientApplication.getAllAccounts()[0]:null)}logout(){return Ep(this,void 0,void 0,(function*(){const t={account:this._publicClientApplication.getActiveAccount()};this.clearStoredAccount(),this._loginType==e.LoginType.Redirect?(this._publicClientApplication.logoutRedirect(t),this.setState(e.ProviderState.SignedOut)):(yield this._publicClientApplication.logoutPopup(Object.assign({},t)),this.setState(e.ProviderState.SignedOut))}))}getAccessToken(t){return Ep(this,void 0,void 0,(function*(){const o=t&&t.scopes||this.scopes,r={scopes:o,account:this.getAccount()};try{const e=r;return(yield this._publicClientApplication.acquireTokenSilent(e)).accessToken}catch(t){if(t instanceof cu)if(this._loginType===e.LoginType.Redirect){if(this.areScopesDenied(o))throw t;this.setRequestedScopes(o),this._publicClientApplication.acquireTokenRedirect(r)}else try{return(yield this._publicClientApplication.acquireTokenPopup(r)).accessToken}catch(e){throw e}else this.setState(e.ProviderState.SignedOut)}throw null}))}}var Pp=function(e,t,o,r){var n,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},Rp=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Op=class extends e.MgtBaseProvider{constructor(){super(...arguments),this.clientId=""}get isAvailable(){return!0}initializeProvider(){if(this.clientId){const t={clientId:this.clientId};if(this.loginType&&this.loginType.length>1){let o=this.loginType.toLowerCase();o=o[0].toUpperCase()+o.slice(1);const r=e.LoginType[o];t.loginType=r}if(this.authority&&(t.authority=this.authority),this.scopes){const e=this.scopes.split(",");e&&e.length>0&&(t.scopes=e)}if(this.redirectUri&&(t.redirectUri=this.redirectUri),this.prompt){let e=this.prompt.toUpperCase();const o=Ip[e];t.prompt=o}if(this.prompt){let e=this.prompt.toUpperCase();const o=Ip[e];t.prompt=o}this.provider=new Ap(t),e.Providers.globalProvider=this.provider}}};Pp([(0,t.Cb)({attribute:"client-id",type:String}),Rp("design:type",Object)],Op.prototype,"clientId",void 0),Pp([(0,t.Cb)({attribute:"login-type",type:String}),Rp("design:type",Object)],Op.prototype,"loginType",void 0),Pp([(0,t.Cb)({attribute:"scopes",type:String}),Rp("design:type",Object)],Op.prototype,"scopes",void 0),Pp([(0,t.Cb)({attribute:"authority",type:String}),Rp("design:type",Object)],Op.prototype,"authority",void 0),Pp([(0,t.Cb)({attribute:"redirect-uri",type:String}),Rp("design:type",Object)],Op.prototype,"redirectUri",void 0),Pp([(0,t.Cb)({attribute:"prompt",type:String}),Rp("design:type",String)],Op.prototype,"prompt",void 0),Op=Pp([(0,t.Mo)("mgt-msal2-provider")],Op),e.Providers.globalProvider=new Ap({clientId:"c789f79b-23ae-4888-bd4c-eb55e13f7c8d",redirectUri:"http://localhost:5500/public/"}),document.getElementById("login").appendChild(function(){const e=document.createElement("div");return e.innerHTML="<mgt-login></mgt-login>",e}()),document.getElementById("files").appendChild(function(){const e=document.createElement("div");return e.innerHTML="<mgt-file-list></mgt-file-list>",e}()),document.getElementById("range").appendChild(function(){const e=document.createElement("div");return e.innerHTML='<mgt-get resource="/me/drive/items/E811A422CA0F0D69!899/workbook/tables/Sheet1/range"></mgt-get>',e}())})()})();